<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Static</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@fireproof/core/dist/browser/fireproof.global.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .gradient-text {
            background: linear-gradient(135deg, #a855f7, #ec4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .cherry-glow {
            box-shadow: 0 0 20px rgba(255, 23, 68, 0.3);
        }
        .animate-float {
            animation: float 3s ease-in-out infinite;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-purple-900 to-indigo-900 text-white">
    <div class="container mx-auto px-8 py-8">
        <!-- Header -->
        <header class="text-center mb-12">
            <div class="cherry-glow inline-block p-4 rounded-full bg-gradient-to-r from-red-500 to-pink-500 mb-6 animate-float">
                <span class="text-4xl">üçí</span>
            </div>
            <h1 class="text-5xl font-extrabold mb-4 gradient-text">
                Test Static
            </h1>
            <p class="text-xl text-purple-200">
                Your tiny, portable static app, ready to use!
            </p>
        </header>

        <!-- Main Content -->
        <main class="max-w-4xl mx-auto space-y-8">
            <!-- App Status Card -->
            <div class="glass rounded-2xl p-8">
                <h2 class="text-2xl font-semibold mb-6">üì± App Status</h2>
                <div class="space-y-4">
                    <div class="flex items-center space-x-3">
                        <div class="w-3 h-3 rounded-full bg-green-400 animate-pulse"></div>
                        <span class="font-medium text-green-200">App Running</span>
                    </div>
                    <div class="bg-white/5 rounded-lg p-4">
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div>
                                <span class="text-white/60">Type:</span>
                                <span class="text-white ml-2">Static HTML</span>
                            </div>
                            <div>
                                <span class="text-white/60">Size:</span>
                                <span class="text-white ml-2">&lt; 2 MB</span>
                            </div>
                            <div>
                                <span class="text-white/60">Database:</span>
                                <span class="text-white ml-2">Fireproof</span>
                            </div>
                            <div>
                                <span class="text-white/60">Time:</span>
                                <span class="text-white ml-2" id="current-time"></span>
                            </div>
                        </div>
                    </div>
                    <p class="text-purple-200 text-lg">Static HTML app with Fireproof database is ready!</p>
                </div>
            </div>

            <!-- Database Status Card -->
            <div class="glass rounded-2xl p-8">
                <h2 class="text-2xl font-semibold mb-6">üçí Fireproof Database</h2>
                <div class="space-y-4">
                    <div class="flex items-center space-x-3">
                        <div class="w-3 h-3 rounded-full bg-green-400 animate-pulse"></div>
                        <span class="font-medium text-green-200">Database Connected</span>
                    </div>
                    <div class="bg-white/5 rounded-lg p-4">
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div>
                                <span class="text-white/60">Documents:</span>
                                <span class="text-white ml-2" id="doc-count">0</span>
                            </div>
                            <div>
                                <span class="text-white/60">Size:</span>
                                <span class="text-white ml-2" id="db-size">0 bytes</span>
                            </div>
                        </div>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="toggleTodoDemo()" class="px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors">
                            <span id="demo-toggle-text">Show</span> Todo Demo
                        </button>
                        <button onclick="addSampleData()" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors">
                            Add Sample Data
                        </button>
                    </div>
                </div>
            </div>

            <!-- Todo Demo -->
            <div id="todo-demo" class="glass rounded-2xl p-8 hidden">
                <h3 class="text-xl font-semibold mb-4">Todo List Demo</h3>
                <form onsubmit="addTodo(event)" class="flex gap-2 mb-4">
                    <input
                        type="text"
                        id="todo-input"
                        placeholder="Add a new todo"
                        class="flex-grow px-4 py-2 rounded-lg bg-white/5 border border-white/20 text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-purple-500"
                        required
                    />
                    <button
                        type="submit"
                        class="px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors"
                    >
                        Add
                    </button>
                </form>
                <ul id="todo-list" class="space-y-2">
                    <p class="text-white/60">No todos yet. Add one above!</p>
                </ul>
            </div>

            <!-- Next Steps Card -->
            <div class="glass rounded-2xl p-8">
                <h2 class="text-2xl font-semibold mb-6">üéØ Next Steps</h2>
                <div class="space-y-4 text-purple-200">
                    <div class="flex items-start space-x-3">
                        <span class="text-purple-400 font-bold">1.</span>
                        <p>Customize the HTML and CSS in this file</p>
                    </div>
                    <div class="flex items-start space-x-3">
                        <span class="text-purple-400 font-bold">2.</span>
                        <p>Add more Fireproof database operations</p>
                    </div>
                    <div class="flex items-start space-x-3">
                        <span class="text-purple-400 font-bold">3.</span>
                        <p>Implement your app's core functionality</p>
                    </div>
                    <div class="flex items-start space-x-3">
                        <span class="text-purple-400 font-bold">4.</span>
                        <p>Test locally by opening this HTML file</p>
                    </div>
                    <div class="flex items-start space-x-3">
                        <span class="text-purple-400 font-bold">5.</span>
                        <p>Share your static cherry! üçí</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Initialize Fireproof database
        const { fireproof } = Fireproof;
        const db = fireproof('test-static');
        
        let showTodoDemo = false;
        let todos = [];

        // Update time
        function updateTime() {
            document.getElementById('current-time').textContent = new Date().toLocaleString();
        }
        updateTime();
        setInterval(updateTime, 1000);

        // Database operations
        async function updateDatabaseStatus() {
            try {
                const info = await db.info();
                document.getElementById('doc-count').textContent = info.doc_count;
                document.getElementById('db-size').textContent = info.data_size + ' bytes';
            } catch (error) {
                console.error('Database status error:', error);
            }
        }

        async function loadTodos() {
            try {
                const result = await db.query('type', { key: 'todo' });
                todos = result.docs || [];
                renderTodos();
            } catch (error) {
                console.error('Load todos error:', error);
            }
        }

        async function addTodo(event) {
            event.preventDefault();
            const input = document.getElementById('todo-input');
            const text = input.value.trim();
            
            if (text) {
                try {
                    await db.put({
                        _id: crypto.randomUUID(),
                        type: 'todo',
                        text: text,
                        done: false,
                        created: Date.now()
                    });
                    input.value = '';
                    await loadTodos();
                    await updateDatabaseStatus();
                } catch (error) {
                    console.error('Add todo error:', error);
                }
            }
        }

        async function toggleTodo(todo) {
            try {
                await db.put({ ...todo, done: !todo.done });
                await loadTodos();
            } catch (error) {
                console.error('Toggle todo error:', error);
            }
        }

        async function deleteTodo(id) {
            try {
                await db.del(id);
                await loadTodos();
                await updateDatabaseStatus();
            } catch (error) {
                console.error('Delete todo error:', error);
            }
        }

        function renderTodos() {
            const todoList = document.getElementById('todo-list');
            
            if (todos.length === 0) {
                todoList.innerHTML = '<p class="text-white/60">No todos yet. Add one above!</p>';
                return;
            }

            todoList.innerHTML = todos.map(todo => `
                <li class="flex items-center justify-between bg-white/5 p-3 rounded-lg">
                    <label class="flex items-center space-x-3 cursor-pointer">
                        <input
                            type="checkbox"
                            ${todo.done ? 'checked' : ''}
                            onchange="toggleTodo(${JSON.stringify(todo).replace(/"/g, '&quot;')})"
                            class="form-checkbox h-5 w-5 text-purple-600 rounded border-gray-300 focus:ring-purple-500"
                        />
                        <span class="text-lg ${todo.done ? 'line-through text-white/60' : 'text-white'}">
                            ${todo.text}
                        </span>
                    </label>
                    <button
                        onclick="deleteTodo('${todo._id}')"
                        class="text-red-400 hover:text-red-500 transition-colors"
                    >
                        Delete
                    </button>
                </li>
            `).join('');
        }

        function toggleTodoDemo() {
            showTodoDemo = !showTodoDemo;
            const demo = document.getElementById('todo-demo');
            const toggleText = document.getElementById('demo-toggle-text');
            
            if (showTodoDemo) {
                demo.classList.remove('hidden');
                toggleText.textContent = 'Hide';
            } else {
                demo.classList.add('hidden');
                toggleText.textContent = 'Show';
            }
        }

        async function addSampleData() {
            try {
                await db.put({
                    _id: crypto.randomUUID(),
                    type: 'todo',
                    text: 'Sample todo from static app!',
                    done: false,
                    created: Date.now()
                });
                await loadTodos();
                await updateDatabaseStatus();
            } catch (error) {
                console.error('Add sample data error:', error);
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', async () => {
            await updateDatabaseStatus();
            await loadTodos();
        });
    </script>
</body>
</html>

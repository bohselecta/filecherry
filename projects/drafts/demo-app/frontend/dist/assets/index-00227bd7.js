var __defProp2=Object.defineProperty,__defNormalProp=(e,t,r)=>t in e?__defProp2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,__publicField=(e,t,r)=>(__defNormalProp(e,"symbol"!=typeof t?t+"":t,r),r),__accessCheck2=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},__privateGet2=(e,t,r)=>(__accessCheck2(e,t,"read from private field"),r?r.call(e):t.get(e)),__privateAdd2=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},__privateSet2=(e,t,r,n)=>(__accessCheck2(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),__privateWrapper=(e,t,r,n)=>({set _(n){__privateSet2(e,t,n,r)},get _(){return __privateGet2(e,t,n)}}),__privateMethod2=(e,t,r)=>(__accessCheck2(e,t,"access private method"),r),_a,_blocks,_fetchers,_committed,_b,_committed2,_c,_queue,_carryoverConcurrencyCount,_isIntervalIgnored,_intervalCount,_intervalCap,_interval,_intervalEnd,_intervalId,_timeoutId,_queue2,_queueClass,_pending,_concurrency,_isPaused,_throwOnTimeout,_idAssigner,_doesIntervalAllowAnother,doesIntervalAllowAnother_get,_doesConcurrentAllowAnother,doesConcurrentAllowAnother_get,_next,next_fn,_onResumeInterval,onResumeInterval_fn,_isIntervalPaused,isIntervalPaused_get,_tryToStartAnother,tryToStartAnother_fn,_initializeIntervalIfNeeded,initializeIntervalIfNeeded_fn,_onInterval,onInterval_fn,_processQueue,processQueue_fn,_throwOnAbort,throwOnAbort_fn,_onEvent,onEvent_fn,_head,_tail,_size,_file,_d,_e;!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={},l$1=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$2=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$1=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$1(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=z$1&&e[z$1]||e["@@iterator"])?e:null}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$1={};function E$1(e,t,r){this.props=e,this.context=t,this.refs=D$1,this.updater=r||B$1}function F(){}function G$1(e,t,r){this.props=e,this.context=t,this.refs=D$1,this.updater=r||B$1}E$1.prototype.isReactComponent={},E$1.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},E$1.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},F.prototype=E$1.prototype;var H$1=G$1.prototype=new F;H$1.constructor=G$1,C$1(H$1,E$1.prototype),H$1.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$1(e,t,r){var n,i={},o=null,s=null;if(null!=t)for(n in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)J.call(t,n)&&!L$1.hasOwnProperty(n)&&(i[n]=t[n]);var a=arguments.length-2;if(1===a)i.children=r;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(e&&e.defaultProps)for(n in a=e.defaultProps)void 0===i[n]&&(i[n]=a[n]);return{$$typeof:l$1,type:e,key:o,ref:s,props:i,_owner:K$1.current}}function N$1(e,t){return{$$typeof:l$1,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function O$1(e){return"object"==typeof e&&null!==e&&e.$$typeof===l$1}function escape$1(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}var P$1=/\/+/g;function Q$1(e,t){return"object"==typeof e&&null!==e&&null!=e.key?escape$1(""+e.key):t.toString(36)}function R$1(e,t,r,n,i){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var s=!1;if(null===e)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case l$1:case n$1:s=!0}}if(s)return i=i(s=e),e=""===n?"."+Q$1(s,0):n,I$1(i)?(r="",null!=e&&(r=e.replace(P$1,"$&/")+"/"),R$1(i,t,r,"",function(e){return e})):null!=i&&(O$1(i)&&(i=N$1(i,r+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(P$1,"$&/")+"/")+e)),t.push(i)),1;if(s=0,n=""===n?".":n+":",I$1(e))for(var a=0;a<e.length;a++){var l=n+Q$1(o=e[a],a);s+=R$1(o,t,r,l,i)}else if("function"==typeof(l=A$1(e)))for(e=l.call(e),a=0;!(o=e.next()).done;)s+=R$1(o=o.value,t,r,l=n+Q$1(o,a++),i);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function S$1(e,t,r){if(null==e)return e;var n=[],i=0;return R$1(e,n,"","",function(e){return t.call(r,e,i++)}),n}function T$1(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};function X$1(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$1,forEach:function(e,t,r){S$1(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return S$1(e,function(){t++}),t},toArray:function(e){return S$1(e,function(e){return e})||[]},only:function(e){if(!O$1(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},react_production_min.Component=E$1,react_production_min.Fragment=p$2,react_production_min.Profiler=r,react_production_min.PureComponent=G$1,react_production_min.StrictMode=q$1,react_production_min.Suspense=w,react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1,react_production_min.act=X$1,react_production_min.cloneElement=function(e,t,r){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=C$1({},e.props),i=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=K$1.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)J.call(t,l)&&!L$1.hasOwnProperty(l)&&(n[l]=void 0===t[l]&&void 0!==a?a[l]:t[l])}var l=arguments.length-2;if(1===l)n.children=r;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];n.children=a}return{$$typeof:l$1,type:e.type,key:i,ref:o,props:n,_owner:s}},react_production_min.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:t,_context:e},e.Consumer=e},react_production_min.createElement=M$1,react_production_min.createFactory=function(e){var t=M$1.bind(null,e);return t.type=e,t},react_production_min.createRef=function(){return{current:null}},react_production_min.forwardRef=function(e){return{$$typeof:v$1,render:e}},react_production_min.isValidElement=O$1,react_production_min.lazy=function(e){return{$$typeof:y,_payload:{_status:-1,_result:e},_init:T$1}},react_production_min.memo=function(e,t){return{$$typeof:x,type:e,compare:void 0===t?null:t}},react_production_min.startTransition=function(e){var t=V$1.transition;V$1.transition={};try{e()}finally{V$1.transition=t}},react_production_min.unstable_act=X$1,react_production_min.useCallback=function(e,t){return U$1.current.useCallback(e,t)},react_production_min.useContext=function(e){return U$1.current.useContext(e)},react_production_min.useDebugValue=function(){},react_production_min.useDeferredValue=function(e){return U$1.current.useDeferredValue(e)},react_production_min.useEffect=function(e,t){return U$1.current.useEffect(e,t)},react_production_min.useId=function(){return U$1.current.useId()},react_production_min.useImperativeHandle=function(e,t,r){return U$1.current.useImperativeHandle(e,t,r)},react_production_min.useInsertionEffect=function(e,t){return U$1.current.useInsertionEffect(e,t)},react_production_min.useLayoutEffect=function(e,t){return U$1.current.useLayoutEffect(e,t)},react_production_min.useMemo=function(e,t){return U$1.current.useMemo(e,t)},react_production_min.useReducer=function(e,t,r){return U$1.current.useReducer(e,t,r)},react_production_min.useRef=function(e){return U$1.current.useRef(e)},react_production_min.useState=function(e){return U$1.current.useState(e)},react_production_min.useSyncExternalStore=function(e,t,r){return U$1.current.useSyncExternalStore(e,t,r)},react_production_min.useTransition=function(){return U$1.current.useTransition()},react_production_min.version="18.3.1",react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs(reactExports);
/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=reactExports,k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$1=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$1={key:!0,ref:!0,__self:!0,__source:!0};function q(e,t,r){var i,o={},s=null,a=null;for(i in void 0!==r&&(s=""+r),void 0!==t.key&&(s=""+t.key),void 0!==t.ref&&(a=t.ref),t)m$1.call(t,i)&&!p$1.hasOwnProperty(i)&&(o[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===o[i]&&(o[i]=t[i]);return{$$typeof:k,type:e,key:s,ref:a,props:o,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l,reactJsxRuntime_production_min.jsx=q,reactJsxRuntime_production_min.jsxs=q,jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};
/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
!function(e){function t(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,o=e[n];if(!(0<i(o,t)))break e;e[n]=t,e[r]=o,r=n}}function r(e){return 0===e.length?null:e[0]}function n(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,o=e.length,s=o>>>1;n<s;){var a=2*(n+1)-1,l=e[a],c=a+1,u=e[c];if(0>i(l,r))c<o&&0>i(u,l)?(e[n]=u,e[c]=r,n=c):(e[n]=l,e[a]=r,n=a);else{if(!(c<o&&0>i(u,r)))break e;e[n]=u,e[c]=r,n=c}}}return t}function i(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();e.unstable_now=function(){return s.now()-a}}var l=[],c=[],u=1,d=null,h=3,f=!1,p=!1,y=!1,g="function"==typeof setTimeout?setTimeout:null,m="function"==typeof clearTimeout?clearTimeout:null,b="undefined"!=typeof setImmediate?setImmediate:null;function w(e){for(var i=r(c);null!==i;){if(null===i.callback)n(c);else{if(!(i.startTime<=e))break;n(c),i.sortIndex=i.expirationTime,t(l,i)}i=r(c)}}function v(e){if(y=!1,w(e),!p)if(null!==r(l))p=!0,I(k);else{var t=r(c);null!==t&&P(v,t.startTime-e)}}function k(t,i){p=!1,y&&(y=!1,m(x),x=-1),f=!0;var o=h;try{for(w(i),d=r(l);null!==d&&(!(d.expirationTime>i)||t&&!C());){var s=d.callback;if("function"==typeof s){d.callback=null,h=d.priorityLevel;var a=s(d.expirationTime<=i);i=e.unstable_now(),"function"==typeof a?d.callback=a:d===r(l)&&n(l),w(i)}else n(l);d=r(l)}if(null!==d)var u=!0;else{var g=r(c);null!==g&&P(v,g.startTime-i),u=!1}return u}finally{d=null,h=o,f=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var _,E=!1,S=null,x=-1,T=5,$=-1;function C(){return!(e.unstable_now()-$<T)}function N(){if(null!==S){var t=e.unstable_now();$=t;var r=!0;try{r=S(!0,t)}finally{r?_():(E=!1,S=null)}}else E=!1}if("function"==typeof b)_=function(){b(N)};else if("undefined"!=typeof MessageChannel){var A=new MessageChannel,L=A.port2;A.port1.onmessage=N,_=function(){L.postMessage(null)}}else _=function(){g(N,0)};function I(e){S=e,E||(E=!0,_())}function P(t,r){x=g(function(){t(e.unstable_now())},r)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_continueExecution=function(){p||f||(p=!0,I(k))},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var r=h;h=t;try{return e()}finally{h=r}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=h;h=e;try{return t()}finally{h=r}},e.unstable_scheduleCallback=function(n,i,o){var s=e.unstable_now();switch("object"==typeof o&&null!==o?o="number"==typeof(o=o.delay)&&0<o?s+o:s:o=s,n){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return n={id:u++,callback:i,priorityLevel:n,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>s?(n.sortIndex=o,t(c,n),null===r(l)&&n===r(c)&&(y?(m(x),x=-1):y=!0,P(v,o-s))):(n.sortIndex=a,t(l,n),p||f||(p=!0,I(k))),n},e.unstable_shouldYield=C,e.unstable_wrapCallback=function(e){var t=h;return function(){var r=h;h=t;try{return e.apply(this,arguments)}finally{h=r}}}}(scheduler_production_min),scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports,aa=reactExports,ca=schedulerExports;
/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function p(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(e,t){ha(e,t),ha(e+"Capture",t)}function ha(e,t){for(ea[e]=t,e=0;e<t.length;e++)da.add(t[e])}var ia=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(e){return!!ja.call(ma,e)||!ja.call(la,e)&&(ka.test(e)?ma[e]=!0:(la[e]=!0,!1))}function pa(e,t,r,n){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}function qa(e,t,r,n){if(null==t||pa(e,t,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function v(e,t,r,n,i,o,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){z[e]=new v(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];z[t]=new v(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){z[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){z[e]=new v(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){z[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){z[e]=new v(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){z[e]=new v(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){z[e]=new v(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){z[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(e){return e[1].toUpperCase()}function ta(e,t,r,n){var i=z.hasOwnProperty(t)?z[t]:null;(null!==i?0!==i.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(qa(t,r,i,n)&&(r=null),n||null===i?oa(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=null===r?3!==i.type&&"":r:(t=i.attributeName,n=i.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(i=i.type)||4===i&&!0===r?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(ra,sa);z[t]=new v(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(ra,sa);z[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(ra,sa);z[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){z[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)}),z.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){z[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)});var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=Ja&&e[Ja]||e["@@iterator"])?e:null}var A=Object.assign,La;function Ma(e){if(void 0===La)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);La=t&&t[1]||""}return"\n"+La+e}var Na=!1;function Oa(e,t){if(!e||Na)return"";Na=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&"string"==typeof c.stack){for(var i=c.stack.split("\n"),o=n.stack.split("\n"),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(1!==s||1!==a)do{if(s--,0>--a||i[s]!==o[a]){var l="\n"+i[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=a);break}}}finally{Na=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Ma(e):""}function Pa(e){switch(e.tag){case 5:return Ma(e.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return e=Oa(e.type,!1);case 11:return e=Oa(e.type.render,!1);case 1:return e=Oa(e.type,!0);default:return""}}function Qa(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case Ca:return(e.displayName||"Context")+".Consumer";case Ba:return(e._context.displayName||"Context")+".Provider";case Da:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case Ga:return null!==(t=e.displayName||null)?t:Qa(e.type)||"Memo";case Ha:t=e._payload,e=e._init;try{return Qa(e(t))}catch(r){}}return null}function Ra(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(t);case 8:return t===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function Sa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function Ta(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Ua(e){var t=Ta(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==r&&"function"==typeof r.get&&"function"==typeof r.set){var i=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){n=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Va(e){e._valueTracker||(e._valueTracker=Ua(e))}function Wa(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Ta(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function Xa(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Ya(e,t){var r=t.checked;return A({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function Za(e,t){var r=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;r=Sa(null!=t.value?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function ab(e,t){null!=(t=t.checked)&&ta(e,"checked",t,!1)}function bb(e,t){ab(e,t);var r=Sa(t.value),n=t.type;if(null!=r)"number"===n?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?cb(e,t.type,r):t.hasOwnProperty("defaultValue")&&cb(e,t.type,Sa(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function db$1(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function cb(e,t,r){"number"===t&&Xa(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var eb=Array.isArray;function fb(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Sa(r),t=null,i=0;i<e.length;i++){if(e[i].value===r)return e[i].selected=!0,void(n&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function gb(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(p(91));return A({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function hb(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(p(92));if(eb(r)){if(1<r.length)throw Error(p(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:Sa(r)}}function ib(e,t){var r=Sa(t.value),n=Sa(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=n&&(e.defaultValue=""+n)}function jb(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function kb(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?kb(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var mb,nb=(a=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((mb=mb||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=mb.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction(function(){return a(e,t)})}:a),a;function ob(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];function rb(e,t,r){return null==t||"boolean"==typeof t||""===t?"":r||"number"!=typeof t||0===t||pb.hasOwnProperty(e)&&pb[e]?(""+t).trim():t+"px"}function sb(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var n=0===r.indexOf("--"),i=rb(r,t[r],n);"float"===r&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}Object.keys(pb).forEach(function(e){qb.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pb[t]=pb[e]})});var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(e,t){if(t){if(tb[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(p(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(p(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(p(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(p(62))}}function vb(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var yb=null,zb=null,Ab=null;function Bb(e){if(e=Cb(e)){if("function"!=typeof yb)throw Error(p(280));var t=e.stateNode;t&&(t=Db(t),yb(e.stateNode,e.type,t))}}function Eb(e){zb?Ab?Ab.push(e):Ab=[e]:zb=e}function Fb(){if(zb){var e=zb,t=Ab;if(Ab=zb=null,Bb(e),t)for(e=0;e<t.length;e++)Bb(t[e])}}function Gb(e,t){return e(t)}function Hb(){}var Ib=!1;function Jb(e,t,r){if(Ib)return e(t,r);Ib=!0;try{return Gb(e,t,r)}finally{Ib=!1,(null!==zb||null!==Ab)&&(Hb(),Fb())}}function Kb(e,t){var r=e.stateNode;if(null===r)return null;var n=Db(r);if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!=typeof r)throw Error(p(231,t,typeof r));return r}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch(a){Lb=!1}function Nb(e,t,r,n,i,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(e){Ob=!0,Pb=e}};function Tb(e,t,r,n,i,o,s,a,l){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(e,t,r,n,i,o,s,a,l){if(Tb.apply(this,arguments),Ob){if(!Ob)throw Error(p(198));var c=Pb;Ob=!1,Pb=null,Qb||(Qb=!0,Rb=c)}}function Vb(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function Wb(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Xb(e){if(Vb(e)!==e)throw Error(p(188))}function Yb(e){var t=e.alternate;if(!t){if(null===(t=Vb(e)))throw Error(p(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(n=i.return)){r=n;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===r)return Xb(i),e;if(o===n)return Xb(i),t;o=o.sibling}throw Error(p(188))}if(r.return!==n.return)r=i,n=o;else{for(var s=!1,a=i.child;a;){if(a===r){s=!0,r=i,n=o;break}if(a===n){s=!0,n=i,r=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===r){s=!0,r=o,n=i;break}if(a===n){s=!0,n=o,r=i;break}a=a.sibling}if(!s)throw Error(p(189))}}if(r.alternate!==n)throw Error(p(190))}if(3!==r.tag)throw Error(p(188));return r.stateNode.current===r?e:t}function Zb(e){return null!==(e=Yb(e))?$b(e):null}function $b(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=$b(e);if(null!==t)return t;e=e.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(e){if(lc&&"function"==typeof lc.onCommitFiberRoot)try{lc.onCommitFiberRoot(kc,e,void 0,!(128&~e.current.flags))}catch(t){}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(e){return 0===(e>>>=0)?32:31-(pc(e)/qc|0)|0}var rc=64,sc=4194304;function tc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function uc(e,t){var r=e.pendingLanes;if(0===r)return 0;var n=0,i=e.suspendedLanes,o=e.pingedLanes,s=268435455&r;if(0!==s){var a=s&~i;0!==a?n=tc(a):0!==(o&=s)&&(n=tc(o))}else 0!==(s=r&~i)?n=tc(s):0!==o&&(n=tc(o));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&i)&&((i=n&-n)>=(o=t&-t)||16===i&&4194240&o))return t;if(4&n&&(n|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)i=1<<(r=31-oc(t)),n|=e[r],t&=~i;return n}function vc(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function wc(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-oc(o),a=1<<s,l=i[s];-1===l?0!==(a&r)&&0===(a&n)||(i[s]=vc(a,t)):l<=t&&(e.expiredLanes|=a),o&=~a}}function xc(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function yc(){var e=rc;return!(4194240&(rc<<=1))&&(rc=64),e}function zc(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Ac(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-oc(t)]=r}function Bc(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-oc(r),o=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~o}}function Cc(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-oc(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var C=0;function Dc(e){return 1<(e&=-e)?4<e?268435455&e?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(e,t){switch(e){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(t.pointerId)}}function Tc(e,t,r,n,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:o,targetContainers:[i]},null!==t&&(null!==(t=Cb(t))&&Fc(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Uc(e,t,r,n,i){switch(t){case"focusin":return Lc=Tc(Lc,e,t,r,n,i),!0;case"dragenter":return Mc=Tc(Mc,e,t,r,n,i),!0;case"mouseover":return Nc=Tc(Nc,e,t,r,n,i),!0;case"pointerover":var o=i.pointerId;return Oc.set(o,Tc(Oc.get(o)||null,e,t,r,n,i)),!0;case"gotpointercapture":return o=i.pointerId,Pc.set(o,Tc(Pc.get(o)||null,e,t,r,n,i)),!0}return!1}function Vc(e){var t=Wc(e.target);if(null!==t){var r=Vb(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=Wb(r)))return e.blockedOn=t,void Ic(e.priority,function(){Gc(r)})}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Xc(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=Yc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=Cb(r))&&Fc(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);wb=n,r.target.dispatchEvent(n),wb=null,t.shift()}return!0}function Zc(e,t,r){Xc(e)&&r.delete(t)}function $c(){Jc=!1,null!==Lc&&Xc(Lc)&&(Lc=null),null!==Mc&&Xc(Mc)&&(Mc=null),null!==Nc&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(e,t){e.blockedOn===t&&(e.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(e){function t(t){return ad(t,e)}if(0<Kc.length){ad(Kc[0],e);for(var r=1;r<Kc.length;r++){var n=Kc[r];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==Lc&&ad(Lc,e),null!==Mc&&ad(Mc,e),null!==Nc&&ad(Nc,e),Oc.forEach(t),Pc.forEach(t),r=0;r<Qc.length;r++)(n=Qc[r]).blockedOn===e&&(n.blockedOn=null);for(;0<Qc.length&&null===(r=Qc[0]).blockedOn;)Vc(r),null===r.blockedOn&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(e,t,r,n){var i=C,o=cd.transition;cd.transition=null;try{C=1,fd(e,t,r,n)}finally{C=i,cd.transition=o}}function gd(e,t,r,n){var i=C,o=cd.transition;cd.transition=null;try{C=4,fd(e,t,r,n)}finally{C=i,cd.transition=o}}function fd(e,t,r,n){if(dd){var i=Yc(e,t,r,n);if(null===i)hd(e,t,n,id,r),Sc(e,n);else if(Uc(i,e,t,r,n))n.stopPropagation();else if(Sc(e,n),4&t&&-1<Rc.indexOf(e)){for(;null!==i;){var o=Cb(i);if(null!==o&&Ec(o),null===(o=Yc(e,t,r,n))&&hd(e,t,n,id,r),o===i)break;i=o}null!==i&&n.stopPropagation()}else hd(e,t,n,null,r)}}var id=null;function Yc(e,t,r,n){if(id=null,null!==(e=Wc(e=xb(n))))if(null===(t=Vb(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=Wb(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return id=e,null}function jd(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var e,t,r=ld,n=r.length,i="value"in kd?kd.value:kd.textContent,o=i.length;for(e=0;e<n&&r[e]===i[e];e++);var s=n-e;for(t=1;t<=s&&r[n-t]===i[o-t];t++);return md=i.slice(e,1<t?1-t:void 0)}function od(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function pd(){return!0}function qd(){return!1}function rd(e){function t(t,r,n,i,o){for(var s in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?pd:qd,this.isPropagationStopped=qd,this}return A(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),t}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==yd&&(yd&&"mousemove"===e.type?(wd=e.screenX-yd.screenX,xd=e.screenY-yd.screenY):xd=wd=0,yd=e),wd)},movementY:function(e){return"movementY"in e?e.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Od[e])&&!!t[e]}function zd(){return Pd}var Qd=A({},ud,{key:function(e){if(e.key){var t=Md[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=od(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Nd[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(e){return"keypress"===e.type?od(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?od(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=String.fromCharCode(32),fe=!1;function ge(e,t){switch(e){case"keyup":return-1!==$d.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var ie=!1;function je(e,t){switch(e){case"compositionend":return he(t);case"keypress":return 32!==t.which?null:(fe=!0,ee);case"textInput":return(e=t.data)===ee&&fe?null:e;default:return null}}function ke(e,t){if(ie)return"compositionend"===e||!ae&&ge(e,t)?(e=nd(),md=ld=kd=null,ie=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return de&&"ko"!==t.locale?null:t.data}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!le[e.type]:"textarea"===t}function ne(e,t,r,n){Eb(n),0<(t=oe(t,"onChange")).length&&(r=new td("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var pe=null,qe=null;function re(e){se(e,0)}function te(e){if(Wa(ue(e)))return e}function ve(e,t){if("change"===e)return t}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye="function"==typeof ze.oninput}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(e){if("value"===e.propertyName&&te(qe)){var t=[];ne(t,qe,e,xb(e)),Jb(re,t)}}function Ce(e,t,r){"focusin"===e?(Ae(),qe=r,(pe=t).attachEvent("onpropertychange",Be)):"focusout"===e&&Ae()}function De(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return te(qe)}function Ee(e,t){if("click"===e)return te(t)}function Fe(e,t){if("input"===e||"change"===e)return te(t)}function Ge(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t}var He="function"==typeof Object.is?Object.is:Ge;function Ie(e,t){if(He(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!ja.call(t,i)||!He(e[i],t[i]))return!1}return!0}function Je(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ke(e,t){var r,n=Je(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Je(n)}}function Le(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?Le(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function Me(){for(var e=window,t=Xa();t instanceof e.HTMLIFrameElement;){try{var r="string"==typeof t.contentWindow.location.href}catch(n){r=!1}if(!r)break;t=Xa((e=t.contentWindow).document)}return t}function Ne(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function Oe(e){var t=Me(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Le(r.ownerDocument.documentElement,r)){if(null!==n&&Ne(r))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if((e=(t=r.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=r.textContent.length,o=Math.min(n.start,i);n=void 0===n.end?o:Math.min(n.end,i),!e.extend&&o>n&&(i=n,n=o,o=i),i=Ke(r,o);var s=Ke(r,n);i&&s&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),o>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=r;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof r.focus&&r.focus(),r=0;r<t.length;r++)(e=t[r]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;Te||null==Qe||Qe!==Xa(n)||("selectionStart"in(n=Qe)&&Ne(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},Se&&Ie(Se,n)||(Se=n,0<(n=oe(Re,"onSelect")).length&&(t=new td("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Qe)))}function Ve(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};function Ze(e){if(Xe[e])return Xe[e];if(!We[e])return e;var t,r=We[e];for(t in r)if(r.hasOwnProperty(t)&&t in Ye)return Xe[e]=r[t];return e}ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);var $e=Ze("animationend"),af=Ze("animationiteration"),bf$1=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(e,t){df.set(e,t),fa(t,[e])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd"),ff(af,"onAnimationIteration"),ff(bf$1,"onAnimationStart"),ff("dblclick","onDoubleClick"),ff("focusin","onFocus"),ff("focusout","onBlur"),ff(cf,"onTransitionEnd"),ha("onMouseEnter",["mouseout","mouseover"]),ha("onMouseLeave",["mouseout","mouseover"]),ha("onPointerEnter",["pointerout","pointerover"]),ha("onPointerLeave",["pointerout","pointerover"]),fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),fa("onBeforeInput",["compositionend","keypress","textInput","paste"]),fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Ub(n,t,void 0,e),e.currentTarget=null}function se(e,t){t=!!(4&t);for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var o=void 0;if(t)for(var s=n.length-1;0<=s;s--){var a=n[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;nf(i,a,c),o=l}else for(s=0;s<n.length;s++){if(l=(a=n[s]).instance,c=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;nf(i,a,c),o=l}}}if(Qb)throw e=Rb,Qb=!1,Rb=null,e}function D(e,t){var r=t[of];void 0===r&&(r=t[of]=new Set);var n=e+"__bubble";r.has(n)||(pf(t,e,2,!1),r.add(n))}function qf(e,t,r){var n=0;t&&(n|=4),pf(r,e,n,t)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(e){if(!e[rf]){e[rf]=!0,da.forEach(function(t){"selectionchange"!==t&&(mf.has(t)||qf(t,!1,e),qf(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[rf]||(t[rf]=!0,qf("selectionchange",!1,t))}}function pf(e,t,r,n){switch(jd(t)){case 1:var i=ed;break;case 4:i=gd;break;default:i=fd}r=i.bind(null,t,r,e),i=void 0,!Lb||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),n?void 0!==i?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):void 0!==i?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function hd(e,t,r,n,i){var o=n;if(!(1&t||2&t||null===n))e:for(;;){if(null===n)return;var s=n.tag;if(3===s||4===s){var a=n.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===s)for(s=n.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;s=s.return}for(;null!==a;){if(null===(s=Wc(a)))return;if(5===(l=s.tag)||6===l){n=o=s;continue e}a=a.parentNode}}n=n.return}Jb(function(){var n=o,i=xb(r),s=[];e:{var a=df.get(e);if(void 0!==a){var l=td,c=e;switch(e){case"keypress":if(0===od(r))break e;case"keydown":case"keyup":l=Rd;break;case"focusin":c="focus",l=Fd;break;case"focusout":c="blur",l=Fd;break;case"beforeblur":case"afterblur":l=Fd;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Vd;break;case $e:case af:case bf$1:l=Hd;break;case cf:l=Xd;break;case"scroll":l=vd;break;case"wheel":l=Zd;break;case"copy":case"cut":case"paste":l=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Td}var u=!!(4&t),d=!u&&"scroll"===e,h=u?null!==a?a+"Capture":null:a;u=[];for(var f,p=n;null!==p;){var y=(f=p).stateNode;if(5===f.tag&&null!==y&&(f=y,null!==h&&(null!=(y=Kb(p,h))&&u.push(tf(p,y,f)))),d)break;p=p.return}0<u.length&&(a=new l(a,c,null,r,i),s.push({event:a,listeners:u}))}}if(!(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||r===wb||!(c=r.relatedTarget||r.fromElement)||!Wc(c)&&!c[uf])&&(l||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=n,null!==(c=(c=r.relatedTarget||r.toElement)?Wc(c):null)&&(c!==(d=Vb(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=n),l!==c)){if(u=Bd,y="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=Td,y="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==l?a:ue(l),f=null==c?a:ue(c),(a=new u(y,p+"leave",l,r,i)).target=d,a.relatedTarget=f,y=null,Wc(i)===n&&((u=new u(h,p+"enter",c,r,i)).target=f,u.relatedTarget=d,y=u),d=y,l&&c)e:{for(h=c,p=0,f=u=l;f;f=vf(f))p++;for(f=0,y=h;y;y=vf(y))f++;for(;0<p-f;)u=vf(u),p--;for(;0<f-p;)h=vf(h),f--;for(;p--;){if(u===h||null!==h&&u===h.alternate)break e;u=vf(u),h=vf(h)}u=null}else u=null;null!==l&&wf(s,a,l,u,!1),null!==c&&null!==d&&wf(s,d,c,u,!0)}if("select"===(l=(a=n?ue(n):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var g=ve;else if(me(a))if(we)g=Fe;else{g=De;var m=Ce}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=Ee);switch(g&&(g=g(e,n))?ne(s,g,r,i):(m&&m(e,a,n),"focusout"===e&&(m=a._wrapperState)&&m.controlled&&"number"===a.type&&cb(a,"number",a.value)),m=n?ue(n):window,e){case"focusin":(me(m)||"true"===m.contentEditable)&&(Qe=m,Re=n,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(s,r,i);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(s,r,i)}var b;if(ae)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else ie?ge(e,r)&&(w="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(w="onCompositionStart");w&&(de&&"ko"!==r.locale&&(ie||"onCompositionStart"!==w?"onCompositionEnd"===w&&ie&&(b=nd()):(ld="value"in(kd=i)?kd.value:kd.textContent,ie=!0)),0<(m=oe(n,w)).length&&(w=new Ld(w,e,null,r,i),s.push({event:w,listeners:m}),b?w.data=b:null!==(b=he(r))&&(w.data=b))),(b=ce?je(e,r):ke(e,r))&&(0<(n=oe(n,"onBeforeInput")).length&&(i=new Ld("onBeforeInput","beforeinput",null,r,i),s.push({event:i,listeners:n}),i.data=b))}se(s,t)})}function tf(e,t,r){return{instance:e,listener:t,currentTarget:r}}function oe(e,t){for(var r=t+"Capture",n=[];null!==e;){var i=e,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=Kb(e,r))&&n.unshift(tf(e,o,i)),null!=(o=Kb(e,t))&&n.push(tf(e,o,i))),e=e.return}return n}function vf(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function wf(e,t,r,n,i){for(var o=t._reactName,s=[];null!==r&&r!==n;){var a=r,l=a.alternate,c=a.stateNode;if(null!==l&&l===n)break;5===a.tag&&null!==c&&(a=c,i?null!=(l=Kb(r,o))&&s.unshift(tf(r,l,a)):i||null!=(l=Kb(r,o))&&s.push(tf(r,l,a))),r=r.return}0!==s.length&&e.push({event:t,listeners:s})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(e){return("string"==typeof e?e:""+e).replace(xf,"\n").replace(yf,"")}function Af(e,t,r){if(t=zf(t),zf(e)!==t&&r)throw Error(p(425))}function Bf(){}var Cf=null,Df=null;function Ef(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Ff="function"==typeof setTimeout?setTimeout:void 0,Gf="function"==typeof clearTimeout?clearTimeout:void 0,Hf="function"==typeof Promise?Promise:void 0,Jf="function"==typeof queueMicrotask?queueMicrotask:void 0!==Hf?function(e){return Hf.resolve(null).then(e).catch(If)}:Ff;function If(e){setTimeout(function(){throw e})}function Kf(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&8===i.nodeType)if("/$"===(r=i.data)){if(0===n)return e.removeChild(i),void bd(t);n--}else"$"!==r&&"$?"!==r&&"$!"!==r||n++;r=i}while(r);bd(t)}function Lf(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function Mf(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(e){var t=e[Of];if(t)return t;for(var r=e.parentNode;r;){if(t=r[uf]||r[Of]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=Mf(e);null!==e;){if(r=e[Of])return r;e=Mf(e)}return t}r=(e=r).parentNode}return null}function Cb(e){return!(e=e[Of]||e[uf])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ue(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(p(33))}function Db(e){return e[Pf]||null}var Sf=[],Tf=-1;function Uf(e){return{current:e}}function E(e){0>Tf||(e.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(e,t){Tf++,Sf[Tf]=e.current,e.current=t}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(e,t){var r=e.type.contextTypes;if(!r)return Vf;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in r)o[i]=t[i];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Zf(e){return null!=(e=e.childContextTypes)}function $f(){E(Wf),E(H)}function ag(e,t,r){if(H.current!==Vf)throw Error(p(168));G(H,t),G(Wf,r)}function bg(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,"function"!=typeof n.getChildContext)return r;for(var i in n=n.getChildContext())if(!(i in t))throw Error(p(108,Ra(e)||"Unknown",i));return A({},r,n)}function cg(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Vf,Xf=H.current,G(H,e),G(Wf,Wf.current),!0}function dg(e,t,r){var n=e.stateNode;if(!n)throw Error(p(169));r?(e=bg(e,t,Xf),n.__reactInternalMemoizedMergedChildContext=e,E(Wf),E(H),G(H,e)):E(Wf),G(Wf,r)}var eg=null,fg=!1,gg=!1;function hg(e){null===eg?eg=[e]:eg.push(e)}function ig(e){fg=!0,hg(e)}function jg(){if(!gg&&null!==eg){gg=!0;var e=0,t=C;try{var r=eg;for(C=1;e<r.length;e++){var n=r[e];do{n=n(!0)}while(null!==n)}eg=null,fg=!1}catch(i){throw null!==eg&&(eg=eg.slice(e+1)),ac(fc,jg),i}finally{C=t,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(e,t){kg[lg++]=ng,kg[lg++]=mg,mg=e,ng=t}function ug(e,t,r){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=e;var n=rg;e=sg;var i=32-oc(n)-1;n&=~(1<<i),r+=1;var o=32-oc(t)+i;if(30<o){var s=i-i%5;o=(n&(1<<s)-1).toString(32),n>>=s,i-=s,rg=1<<32-oc(t)+i|r<<i|n,sg=o+e}else rg=1<<o|r<<i|n,sg=e}function vg(e){null!==e.return&&(tg(e,1),ug(e,1,0))}function wg(e){for(;e===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;e===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(e,t){var r=Bg(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function Cg(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,xg=e,yg=Lf(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,xg=e,yg=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==qg?{id:rg,overflow:sg}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=Bg(18,null,null,0)).stateNode=t,r.return=e,e.child=r,xg=e,yg=null,!0);default:return!1}}function Dg(e){return!(!(1&e.mode)||128&e.flags)}function Eg(e){if(I){var t=yg;if(t){var r=t;if(!Cg(e,t)){if(Dg(e))throw Error(p(418));t=Lf(r.nextSibling);var n=xg;t&&Cg(e,t)?Ag(n,r):(e.flags=-4097&e.flags|2,I=!1,xg=e)}}else{if(Dg(e))throw Error(p(418));e.flags=-4097&e.flags|2,I=!1,xg=e}}}function Fg(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;xg=e}function Gg(e){if(e!==xg)return!1;if(!I)return Fg(e),I=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!Ef(e.type,e.memoizedProps)),t&&(t=yg)){if(Dg(e))throw Hg(),Error(p(418));for(;t;)Ag(e,t),t=Lf(t.nextSibling)}if(Fg(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(p(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){yg=Lf(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}yg=null}}else yg=xg?Lf(e.stateNode.nextSibling):null;return!0}function Hg(){for(var e=yg;e;)e=Lf(e.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(e){null===zg?zg=[e]:zg.push(e)}var Kg=ua.ReactCurrentBatchConfig;function Lg(e,t,r){if(null!==(e=r.ref)&&"function"!=typeof e&&"object"!=typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(p(309));var n=r.stateNode}if(!n)throw Error(p(147,e));var i=n,o=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===o?t.ref:((t=function(e){var t=i.refs;null===e?delete t[o]:t[o]=e})._stringRef=o,t)}if("string"!=typeof e)throw Error(p(284));if(!r._owner)throw Error(p(290,e))}return e}function Mg(e,t){throw e=Object.prototype.toString.call(t),Error(p(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ng(e){return(0,e._init)(e._payload)}function Og(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Pg(e,t)).index=0,e.sibling=null,e}function o(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=2,r):n:(t.flags|=2,r):(t.flags|=1048576,r)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function a(e,t,r,n){return null===t||6!==t.tag?((t=Qg(r,e.mode,n)).return=e,t):((t=i(t,r)).return=e,t)}function l(e,t,r,n){var o=r.type;return o===ya?u(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===o||"object"==typeof o&&null!==o&&o.$$typeof===Ha&&Ng(o)===t.type)?((n=i(t,r.props)).ref=Lg(e,t,r),n.return=e,n):((n=Rg(r.type,r.key,r.props,null,e.mode,n)).ref=Lg(e,t,r),n.return=e,n)}function c(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Sg(r,e.mode,n)).return=e,t):((t=i(t,r.children||[])).return=e,t)}function u(e,t,r,n,o){return null===t||7!==t.tag?((t=Tg(r,e.mode,n,o)).return=e,t):((t=i(t,r)).return=e,t)}function d(e,t,r){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Qg(""+t,e.mode,r)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case va:return(r=Rg(t.type,t.key,t.props,null,e.mode,r)).ref=Lg(e,null,t),r.return=e,r;case wa:return(t=Sg(t,e.mode,r)).return=e,t;case Ha:return d(e,(0,t._init)(t._payload),r)}if(eb(t)||Ka(t))return(t=Tg(t,e.mode,r,null)).return=e,t;Mg(e,t)}return null}function h(e,t,r,n){var i=null!==t?t.key:null;if("string"==typeof r&&""!==r||"number"==typeof r)return null!==i?null:a(e,t,""+r,n);if("object"==typeof r&&null!==r){switch(r.$$typeof){case va:return r.key===i?l(e,t,r,n):null;case wa:return r.key===i?c(e,t,r,n):null;case Ha:return h(e,t,(i=r._init)(r._payload),n)}if(eb(r)||Ka(r))return null!==i?null:u(e,t,r,n,null);Mg(e,r)}return null}function f(e,t,r,n,i){if("string"==typeof n&&""!==n||"number"==typeof n)return a(t,e=e.get(r)||null,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case va:return l(t,e=e.get(null===n.key?r:n.key)||null,n,i);case wa:return c(t,e=e.get(null===n.key?r:n.key)||null,n,i);case Ha:return f(e,t,r,(0,n._init)(n._payload),i)}if(eb(n)||Ka(n))return u(t,e=e.get(r)||null,n,i,null);Mg(t,n)}return null}return function a(l,c,u,y){if("object"==typeof u&&null!==u&&u.type===ya&&null===u.key&&(u=u.props.children),"object"==typeof u&&null!==u){switch(u.$$typeof){case va:e:{for(var g=u.key,m=c;null!==m;){if(m.key===g){if((g=u.type)===ya){if(7===m.tag){r(l,m.sibling),(c=i(m,u.props.children)).return=l,l=c;break e}}else if(m.elementType===g||"object"==typeof g&&null!==g&&g.$$typeof===Ha&&Ng(g)===m.type){r(l,m.sibling),(c=i(m,u.props)).ref=Lg(l,m,u),c.return=l,l=c;break e}r(l,m);break}t(l,m),m=m.sibling}u.type===ya?((c=Tg(u.props.children,l.mode,y,u.key)).return=l,l=c):((y=Rg(u.type,u.key,u.props,null,l.mode,y)).ref=Lg(l,c,u),y.return=l,l=y)}return s(l);case wa:e:{for(m=u.key;null!==c;){if(c.key===m){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){r(l,c.sibling),(c=i(c,u.children||[])).return=l,l=c;break e}r(l,c);break}t(l,c),c=c.sibling}(c=Sg(u,l.mode,y)).return=l,l=c}return s(l);case Ha:return a(l,c,(m=u._init)(u._payload),y)}if(eb(u))return function(i,s,a,l){for(var c=null,u=null,p=s,y=s=0,g=null;null!==p&&y<a.length;y++){p.index>y?(g=p,p=null):g=p.sibling;var m=h(i,p,a[y],l);if(null===m){null===p&&(p=g);break}e&&p&&null===m.alternate&&t(i,p),s=o(m,s,y),null===u?c=m:u.sibling=m,u=m,p=g}if(y===a.length)return r(i,p),I&&tg(i,y),c;if(null===p){for(;y<a.length;y++)null!==(p=d(i,a[y],l))&&(s=o(p,s,y),null===u?c=p:u.sibling=p,u=p);return I&&tg(i,y),c}for(p=n(i,p);y<a.length;y++)null!==(g=f(p,i,y,a[y],l))&&(e&&null!==g.alternate&&p.delete(null===g.key?y:g.key),s=o(g,s,y),null===u?c=g:u.sibling=g,u=g);return e&&p.forEach(function(e){return t(i,e)}),I&&tg(i,y),c}(l,c,u,y);if(Ka(u))return function(i,s,a,l){var c=Ka(a);if("function"!=typeof c)throw Error(p(150));if(null==(a=c.call(a)))throw Error(p(151));for(var u=c=null,y=s,g=s=0,m=null,b=a.next();null!==y&&!b.done;g++,b=a.next()){y.index>g?(m=y,y=null):m=y.sibling;var w=h(i,y,b.value,l);if(null===w){null===y&&(y=m);break}e&&y&&null===w.alternate&&t(i,y),s=o(w,s,g),null===u?c=w:u.sibling=w,u=w,y=m}if(b.done)return r(i,y),I&&tg(i,g),c;if(null===y){for(;!b.done;g++,b=a.next())null!==(b=d(i,b.value,l))&&(s=o(b,s,g),null===u?c=b:u.sibling=b,u=b);return I&&tg(i,g),c}for(y=n(i,y);!b.done;g++,b=a.next())null!==(b=f(y,i,g,b.value,l))&&(e&&null!==b.alternate&&y.delete(null===b.key?g:b.key),s=o(b,s,g),null===u?c=b:u.sibling=b,u=b);return e&&y.forEach(function(e){return t(i,e)}),I&&tg(i,g),c}(l,c,u,y);Mg(l,u)}return"string"==typeof u&&""!==u||"number"==typeof u?(u=""+u,null!==c&&6===c.tag?(r(l,c.sibling),(c=i(c,u)).return=l,l=c):(r(l,c),(c=Qg(u,l.mode,y)).return=l,l=c),s(l)):r(l,c)}}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(e){var t=Wg.current;E(Wg),e._currentValue=t}function bh(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function ch(e,t){Xg=e,Zg=Yg=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(dh=!0),e.firstContext=null)}function eh(e){var t=e._currentValue;if(Zg!==e)if(e={context:e,memoizedValue:t,next:null},null===Yg){if(null===Xg)throw Error(p(308));Yg=e,Xg.dependencies={lanes:0,firstContext:e}}else Yg=Yg.next=e;return t}var fh=null;function gh(e){null===fh?fh=[e]:fh.push(e)}function hh(e,t,r,n){var i=t.interleaved;return null===i?(r.next=r,gh(t)):(r.next=i.next,i.next=r),t.interleaved=r,ih(e,n)}function ih(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}var jh=!1;function kh(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function mh(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function nh(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,2&K){var i=n.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),n.pending=t,ih(e,r)}return null===(i=n.interleaved)?(t.next=t,gh(n)):(t.next=i.next,i.next=t),n.interleaved=t,ih(e,r)}function oh(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,4194240&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,Cc(e,r)}}function ph(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var i=null,o=null;if(null!==(r=r.firstBaseUpdate)){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===o?i=o=s:o=o.next=s,r=r.next}while(null!==r);null===o?i=o=t:o=o.next=t}else i=o=t;return r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:n.shared,effects:n.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function qh(e,t,r,n){var i=e.updateQueue;jh=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,c=l.next;l.next=null,null===s?o=c:s.next=c,s=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==o){var d=i.baseState;for(s=0,u=c=l=null,a=o;;){var h=a.lane,f=a.eventTime;if((n&h)===h){null!==u&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,y=a;switch(h=t,f=r,y.tag){case 1:if("function"==typeof(p=y.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null==(h="function"==typeof(p=y.payload)?p.call(f,d,h):p))break e;d=A({},d,h);break e;case 2:jh=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=f,l=d):u=u.next=f,s|=h;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(h=a).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===u&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{s|=i.lane,i=i.next}while(i!==t)}else null===o&&(i.shared.lanes=0);rh|=s,e.lanes=s,e.memoizedState=d}}function sh(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(null!==i){if(n.callback=null,n=r,"function"!=typeof i)throw Error(p(191,i));i.call(n)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(e){if(e===th)throw Error(p(174));return e}function yh(e,t){switch(G(wh,t),G(vh,e),G(uh,th),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:lb(null,"");break;default:t=lb(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}E(uh),G(uh,t)}function zh(){E(uh),E(vh),E(wh)}function Ah(e){xh(wh.current);var t=xh(uh.current),r=lb(t,e.type);t!==r&&(G(vh,e),G(uh,r))}function Bh(e){vh.current===e&&(E(uh),E(vh))}var L=Uf(0);function Ch(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Dh=[];function Eh(){for(var e=0;e<Dh.length;e++)Dh[e]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M=null,N=null,O=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P(){throw Error(p(321))}function Mh(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!He(e[r],t[r]))return!1;return!0}function Nh(e,t,r,n,i,o){if(Hh=o,M=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Fh.current=null===e||null===e.memoizedState?Oh:Ph,e=r(n,i),Jh){o=0;do{if(Jh=!1,Kh=0,25<=o)throw Error(p(301));o+=1,O=N=null,t.updateQueue=null,Fh.current=Qh,e=r(n,i)}while(Jh)}if(Fh.current=Rh,t=null!==N&&null!==N.next,Hh=0,O=N=M=null,Ih=!1,t)throw Error(p(300));return e}function Sh(){var e=0!==Kh;return Kh=0,e}function Th(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===O?M.memoizedState=O=e:O=O.next=e,O}function Uh(){if(null===N){var e=M.alternate;e=null!==e?e.memoizedState:null}else e=N.next;var t=null===O?M.memoizedState:O.next;if(null!==t)O=t,N=e;else{if(null===e)throw Error(p(310));e={memoizedState:(N=e).memoizedState,baseState:N.baseState,baseQueue:N.baseQueue,queue:N.queue,next:null},null===O?M.memoizedState=O=e:O=O.next=e}return O}function Vh(e,t){return"function"==typeof t?t(e):t}function Wh(e){var t=Uh(),r=t.queue;if(null===r)throw Error(p(311));r.lastRenderedReducer=e;var n=N,i=n.baseQueue,o=r.pending;if(null!==o){if(null!==i){var s=i.next;i.next=o.next,o.next=s}n.baseQueue=i=o,r.pending=null}if(null!==i){o=i.next,n=n.baseState;var a=s=null,l=null,c=o;do{var u=c.lane;if((Hh&u)===u)null!==l&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===l?(a=l=d,s=n):l=l.next=d,M.lanes|=u,rh|=u}c=c.next}while(null!==c&&c!==o);null===l?s=n:l.next=a,He(n,t.memoizedState)||(dh=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=l,r.lastRenderedState=n}if(null!==(e=r.interleaved)){i=e;do{o=i.lane,M.lanes|=o,rh|=o,i=i.next}while(i!==e)}else null===i&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Xh(e){var t=Uh(),r=t.queue;if(null===r)throw Error(p(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,o=t.memoizedState;if(null!==i){r.pending=null;var s=i=i.next;do{o=e(o,s.action),s=s.next}while(s!==i);He(o,t.memoizedState)||(dh=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),r.lastRenderedState=o}return[o,n]}function Yh(){}function Zh(e,t){var r=M,n=Uh(),i=t(),o=!He(n.memoizedState,i);if(o&&(n.memoizedState=i,dh=!0),n=n.queue,$h(ai.bind(null,r,n,e),[e]),n.getSnapshot!==t||o||null!==O&&1&O.memoizedState.tag){if(r.flags|=2048,bi(9,ci.bind(null,r,n,i,t),void 0,null),null===Q)throw Error(p(349));30&Hh||di(r,t,i)}return i}function di(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=M.updateQueue)?(t={lastEffect:null,stores:null},M.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function ci(e,t,r,n){t.value=r,t.getSnapshot=n,ei(t)&&fi(e)}function ai(e,t,r){return r(function(){ei(t)&&fi(e)})}function ei(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!He(e,r)}catch(n){return!0}}function fi(e){var t=ih(e,1);null!==t&&gi(t,e,1,-1)}function hi(e){var t=Th();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:e},t.queue=e,e=e.dispatch=ii.bind(null,M,e),[t.memoizedState,e]}function bi(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===(t=M.updateQueue)?(t={lastEffect:null,stores:null},M.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function ji(){return Uh().memoizedState}function ki(e,t,r,n){var i=Th();M.flags|=e,i.memoizedState=bi(1|t,r,void 0,void 0===n?null:n)}function li(e,t,r,n){var i=Uh();n=void 0===n?null:n;var o=void 0;if(null!==N){var s=N.memoizedState;if(o=s.destroy,null!==n&&Mh(n,s.deps))return void(i.memoizedState=bi(t,r,o,n))}M.flags|=e,i.memoizedState=bi(1|t,r,o,n)}function mi(e,t){return ki(8390656,8,e,t)}function $h(e,t){return li(2048,8,e,t)}function ni(e,t){return li(4,2,e,t)}function oi(e,t){return li(4,4,e,t)}function pi(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function qi(e,t,r){return r=null!=r?r.concat([e]):null,li(4,4,pi.bind(null,t,e),r)}function ri(){}function si(e,t){var r=Uh();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&Mh(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function ti(e,t){var r=Uh();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&Mh(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function ui(e,t,r){return 21&Hh?(He(r,t)||(r=yc(),M.lanes|=r,rh|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,dh=!0),e.memoizedState=r)}function vi(e,t){var r=C;C=0!==r&&4>r?r:4,e(!0);var n=Gh.transition;Gh.transition={};try{e(!1),t()}finally{C=r,Gh.transition=n}}function wi(){return Uh().memoizedState}function xi(e,t,r){var n=yi(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},zi(e))Ai(t,r);else if(null!==(r=hh(e,t,r,n))){gi(r,e,n,R()),Bi(r,t,n)}}function ii(e,t,r){var n=yi(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(zi(e))Ai(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=o(s,r);if(i.hasEagerState=!0,i.eagerState=a,He(a,s)){var l=t.interleaved;return null===l?(i.next=i,gh(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(r=hh(e,t,i,n))&&(gi(r,e,n,i=R()),Bi(r,t,n))}}function zi(e){var t=e.alternate;return e===M||null!==t&&t===M}function Ai(e,t){Jh=Ih=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Bi(e,t,r){if(4194240&r){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,Cc(e,r)}}var Rh={readContext:eh,useCallback:P,useContext:P,useEffect:P,useImperativeHandle:P,useInsertionEffect:P,useLayoutEffect:P,useMemo:P,useReducer:P,useRef:P,useState:P,useDebugValue:P,useDeferredValue:P,useTransition:P,useMutableSource:P,useSyncExternalStore:P,useId:P,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(e,t){return Th().memoizedState=[e,void 0===t?null:t],e},useContext:eh,useEffect:mi,useImperativeHandle:function(e,t,r){return r=null!=r?r.concat([e]):null,ki(4194308,4,pi.bind(null,t,e),r)},useLayoutEffect:function(e,t){return ki(4194308,4,e,t)},useInsertionEffect:function(e,t){return ki(4,2,e,t)},useMemo:function(e,t){var r=Th();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Th();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=xi.bind(null,M,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},Th().memoizedState=e},useState:hi,useDebugValue:ri,useDeferredValue:function(e){return Th().memoizedState=e},useTransition:function(){var e=hi(!1),t=e[0];return e=vi.bind(null,e[1]),Th().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=M,i=Th();if(I){if(void 0===r)throw Error(p(407));r=r()}else{if(r=t(),null===Q)throw Error(p(349));30&Hh||di(n,t,r)}i.memoizedState=r;var o={value:r,getSnapshot:t};return i.queue=o,mi(ai.bind(null,n,o,e),[e]),n.flags|=2048,bi(9,ci.bind(null,n,o,r,t),void 0,null),r},useId:function(){var e=Th(),t=Q.identifierPrefix;if(I){var r=sg;t=":"+t+"R"+(r=(rg&~(1<<32-oc(rg)-1)).toString(32)+r),0<(r=Kh++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=Lh++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(e){return ui(Uh(),N.memoizedState,e)},useTransition:function(){return[Wh(Vh)[0],Uh().memoizedState]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(e){var t=Uh();return null===N?t.memoizedState=e:ui(t,N.memoizedState,e)},useTransition:function(){return[Xh(Vh)[0],Uh().memoizedState]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(e,t){if(e&&e.defaultProps){for(var r in t=A({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}function Di(e,t,r,n){r=null==(r=r(n,t=e.memoizedState))?t:A({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var Ei={isMounted:function(e){return!!(e=e._reactInternals)&&Vb(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=R(),i=yi(e),o=mh(n,i);o.payload=t,null!=r&&(o.callback=r),null!==(t=nh(e,o,i))&&(gi(t,e,i,n),oh(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=R(),i=yi(e),o=mh(n,i);o.tag=1,o.payload=t,null!=r&&(o.callback=r),null!==(t=nh(e,o,i))&&(gi(t,e,i,n),oh(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=R(),n=yi(e),i=mh(r,n);i.tag=2,null!=t&&(i.callback=t),null!==(t=nh(e,i,n))&&(gi(t,e,n,r),oh(t,e,n))}};function Fi(e,t,r,n,i,o,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!Ie(r,n)||!Ie(i,o))}function Gi(e,t,r){var n=!1,i=Vf,o=t.contextType;return"object"==typeof o&&null!==o?o=eh(o):(i=Zf(t)?Xf:H.current,o=(n=null!=(n=t.contextTypes))?Yf(e,i):Vf),t=new t(r,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Ei,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function Hi(e,t,r,n){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Ei.enqueueReplaceState(t,t.state,null)}function Ii(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},kh(e);var o=t.contextType;"object"==typeof o&&null!==o?i.context=eh(o):(o=Zf(t)?Xf:H.current,i.context=Yf(e,o)),i.state=e.memoizedState,"function"==typeof(o=t.getDerivedStateFromProps)&&(Di(e,t,o,r),i.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(t=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&Ei.enqueueReplaceState(i,i.state,null),qh(e,r,i,n),i.state=e.memoizedState),"function"==typeof i.componentDidMount&&(e.flags|=4194308)}function Ji(e,t){try{var r="",n=t;do{r+=Pa(n),n=n.return}while(n);var i=r}catch(o){i="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:i,digest:null}}function Ki(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}function Li(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Mi="function"==typeof WeakMap?WeakMap:Map;function Ni(e,t,r){(r=mh(-1,r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Oi||(Oi=!0,Pi=n),Li(e,t)},r}function Qi(e,t,r){(r=mh(-1,r)).tag=3;var n=e.type.getDerivedStateFromError;if("function"==typeof n){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){Li(e,t)}}var o=e.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(r.callback=function(){Li(e,t),"function"!=typeof n&&(null===Ri?Ri=new Set([this]):Ri.add(this));var r=t.stack;this.componentDidCatch(t.value,{componentStack:null!==r?r:""})}),r}function Si(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new Mi;var i=new Set;n.set(t,i)}else void 0===(i=n.get(t))&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=Ti.bind(null,e,t,r),t.then(e,e))}function Ui(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function Vi(e,t,r,n,i){return 1&e.mode?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=mh(-1,1)).tag=2,nh(r,t,1))),r.lanes|=1),e)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(e,t,r,n){t.child=null===e?Vg(t,null,r,n):Ug(t,e.child,r,n)}function Yi(e,t,r,n,i){r=r.render;var o=t.ref;return ch(t,i),n=Nh(e,t,r,n,o,i),r=Sh(),null===e||dh?(I&&r&&vg(t),t.flags|=1,Xi(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Zi(e,t,i))}function $i(e,t,r,n,i){if(null===e){var o=r.type;return"function"!=typeof o||aj(o)||void 0!==o.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=Rg(r.type,null,n,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,bj(e,t,o,n,i))}if(o=e.child,0===(e.lanes&i)){var s=o.memoizedProps;if((r=null!==(r=r.compare)?r:Ie)(s,n)&&e.ref===t.ref)return Zi(e,t,i)}return t.flags|=1,(e=Pg(o,n)).ref=t.ref,e.return=t,t.child=e}function bj(e,t,r,n,i){if(null!==e){var o=e.memoizedProps;if(Ie(o,n)&&e.ref===t.ref){if(dh=!1,t.pendingProps=n=o,0===(e.lanes&i))return t.lanes=e.lanes,Zi(e,t,i);131072&e.flags&&(dh=!0)}}return cj(e,t,r,n,i)}function dj(e,t,r){var n=t.pendingProps,i=n.children,o=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(1&t.mode){if(!(1073741824&r))return e=null!==o?o.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,G(ej,fj),fj|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==o?o.baseLanes:r,G(ej,fj),fj|=n}else t.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=r;else null!==o?(n=o.baseLanes|r,t.memoizedState=null):n=r,G(ej,fj),fj|=n;return Xi(e,t,i,r),t.child}function gj(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function cj(e,t,r,n,i){var o=Zf(r)?Xf:H.current;return o=Yf(t,o),ch(t,i),r=Nh(e,t,r,n,o,i),n=Sh(),null===e||dh?(I&&n&&vg(t),t.flags|=1,Xi(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Zi(e,t,i))}function hj(e,t,r,n,i){if(Zf(r)){var o=!0;cg(t)}else o=!1;if(ch(t,i),null===t.stateNode)ij(e,t),Gi(t,r,n),Ii(t,r,n,i),n=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var l=s.context,c=r.contextType;"object"==typeof c&&null!==c?c=eh(c):c=Yf(t,c=Zf(r)?Xf:H.current);var u=r.getDerivedStateFromProps,d="function"==typeof u||"function"==typeof s.getSnapshotBeforeUpdate;d||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==n||l!==c)&&Hi(t,s,n,c),jh=!1;var h=t.memoizedState;s.state=h,qh(t,n,s,i),l=t.memoizedState,a!==n||h!==l||Wf.current||jh?("function"==typeof u&&(Di(t,r,u,n),l=t.memoizedState),(a=jh||Fi(t,r,a,n,h,l,c))?(d||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(t.flags|=4194308)):("function"==typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),s.props=n,s.state=l,s.context=c,n=a):("function"==typeof s.componentDidMount&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,lh(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:Ci(t.type,a),s.props=c,d=t.pendingProps,h=s.context,"object"==typeof(l=r.contextType)&&null!==l?l=eh(l):l=Yf(t,l=Zf(r)?Xf:H.current);var f=r.getDerivedStateFromProps;(u="function"==typeof f||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==d||h!==l)&&Hi(t,s,n,l),jh=!1,h=t.memoizedState,s.state=h,qh(t,n,s,i);var p=t.memoizedState;a!==d||h!==p||Wf.current||jh?("function"==typeof f&&(Di(t,r,f,n),p=t.memoizedState),(c=jh||Fi(t,r,c,n,h,p,l)||!1)?(u||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(n,p,l),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(n,p,l)),"function"==typeof s.componentDidUpdate&&(t.flags|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),s.props=n,s.state=p,s.context=l,n=c):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return jj(e,t,r,n,o,i)}function jj(e,t,r,n,i,o){gj(e,t);var s=!!(128&t.flags);if(!n&&!s)return i&&dg(t,r,!1),Zi(e,t,o);n=t.stateNode,Wi.current=t;var a=s&&"function"!=typeof r.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&s?(t.child=Ug(t,e.child,null,o),t.child=Ug(t,null,a,o)):Xi(e,t,a,o),t.memoizedState=n.state,i&&dg(t,r,!0),t.child}function kj(e){var t=e.stateNode;t.pendingContext?ag(e,t.pendingContext,t.pendingContext!==t.context):t.context&&ag(e,t.context,!1),yh(e,t.containerInfo)}function lj(e,t,r,n,i){return Ig(),Jg(i),t.flags|=256,Xi(e,t,r,n),t.child}var mj={dehydrated:null,treeContext:null,retryLane:0},zj,Aj,Bj,Cj;function nj(e){return{baseLanes:e,cachePool:null,transitions:null}}function oj(e,t,r){var n,i=t.pendingProps,o=L.current,s=!1,a=!!(128&t.flags);if((n=a)||(n=(null===e||null!==e.memoizedState)&&!!(2&o)),n?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),G(L,1&o),null===e)return Eg(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(1&t.mode?"$!"===e.data?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=i.children,e=i.fallback,s?(i=t.mode,s=t.child,a={mode:"hidden",children:a},1&i||null===s?s=pj(a,i,0,null):(s.childLanes=0,s.pendingProps=a),e=Tg(e,i,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=nj(r),t.memoizedState=mj,e):qj(t,a));if(null!==(o=e.memoizedState)&&null!==(n=o.dehydrated))return rj(e,t,a,i,n,o,r);if(s){s=i.fallback,a=t.mode,n=(o=e.child).sibling;var l={mode:"hidden",children:i.children};return 1&a||t.child===o?(i=Pg(o,l)).subtreeFlags=14680064&o.subtreeFlags:((i=t.child).childLanes=0,i.pendingProps=l,t.deletions=null),null!==n?s=Pg(n,s):(s=Tg(s,a,r,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,a=null===(a=e.child.memoizedState)?nj(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~r,t.memoizedState=mj,i}return e=(s=e.child).sibling,i=Pg(s,{mode:"visible",children:i.children}),!(1&t.mode)&&(i.lanes=r),i.return=t,i.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=i,t.memoizedState=null,i}function qj(e,t){return(t=pj({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function sj(e,t,r,n){return null!==n&&Jg(n),Ug(t,e.child,null,r),(e=qj(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function rj(e,t,r,n,i,o,s){if(r)return 256&t.flags?(t.flags&=-257,sj(e,t,s,n=Ki(Error(p(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=n.fallback,i=t.mode,n=pj({mode:"visible",children:n.children},i,0,null),(o=Tg(o,i,s,null)).flags|=2,n.return=t,o.return=t,n.sibling=o,t.child=n,1&t.mode&&Ug(t,e.child,null,s),t.child.memoizedState=nj(s),t.memoizedState=mj,o);if(!(1&t.mode))return sj(e,t,s,null);if("$!"===i.data){if(n=i.nextSibling&&i.nextSibling.dataset)var a=n.dgst;return n=a,sj(e,t,s,n=Ki(o=Error(p(419)),n,void 0))}if(a=0!==(s&e.childLanes),dh||a){if(null!==(n=Q)){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(n.suspendedLanes|s))?0:i)&&i!==o.retryLane&&(o.retryLane=i,ih(e,i),gi(n,e,i,-1))}return tj(),sj(e,t,s,n=Ki(Error(p(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=uj.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,yg=Lf(i.nextSibling),xg=t,I=!0,zg=null,null!==e&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=e.id,sg=e.overflow,qg=t),(t=qj(t,n.children)).flags|=4096,t)}function vj(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),bh(e.return,t,r)}function wj(e,t,r,n,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=i)}function xj(e,t,r){var n=t.pendingProps,i=n.revealOrder,o=n.tail;if(Xi(e,t,n.children,r),2&(n=L.current))n=1&n|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&vj(e,r,t);else if(19===e.tag)vj(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(G(L,n),1&t.mode)switch(i){case"forwards":for(r=t.child,i=null;null!==r;)null!==(e=r.alternate)&&null===Ch(e)&&(i=r),r=r.sibling;null===(r=i)?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),wj(t,!1,i,r,o);break;case"backwards":for(r=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===Ch(e)){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}wj(t,!0,r,null,o);break;case"together":wj(t,!1,null,null,void 0);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function ij(e,t){!(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Zi(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),rh|=t.lanes,0===(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(p(153));if(null!==t.child){for(r=Pg(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Pg(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function yj(e,t,r){switch(t.tag){case 3:kj(t),Ig();break;case 5:Ah(t);break;case 1:Zf(t.type)&&cg(t);break;case 4:yh(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;G(Wg,n._currentValue),n._currentValue=i;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(G(L,1&L.current),t.flags|=128,null):0!==(r&t.child.childLanes)?oj(e,t,r):(G(L,1&L.current),null!==(e=Zi(e,t,r))?e.sibling:null);G(L,1&L.current);break;case 19:if(n=0!==(r&t.childLanes),128&e.flags){if(n)return xj(e,t,r);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),G(L,L.current),n)break;return null;case 22:case 23:return t.lanes=0,dj(e,t,r)}return Zi(e,t,r)}function Dj(e,t){if(!I)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function S(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=14680064&i.subtreeFlags,n|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Ej(e,t,r){var n=t.pendingProps;switch(wg(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(t),null;case 1:case 17:return Zf(t.type)&&$f(),S(t),null;case 3:return n=t.stateNode,zh(),E(Wf),E(H),Eh(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(Gg(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,null!==zg&&(Fj(zg),zg=null))),Aj(e,t),S(t),null;case 5:Bh(t);var i=xh(wh.current);if(r=t.type,null!==e&&null!=t.stateNode)Bj(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(p(166));return S(t),null}if(e=xh(uh.current),Gg(t)){n=t.stateNode,r=t.type;var o=t.memoizedProps;switch(n[Of]=t,n[Pf]=o,e=!!(1&t.mode),r){case"dialog":D("cancel",n),D("close",n);break;case"iframe":case"object":case"embed":D("load",n);break;case"video":case"audio":for(i=0;i<lf.length;i++)D(lf[i],n);break;case"source":D("error",n);break;case"img":case"image":case"link":D("error",n),D("load",n);break;case"details":D("toggle",n);break;case"input":Za(n,o),D("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},D("invalid",n);break;case"textarea":hb(n,o),D("invalid",n)}for(var s in ub(r,o),i=null,o)if(o.hasOwnProperty(s)){var a=o[s];"children"===s?"string"==typeof a?n.textContent!==a&&(!0!==o.suppressHydrationWarning&&Af(n.textContent,a,e),i=["children",a]):"number"==typeof a&&n.textContent!==""+a&&(!0!==o.suppressHydrationWarning&&Af(n.textContent,a,e),i=["children",""+a]):ea.hasOwnProperty(s)&&null!=a&&"onScroll"===s&&D("scroll",n)}switch(r){case"input":Va(n),db$1(n,o,!0);break;case"textarea":Va(n),jb(n);break;case"select":case"option":break;default:"function"==typeof o.onClick&&(n.onclick=Bf)}n=i,t.updateQueue=n,null!==n&&(t.flags|=4)}else{s=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=kb(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=s.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof n.is?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),"select"===r&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[Of]=t,e[Pf]=n,zj(e,t,!1,!1),t.stateNode=e;e:{switch(s=vb(r,n),r){case"dialog":D("cancel",e),D("close",e),i=n;break;case"iframe":case"object":case"embed":D("load",e),i=n;break;case"video":case"audio":for(i=0;i<lf.length;i++)D(lf[i],e);i=n;break;case"source":D("error",e),i=n;break;case"img":case"image":case"link":D("error",e),D("load",e),i=n;break;case"details":D("toggle",e),i=n;break;case"input":Za(e,n),i=Ya(e,n),D("invalid",e);break;case"option":default:i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=A({},n,{value:void 0}),D("invalid",e);break;case"textarea":hb(e,n),i=gb(e,n),D("invalid",e)}for(o in ub(r,i),a=i)if(a.hasOwnProperty(o)){var l=a[o];"style"===o?sb(e,l):"dangerouslySetInnerHTML"===o?null!=(l=l?l.__html:void 0)&&nb(e,l):"children"===o?"string"==typeof l?("textarea"!==r||""!==l)&&ob(e,l):"number"==typeof l&&ob(e,""+l):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(ea.hasOwnProperty(o)?null!=l&&"onScroll"===o&&D("scroll",e):null!=l&&ta(e,o,l,s))}switch(r){case"input":Va(e),db$1(e,n,!1);break;case"textarea":Va(e),jb(e);break;case"option":null!=n.value&&e.setAttribute("value",""+Sa(n.value));break;case"select":e.multiple=!!n.multiple,null!=(o=n.value)?fb(e,!!n.multiple,o,!1):null!=n.defaultValue&&fb(e,!!n.multiple,n.defaultValue,!0);break;default:"function"==typeof i.onClick&&(e.onclick=Bf)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return S(t),null;case 6:if(e&&null!=t.stateNode)Cj(e,t,e.memoizedProps,n);else{if("string"!=typeof n&&null===t.stateNode)throw Error(p(166));if(r=xh(wh.current),xh(uh.current),Gg(t)){if(n=t.stateNode,r=t.memoizedProps,n[Of]=t,(o=n.nodeValue!==r)&&null!==(e=xg))switch(e.tag){case 3:Af(n.nodeValue,r,!!(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Af(n.nodeValue,r,!!(1&e.mode))}o&&(t.flags|=4)}else(n=(9===r.nodeType?r:r.ownerDocument).createTextNode(n))[Of]=t,t.stateNode=n}return S(t),null;case 13:if(E(L),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(I&&null!==yg&&1&t.mode&&!(128&t.flags))Hg(),Ig(),t.flags|=98560,o=!1;else if(o=Gg(t),null!==n&&null!==n.dehydrated){if(null===e){if(!o)throw Error(p(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(p(317));o[Of]=t}else Ig(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;S(t),o=!1}else null!==zg&&(Fj(zg),zg=null),o=!0;if(!o)return 65536&t.flags?t:null}return 128&t.flags?(t.lanes=r,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,1&t.mode&&(null===e||1&L.current?0===T&&(T=3):tj())),null!==t.updateQueue&&(t.flags|=4),S(t),null);case 4:return zh(),Aj(e,t),null===e&&sf(t.stateNode.containerInfo),S(t),null;case 10:return ah(t.type._context),S(t),null;case 19:if(E(L),null===(o=t.memoizedState))return S(t),null;if(n=!!(128&t.flags),null===(s=o.rendering))if(n)Dj(o,!1);else{if(0!==T||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(s=Ch(e))){for(t.flags|=128,Dj(o,!1),null!==(n=s.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;null!==r;)e=n,(o=r).flags&=14680066,null===(s=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,e=s.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return G(L,1&L.current|2),t.child}e=e.sibling}null!==o.tail&&B()>Gj&&(t.flags|=128,n=!0,Dj(o,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=Ch(s))){if(t.flags|=128,n=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),Dj(o,!0),null===o.tail&&"hidden"===o.tailMode&&!s.alternate&&!I)return S(t),null}else 2*B()-o.renderingStartTime>Gj&&1073741824!==r&&(t.flags|=128,n=!0,Dj(o,!1),t.lanes=4194304);o.isBackwards?(s.sibling=t.child,t.child=s):(null!==(r=o.last)?r.sibling=s:t.child=s,o.last=s)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=B(),t.sibling=null,r=L.current,G(L,n?1&r|2:1&r),t):(S(t),null);case 22:case 23:return Hj(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&1&t.mode?!!(1073741824&fj)&&(S(t),6&t.subtreeFlags&&(t.flags|=8192)):S(t),null;case 24:case 25:return null}throw Error(p(156,t.tag))}function Ij(e,t){switch(wg(t),t.tag){case 1:return Zf(t.type)&&$f(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return zh(),E(Wf),E(H),Eh(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Bh(t),null;case 13:if(E(L),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(p(340));Ig()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return E(L),null;case 4:return zh(),null;case 10:return ah(t.type._context),null;case 22:case 23:return Hj(),null;default:return null}}zj=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},Aj=function(){},Bj=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,xh(uh.current);var o,s=null;switch(r){case"input":i=Ya(e,i),n=Ya(e,n),s=[];break;case"select":i=A({},i,{value:void 0}),n=A({},n,{value:void 0}),s=[];break;case"textarea":i=gb(e,i),n=gb(e,n),s=[];break;default:"function"!=typeof i.onClick&&"function"==typeof n.onClick&&(e.onclick=Bf)}for(c in ub(r,n),r=null,i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&null!=i[c])if("style"===c){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(ea.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(a=null!=i?i[c]:void 0,n.hasOwnProperty(c)&&l!==a&&(null!=l||null!=a))if("style"===c)if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(r||(r={}),r[o]=l[o])}else r||(s||(s=[]),s.push(c,r)),r=l;else"dangerouslySetInnerHTML"===c?(l=l?l.__html:void 0,a=a?a.__html:void 0,null!=l&&a!==l&&(s=s||[]).push(c,l)):"children"===c?"string"!=typeof l&&"number"!=typeof l||(s=s||[]).push(c,""+l):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(ea.hasOwnProperty(c)?(null!=l&&"onScroll"===c&&D("scroll",e),s||a===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}},Cj=function(e,t,r,n){r!==n&&(t.flags|=4)};var Jj=!1,U=!1,Kj="function"==typeof WeakSet?WeakSet:Set,V=null;function Lj(e,t){var r=e.ref;if(null!==r)if("function"==typeof r)try{r(null)}catch(n){W(e,t,n)}else r.current=null}function Mj(e,t,r){try{r()}catch(n){W(e,t,n)}}var Nj=!1;function Oj(e,t){if(Cf=dd,Ne(e=Me())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var i=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{r.nodeType,o.nodeType}catch(k){r=null;break e}var s=0,a=-1,l=-1,c=0,u=0,d=e,h=null;t:for(;;){for(var f;d!==r||0!==i&&3!==d.nodeType||(a=s+i),d!==o||0!==n&&3!==d.nodeType||(l=s+n),3===d.nodeType&&(s+=d.nodeValue.length),null!==(f=d.firstChild);)h=d,d=f;for(;;){if(d===e)break t;if(h===r&&++c===i&&(a=s),h===o&&++u===n&&(l=s),null!==(f=d.nextSibling))break;h=(d=h).parentNode}d=f}r=-1===a||-1===l?null:{start:a,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Df={focusedElem:e,selectionRange:r},dd=!1,V=t;null!==V;)if(e=(t=V).child,1028&t.subtreeFlags&&null!==e)e.return=t,V=e;else for(;null!==V;){t=V;try{var y=t.alternate;if(1024&t.flags)switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==y){var g=y.memoizedProps,m=y.memoizedState,b=t.stateNode,w=b.getSnapshotBeforeUpdate(t.elementType===t.type?g:Ci(t.type,g),m);b.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var v=t.stateNode.containerInfo;1===v.nodeType?v.textContent="":9===v.nodeType&&v.documentElement&&v.removeChild(v.documentElement);break;default:throw Error(p(163))}}catch(k){W(t,t.return,k)}if(null!==(e=t.sibling)){e.return=t.return,V=e;break}V=t.return}return y=Nj,Nj=!1,y}function Pj(e,t,r){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var i=n=n.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,void 0!==o&&Mj(t,r,o)}i=i.next}while(i!==n)}}function Qj(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Rj(e){var t=e.ref;if(null!==t){var r=e.stateNode;e.tag,e=r,"function"==typeof t?t(e):t.current=e}}function Sj(e){var t=e.alternate;null!==t&&(e.alternate=null,Sj(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[Of],delete t[Pf],delete t[of],delete t[Qf],delete t[Rf])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Tj(e){return 5===e.tag||3===e.tag||4===e.tag}function Uj(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Tj(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Vj(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!=(r=r._reactRootContainer)||null!==t.onclick||(t.onclick=Bf));else if(4!==n&&null!==(e=e.child))for(Vj(e,t,r),e=e.sibling;null!==e;)Vj(e,t,r),e=e.sibling}function Wj(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&null!==(e=e.child))for(Wj(e,t,r),e=e.sibling;null!==e;)Wj(e,t,r),e=e.sibling}var X=null,Xj=!1;function Yj(e,t,r){for(r=r.child;null!==r;)Zj(e,t,r),r=r.sibling}function Zj(e,t,r){if(lc&&"function"==typeof lc.onCommitFiberUnmount)try{lc.onCommitFiberUnmount(kc,r)}catch(a){}switch(r.tag){case 5:U||Lj(r,t);case 6:var n=X,i=Xj;X=null,Yj(e,t,r),Xj=i,null!==(X=n)&&(Xj?(e=X,r=r.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)):X.removeChild(r.stateNode));break;case 18:null!==X&&(Xj?(e=X,r=r.stateNode,8===e.nodeType?Kf(e.parentNode,r):1===e.nodeType&&Kf(e,r),bd(e)):Kf(X,r.stateNode));break;case 4:n=X,i=Xj,X=r.stateNode.containerInfo,Xj=!0,Yj(e,t,r),X=n,Xj=i;break;case 0:case 11:case 14:case 15:if(!U&&(null!==(n=r.updateQueue)&&null!==(n=n.lastEffect))){i=n=n.next;do{var o=i,s=o.destroy;o=o.tag,void 0!==s&&(2&o||4&o)&&Mj(r,t,s),i=i.next}while(i!==n)}Yj(e,t,r);break;case 1:if(!U&&(Lj(r,t),"function"==typeof(n=r.stateNode).componentWillUnmount))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){W(r,t,a)}Yj(e,t,r);break;case 21:Yj(e,t,r);break;case 22:1&r.mode?(U=(n=U)||null!==r.memoizedState,Yj(e,t,r),U=n):Yj(e,t,r);break;default:Yj(e,t,r)}}function ak(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new Kj),t.forEach(function(t){var n=bk.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))})}}function ck(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var i=r[n];try{var o=e,s=t,a=s;e:for(;null!==a;){switch(a.tag){case 5:X=a.stateNode,Xj=!1;break e;case 3:case 4:X=a.stateNode.containerInfo,Xj=!0;break e}a=a.return}if(null===X)throw Error(p(160));Zj(o,s,i),X=null,Xj=!1;var l=i.alternate;null!==l&&(l.return=null),i.return=null}catch(c){W(i,t,c)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)dk(t,e),t=t.sibling}function dk(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ck(t,e),ek(e),4&n){try{Pj(3,e,e.return),Qj(3,e)}catch(g){W(e,e.return,g)}try{Pj(5,e,e.return)}catch(g){W(e,e.return,g)}}break;case 1:ck(t,e),ek(e),512&n&&null!==r&&Lj(r,r.return);break;case 5:if(ck(t,e),ek(e),512&n&&null!==r&&Lj(r,r.return),32&e.flags){var i=e.stateNode;try{ob(i,"")}catch(g){W(e,e.return,g)}}if(4&n&&null!=(i=e.stateNode)){var o=e.memoizedProps,s=null!==r?r.memoizedProps:o,a=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===a&&"radio"===o.type&&null!=o.name&&ab(i,o),vb(a,s);var c=vb(a,o);for(s=0;s<l.length;s+=2){var u=l[s],d=l[s+1];"style"===u?sb(i,d):"dangerouslySetInnerHTML"===u?nb(i,d):"children"===u?ob(i,d):ta(i,u,d,c)}switch(a){case"input":bb(i,o);break;case"textarea":ib(i,o);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var f=o.value;null!=f?fb(i,!!o.multiple,f,!1):h!==!!o.multiple&&(null!=o.defaultValue?fb(i,!!o.multiple,o.defaultValue,!0):fb(i,!!o.multiple,o.multiple?[]:"",!1))}i[Pf]=o}catch(g){W(e,e.return,g)}}break;case 6:if(ck(t,e),ek(e),4&n){if(null===e.stateNode)throw Error(p(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(g){W(e,e.return,g)}}break;case 3:if(ck(t,e),ek(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{bd(t.containerInfo)}catch(g){W(e,e.return,g)}break;case 4:default:ck(t,e),ek(e);break;case 13:ck(t,e),ek(e),8192&(i=e.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||(fk=B())),4&n&&ak(e);break;case 22:if(u=null!==r&&null!==r.memoizedState,1&e.mode?(U=(c=U)||u,ck(t,e),U=c):ck(t,e),ek(e),8192&n){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!u&&1&e.mode)for(V=e,u=e.child;null!==u;){for(d=V=u;null!==V;){switch(f=(h=V).child,h.tag){case 0:case 11:case 14:case 15:Pj(4,h,h.return);break;case 1:Lj(h,h.return);var y=h.stateNode;if("function"==typeof y.componentWillUnmount){n=h,r=h.return;try{t=n,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(g){W(n,r,g)}}break;case 5:Lj(h,h.return);break;case 22:if(null!==h.memoizedState){gk(d);continue}}null!==f?(f.return=h,V=f):gk(d)}u=u.sibling}e:for(u=null,d=e;;){if(5===d.tag){if(null===u){u=d;try{i=d.stateNode,c?"function"==typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(a=d.stateNode,s=null!=(l=d.memoizedProps.style)&&l.hasOwnProperty("display")?l.display:null,a.style.display=rb("display",s))}catch(g){W(e,e.return,g)}}}else if(6===d.tag){if(null===u)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){W(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ck(t,e),ek(e),4&n&&ak(e);case 21:}}function ek(e){var t=e.flags;if(2&t){try{e:{for(var r=e.return;null!==r;){if(Tj(r)){var n=r;break e}r=r.return}throw Error(p(160))}switch(n.tag){case 5:var i=n.stateNode;32&n.flags&&(ob(i,""),n.flags&=-33),Wj(e,Uj(e),i);break;case 3:case 4:var o=n.stateNode.containerInfo;Vj(e,Uj(e),o);break;default:throw Error(p(161))}}catch(s){W(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function hk(e,t,r){V=e,ik(e)}function ik(e,t,r){for(var n=!!(1&e.mode);null!==V;){var i=V,o=i.child;if(22===i.tag&&n){var s=null!==i.memoizedState||Jj;if(!s){var a=i.alternate,l=null!==a&&null!==a.memoizedState||U;a=Jj;var c=U;if(Jj=s,(U=l)&&!c)for(V=i;null!==V;)l=(s=V).child,22===s.tag&&null!==s.memoizedState?jk(i):null!==l?(l.return=s,V=l):jk(i);for(;null!==o;)V=o,ik(o),o=o.sibling;V=i,Jj=a,U=c}kk(e)}else 8772&i.subtreeFlags&&null!==o?(o.return=i,V=o):kk(e)}}function kk(e){for(;null!==V;){var t=V;if(8772&t.flags){var r=t.alternate;try{if(8772&t.flags)switch(t.tag){case 0:case 11:case 15:U||Qj(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!U)if(null===r)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Ci(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&sh(t,o,n);break;case 3:var s=t.updateQueue;if(null!==s){if(r=null,null!==t.child)switch(t.child.tag){case 5:case 1:r=t.child.stateNode}sh(t,s,r)}break;case 5:var a=t.stateNode;if(null===r&&4&t.flags){r=a;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var u=c.memoizedState;if(null!==u){var d=u.dehydrated;null!==d&&bd(d)}}}break;default:throw Error(p(163))}U||512&t.flags&&Rj(t)}catch(h){W(t,t.return,h)}}if(t===e){V=null;break}if(null!==(r=t.sibling)){r.return=t.return,V=r;break}V=t.return}}function gk(e){for(;null!==V;){var t=V;if(t===e){V=null;break}var r=t.sibling;if(null!==r){r.return=t.return,V=r;break}V=t.return}}function jk(e){for(;null!==V;){var t=V;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Qj(4,t)}catch(l){W(t,r,l)}break;case 1:var n=t.stateNode;if("function"==typeof n.componentDidMount){var i=t.return;try{n.componentDidMount()}catch(l){W(t,i,l)}}var o=t.return;try{Rj(t)}catch(l){W(t,o,l)}break;case 5:var s=t.return;try{Rj(t)}catch(l){W(t,s,l)}}}catch(l){W(t,t.return,l)}if(t===e){V=null;break}var a=t.sibling;if(null!==a){a.return=t.return,V=a;break}V=t.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K=0,Q=null,Y=null,Z=0,fj=0,ej=Uf(0),T=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0,Vk;function R(){return 6&K?B():-1!==Ak?Ak:Ak=B()}function yi(e){return 1&e.mode?2&K&&0!==Z?Z&-Z:null!==Kg.transition?(0===Bk&&(Bk=yc()),Bk):0!==(e=C)?e:e=void 0===(e=window.event)?16:jd(e.type):1}function gi(e,t,r,n){if(50<yk)throw yk=0,zk=null,Error(p(185));Ac(e,r,n),2&K&&e===Q||(e===Q&&(!(2&K)&&(qk|=r),4===T&&Ck(e,Z)),Dk(e,n),1===r&&0===K&&!(1&t.mode)&&(Gj=B()+500,fg&&jg()))}function Dk(e,t){var r=e.callbackNode;wc(e,t);var n=uc(e,e===Q?Z:0);if(0===n)null!==r&&bc(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=r&&bc(r),1===t)0===e.tag?ig(Ek.bind(null,e)):hg(Ek.bind(null,e)),Jf(function(){!(6&K)&&jg()}),r=null;else{switch(Dc(n)){case 1:r=fc;break;case 4:r=gc;break;case 16:default:r=hc;break;case 536870912:r=jc}r=Fk(r,Gk.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Gk(e,t){if(Ak=-1,Bk=0,6&K)throw Error(p(327));var r=e.callbackNode;if(Hk()&&e.callbackNode!==r)return null;var n=uc(e,e===Q?Z:0);if(0===n)return null;if(30&n||0!==(n&e.expiredLanes)||t)t=Ik(e,n);else{t=n;var i=K;K|=2;var o=Jk();for(Q===e&&Z===t||(uk=null,Gj=B()+500,Kk(e,t));;)try{Lk();break}catch(a){Mk(e,a)}$g(),mk.current=o,K=i,null!==Y?t=0:(Q=null,Z=0,t=T)}if(0!==t){if(2===t&&(0!==(i=xc(e))&&(n=i,t=Nk(e,i))),1===t)throw r=pk,Kk(e,0),Ck(e,n),Dk(e,B()),r;if(6===t)Ck(e,n);else{if(i=e.current.alternate,!(30&n||Ok(i)||(t=Ik(e,n),2===t&&(o=xc(e),0!==o&&(n=o,t=Nk(e,o))),1!==t)))throw r=pk,Kk(e,0),Ck(e,n),Dk(e,B()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(p(345));case 2:case 5:Pk(e,tk,uk);break;case 3:if(Ck(e,n),(130023424&n)===n&&10<(t=fk+500-B())){if(0!==uc(e,0))break;if(((i=e.suspendedLanes)&n)!==n){R(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Ff(Pk.bind(null,e,tk,uk),t);break}Pk(e,tk,uk);break;case 4:if(Ck(e,n),(4194240&n)===n)break;for(t=e.eventTimes,i=-1;0<n;){var s=31-oc(n);o=1<<s,(s=t[s])>i&&(i=s),n&=~o}if(n=i,10<(n=(120>(n=B()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*lk(n/1960))-n)){e.timeoutHandle=Ff(Pk.bind(null,e,tk,uk),n);break}Pk(e,tk,uk);break;default:throw Error(p(329))}}}return Dk(e,B()),e.callbackNode===r?Gk.bind(null,e):null}function Nk(e,t){var r=sk;return e.current.memoizedState.isDehydrated&&(Kk(e,t).flags|=256),2!==(e=Ik(e,t))&&(t=tk,tk=r,null!==t&&Fj(t)),e}function Fj(e){null===tk?tk=e:tk.push.apply(tk,e)}function Ok(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var n=0;n<r.length;n++){var i=r[n],o=i.getSnapshot;i=i.value;try{if(!He(o(),i))return!1}catch(s){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ck(e,t){for(t&=~rk,t&=~qk,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-oc(t),n=1<<r;e[r]=-1,t&=~n}}function Ek(e){if(6&K)throw Error(p(327));Hk();var t=uc(e,0);if(!(1&t))return Dk(e,B()),null;var r=Ik(e,t);if(0!==e.tag&&2===r){var n=xc(e);0!==n&&(t=n,r=Nk(e,n))}if(1===r)throw r=pk,Kk(e,0),Ck(e,t),Dk(e,B()),r;if(6===r)throw Error(p(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Pk(e,tk,uk),Dk(e,B()),null}function Qk(e,t){var r=K;K|=1;try{return e(t)}finally{0===(K=r)&&(Gj=B()+500,fg&&jg())}}function Rk(e){null!==wk&&0===wk.tag&&!(6&K)&&Hk();var t=K;K|=1;var r=ok.transition,n=C;try{if(ok.transition=null,C=1,e)return e()}finally{C=n,ok.transition=r,!(6&(K=t))&&jg()}}function Hj(){fj=ej.current,E(ej)}function Kk(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,Gf(r)),null!==Y)for(r=Y.return;null!==r;){var n=r;switch(wg(n),n.tag){case 1:null!=(n=n.type.childContextTypes)&&$f();break;case 3:zh(),E(Wf),E(H),Eh();break;case 5:Bh(n);break;case 4:zh();break;case 13:case 19:E(L);break;case 10:ah(n.type._context);break;case 22:case 23:Hj()}r=r.return}if(Q=e,Y=e=Pg(e.current,null),Z=fj=t,T=0,pk=null,rk=qk=rh=0,tk=sk=null,null!==fh){for(t=0;t<fh.length;t++)if(null!==(n=(r=fh[t]).interleaved)){r.interleaved=null;var i=n.next,o=r.pending;if(null!==o){var s=o.next;o.next=i,n.next=s}r.pending=n}fh=null}return e}function Mk(e,t){for(;;){var r=Y;try{if($g(),Fh.current=Rh,Ih){for(var n=M.memoizedState;null!==n;){var i=n.queue;null!==i&&(i.pending=null),n=n.next}Ih=!1}if(Hh=0,O=N=M=null,Jh=!1,Kh=0,nk.current=null,null===r||null===r.return){T=1,pk=t,Y=null;break}e:{var o=e,s=r.return,a=r,l=t;if(t=Z,a.flags|=32768,null!==l&&"object"==typeof l&&"function"==typeof l.then){var c=l,u=a,d=u.tag;if(!(1&u.mode||0!==d&&11!==d&&15!==d)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=Ui(s);if(null!==f){f.flags&=-257,Vi(f,s,a,o,t),1&f.mode&&Si(o,c,t),l=c;var y=(t=f).updateQueue;if(null===y){var g=new Set;g.add(l),t.updateQueue=g}else y.add(l);break e}if(!(1&t)){Si(o,c,t),tj();break e}l=Error(p(426))}else if(I&&1&a.mode){var m=Ui(s);if(null!==m){!(65536&m.flags)&&(m.flags|=256),Vi(m,s,a,o,t),Jg(Ji(l,a));break e}}o=l=Ji(l,a),4!==T&&(T=2),null===sk?sk=[o]:sk.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,ph(o,Ni(o,l,t));break e;case 1:a=l;var b=o.type,w=o.stateNode;if(!(128&o.flags||"function"!=typeof b.getDerivedStateFromError&&(null===w||"function"!=typeof w.componentDidCatch||null!==Ri&&Ri.has(w)))){o.flags|=65536,t&=-t,o.lanes|=t,ph(o,Qi(o,a,t));break e}}o=o.return}while(null!==o)}Sk(r)}catch(v){t=v,Y===r&&null!==r&&(Y=r=r.return);continue}break}}function Jk(){var e=mk.current;return mk.current=Rh,null===e?Rh:e}function tj(){0!==T&&3!==T&&2!==T||(T=4),null===Q||!(268435455&rh)&&!(268435455&qk)||Ck(Q,Z)}function Ik(e,t){var r=K;K|=2;var n=Jk();for(Q===e&&Z===t||(uk=null,Kk(e,t));;)try{Tk();break}catch(i){Mk(e,i)}if($g(),K=r,mk.current=n,null!==Y)throw Error(p(261));return Q=null,Z=0,T}function Tk(){for(;null!==Y;)Uk(Y)}function Lk(){for(;null!==Y&&!cc();)Uk(Y)}function Uk(e){var t=Vk(e.alternate,e,fj);e.memoizedProps=e.pendingProps,null===t?Sk(e):Y=t,nk.current=null}function Sk(e){var t=e;do{var r=t.alternate;if(e=t.return,32768&t.flags){if(null!==(r=Ij(r,t)))return r.flags&=32767,void(Y=r);if(null===e)return T=6,void(Y=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}else if(null!==(r=Ej(r,t,fj)))return void(Y=r);if(null!==(t=t.sibling))return void(Y=t);Y=t=e}while(null!==t);0===T&&(T=5)}function Pk(e,t,r){var n=C,i=ok.transition;try{ok.transition=null,C=1,Wk(e,t,r,n)}finally{ok.transition=i,C=n}return null}function Wk(e,t,r,n){do{Hk()}while(null!==wk);if(6&K)throw Error(p(327));r=e.finishedWork;var i=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(p(177));e.callbackNode=null,e.callbackPriority=0;var o=r.lanes|r.childLanes;if(Bc(e,o),e===Q&&(Y=Q=null,Z=0),!(2064&r.subtreeFlags)&&!(2064&r.flags)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),o=!!(15990&r.flags),15990&r.subtreeFlags||o){o=ok.transition,ok.transition=null;var s=C;C=1;var a=K;K|=4,nk.current=null,Oj(e,r),dk(r,e),Oe(Df),dd=!!Cf,Df=Cf=null,e.current=r,hk(r),dc(),K=a,C=s,ok.transition=o}else e.current=r;if(vk&&(vk=!1,wk=e,xk=i),0===(o=e.pendingLanes)&&(Ri=null),mc(r.stateNode),Dk(e,B()),null!==t)for(n=e.onRecoverableError,r=0;r<t.length;r++)n((i=t[r]).value,{componentStack:i.stack,digest:i.digest});if(Oi)throw Oi=!1,e=Pi,Pi=null,e;return 1&xk&&0!==e.tag&&Hk(),1&(o=e.pendingLanes)?e===zk?yk++:(yk=0,zk=e):yk=0,jg(),null}function Hk(){if(null!==wk){var e=Dc(xk),t=ok.transition,r=C;try{if(ok.transition=null,C=16>e?16:e,null===wk)var n=!1;else{if(e=wk,wk=null,xk=0,6&K)throw Error(p(331));var i=K;for(K|=4,V=e.current;null!==V;){var o=V,s=o.child;if(16&V.flags){var a=o.deletions;if(null!==a){for(var l=0;l<a.length;l++){var c=a[l];for(V=c;null!==V;){var u=V;switch(u.tag){case 0:case 11:case 15:Pj(8,u,o)}var d=u.child;if(null!==d)d.return=u,V=d;else for(;null!==V;){var h=(u=V).sibling,f=u.return;if(Sj(u),u===c){V=null;break}if(null!==h){h.return=f,V=h;break}V=f}}}var y=o.alternate;if(null!==y){var g=y.child;if(null!==g){y.child=null;do{var m=g.sibling;g.sibling=null,g=m}while(null!==g)}}V=o}}if(2064&o.subtreeFlags&&null!==s)s.return=o,V=s;else e:for(;null!==V;){if(2048&(o=V).flags)switch(o.tag){case 0:case 11:case 15:Pj(9,o,o.return)}var b=o.sibling;if(null!==b){b.return=o.return,V=b;break e}V=o.return}}var w=e.current;for(V=w;null!==V;){var v=(s=V).child;if(2064&s.subtreeFlags&&null!==v)v.return=s,V=v;else e:for(s=w;null!==V;){if(2048&(a=V).flags)try{switch(a.tag){case 0:case 11:case 15:Qj(9,a)}}catch(_){W(a,a.return,_)}if(a===s){V=null;break e}var k=a.sibling;if(null!==k){k.return=a.return,V=k;break e}V=a.return}}if(K=i,jg(),lc&&"function"==typeof lc.onPostCommitFiberRoot)try{lc.onPostCommitFiberRoot(kc,e)}catch(_){}n=!0}return n}finally{C=r,ok.transition=t}}return!1}function Xk(e,t,r){e=nh(e,t=Ni(e,t=Ji(r,t),1),1),t=R(),null!==e&&(Ac(e,1,t),Dk(e,t))}function W(e,t,r){if(3===e.tag)Xk(e,e,r);else for(;null!==t;){if(3===t.tag){Xk(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof n.componentDidCatch&&(null===Ri||!Ri.has(n))){t=nh(t,e=Qi(t,e=Ji(r,e),1),1),e=R(),null!==t&&(Ac(t,1,e),Dk(t,e));break}}t=t.return}}function Ti(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),t=R(),e.pingedLanes|=e.suspendedLanes&r,Q===e&&(Z&r)===r&&(4===T||3===T&&(130023424&Z)===Z&&500>B()-fk?Kk(e,0):rk|=r),Dk(e,t)}function Yk(e,t){0===t&&(1&e.mode?(t=sc,!(130023424&(sc<<=1))&&(sc=4194304)):t=1);var r=R();null!==(e=ih(e,t))&&(Ac(e,t,r),Dk(e,r))}function uj(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Yk(e,r)}function bk(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;null!==i&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(p(314))}null!==n&&n.delete(t),Yk(e,r)}function Fk(e,t){return ac(e,t)}function $k(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(e,t,r,n){return new $k(e,t,r,n)}function aj(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Zk(e){if("function"==typeof e)return aj(e)?1:0;if(null!=e){if((e=e.$$typeof)===Da)return 11;if(e===Ga)return 14}return 2}function Pg(e,t){var r=e.alternate;return null===r?((r=Bg(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Rg(e,t,r,n,i,o){var s=2;if(n=e,"function"==typeof e)aj(e)&&(s=1);else if("string"==typeof e)s=5;else e:switch(e){case ya:return Tg(r.children,i,o,t);case za:s=8,i|=8;break;case Aa:return(e=Bg(12,r,t,2|i)).elementType=Aa,e.lanes=o,e;case Ea:return(e=Bg(13,r,t,i)).elementType=Ea,e.lanes=o,e;case Fa:return(e=Bg(19,r,t,i)).elementType=Fa,e.lanes=o,e;case Ia:return pj(r,i,o,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case Ba:s=10;break e;case Ca:s=9;break e;case Da:s=11;break e;case Ga:s=14;break e;case Ha:s=16,n=null;break e}throw Error(p(130,null==e?e:typeof e,""))}return(t=Bg(s,r,t,i)).elementType=e,t.type=n,t.lanes=o,t}function Tg(e,t,r,n){return(e=Bg(7,e,n,t)).lanes=r,e}function pj(e,t,r,n){return(e=Bg(22,e,n,t)).elementType=Ia,e.lanes=r,e.stateNode={isHidden:!1},e}function Qg(e,t,r){return(e=Bg(6,e,null,t)).lanes=r,e}function Sg(e,t,r){return(t=Bg(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function al(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function bl(e,t,r,n,i,o,s,a,l){return e=new al(e,t,r,a,l),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Bg(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(o),e}function cl(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:wa,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}function dl(e){if(!e)return Vf;e:{if(Vb(e=e._reactInternals)!==e||1!==e.tag)throw Error(p(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Zf(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(p(171))}if(1===e.tag){var r=e.type;if(Zf(r))return bg(e,r,t)}return t}function el(e,t,r,n,i,o,s,a,l){return(e=bl(r,n,!0,e,i,o,s,a,l)).context=dl(null),r=e.current,(o=mh(n=R(),i=yi(r))).callback=null!=t?t:null,nh(r,o,i),e.current.lanes=i,Ac(e,i,n),Dk(e,n),e}function fl(e,t,r,n){var i=t.current,o=R(),s=yi(i);return r=dl(r),null===t.context?t.context=r:t.pendingContext=r,(t=mh(o,s)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=nh(i,t,s))&&(gi(e,i,s,o),oh(e,i,s)),s}function gl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function hl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function il(e,t){hl(e,t),(e=e.alternate)&&hl(e,t)}function jl(){return null}Vk=function(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps||Wf.current)dh=!0;else{if(0===(e.lanes&r)&&!(128&t.flags))return dh=!1,yj(e,t,r);dh=!!(131072&e.flags)}else dh=!1,I&&1048576&t.flags&&ug(t,ng,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;ij(e,t),e=t.pendingProps;var i=Yf(t,H.current);ch(t,r),i=Nh(null,t,n,e,i,r);var o=Sh();return t.flags|=1,"object"==typeof i&&null!==i&&"function"==typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Zf(n)?(o=!0,cg(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,kh(t),i.updater=Ei,t.stateNode=i,i._reactInternals=t,Ii(t,n,e,r),t=jj(null,t,n,!0,o,r)):(t.tag=0,I&&o&&vg(t),Xi(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(ij(e,t),e=t.pendingProps,n=(i=n._init)(n._payload),t.type=n,i=t.tag=Zk(n),e=Ci(n,e),i){case 0:t=cj(null,t,n,e,r);break e;case 1:t=hj(null,t,n,e,r);break e;case 11:t=Yi(null,t,n,e,r);break e;case 14:t=$i(null,t,n,Ci(n.type,e),r);break e}throw Error(p(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,cj(e,t,n,i=t.elementType===n?i:Ci(n,i),r);case 1:return n=t.type,i=t.pendingProps,hj(e,t,n,i=t.elementType===n?i:Ci(n,i),r);case 3:e:{if(kj(t),null===e)throw Error(p(387));n=t.pendingProps,i=(o=t.memoizedState).element,lh(e,t),qh(t,n,null,r);var s=t.memoizedState;if(n=s.element,o.isDehydrated){if(o={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=lj(e,t,n,r,i=Ji(Error(p(423)),t));break e}if(n!==i){t=lj(e,t,n,r,i=Ji(Error(p(424)),t));break e}for(yg=Lf(t.stateNode.containerInfo.firstChild),xg=t,I=!0,zg=null,r=Vg(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(Ig(),n===i){t=Zi(e,t,r);break e}Xi(e,t,n,r)}t=t.child}return t;case 5:return Ah(t),null===e&&Eg(t),n=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,s=i.children,Ef(n,i)?s=null:null!==o&&Ef(n,o)&&(t.flags|=32),gj(e,t),Xi(e,t,s,r),t.child;case 6:return null===e&&Eg(t),null;case 13:return oj(e,t,r);case 4:return yh(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=Ug(t,null,n,r):Xi(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,Yi(e,t,n,i=t.elementType===n?i:Ci(n,i),r);case 7:return Xi(e,t,t.pendingProps,r),t.child;case 8:case 12:return Xi(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,o=t.memoizedProps,s=i.value,G(Wg,n._currentValue),n._currentValue=s,null!==o)if(He(o.value,s)){if(o.children===i.children&&!Wf.current){t=Zi(e,t,r);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var a=o.dependencies;if(null!==a){s=o.child;for(var l=a.firstContext;null!==l;){if(l.context===n){if(1===o.tag){(l=mh(-1,r&-r)).tag=2;var c=o.updateQueue;if(null!==c){var u=(c=c.shared).pending;null===u?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}o.lanes|=r,null!==(l=o.alternate)&&(l.lanes|=r),bh(o.return,r,t),a.lanes|=r;break}l=l.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(p(341));s.lanes|=r,null!==(a=s.alternate)&&(a.lanes|=r),bh(s,r,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}Xi(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,ch(t,r),n=n(i=eh(i)),t.flags|=1,Xi(e,t,n,r),t.child;case 14:return i=Ci(n=t.type,t.pendingProps),$i(e,t,n,i=Ci(n.type,i),r);case 15:return bj(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ci(n,i),ij(e,t),t.tag=1,Zf(n)?(e=!0,cg(t)):e=!1,ch(t,r),Gi(t,n,i),Ii(t,n,i,r),jj(null,t,n,!0,e,r);case 19:return xj(e,t,r);case 22:return dj(e,t,r)}throw Error(p(156,t.tag))};var kl="function"==typeof reportError?reportError:function(e){console.error(e)};function ll(e){this._internalRoot=e}function ml(e){this._internalRoot=e}function nl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function ol(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function pl(){}function ql(e,t,r,n,i){if(i){if("function"==typeof n){var o=n;n=function(){var e=gl(s);o.call(e)}}var s=el(t,n,e,0,null,!1,!1,"",pl);return e._reactRootContainer=s,e[uf]=s.current,sf(8===e.nodeType?e.parentNode:e),Rk(),s}for(;i=e.lastChild;)e.removeChild(i);if("function"==typeof n){var a=n;n=function(){var e=gl(l);a.call(e)}}var l=bl(e,0,!1,null,null,!1,!1,"",pl);return e._reactRootContainer=l,e[uf]=l.current,sf(8===e.nodeType?e.parentNode:e),Rk(function(){fl(t,l,r,n)}),l}function rl(e,t,r,n,i){var o=r._reactRootContainer;if(o){var s=o;if("function"==typeof i){var a=i;i=function(){var e=gl(s);a.call(e)}}fl(t,s,e,i)}else s=ql(r,t,e,i,n);return gl(s)}ml.prototype.render=ll.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(p(409));fl(e,t,null,null)},ml.prototype.unmount=ll.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;Rk(function(){fl(null,e,null,null)}),t[uf]=null}},ml.prototype.unstable_scheduleHydration=function(e){if(e){var t=Hc();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Qc.length&&0!==t&&t<Qc[r].priority;r++);Qc.splice(r,0,e),0===r&&Vc(e)}},Ec=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=tc(t.pendingLanes);0!==r&&(Cc(t,1|r),Dk(t,B()),!(6&K)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var t=ih(e,1);if(null!==t){var r=R();gi(t,e,1,r)}}),il(e,1)}},Fc=function(e){if(13===e.tag){var t=ih(e,134217728);if(null!==t)gi(t,e,134217728,R());il(e,134217728)}},Gc=function(e){if(13===e.tag){var t=yi(e),r=ih(e,t);if(null!==r)gi(r,e,t,R());il(e,t)}},Hc=function(){return C},Ic=function(e,t){var r=C;try{return C=e,t()}finally{C=r}},yb=function(e,t,r){switch(t){case"input":if(bb(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=Db(n);if(!i)throw Error(p(90));Wa(n),bb(n,i)}}}break;case"textarea":ib(e,r);break;case"select":null!=(t=r.value)&&fb(e,!!r.multiple,t,!1)}},Gb=Qk,Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Zb(e))?null:e.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch(a){}}function checkDCE(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(e){console.error(e)}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl,reactDom_production_min.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!nl(t))throw Error(p(200));return cl(e,t,null,r)},reactDom_production_min.createRoot=function(e,t){if(!nl(e))throw Error(p(299));var r=!1,n="",i=kl;return null!=t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=bl(e,1,!1,null,null,r,!1,n,i),e[uf]=t.current,sf(8===e.nodeType?e.parentNode:e),new ll(t)},reactDom_production_min.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(p(188));throw e=Object.keys(e).join(","),Error(p(268,e))}return e=null===(e=Zb(t))?null:e.stateNode},reactDom_production_min.flushSync=function(e){return Rk(e)},reactDom_production_min.hydrate=function(e,t,r){if(!ol(t))throw Error(p(200));return rl(null,e,t,!0,r)},reactDom_production_min.hydrateRoot=function(e,t,r){if(!nl(e))throw Error(p(405));var n=null!=r&&r.hydratedSources||null,i=!1,o="",s=kl;if(null!=r&&(!0===r.unstable_strictMode&&(i=!0),void 0!==r.identifierPrefix&&(o=r.identifierPrefix),void 0!==r.onRecoverableError&&(s=r.onRecoverableError)),t=el(t,null,e,1,null!=r?r:null,i,!1,o,s),e[uf]=t.current,sf(e),n)for(e=0;e<n.length;e++)i=(i=(r=n[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new ml(t)},reactDom_production_min.render=function(e,t,r){if(!ol(t))throw Error(p(200));return rl(null,e,t,!1,r)},reactDom_production_min.unmountComponentAtNode=function(e){if(!ol(e))throw Error(p(40));return!!e._reactRootContainer&&(Rk(function(){rl(null,null,e,!1,function(){e._reactRootContainer=null,e[uf]=null})}),!0)},reactDom_production_min.unstable_batchedUpdates=Qk,reactDom_production_min.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!ol(r))throw Error(p(200));if(null==e||void 0===e._reactInternals)throw Error(p(38));return rl(e,t,r,!1,n)},reactDom_production_min.version="18.3.1-next-f1338f8080-20240426",checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports,m=reactDomExports;client.createRoot=m.createRoot,client.hydrateRoot=m.hydrateRoot;const scriptRel="modulepreload",assetsURL=function(e){return"/"+e},seen={},__vitePreload=function(e,t,r){if(!t||0===t.length)return e();const n=document.getElementsByTagName("link");return Promise.all(t.map(e=>{if((e=assetsURL(e))in seen)return;seen[e]=!0;const t=e.endsWith(".css"),i=t?'[rel="stylesheet"]':"";if(!!r)for(let r=n.length-1;r>=0;r--){const i=n[r];if(i.href===e&&(!t||"stylesheet"===i.rel))return}else if(document.querySelector(`link[href="${e}"]${i}`))return;const o=document.createElement("link");return o.rel=t?"stylesheet":scriptRel,t||(o.as="script",o.crossOrigin=""),o.href=e,document.head.appendChild(o),t?new Promise((t,r)=>{o.addEventListener("load",t),o.addEventListener("error",()=>r(new Error(`Unable to preload CSS for ${e}`)))}):void 0})).then(()=>e()).catch(e=>{const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e})};function stripper(e,t){return localStripper(void 0,(Array.isArray(e)?e:[e]).map(e=>{if("string"==typeof e){const t=e.replace(/[-\\[\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\^\\$\\|]/g,"\\$&");return new RegExp(`^${t}$`)}return e}),t)}function localStripper(e,t,r){if("object"!=typeof r||null===r)return r;if(Array.isArray(r))return r.map(r=>localStripper(e,t,r));const n={...r},i=(e,r)=>{for(const n of t)if(n.test(e)||n.test(r))return!0;return!1};for(const o in n)if(Object.prototype.hasOwnProperty.call(n,o)){let r;if(r=e?[e,o].join("."):o,i(o,r)){delete n[o];continue}"object"==typeof n[o]&&(Array.isArray(n[o])?n[o]=n[o].reduce((e,n,s)=>(i(o,`${r}[${s}]`)||e.push(localStripper(`${r}[${s}]`,t,n)),e),[]):n[o]=localStripper(r,t,n[o]))}return n}var ConsoleWriterStreamDefaultWriter=class{constructor(e){this.stream=e,this.desiredSize=null,this.decoder=new TextDecoder,this._stream=e,this.ready=Promise.resolve(void 0),this.closed=Promise.resolve(void 0)}abort(e){throw new Error("Method not implemented.")}async close(){}releaseLock(){this._stream.locked=!1,this.ready=Promise.resolve(void 0),this.closed=Promise.resolve(void 0)}write(e){let t=this.decoder.decode(e).trimEnd(),r="log";try{t=JSON.parse(t),r=t.level}catch(n){}switch(r){case"error":console.error(t);break;case"warn":console.warn(t);break;default:console.log(t)}return Promise.resolve()}},ConsoleWriterStream=class{constructor(){this.locked=!1}abort(e){throw new Error("Method not implemented.")}close(){return Promise.resolve()}getWriter(){if(this.locked)throw new Error("Stream is locked");return this.locked=!0,this._writer||(this._writer=new ConsoleWriterStreamDefaultWriter(this)),this._writer}},FanoutWriteStream=class{constructor(e){this.desiredSize=null,this._writers=e,this.ready=Promise.all(this._writers.map(e=>e.ready)).then(()=>{}),this.closed=Promise.all(this._writers.map(e=>e.closed)).then(()=>{})}abort(e){return Promise.all(this._writers.map(t=>t.abort(e))).then(()=>{})}close(){return Promise.all(this._writers.map(e=>e.close())).then(()=>{})}releaseLock(){this._writers.map(e=>e.releaseLock())}write(e){return Promise.all(this._writers.map(t=>t.write(e))).then(()=>{})}},__defProp$1=Object.defineProperty,__typeError=e=>{throw TypeError(e)},__export$1=(e,t)=>{for(var r in t)__defProp$1(e,r,{get:t[r],enumerable:!0})},__accessCheck=(e,t,r)=>t.has(e)||__typeError("Cannot "+r),__privateGet=(e,t,r)=>(__accessCheck(e,t,"read from private field"),r?r.call(e):t.get(e)),__privateAdd=(e,t,r)=>t.has(e)?__typeError("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),__privateSet=(e,t,r,n)=>(__accessCheck(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),__privateMethod=(e,t,r)=>(__accessCheck(e,t,"access private method"),r),Result=class e{static Ok(e){return new ResultOK(e)}static Err(t){return"string"==typeof t?new ResultError(new Error(t)):e.Is(t)?t.is_ok()?new ResultError(new Error("Result Error is Ok")):t:new ResultError(t)}static Is(t){if(!t)return!1;if(t instanceof e)return!0;const r=t;return!![typeof r.is_ok,typeof r.is_err,typeof r.unwrap,typeof r.unwrap_err].every(e=>"function"===e)}isOk(){return this.is_ok()}isErr(){return this.is_err()}Ok(){return this.unwrap()}Err(){return this.unwrap_err()}},ResultOK=class extends Result{constructor(e){super(),this._t=e}is_ok(){return!0}is_err(){return!1}unwrap_err(){throw new Error("Result is Ok")}unwrap(){return this._t}},ResultError=class extends Result{constructor(e){super(),this._error=e}is_ok(){return!1}is_err(){return!0}unwrap(){throw new Error(`Result is Err: ${this._error}`)}unwrap_err(){return this._error}};function exception2Result(e){try{const t=e();return t instanceof Promise?t.then(e=>Result.Ok(e)).catch(e=>Result.Err(e)):Result.Ok(t)}catch(t){return Result.Err(t)}}var _Required=class{constructor(){this.type="REQUIRED"}},_Optional=class{constructor(){this.type="OPTIONAL"}},param={REQUIRED:new _Required,OPTIONAL:new _Optional};function getParamsResult(e,t){const r=e.flat().reduce((e,t)=>("string"==typeof t?e.push({key:t,def:void 0,isOptional:!1}):"object"==typeof t&&e.push(...Object.keys(t).map(e=>({key:e,def:"string"==typeof t[e]?t[e]:void 0,isOptional:t[e]===param.OPTIONAL}))),e),[]),n=e.find(e=>"function"==typeof e)||((...e)=>`missing parameters: ${e.join(",")}`),i=[],o={};for(const s of r){const e=t.getParam(s.key);void 0===e?"string"==typeof s.def?o[s.key]=s.def:s.isOptional||i.push(s.key):o[s.key]=e}return i.length?Result.Err(n(...i)):Result.Ok(o)}var globalBuffer=globalThis;function coerceIntoUint8(e){return e instanceof ArrayBuffer?Result.Ok(new Uint8Array(e)):ArrayBuffer.isView(e)?Result.Ok(new Uint8Array(e.buffer,e.byteOffset,e.byteLength)):e instanceof Blob?Result.Err("Blob not supported"):globalBuffer.Buffer&&globalBuffer.Buffer.isBuffer(e)?Result.Ok(new Uint8Array(e.buffer,e.byteOffset,e.byteLength)):e instanceof Uint8Array?Result.Ok(e):Result.Is(e)?e.isErr()?Result.Err(e):coerceIntoUint8(e.unwrap()):Result.Err("Not a Uint8Array")}async function asyncCoerceIntoUint8(e){let t=await e;return t instanceof Blob&&(t=await t.arrayBuffer()),coerceIntoUint8(t)}var TxtOps=class{constructor(){this.encoder=new TextEncoder,this.decoder=new TextDecoder}encode(e){return this.encoder.encode(e)}decode(e){if(Result.Is(e)){if(e.isErr())throw e.Err();const t=e.unwrap();if("string"==typeof t)return this.decode(t)}return"string"==typeof e?e:this.decoder.decode(coerceIntoUint8(e).Ok())}async asyncDecode(e){let t=await e;return t instanceof Blob&&(t=await t.arrayBuffer()),this.decode(t)}},txtEnDecoder;function TxtEnDecoderSingleton(){return txtEnDecoder=null!=txtEnDecoder?txtEnDecoder:new TxtOps}var TimeMode={REAL:"real",CONST:"const",STEP:"step"},RandomMode={CONST:"const",STEP:"step",RANDOM:"random"},IDMode={UUID:"uuid",CONST:"const",STEP:"step"},Time=class{TimeSince(e){return this.Now().getTime()-e.getTime()}},SysTime=class extends Time{Now(){return new Date}Sleep(e){return new Promise(t=>{setTimeout(()=>{t()},e)})}},ConstTime=class extends Time{Now(){return new Date(2021,1,1,0,0,0,0)}Sleep(e){return Promise.resolve()}},StepTime=class extends Time{constructor(){super(),this._step=(new ConstTime).Now(),this._start=this._step}Now(e=1){for(let t=0;e>0&&t<e;t++)this._step=new Date(this._step.getTime()+1e3);return e<1&&(this._step=new Date(this._start.getTime()+-1e3*e)),this._step}Sleep(e){return this._step=new Date(this._step.getTime()+e),Promise.resolve()}};function TimeFactory(e){switch(e){case TimeMode.REAL:return new SysTime;case TimeMode.CONST:return new ConstTime;case TimeMode.STEP:return new StepTime}return new SysTime}var RandomService=class{constructor(e){this._step=0,this._mode=e}Random0ToValue(e){switch(this._mode){case RandomMode.CONST:return.5*e;case RandomMode.STEP:return this._step+=1e-4,this._step*e;case RandomMode.RANDOM:return Math.random()*e;default:throw new Error("Unknown RandomMode")}}},IdService=class{constructor(e){this._step=0,e||(e=IDMode.UUID),this._mode=e}NextId(){switch(this._mode){case IDMode.UUID:return crypto.randomUUID();case IDMode.CONST:return"VeryUniqueID";case IDMode.STEP:return"STEPId-"+this._step++;default:throw new Error("Unknown IDMode")}}};function consumeReadableStream(e,t){e.read().then(({done:r,value:n})=>{r||t(n).then(()=>{consumeReadableStream(e,t)}).catch(e=>{console.error("consumeReadableStream:writeFn",e)})}).catch(e=>{console.error("consumeReadableStream:read",e)})}function CFWriteableStream(e){const t=new TransformStream;return consumeReadableStream(t.readable.getReader(),e),t.writable}var BaseSysAbstraction=class{constructor(e){this._time=new SysTime,this._idService=new IdService,this._randomService=new RandomService(RandomMode.RANDOM),this._fileSystem=e.FileSystem,this._systemService=e.SystemService,this._txtEnDe=e.TxtEnDecoder;const t=this._txtEnDe;this._stdout=CFWriteableStream(e=>{const r=t.decode(e);return console.log(r.trimEnd()),Promise.resolve()}),this._stderr=CFWriteableStream(e=>{const r=t.decode(e);return console.error(r.trimEnd()),Promise.resolve()})}},WrapperSysAbstraction=class{constructor(e,t){this._time=e._time,this._stdout=e._stdout,this._stderr=e._stderr,this._idService=e._idService,this._randomService=e._randomService,this._fileSystem=e._fileSystem,this._systemService=e._systemService,t&&(t.TimeMode&&(this._time=TimeFactory(t.TimeMode)),t.Stdout&&(this._stdout=t.Stdout),t.Stderr&&(this._stderr=t.Stderr),t.IdMode&&(this._idService=new IdService(t.IdMode)),t.RandomMode&&(this._randomService=new RandomService(t.RandomMode)),t.FileSystem&&(this._fileSystem=t.FileSystem),t.SystemService&&(this._systemService=t.SystemService))}Time(){return this._time}NextId(){return this._idService.NextId()}Random0ToValue(e){return this._randomService.Random0ToValue(e)}Stdout(){return this._stdout}Stderr(){return this._stderr}System(){return this._systemService}FileSystem(){return this._fileSystem}},_promise,_resolveFn,_rejectFn,Future$1=class{constructor(){__privateAdd(this,_promise),__privateAdd(this,_resolveFn,()=>{throw new Error("This Promise is not working as expected.")}),__privateAdd(this,_rejectFn,()=>{throw new Error("This Promise is not working as expected.")}),__privateSet(this,_promise,new Promise((e,t)=>{__privateSet(this,_resolveFn,e),__privateSet(this,_rejectFn,t)}))}async asPromise(){return __privateGet(this,_promise)}resolve(e){__privateGet(this,_resolveFn).call(this,e)}reject(e){__privateGet(this,_rejectFn).call(this,e)}};_promise=new WeakMap,_resolveFn=new WeakMap,_rejectFn=new WeakMap;var LRUMap=class{constructor(e={}){this._map=new Map,this.param={maxEntries:e.maxEntries||100,maxAge:e.maxAge||0}}touch(e){if(!this._map.has(e))throw new Error(`key not found in cache: ${e}`);const t=this._map.get(e);return this._map.delete(e),this._map.set(e,t),t}setParam(e={}){if("number"==typeof e.maxEntries&&(this.param.maxEntries=e.maxEntries,e.maxEntries>0&&this._map.size>e.maxEntries)){const t=[];let r=this._map.size;for(const n of this._map.keys()){if(!(r>e.maxEntries))break;t.push(n),r--}for(const e of t)this._map.delete(e)}}has(e){return this._map.has(e)}get size(){return this._map.size}async getSet(e,t){const r=this.get(e);if(r)return r;{const r=await t(e);return this.set(e,r),r}}get(e){return this._map.has(e)?this.touch(e):this._map.get(e)}set(e,t){this._map.delete(e),this.param.maxEntries>0&&this._map.size>=this.param.maxEntries?(this._map.delete(this._map.keys().next().value),this._map.set(e,t)):this._map.set(e,t)}delete(e){this._map.delete(e)}clear(){this._map.clear()}forEach(e){this._map.forEach(e)}entries(){return this._map.entries()}},ResolveSeq=class{constructor(e){this._flushWaiting=[],this._seqFutures=[],this.ctx=e}reset(){}flush(){var e;if(this._seqFutures.length>0){const t=new Future$1;return null==(e=this._flushWaiting)||e.push(t),t.asPromise()}return Promise.resolve()}_step(e){var t;return e?(e.fn(this.ctx).then(t=>e.future.resolve(t)).catch(t=>e.future.reject(t)).finally(()=>{this._seqFutures.shift(),this._step(this._seqFutures[0])}),Promise.resolve()):(this._flushWaiting.forEach(e=>e.resolve()),null==(t=this._flushWaiting)||t.splice(0,this._flushWaiting.length),Promise.resolve())}async add(e,t){const r=new Future$1;return this._seqFutures.push({future:r,fn:e,id:t}),1===this._seqFutures.length&&this._step(this._seqFutures[0]),r.asPromise()}},ResolveOnce=class{constructor(e){this._onceDone=!1,this._onceFutures=[],this._onceOk=!1,this._isPromise=!1,this.ctx=e}get ready(){return this._onceDone}reset(){if(this._onceDone=!1,this._onceOk=!1,this._onceValue=void 0,this._onceError=void 0,this._inProgress){this._onceFutures.findIndex(e=>e===this._inProgress)>=0&&this._onceFutures.push(...this._onceFutures.splice(2).slice(1))}else this._onceFutures.length=0}once(e){if(this._onceDone){if(this._onceError){if(this._isPromise)return Promise.reject(this._onceError);throw this._onceError}if(this._onceOk)return this._isPromise?Promise.resolve(this._onceValue):this._onceValue;throw new Error("ResolveOnce.once impossible")}const t=new Future$1;if(this._onceFutures.push(t),1===this._onceFutures.length){const n=e=>{this._onceValue=e,this._onceOk=!0,this._onceDone=!0,this._isPromise&&this._onceFutures.forEach(e=>e.resolve(this._onceValue)),this._onceFutures.length=0},i=e=>{this._onceError=e,this._onceOk=!1,this._onceValue=void 0,this._onceDone=!0,this._isPromise&&this._onceFutures.forEach(e=>e.reject(this._onceError)),this._onceFutures.length=0};this._inProgress=t;try{const t=e(this.ctx);"function"==typeof t.then?(this._isPromise=!0,t.then(n).catch(i).finally(()=>{this._inProgress=void 0})):n(t)}catch(r){i(r)}this._isPromise||(this._inProgress=void 0)}return this._isPromise?t.asPromise():this.once(e)}},Keyed=class{constructor(e,t){var r;this.factory=e,this._map=new LRUMap(null!=(r=null==t?void 0:t.lru)?r:{maxEntries:-1})}setParam(e){this._map.setParam(e.lru)}async asyncGet(e){return this.get(await e())}get(e){"function"==typeof e&&(e=e());let t=this._map.get(e);return t||(t=this.factory(e),this._map.set(e,t)),t}unget(e){const t=this._map.get(e);null==t||t.reset(),this._map.delete(e)}reset(){this._map.forEach(e=>e.reset()),this._map.clear()}},KeyedResolvOnce=class extends Keyed{constructor(e={}){super(e=>new ResolveOnce(e),e)}values(){return Array.from(this._map.entries()).filter(([e,t])=>t._onceDone).map(([e,t])=>{if(t._onceDone)return t._onceError?{key:e,value:Result.Err(t._onceError)}:{key:e,value:Result.Ok(t._onceValue)};throw new Error("KeyedResolvOnce.values impossible")})}};function isSet(e,t=globalThis){const[r,...n]=e.split(".");return!!(["object","function"].includes(typeof t)&&t&&["object","function"].includes(typeof t[r])&&t[r])&&(n.length<=1||isSet(n.join("."),t[r]))}function runtimeFn(){const e=globalThis;let t=isSet("navigator.product")&&"object"==typeof e.navigator&&"ReactNative"===e.navigator.product,r=!1;isSet("Deno")||(r=isSet("process.versions.node")&&!t);let n=isSet("Deno");const i=isSet("caches.default")&&isSet("WebSocketPair");return i&&(n=!1,r=!1,t=!1),{isNodeIsh:r,isBrowser:!(r||n||i||t),isDeno:n,isReactNative:t,isCFWorker:i}}var once=new ResolveOnce,CFEnvActions=class e{constructor(e){this.injectOnRegister={},this.cfEnv=new Map(Object.entries(e.presetEnv||{}))}static new(t){return once.once(()=>new e(t))}static inject(t){const r=e.new({});for(const e in t){const n=t[e];"string"==typeof n&&(r.env?r.env.set(e,n):r.injectOnRegister[e]=n)}}active(){return runtimeFn().isCFWorker}register(e){this.env=e;for(const t in this.injectOnRegister)e.set(t,this.injectOnRegister[t]);return e}get(e){return this.cfEnv.get(e)}set(e,t){t&&this.cfEnv.set(e,t)}delete(e){this.cfEnv.delete(e)}keys(){return Array.from(this.cfEnv.keys())}},once2=new ResolveOnce,_deno,_DenoEnvActions=class e{constructor(e){__privateAdd(this,_deno,globalThis),this.opts=e}static new(t){return once2.once(()=>new e(t))}get _env(){return __privateGet(this,_deno).Deno.env}register(e){for(const t of e.keys())this._env.set(t,e.get(t)||"");return e}active(){return runtimeFn().isDeno}keys(){return Object.keys(this._env.toObject())}get(e){return this._env.get(e)}set(e,t){t&&this._env.set(e,t)}delete(e){this._env.delete(e)}};_deno=new WeakMap;var DenoEnvActions=_DenoEnvActions,once3=new ResolveOnce,_node,_NodeEnvActions=class e{constructor(e){__privateAdd(this,_node,globalThis),this._env=this.active()?__privateGet(this,_node).process.env:{},this.opts=e}static new(t){return once3.once(()=>new e(t))}register(e){for(const t of e.keys())this._env[t]=e.get(t)||"";return e}active(){return runtimeFn().isNodeIsh}keys(){return Object.keys(this._env)}get(e){return this._env[e]}set(e,t){t&&(this._env[e]=t)}delete(e){delete this._env[e]}};_node=new WeakMap;var NodeEnvActions=_NodeEnvActions,once4=new ResolveOnce,BrowserEnvActions=class e{constructor(e){this.env=new Map,this.opts=e}static new(t){return once4.once(()=>new e(t))}get(e){return this.env.get(e)}set(e,t){t&&this.env.set(e,t)}delete(e){this.env.delete(e)}keys(){return Array.from(this.env.keys())}active(){return!0}register(e){const t=Symbol.for(this.opts.symbol||"CP_ENV");return globalThis[t]=e,e}},envActions=[{id:"cf",fn:e=>CFEnvActions.new(e)},{id:"node",fn:e=>NodeEnvActions.new(e)},{id:"deno",fn:e=>DenoEnvActions.new(e)},{id:"browser",fn:e=>BrowserEnvActions.new(e)}],_envFactories=new KeyedResolvOnce;function envFactory(e={}){const t=envActions.find(t=>t.fn(e).active());if(!t)throw new Error("SysContainer:envFactory: no env available");return _envFactories.get(t.id).once(()=>{const r=t.fn(e),n=new EnvImpl(r,e);return r.register(n),n})}function isIterable$1(e){return null!=e&&"function"==typeof e[Symbol.iterator]}var EnvImpl=class{constructor(e,t={}){this._onSet=[],this._map=e,this._updatePresets(t.presetEnv)}gets(...e){return getParamsResult(e,{getParam:e=>this.get(e)})}sets(...e){e.forEach(e=>{if(Array.isArray(e)){if(2===e.length){const[t,r]=e;if("string"==typeof t&&"string"==typeof r)return void this.set(t,r)}for(const t of e)if(Array.isArray(t)&&2===t.length){const[e,r]=t;"string"==typeof e&&"string"==typeof r&&this.set(e,r)}}else if(isIterable$1(e))for(const[t,r]of e)"string"==typeof t&&"string"==typeof r&&this.set(t,r);else{const t=e;for(const e in t){const r=t[e];"string"==typeof e&&"string"==typeof r&&this.set(e,r)}}})}_updatePresets(e){if(e)for(const[t,r]of e)this._map.set(t,r)}_applyOnSet(e,t,r){e.forEach(e=>{let n=[];n=t?[t]:this._map.keys(),n.filter(t=>0===e.filter.size||!!e.filter.has(t)).forEach(n=>{let i;i=t||r?t&&!r?void 0:r:this._map.get(n),e.fn(n,i)})})}keys(){return this._map.keys()}onSet(e,...t){const r={filter:new Set(t),fn:e};this._onSet.push(r),this._applyOnSet([r])}get(e){return this._map.get(e)}set(e,t){t&&(this._map.set(e,t),this._applyOnSet(this._onSet,e,t))}delete(e){this._map.delete(e),this._applyOnSet(this._onSet,e)}},WebFileService=class{get baseDir(){throw new Error("basedir-Method not implemented.")}create(e){throw new Error("create-Method not implemented.")}readFileString(e){throw new Error("readFileString-Method not implemented.")}writeFileString(e,t){throw new Error("writeFileString-Method not implemented.")}abs(e){throw new Error("abs-Method not implemented.")}join(...e){throw new Error("join-Method not implemented.")}relative(e,t){throw new Error("relative-Method not implemented.")}dirname(e){throw new Error("dirname-Method not implemented.")}basename(e){throw new Error("basename-Method not implemented.")}nodeImport(e){throw new Error("nodeImport-Method not implemented.")}isAbsolute(e){throw new Error("isAbsolute-Method not implemented.")}},WebSystemService=class{Env(){return envFactory()}Args(){throw new Error("Args-Method not implemented.")}OnExit(e){throw new Error("OnExit-Method not implemented.")}Exit(e){throw new Error("Exit-Method not implemented.")}},my=void 0;function WebSysAbstraction(e){return my||(my=new BaseSysAbstraction({TxtEnDecoder:(null==e?void 0:e.TxtEnDecoder)||TxtEnDecoderSingleton(),FileSystem:new WebFileService,SystemService:new WebSystemService})),new WrapperSysAbstraction(my,e)}const ALIAS=Symbol.for("yaml.alias"),DOC=Symbol.for("yaml.document"),MAP=Symbol.for("yaml.map"),PAIR=Symbol.for("yaml.pair"),SCALAR$1=Symbol.for("yaml.scalar"),SEQ=Symbol.for("yaml.seq"),NODE_TYPE=Symbol.for("yaml.node.type"),isAlias=e=>!!e&&"object"==typeof e&&e[NODE_TYPE]===ALIAS,isDocument=e=>!!e&&"object"==typeof e&&e[NODE_TYPE]===DOC,isMap=e=>!!e&&"object"==typeof e&&e[NODE_TYPE]===MAP,isPair=e=>!!e&&"object"==typeof e&&e[NODE_TYPE]===PAIR,isScalar$1=e=>!!e&&"object"==typeof e&&e[NODE_TYPE]===SCALAR$1,isSeq=e=>!!e&&"object"==typeof e&&e[NODE_TYPE]===SEQ;function isCollection$1(e){if(e&&"object"==typeof e)switch(e[NODE_TYPE]){case MAP:case SEQ:return!0}return!1}function isNode(e){if(e&&"object"==typeof e)switch(e[NODE_TYPE]){case ALIAS:case MAP:case SCALAR$1:case SEQ:return!0}return!1}const hasAnchor=e=>(isScalar$1(e)||isCollection$1(e))&&!!e.anchor,BREAK$2=Symbol("break visit"),SKIP$1=Symbol("skip children"),REMOVE$1=Symbol("remove node");function visit$1(e,t){const r=initVisitor(t);if(isDocument(e)){visit_(null,e.contents,r,Object.freeze([e]))===REMOVE$1&&(e.contents=null)}else visit_(null,e,r,Object.freeze([]))}function visit_(e,t,r,n){const i=callVisitor(e,t,r,n);if(isNode(i)||isPair(i))return replaceNode(e,n,i),visit_(e,i,r,n);if("symbol"!=typeof i)if(isCollection$1(t)){n=Object.freeze(n.concat(t));for(let e=0;e<t.items.length;++e){const i=visit_(e,t.items[e],r,n);if("number"==typeof i)e=i-1;else{if(i===BREAK$2)return BREAK$2;i===REMOVE$1&&(t.items.splice(e,1),e-=1)}}}else if(isPair(t)){n=Object.freeze(n.concat(t));const e=visit_("key",t.key,r,n);if(e===BREAK$2)return BREAK$2;e===REMOVE$1&&(t.key=null);const i=visit_("value",t.value,r,n);if(i===BREAK$2)return BREAK$2;i===REMOVE$1&&(t.value=null)}return i}async function visitAsync(e,t){const r=initVisitor(t);if(isDocument(e)){await visitAsync_(null,e.contents,r,Object.freeze([e]))===REMOVE$1&&(e.contents=null)}else await visitAsync_(null,e,r,Object.freeze([]))}async function visitAsync_(e,t,r,n){const i=await callVisitor(e,t,r,n);if(isNode(i)||isPair(i))return replaceNode(e,n,i),visitAsync_(e,i,r,n);if("symbol"!=typeof i)if(isCollection$1(t)){n=Object.freeze(n.concat(t));for(let e=0;e<t.items.length;++e){const i=await visitAsync_(e,t.items[e],r,n);if("number"==typeof i)e=i-1;else{if(i===BREAK$2)return BREAK$2;i===REMOVE$1&&(t.items.splice(e,1),e-=1)}}}else if(isPair(t)){n=Object.freeze(n.concat(t));const e=await visitAsync_("key",t.key,r,n);if(e===BREAK$2)return BREAK$2;e===REMOVE$1&&(t.key=null);const i=await visitAsync_("value",t.value,r,n);if(i===BREAK$2)return BREAK$2;i===REMOVE$1&&(t.value=null)}return i}function initVisitor(e){return"object"==typeof e&&(e.Collection||e.Node||e.Value)?Object.assign({Alias:e.Node,Map:e.Node,Scalar:e.Node,Seq:e.Node},e.Value&&{Map:e.Value,Scalar:e.Value,Seq:e.Value},e.Collection&&{Map:e.Collection,Seq:e.Collection},e):e}function callVisitor(e,t,r,n){var i,o,s,a,l;return"function"==typeof r?r(e,t,n):isMap(t)?null==(i=r.Map)?void 0:i.call(r,e,t,n):isSeq(t)?null==(o=r.Seq)?void 0:o.call(r,e,t,n):isPair(t)?null==(s=r.Pair)?void 0:s.call(r,e,t,n):isScalar$1(t)?null==(a=r.Scalar)?void 0:a.call(r,e,t,n):isAlias(t)?null==(l=r.Alias)?void 0:l.call(r,e,t,n):void 0}function replaceNode(e,t,r){const n=t[t.length-1];if(isCollection$1(n))n.items[e]=r;else if(isPair(n))"key"===e?n.key=r:n.value=r;else{if(!isDocument(n)){const e=isAlias(n)?"alias":"scalar";throw new Error(`Cannot replace node with ${e} parent`)}n.contents=r}}visit$1.BREAK=BREAK$2,visit$1.SKIP=SKIP$1,visit$1.REMOVE=REMOVE$1,visitAsync.BREAK=BREAK$2,visitAsync.SKIP=SKIP$1,visitAsync.REMOVE=REMOVE$1;const escapeChars={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},escapeTagName=e=>e.replace(/[!,[\]{}]/g,e=>escapeChars[e]);class Directives{constructor(e,t){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},Directives.defaultYaml,e),this.tags=Object.assign({},Directives.defaultTags,t)}clone(){const e=new Directives(this.yaml,this.tags);return e.docStart=this.docStart,e}atDocument(){const e=new Directives(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:Directives.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},Directives.defaultTags)}return e}add(e,t){this.atNextDocument&&(this.yaml={explicit:Directives.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},Directives.defaultTags),this.atNextDocument=!1);const r=e.trim().split(/[ \t]+/),n=r.shift();switch(n){case"%TAG":{if(2!==r.length&&(t(0,"%TAG directive should contain exactly two parts"),r.length<2))return!1;const[e,n]=r;return this.tags[e]=n,!0}case"%YAML":{if(this.yaml.explicit=!0,1!==r.length)return t(0,"%YAML directive should contain exactly one part"),!1;const[e]=r;if("1.1"===e||"1.2"===e)return this.yaml.version=e,!0;return t(6,`Unsupported YAML version ${e}`,/^\d+\.\d+$/.test(e)),!1}default:return t(0,`Unknown directive ${n}`,!0),!1}}tagName(e,t){if("!"===e)return"!";if("!"!==e[0])return t(`Not a valid tag: ${e}`),null;if("<"===e[1]){const r=e.slice(2,-1);return"!"===r||"!!"===r?(t(`Verbatim tags aren't resolved, so ${e} is invalid.`),null):(">"!==e[e.length-1]&&t("Verbatim tags must end with a >"),r)}const[,r,n]=e.match(/^(.*!)([^!]*)$/s);n||t(`The ${e} tag has no suffix`);const i=this.tags[r];if(i)try{return i+decodeURIComponent(n)}catch(o){return t(String(o)),null}return"!"===r?e:(t(`Could not resolve tag: ${e}`),null)}tagString(e){for(const[t,r]of Object.entries(this.tags))if(e.startsWith(r))return t+escapeTagName(e.substring(r.length));return"!"===e[0]?e:`!<${e}>`}toString(e){const t=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],r=Object.entries(this.tags);let n;if(e&&r.length>0&&isNode(e.contents)){const t={};visit$1(e.contents,(e,r)=>{isNode(r)&&r.tag&&(t[r.tag]=!0)}),n=Object.keys(t)}else n=[];for(const[i,o]of r)"!!"===i&&"tag:yaml.org,2002:"===o||e&&!n.some(e=>e.startsWith(o))||t.push(`%TAG ${i} ${o}`);return t.join("\n")}}function anchorIsValid(e){if(/[\x00-\x19\s,[\]{}]/.test(e)){const t=JSON.stringify(e);throw new Error(`Anchor must not contain whitespace or control characters: ${t}`)}return!0}function anchorNames(e){const t=new Set;return visit$1(e,{Value(e,r){r.anchor&&t.add(r.anchor)}}),t}function findNewAnchor(e,t){for(let r=1;;++r){const n=`${e}${r}`;if(!t.has(n))return n}}function createNodeAnchors(e,t){const r=[],n=new Map;let i=null;return{onAnchor:n=>{r.push(n),i??(i=anchorNames(e));const o=findNewAnchor(t,i);return i.add(o),o},setAnchors:()=>{for(const e of r){const t=n.get(e);if("object"!=typeof t||!t.anchor||!isScalar$1(t.node)&&!isCollection$1(t.node)){const t=new Error("Failed to resolve repeated object (this should not happen)");throw t.source=e,t}t.node.anchor=t.anchor}},sourceObjects:n}}function applyReviver(e,t,r,n){if(n&&"object"==typeof n)if(Array.isArray(n))for(let i=0,o=n.length;i<o;++i){const t=n[i],r=applyReviver(e,n,String(i),t);void 0===r?delete n[i]:r!==t&&(n[i]=r)}else if(n instanceof Map)for(const i of Array.from(n.keys())){const t=n.get(i),r=applyReviver(e,n,i,t);void 0===r?n.delete(i):r!==t&&n.set(i,r)}else if(n instanceof Set)for(const i of Array.from(n)){const t=applyReviver(e,n,i,i);void 0===t?n.delete(i):t!==i&&(n.delete(i),n.add(t))}else for(const[i,o]of Object.entries(n)){const t=applyReviver(e,n,i,o);void 0===t?delete n[i]:t!==o&&(n[i]=t)}return e.call(t,r,n)}function toJS(e,t,r){if(Array.isArray(e))return e.map((e,t)=>toJS(e,String(t),r));if(e&&"function"==typeof e.toJSON){if(!r||!hasAnchor(e))return e.toJSON(t,r);const n={aliasCount:0,count:1,res:void 0};r.anchors.set(e,n),r.onCreate=e=>{n.res=e,delete r.onCreate};const i=e.toJSON(t,r);return r.onCreate&&r.onCreate(i),i}return"bigint"!=typeof e||(null==r?void 0:r.keep)?e:Number(e)}Directives.defaultYaml={explicit:!1,version:"1.2"},Directives.defaultTags={"!!":"tag:yaml.org,2002:"};class NodeBase{constructor(e){Object.defineProperty(this,NODE_TYPE,{value:e})}clone(){const e=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(e.range=this.range.slice()),e}toJS(e,{mapAsMap:t,maxAliasCount:r,onAnchor:n,reviver:i}={}){if(!isDocument(e))throw new TypeError("A document argument is required");const o={anchors:new Map,doc:e,keep:!0,mapAsMap:!0===t,mapKeyWarned:!1,maxAliasCount:"number"==typeof r?r:100},s=toJS(this,"",o);if("function"==typeof n)for(const{count:a,res:l}of o.anchors.values())n(l,a);return"function"==typeof i?applyReviver(i,{"":s},"",s):s}}class Alias extends NodeBase{constructor(e){super(ALIAS),this.source=e,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(e,t){let r,n;(null==t?void 0:t.aliasResolveCache)?r=t.aliasResolveCache:(r=[],visit$1(e,{Node:(e,t)=>{(isAlias(t)||hasAnchor(t))&&r.push(t)}}),t&&(t.aliasResolveCache=r));for(const i of r){if(i===this)break;i.anchor===this.source&&(n=i)}return n}toJSON(e,t){if(!t)return{source:this.source};const{anchors:r,doc:n,maxAliasCount:i}=t,o=this.resolve(n,t);if(!o){const e=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(e)}let s=r.get(o);if(s||(toJS(o,null,t),s=r.get(o)),!s||void 0===s.res){throw new ReferenceError("This should not happen: Alias anchor was not resolved?")}if(i>=0&&(s.count+=1,0===s.aliasCount&&(s.aliasCount=getAliasCount(n,o,r)),s.count*s.aliasCount>i)){throw new ReferenceError("Excessive alias count indicates a resource exhaustion attack")}return s.res}toString(e,t,r){const n=`*${this.source}`;if(e){if(anchorIsValid(this.source),e.options.verifyAliasOrder&&!e.anchors.has(this.source)){const e=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(e)}if(e.implicitKey)return`${n} `}return n}}function getAliasCount(e,t,r){if(isAlias(t)){const n=t.resolve(e),i=r&&n&&r.get(n);return i?i.count*i.aliasCount:0}if(isCollection$1(t)){let n=0;for(const i of t.items){const t=getAliasCount(e,i,r);t>n&&(n=t)}return n}if(isPair(t)){const n=getAliasCount(e,t.key,r),i=getAliasCount(e,t.value,r);return Math.max(n,i)}return 1}const isScalarValue=e=>!e||"function"!=typeof e&&"object"!=typeof e;class Scalar extends NodeBase{constructor(e){super(SCALAR$1),this.value=e}toJSON(e,t){return(null==t?void 0:t.keep)?this.value:toJS(this.value,e,t)}toString(){return String(this.value)}}Scalar.BLOCK_FOLDED="BLOCK_FOLDED",Scalar.BLOCK_LITERAL="BLOCK_LITERAL",Scalar.PLAIN="PLAIN",Scalar.QUOTE_DOUBLE="QUOTE_DOUBLE",Scalar.QUOTE_SINGLE="QUOTE_SINGLE";const defaultTagPrefix="tag:yaml.org,2002:";function findTagObject(e,t,r){if(t){const e=r.filter(e=>e.tag===t),n=e.find(e=>!e.format)??e[0];if(!n)throw new Error(`Tag ${t} not found`);return n}return r.find(t=>{var r;return(null==(r=t.identify)?void 0:r.call(t,e))&&!t.format})}function createNode(e,t,r){var n,i,o;if(isDocument(e)&&(e=e.contents),isNode(e))return e;if(isPair(e)){const t=null==(i=(n=r.schema[MAP]).createNode)?void 0:i.call(n,r.schema,null,r);return t.items.push(e),t}(e instanceof String||e instanceof Number||e instanceof Boolean||"undefined"!=typeof BigInt&&e instanceof BigInt)&&(e=e.valueOf());const{aliasDuplicateObjects:s,onAnchor:a,onTagObj:l,schema:c,sourceObjects:u}=r;let d;if(s&&e&&"object"==typeof e){if(d=u.get(e),d)return d.anchor??(d.anchor=a(e)),new Alias(d.anchor);d={anchor:null,node:null},u.set(e,d)}(null==t?void 0:t.startsWith("!!"))&&(t=defaultTagPrefix+t.slice(2));let h=findTagObject(e,t,c.tags);if(!h){if(e&&"function"==typeof e.toJSON&&(e=e.toJSON()),!e||"object"!=typeof e){const t=new Scalar(e);return d&&(d.node=t),t}h=e instanceof Map?c[MAP]:Symbol.iterator in Object(e)?c[SEQ]:c[MAP]}l&&(l(h),delete r.onTagObj);const f=(null==h?void 0:h.createNode)?h.createNode(r.schema,e,r):"function"==typeof(null==(o=null==h?void 0:h.nodeClass)?void 0:o.from)?h.nodeClass.from(r.schema,e,r):new Scalar(e);return t?f.tag=t:h.default||(f.tag=h.tag),d&&(d.node=f),f}function collectionFromPath(e,t,r){let n=r;for(let i=t.length-1;i>=0;--i){const e=t[i];if("number"==typeof e&&Number.isInteger(e)&&e>=0){const t=[];t[e]=n,n=t}else n=new Map([[e,n]])}return createNode(n,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:e,sourceObjects:new Map})}const isEmptyPath=e=>null==e||"object"==typeof e&&!!e[Symbol.iterator]().next().done;class Collection extends NodeBase{constructor(e,t){super(e),Object.defineProperty(this,"schema",{value:t,configurable:!0,enumerable:!1,writable:!0})}clone(e){const t=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return e&&(t.schema=e),t.items=t.items.map(t=>isNode(t)||isPair(t)?t.clone(e):t),this.range&&(t.range=this.range.slice()),t}addIn(e,t){if(isEmptyPath(e))this.add(t);else{const[r,...n]=e,i=this.get(r,!0);if(isCollection$1(i))i.addIn(n,t);else{if(void 0!==i||!this.schema)throw new Error(`Expected YAML collection at ${r}. Remaining path: ${n}`);this.set(r,collectionFromPath(this.schema,n,t))}}}deleteIn(e){const[t,...r]=e;if(0===r.length)return this.delete(t);const n=this.get(t,!0);if(isCollection$1(n))return n.deleteIn(r);throw new Error(`Expected YAML collection at ${t}. Remaining path: ${r}`)}getIn(e,t){const[r,...n]=e,i=this.get(r,!0);return 0===n.length?!t&&isScalar$1(i)?i.value:i:isCollection$1(i)?i.getIn(n,t):void 0}hasAllNullValues(e){return this.items.every(t=>{if(!isPair(t))return!1;const r=t.value;return null==r||e&&isScalar$1(r)&&null==r.value&&!r.commentBefore&&!r.comment&&!r.tag})}hasIn(e){const[t,...r]=e;if(0===r.length)return this.has(t);const n=this.get(t,!0);return!!isCollection$1(n)&&n.hasIn(r)}setIn(e,t){const[r,...n]=e;if(0===n.length)this.set(r,t);else{const e=this.get(r,!0);if(isCollection$1(e))e.setIn(n,t);else{if(void 0!==e||!this.schema)throw new Error(`Expected YAML collection at ${r}. Remaining path: ${n}`);this.set(r,collectionFromPath(this.schema,n,t))}}}}const stringifyComment=e=>e.replace(/^(?!$)(?: $)?/gm,"#");function indentComment(e,t){return/^\n+$/.test(e)?e.substring(1):t?e.replace(/^(?! *$)/gm,t):e}const lineComment=(e,t,r)=>e.endsWith("\n")?indentComment(r,t):r.includes("\n")?"\n"+indentComment(r,t):(e.endsWith(" ")?"":" ")+r,FOLD_FLOW="flow",FOLD_BLOCK="block",FOLD_QUOTED="quoted";function foldFlowLines(e,t,r="flow",{indentAtStart:n,lineWidth:i=80,minContentWidth:o=20,onFold:s,onOverflow:a}={}){if(!i||i<0)return e;i<o&&(o=0);const l=Math.max(1+o,1+i-t.length);if(e.length<=l)return e;const c=[],u={};let d,h,f=i-t.length;"number"==typeof n&&(n>i-Math.max(2,o)?c.push(0):f=i-n);let p=!1,y=-1,g=-1,m=-1;r===FOLD_BLOCK&&(y=consumeMoreIndentedLines(e,y,t.length),-1!==y&&(f=y+l));for(let w;w=e[y+=1];){if(r===FOLD_QUOTED&&"\\"===w){switch(g=y,e[y+1]){case"x":y+=3;break;case"u":y+=5;break;case"U":y+=9;break;default:y+=1}m=y}if("\n"===w)r===FOLD_BLOCK&&(y=consumeMoreIndentedLines(e,y,t.length)),f=y+t.length+l,d=void 0;else{if(" "===w&&h&&" "!==h&&"\n"!==h&&"\t"!==h){const t=e[y+1];t&&" "!==t&&"\n"!==t&&"\t"!==t&&(d=y)}if(y>=f)if(d)c.push(d),f=d+l,d=void 0;else if(r===FOLD_QUOTED){for(;" "===h||"\t"===h;)h=w,w=e[y+=1],p=!0;const t=y>m+1?y-2:g-1;if(u[t])return e;c.push(t),u[t]=!0,f=t+l,d=void 0}else p=!0}h=w}if(p&&a&&a(),0===c.length)return e;s&&s();let b=e.slice(0,c[0]);for(let w=0;w<c.length;++w){const n=c[w],i=c[w+1]||e.length;0===n?b=`\n${t}${e.slice(0,i)}`:(r===FOLD_QUOTED&&u[n]&&(b+=`${e[n]}\\`),b+=`\n${t}${e.slice(n+1,i)}`)}return b}function consumeMoreIndentedLines(e,t,r){let n=t,i=t+1,o=e[i];for(;" "===o||"\t"===o;)if(t<i+r)o=e[++t];else{do{o=e[++t]}while(o&&"\n"!==o);n=t,i=t+1,o=e[i]}return n}const getFoldOptions=(e,t)=>({indentAtStart:t?e.indent.length:e.indentAtStart,lineWidth:e.options.lineWidth,minContentWidth:e.options.minContentWidth}),containsDocumentMarker=e=>/^(%|---|\.\.\.)/m.test(e);function lineLengthOverLimit(e,t,r){if(!t||t<0)return!1;const n=t-r,i=e.length;if(i<=n)return!1;for(let o=0,s=0;o<i;++o)if("\n"===e[o]){if(o-s>n)return!0;if(s=o+1,i-s<=n)return!1}return!0}function doubleQuotedString(e,t){const r=JSON.stringify(e);if(t.options.doubleQuotedAsJSON)return r;const{implicitKey:n}=t,i=t.options.doubleQuotedMinMultiLineLength,o=t.indent||(containsDocumentMarker(e)?"  ":"");let s="",a=0;for(let l=0,c=r[l];c;c=r[++l])if(" "===c&&"\\"===r[l+1]&&"n"===r[l+2]&&(s+=r.slice(a,l)+"\\ ",l+=1,a=l,c="\\"),"\\"===c)switch(r[l+1]){case"u":{s+=r.slice(a,l);const e=r.substr(l+2,4);switch(e){case"0000":s+="\\0";break;case"0007":s+="\\a";break;case"000b":s+="\\v";break;case"001b":s+="\\e";break;case"0085":s+="\\N";break;case"00a0":s+="\\_";break;case"2028":s+="\\L";break;case"2029":s+="\\P";break;default:"00"===e.substr(0,2)?s+="\\x"+e.substr(2):s+=r.substr(l,6)}l+=5,a=l+1}break;case"n":if(n||'"'===r[l+2]||r.length<i)l+=1;else{for(s+=r.slice(a,l)+"\n\n";"\\"===r[l+2]&&"n"===r[l+3]&&'"'!==r[l+4];)s+="\n",l+=2;s+=o," "===r[l+2]&&(s+="\\"),l+=1,a=l+1}break;default:l+=1}return s=a?s+r.slice(a):r,n?s:foldFlowLines(s,o,FOLD_QUOTED,getFoldOptions(t,!1))}function singleQuotedString(e,t){if(!1===t.options.singleQuote||t.implicitKey&&e.includes("\n")||/[ \t]\n|\n[ \t]/.test(e))return doubleQuotedString(e,t);const r=t.indent||(containsDocumentMarker(e)?"  ":""),n="'"+e.replace(/'/g,"''").replace(/\n+/g,`$&\n${r}`)+"'";return t.implicitKey?n:foldFlowLines(n,r,FOLD_FLOW,getFoldOptions(t,!1))}function quotedString(e,t){const{singleQuote:r}=t.options;let n;if(!1===r)n=doubleQuotedString;else{const t=e.includes('"'),i=e.includes("'");n=t&&!i?singleQuotedString:i&&!t?doubleQuotedString:r?singleQuotedString:doubleQuotedString}return n(e,t)}let blockEndNewlines;try{blockEndNewlines=new RegExp("(^|(?<!\n))\n+(?!\n|$)","g")}catch{blockEndNewlines=/\n+(?!\n|$)/g}function blockString({comment:e,type:t,value:r},n,i,o){const{blockQuote:s,commentString:a,lineWidth:l}=n.options;if(!s||/\n[\t ]+$/.test(r))return quotedString(r,n);const c=n.indent||(n.forceBlockIndent||containsDocumentMarker(r)?"  ":""),u="literal"===s||"folded"!==s&&t!==Scalar.BLOCK_FOLDED&&(t===Scalar.BLOCK_LITERAL||!lineLengthOverLimit(r,l,c.length));if(!r)return u?"|\n":">\n";let d,h;for(h=r.length;h>0;--h){const e=r[h-1];if("\n"!==e&&"\t"!==e&&" "!==e)break}let f=r.substring(h);const p=f.indexOf("\n");-1===p?d="-":r===f||p!==f.length-1?(d="+",o&&o()):d="",f&&(r=r.slice(0,-f.length),"\n"===f[f.length-1]&&(f=f.slice(0,-1)),f=f.replace(blockEndNewlines,`$&${c}`));let y,g=!1,m=-1;for(y=0;y<r.length;++y){const e=r[y];if(" "===e)g=!0;else{if("\n"!==e)break;m=y}}let b=r.substring(0,m<y?m+1:y);b&&(r=r.substring(b.length),b=b.replace(/\n+/g,`$&${c}`));let w=(g?c?"2":"1":"")+d;if(e&&(w+=" "+a(e.replace(/ ?[\r\n]+/g," ")),i&&i()),!u){const e=r.replace(/\n+/g,"\n$&").replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${c}`);let i=!1;const o=getFoldOptions(n,!0);"folded"!==s&&t!==Scalar.BLOCK_FOLDED&&(o.onOverflow=()=>{i=!0});const a=foldFlowLines(`${b}${e}${f}`,c,FOLD_BLOCK,o);if(!i)return`>${w}\n${c}${a}`}return`|${w}\n${c}${b}${r=r.replace(/\n+/g,`$&${c}`)}${f}`}function plainString(e,t,r,n){const{type:i,value:o}=e,{actualString:s,implicitKey:a,indent:l,indentStep:c,inFlow:u}=t;if(a&&o.includes("\n")||u&&/[[\]{},]/.test(o))return quotedString(o,t);if(/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(o))return a||u||!o.includes("\n")?quotedString(o,t):blockString(e,t,r,n);if(!a&&!u&&i!==Scalar.PLAIN&&o.includes("\n"))return blockString(e,t,r,n);if(containsDocumentMarker(o)){if(""===l)return t.forceBlockIndent=!0,blockString(e,t,r,n);if(a&&l===c)return quotedString(o,t)}const d=o.replace(/\n+/g,`$&\n${l}`);if(s){const e=e=>{var t;return e.default&&"tag:yaml.org,2002:str"!==e.tag&&(null==(t=e.test)?void 0:t.test(d))},{compat:r,tags:n}=t.doc.schema;if(n.some(e)||(null==r?void 0:r.some(e)))return quotedString(o,t)}return a?d:foldFlowLines(d,l,FOLD_FLOW,getFoldOptions(t,!1))}function stringifyString(e,t,r,n){const{implicitKey:i,inFlow:o}=t,s="string"==typeof e.value?e:Object.assign({},e,{value:String(e.value)});let{type:a}=e;a!==Scalar.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(s.value)&&(a=Scalar.QUOTE_DOUBLE);const l=e=>{switch(e){case Scalar.BLOCK_FOLDED:case Scalar.BLOCK_LITERAL:return i||o?quotedString(s.value,t):blockString(s,t,r,n);case Scalar.QUOTE_DOUBLE:return doubleQuotedString(s.value,t);case Scalar.QUOTE_SINGLE:return singleQuotedString(s.value,t);case Scalar.PLAIN:return plainString(s,t,r,n);default:return null}};let c=l(a);if(null===c){const{defaultKeyType:e,defaultStringType:r}=t.options,n=i&&e||r;if(c=l(n),null===c)throw new Error(`Unsupported default string type ${n}`)}return c}function createStringifyContext(e,t){const r=Object.assign({blockQuote:!0,commentString:stringifyComment,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},e.schema.toStringOptions,t);let n;switch(r.collectionStyle){case"block":n=!1;break;case"flow":n=!0;break;default:n=null}return{anchors:new Set,doc:e,flowCollectionPadding:r.flowCollectionPadding?" ":"",indent:"",indentStep:"number"==typeof r.indent?" ".repeat(r.indent):"  ",inFlow:n,options:r}}function getTagObject(e,t){var r;if(t.tag){const r=e.filter(e=>e.tag===t.tag);if(r.length>0)return r.find(e=>e.format===t.format)??r[0]}let n,i;if(isScalar$1(t)){i=t.value;let r=e.filter(e=>{var t;return null==(t=e.identify)?void 0:t.call(e,i)});if(r.length>1){const e=r.filter(e=>e.test);e.length>0&&(r=e)}n=r.find(e=>e.format===t.format)??r.find(e=>!e.format)}else i=t,n=e.find(e=>e.nodeClass&&i instanceof e.nodeClass);if(!n){const e=(null==(r=null==i?void 0:i.constructor)?void 0:r.name)??(null===i?"null":typeof i);throw new Error(`Tag not resolved for ${e} value`)}return n}function stringifyProps(e,t,{anchors:r,doc:n}){if(!n.directives)return"";const i=[],o=(isScalar$1(e)||isCollection$1(e))&&e.anchor;o&&anchorIsValid(o)&&(r.add(o),i.push(`&${o}`));const s=e.tag??(t.default?null:t.tag);return s&&i.push(n.directives.tagString(s)),i.join(" ")}function stringify$2(e,t,r,n){var i;if(isPair(e))return e.toString(t,r,n);if(isAlias(e)){if(t.doc.directives)return e.toString(t);if(null==(i=t.resolvedAliases)?void 0:i.has(e))throw new TypeError("Cannot stringify circular structure without alias nodes");t.resolvedAliases?t.resolvedAliases.add(e):t.resolvedAliases=new Set([e]),e=e.resolve(t.doc)}let o;const s=isNode(e)?e:t.doc.createNode(e,{onTagObj:e=>o=e});o??(o=getTagObject(t.doc.schema.tags,s));const a=stringifyProps(s,o,t);a.length>0&&(t.indentAtStart=(t.indentAtStart??0)+a.length+1);const l="function"==typeof o.stringify?o.stringify(s,t,r,n):isScalar$1(s)?stringifyString(s,t,r,n):s.toString(t,r,n);return a?isScalar$1(s)||"{"===l[0]||"["===l[0]?`${a} ${l}`:`${a}\n${t.indent}${l}`:l}function stringifyPair({key:e,value:t},r,n,i){const{allNullValues:o,doc:s,indent:a,indentStep:l,options:{commentString:c,indentSeq:u,simpleKeys:d}}=r;let h=isNode(e)&&e.comment||null;if(d){if(h)throw new Error("With simple keys, key nodes cannot have comments");if(isCollection$1(e)||!isNode(e)&&"object"==typeof e){throw new Error("With simple keys, collection cannot be used as a key value")}}let f=!d&&(!e||h&&null==t&&!r.inFlow||isCollection$1(e)||(isScalar$1(e)?e.type===Scalar.BLOCK_FOLDED||e.type===Scalar.BLOCK_LITERAL:"object"==typeof e));r=Object.assign({},r,{allNullValues:!1,implicitKey:!f&&(d||!o),indent:a+l});let p,y,g,m=!1,b=!1,w=stringify$2(e,r,()=>m=!0,()=>b=!0);if(!f&&!r.inFlow&&w.length>1024){if(d)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");f=!0}if(r.inFlow){if(o||null==t)return m&&n&&n(),""===w?"?":f?`? ${w}`:w}else if(o&&!d||null==t&&f)return w=`? ${w}`,h&&!m?w+=lineComment(w,r.indent,c(h)):b&&i&&i(),w;m&&(h=null),f?(h&&(w+=lineComment(w,r.indent,c(h))),w=`? ${w}\n${a}:`):(w=`${w}:`,h&&(w+=lineComment(w,r.indent,c(h)))),isNode(t)?(p=!!t.spaceBefore,y=t.commentBefore,g=t.comment):(p=!1,y=null,g=null,t&&"object"==typeof t&&(t=s.createNode(t))),r.implicitKey=!1,f||h||!isScalar$1(t)||(r.indentAtStart=w.length+1),b=!1,u||!(l.length>=2)||r.inFlow||f||!isSeq(t)||t.flow||t.tag||t.anchor||(r.indent=r.indent.substring(2));let v=!1;const k=stringify$2(t,r,()=>v=!0,()=>b=!0);let _=" ";if(h||p||y){if(_=p?"\n":"",y){_+=`\n${indentComment(c(y),r.indent)}`}""!==k||r.inFlow?_+=`\n${r.indent}`:"\n"===_&&(_="\n\n")}else if(!f&&isCollection$1(t)){const e=k[0],n=k.indexOf("\n"),i=-1!==n,o=r.inFlow??t.flow??0===t.items.length;if(i||!o){let t=!1;if(i&&("&"===e||"!"===e)){let r=k.indexOf(" ");"&"===e&&-1!==r&&r<n&&"!"===k[r+1]&&(r=k.indexOf(" ",r+1)),(-1===r||n<r)&&(t=!0)}t||(_=`\n${r.indent}`)}}else""!==k&&"\n"!==k[0]||(_="");return w+=_+k,r.inFlow?v&&n&&n():g&&!v?w+=lineComment(w,r.indent,c(g)):b&&i&&i(),w}function warn(e,t){"debug"!==e&&"warn"!==e||console.warn(t)}const MERGE_KEY="<<",merge$1={identify:e=>e===MERGE_KEY||"symbol"==typeof e&&e.description===MERGE_KEY,default:"key",tag:"tag:yaml.org,2002:merge",test:/^<<$/,resolve:()=>Object.assign(new Scalar(Symbol(MERGE_KEY)),{addToJSMap:addMergeToJSMap}),stringify:()=>MERGE_KEY},isMergeKey=(e,t)=>(merge$1.identify(t)||isScalar$1(t)&&(!t.type||t.type===Scalar.PLAIN)&&merge$1.identify(t.value))&&(null==e?void 0:e.doc.schema.tags.some(e=>e.tag===merge$1.tag&&e.default));function addMergeToJSMap(e,t,r){if(r=e&&isAlias(r)?r.resolve(e.doc):r,isSeq(r))for(const n of r.items)mergeValue(e,t,n);else if(Array.isArray(r))for(const n of r)mergeValue(e,t,n);else mergeValue(e,t,r)}function mergeValue(e,t,r){const n=e&&isAlias(r)?r.resolve(e.doc):r;if(!isMap(n))throw new Error("Merge sources must be maps or map aliases");const i=n.toJSON(null,e,Map);for(const[o,s]of i)t instanceof Map?t.has(o)||t.set(o,s):t instanceof Set?t.add(o):Object.prototype.hasOwnProperty.call(t,o)||Object.defineProperty(t,o,{value:s,writable:!0,enumerable:!0,configurable:!0});return t}function addPairToJSMap(e,t,{key:r,value:n}){if(isNode(r)&&r.addToJSMap)r.addToJSMap(e,t,n);else if(isMergeKey(e,r))addMergeToJSMap(e,t,n);else{const i=toJS(r,"",e);if(t instanceof Map)t.set(i,toJS(n,i,e));else if(t instanceof Set)t.add(i);else{const o=stringifyKey(r,i,e),s=toJS(n,o,e);o in t?Object.defineProperty(t,o,{value:s,writable:!0,enumerable:!0,configurable:!0}):t[o]=s}}return t}function stringifyKey(e,t,r){if(null===t)return"";if("object"!=typeof t)return String(t);if(isNode(e)&&(null==r?void 0:r.doc)){const t=createStringifyContext(r.doc,{});t.anchors=new Set;for(const e of r.anchors.keys())t.anchors.add(e.anchor);t.inFlow=!0,t.inStringifyKey=!0;const n=e.toString(t);if(!r.mapKeyWarned){let e=JSON.stringify(n);e.length>40&&(e=e.substring(0,36)+'..."'),warn(r.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${e}. Set mapAsMap: true to use object keys.`),r.mapKeyWarned=!0}return n}return JSON.stringify(t)}function createPair(e,t,r){const n=createNode(e,void 0,r),i=createNode(t,void 0,r);return new Pair(n,i)}class Pair{constructor(e,t=null){Object.defineProperty(this,NODE_TYPE,{value:PAIR}),this.key=e,this.value=t}clone(e){let{key:t,value:r}=this;return isNode(t)&&(t=t.clone(e)),isNode(r)&&(r=r.clone(e)),new Pair(t,r)}toJSON(e,t){return addPairToJSMap(t,(null==t?void 0:t.mapAsMap)?new Map:{},this)}toString(e,t,r){return(null==e?void 0:e.doc)?stringifyPair(this,e,t,r):JSON.stringify(this)}}function stringifyCollection(e,t,r){return(t.inFlow??e.flow?stringifyFlowCollection:stringifyBlockCollection)(e,t,r)}function stringifyBlockCollection({comment:e,items:t},r,{blockItemPrefix:n,flowChars:i,itemIndent:o,onChompKeep:s,onComment:a}){const{indent:l,options:{commentString:c}}=r,u=Object.assign({},r,{indent:o,type:null});let d=!1;const h=[];for(let p=0;p<t.length;++p){const e=t[p];let i=null;if(isNode(e))!d&&e.spaceBefore&&h.push(""),addCommentBefore(r,h,e.commentBefore,d),e.comment&&(i=e.comment);else if(isPair(e)){const t=isNode(e.key)?e.key:null;t&&(!d&&t.spaceBefore&&h.push(""),addCommentBefore(r,h,t.commentBefore,d))}d=!1;let s=stringify$2(e,u,()=>i=null,()=>d=!0);i&&(s+=lineComment(s,o,c(i))),d&&i&&(d=!1),h.push(n+s)}let f;if(0===h.length)f=i.start+i.end;else{f=h[0];for(let e=1;e<h.length;++e){const t=h[e];f+=t?`\n${l}${t}`:"\n"}}return e?(f+="\n"+indentComment(c(e),l),a&&a()):d&&s&&s(),f}function stringifyFlowCollection({items:e},t,{flowChars:r,itemIndent:n}){const{indent:i,indentStep:o,flowCollectionPadding:s,options:{commentString:a}}=t;n+=o;const l=Object.assign({},t,{indent:n,inFlow:!0,type:null});let c=!1,u=0;const d=[];for(let p=0;p<e.length;++p){const r=e[p];let i=null;if(isNode(r))r.spaceBefore&&d.push(""),addCommentBefore(t,d,r.commentBefore,!1),r.comment&&(i=r.comment);else if(isPair(r)){const e=isNode(r.key)?r.key:null;e&&(e.spaceBefore&&d.push(""),addCommentBefore(t,d,e.commentBefore,!1),e.comment&&(c=!0));const n=isNode(r.value)?r.value:null;n?(n.comment&&(i=n.comment),n.commentBefore&&(c=!0)):null==r.value&&(null==e?void 0:e.comment)&&(i=e.comment)}i&&(c=!0);let o=stringify$2(r,l,()=>i=null);p<e.length-1&&(o+=","),i&&(o+=lineComment(o,n,a(i))),!c&&(d.length>u||o.includes("\n"))&&(c=!0),d.push(o),u=d.length}const{start:h,end:f}=r;if(0===d.length)return h+f;if(!c){const e=d.reduce((e,t)=>e+t.length+2,2);c=t.options.lineWidth>0&&e>t.options.lineWidth}if(c){let e=h;for(const t of d)e+=t?`\n${o}${i}${t}`:"\n";return`${e}\n${i}${f}`}return`${h}${s}${d.join(" ")}${s}${f}`}function addCommentBefore({indent:e,options:{commentString:t}},r,n,i){if(n&&i&&(n=n.replace(/^\n+/,"")),n){const i=indentComment(t(n),e);r.push(i.trimStart())}}function findPair(e,t){const r=isScalar$1(t)?t.value:t;for(const n of e)if(isPair(n)){if(n.key===t||n.key===r)return n;if(isScalar$1(n.key)&&n.key.value===r)return n}}class YAMLMap extends Collection{static get tagName(){return"tag:yaml.org,2002:map"}constructor(e){super(MAP,e),this.items=[]}static from(e,t,r){const{keepUndefined:n,replacer:i}=r,o=new this(e),s=(e,s)=>{if("function"==typeof i)s=i.call(t,e,s);else if(Array.isArray(i)&&!i.includes(e))return;(void 0!==s||n)&&o.items.push(createPair(e,s,r))};if(t instanceof Map)for(const[a,l]of t)s(a,l);else if(t&&"object"==typeof t)for(const a of Object.keys(t))s(a,t[a]);return"function"==typeof e.sortMapEntries&&o.items.sort(e.sortMapEntries),o}add(e,t){var r;let n;n=isPair(e)?e:e&&"object"==typeof e&&"key"in e?new Pair(e.key,e.value):new Pair(e,null==e?void 0:e.value);const i=findPair(this.items,n.key),o=null==(r=this.schema)?void 0:r.sortMapEntries;if(i){if(!t)throw new Error(`Key ${n.key} already set`);isScalar$1(i.value)&&isScalarValue(n.value)?i.value.value=n.value:i.value=n.value}else if(o){const e=this.items.findIndex(e=>o(n,e)<0);-1===e?this.items.push(n):this.items.splice(e,0,n)}else this.items.push(n)}delete(e){const t=findPair(this.items,e);if(!t)return!1;return this.items.splice(this.items.indexOf(t),1).length>0}get(e,t){const r=findPair(this.items,e),n=null==r?void 0:r.value;return(!t&&isScalar$1(n)?n.value:n)??void 0}has(e){return!!findPair(this.items,e)}set(e,t){this.add(new Pair(e,t),!0)}toJSON(e,t,r){const n=r?new r:(null==t?void 0:t.mapAsMap)?new Map:{};(null==t?void 0:t.onCreate)&&t.onCreate(n);for(const i of this.items)addPairToJSMap(t,n,i);return n}toString(e,t,r){if(!e)return JSON.stringify(this);for(const n of this.items)if(!isPair(n))throw new Error(`Map items must all be pairs; found ${JSON.stringify(n)} instead`);return!e.allNullValues&&this.hasAllNullValues(!1)&&(e=Object.assign({},e,{allNullValues:!0})),stringifyCollection(this,e,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:e.indent||"",onChompKeep:r,onComment:t})}}const map$1={collection:"map",default:!0,nodeClass:YAMLMap,tag:"tag:yaml.org,2002:map",resolve:(e,t)=>(isMap(e)||t("Expected a mapping for this tag"),e),createNode:(e,t,r)=>YAMLMap.from(e,t,r)};class YAMLSeq extends Collection{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(e){super(SEQ,e),this.items=[]}add(e){this.items.push(e)}delete(e){const t=asItemIndex(e);if("number"!=typeof t)return!1;return this.items.splice(t,1).length>0}get(e,t){const r=asItemIndex(e);if("number"!=typeof r)return;const n=this.items[r];return!t&&isScalar$1(n)?n.value:n}has(e){const t=asItemIndex(e);return"number"==typeof t&&t<this.items.length}set(e,t){const r=asItemIndex(e);if("number"!=typeof r)throw new Error(`Expected a valid index, not ${e}.`);const n=this.items[r];isScalar$1(n)&&isScalarValue(t)?n.value=t:this.items[r]=t}toJSON(e,t){const r=[];(null==t?void 0:t.onCreate)&&t.onCreate(r);let n=0;for(const i of this.items)r.push(toJS(i,String(n++),t));return r}toString(e,t,r){return e?stringifyCollection(this,e,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(e.indent||"")+"  ",onChompKeep:r,onComment:t}):JSON.stringify(this)}static from(e,t,r){const{replacer:n}=r,i=new this(e);if(t&&Symbol.iterator in Object(t)){let e=0;for(let o of t){if("function"==typeof n){const r=t instanceof Set?o:String(e++);o=n.call(t,r,o)}i.items.push(createNode(o,void 0,r))}}return i}}function asItemIndex(e){let t=isScalar$1(e)?e.value:e;return t&&"string"==typeof t&&(t=Number(t)),"number"==typeof t&&Number.isInteger(t)&&t>=0?t:null}const seq={collection:"seq",default:!0,nodeClass:YAMLSeq,tag:"tag:yaml.org,2002:seq",resolve:(e,t)=>(isSeq(e)||t("Expected a sequence for this tag"),e),createNode:(e,t,r)=>YAMLSeq.from(e,t,r)},string$1={identify:e=>"string"==typeof e,default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify:(e,t,r,n)=>stringifyString(e,t=Object.assign({actualString:!0},t),r,n)},nullTag={identify:e=>null==e,createNode:()=>new Scalar(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new Scalar(null),stringify:({source:e},t)=>"string"==typeof e&&nullTag.test.test(e)?e:t.options.nullStr},boolTag={identify:e=>"boolean"==typeof e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:e=>new Scalar("t"===e[0]||"T"===e[0]),stringify({source:e,value:t},r){if(e&&boolTag.test.test(e)){if(t===("t"===e[0]||"T"===e[0]))return e}return t?r.options.trueStr:r.options.falseStr}};function stringifyNumber({format:e,minFractionDigits:t,tag:r,value:n}){if("bigint"==typeof n)return String(n);const i="number"==typeof n?n:Number(n);if(!isFinite(i))return isNaN(i)?".nan":i<0?"-.inf":".inf";let o=JSON.stringify(n);if(!e&&t&&(!r||"tag:yaml.org,2002:float"===r)&&/^\d/.test(o)){let e=o.indexOf(".");e<0&&(e=o.length,o+=".");let r=t-(o.length-e-1);for(;r-- >0;)o+="0"}return o}const floatNaN$1={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:e=>"nan"===e.slice(-3).toLowerCase()?NaN:"-"===e[0]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:stringifyNumber},floatExp$1={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e),stringify(e){const t=Number(e.value);return isFinite(t)?t.toExponential():stringifyNumber(e)}},float$2={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(e){const t=new Scalar(parseFloat(e)),r=e.indexOf(".");return-1!==r&&"0"===e[e.length-1]&&(t.minFractionDigits=e.length-r-1),t},stringify:stringifyNumber},intIdentify$2=e=>"bigint"==typeof e||Number.isInteger(e),intResolve$1=(e,t,r,{intAsBigInt:n})=>n?BigInt(e):parseInt(e.substring(t),r);function intStringify$1(e,t,r){const{value:n}=e;return intIdentify$2(n)&&n>=0?r+n.toString(t):stringifyNumber(e)}const intOct$1={identify:e=>intIdentify$2(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(e,t,r)=>intResolve$1(e,2,8,r),stringify:e=>intStringify$1(e,8,"0o")},int$1={identify:intIdentify$2,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(e,t,r)=>intResolve$1(e,0,10,r),stringify:stringifyNumber},intHex$1={identify:e=>intIdentify$2(e)&&e>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(e,t,r)=>intResolve$1(e,2,16,r),stringify:e=>intStringify$1(e,16,"0x")},schema$2=[map$1,seq,string$1,nullTag,boolTag,intOct$1,int$1,intHex$1,floatNaN$1,floatExp$1,float$2];function intIdentify$1(e){return"bigint"==typeof e||Number.isInteger(e)}const stringifyJSON=({value:e})=>JSON.stringify(e),jsonScalars=[{identify:e=>"string"==typeof e,default:!0,tag:"tag:yaml.org,2002:str",resolve:e=>e,stringify:stringifyJSON},{identify:e=>null==e,createNode:()=>new Scalar(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:stringifyJSON},{identify:e=>"boolean"==typeof e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^true$|^false$/,resolve:e=>"true"===e,stringify:stringifyJSON},{identify:intIdentify$1,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(e,t,{intAsBigInt:r})=>r?BigInt(e):parseInt(e,10),stringify:({value:e})=>intIdentify$1(e)?e.toString():JSON.stringify(e)},{identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:e=>parseFloat(e),stringify:stringifyJSON}],jsonError={default:!0,tag:"",test:/^/,resolve:(e,t)=>(t(`Unresolved plain scalar ${JSON.stringify(e)}`),e)},schema$1=[map$1,seq].concat(jsonScalars,jsonError),binary={identify:e=>e instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(e,t){if("function"==typeof atob){const t=atob(e.replace(/[\n\r]/g,"")),r=new Uint8Array(t.length);for(let e=0;e<t.length;++e)r[e]=t.charCodeAt(e);return r}return t("This environment does not support reading binary tags; either Buffer or atob is required"),e},stringify({comment:e,type:t,value:r},n,i,o){if(!r)return"";const s=r;let a;if("function"!=typeof btoa)throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");{let e="";for(let t=0;t<s.length;++t)e+=String.fromCharCode(s[t]);a=btoa(e)}if(t??(t=Scalar.BLOCK_LITERAL),t!==Scalar.QUOTE_DOUBLE){const e=Math.max(n.options.lineWidth-n.indent.length,n.options.minContentWidth),r=Math.ceil(a.length/e),i=new Array(r);for(let t=0,n=0;t<r;++t,n+=e)i[t]=a.substr(n,e);a=i.join(t===Scalar.BLOCK_LITERAL?"\n":" ")}return stringifyString({comment:e,type:t,value:a},n,i,o)}};function resolvePairs(e,t){if(isSeq(e))for(let r=0;r<e.items.length;++r){let n=e.items[r];if(!isPair(n)){if(isMap(n)){n.items.length>1&&t("Each pair must have its own sequence indicator");const e=n.items[0]||new Pair(new Scalar(null));if(n.commentBefore&&(e.key.commentBefore=e.key.commentBefore?`${n.commentBefore}\n${e.key.commentBefore}`:n.commentBefore),n.comment){const t=e.value??e.key;t.comment=t.comment?`${n.comment}\n${t.comment}`:n.comment}n=e}e.items[r]=isPair(n)?n:new Pair(n)}}else t("Expected a sequence for this tag");return e}function createPairs(e,t,r){const{replacer:n}=r,i=new YAMLSeq(e);i.tag="tag:yaml.org,2002:pairs";let o=0;if(t&&Symbol.iterator in Object(t))for(let s of t){let e,a;if("function"==typeof n&&(s=n.call(t,String(o++),s)),Array.isArray(s)){if(2!==s.length)throw new TypeError(`Expected [key, value] tuple: ${s}`);e=s[0],a=s[1]}else if(s&&s instanceof Object){const t=Object.keys(s);if(1!==t.length)throw new TypeError(`Expected tuple with one key, not ${t.length} keys`);e=t[0],a=s[e]}else e=s;i.items.push(createPair(e,a,r))}return i}const pairs={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:resolvePairs,createNode:createPairs};class YAMLOMap extends YAMLSeq{constructor(){super(),this.add=YAMLMap.prototype.add.bind(this),this.delete=YAMLMap.prototype.delete.bind(this),this.get=YAMLMap.prototype.get.bind(this),this.has=YAMLMap.prototype.has.bind(this),this.set=YAMLMap.prototype.set.bind(this),this.tag=YAMLOMap.tag}toJSON(e,t){if(!t)return super.toJSON(e);const r=new Map;(null==t?void 0:t.onCreate)&&t.onCreate(r);for(const n of this.items){let e,i;if(isPair(n)?(e=toJS(n.key,"",t),i=toJS(n.value,e,t)):e=toJS(n,"",t),r.has(e))throw new Error("Ordered maps must not include duplicate keys");r.set(e,i)}return r}static from(e,t,r){const n=createPairs(e,t,r),i=new this;return i.items=n.items,i}}YAMLOMap.tag="tag:yaml.org,2002:omap";const omap={collection:"seq",identify:e=>e instanceof Map,nodeClass:YAMLOMap,default:!1,tag:"tag:yaml.org,2002:omap",resolve(e,t){const r=resolvePairs(e,t),n=[];for(const{key:i}of r.items)isScalar$1(i)&&(n.includes(i.value)?t(`Ordered maps must not include duplicate keys: ${i.value}`):n.push(i.value));return Object.assign(new YAMLOMap,r)},createNode:(e,t,r)=>YAMLOMap.from(e,t,r)};function boolStringify({value:e,source:t},r){return t&&(e?trueTag:falseTag).test.test(t)?t:e?r.options.trueStr:r.options.falseStr}const trueTag={identify:e=>!0===e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new Scalar(!0),stringify:boolStringify},falseTag={identify:e=>!1===e,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new Scalar(!1),stringify:boolStringify},floatNaN={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:e=>"nan"===e.slice(-3).toLowerCase()?NaN:"-"===e[0]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:stringifyNumber},floatExp={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:e=>parseFloat(e.replace(/_/g,"")),stringify(e){const t=Number(e.value);return isFinite(t)?t.toExponential():stringifyNumber(e)}},float$1={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(e){const t=new Scalar(parseFloat(e.replace(/_/g,""))),r=e.indexOf(".");if(-1!==r){const n=e.substring(r+1).replace(/_/g,"");"0"===n[n.length-1]&&(t.minFractionDigits=n.length)}return t},stringify:stringifyNumber},intIdentify=e=>"bigint"==typeof e||Number.isInteger(e);function intResolve(e,t,r,{intAsBigInt:n}){const i=e[0];if("-"!==i&&"+"!==i||(t+=1),e=e.substring(t).replace(/_/g,""),n){switch(r){case 2:e=`0b${e}`;break;case 8:e=`0o${e}`;break;case 16:e=`0x${e}`}const t=BigInt(e);return"-"===i?BigInt(-1)*t:t}const o=parseInt(e,r);return"-"===i?-1*o:o}function intStringify(e,t,r){const{value:n}=e;if(intIdentify(n)){const e=n.toString(t);return n<0?"-"+r+e.substr(1):r+e}return stringifyNumber(e)}const intBin={identify:intIdentify,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(e,t,r)=>intResolve(e,2,2,r),stringify:e=>intStringify(e,2,"0b")},intOct={identify:intIdentify,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(e,t,r)=>intResolve(e,1,8,r),stringify:e=>intStringify(e,8,"0")},int={identify:intIdentify,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(e,t,r)=>intResolve(e,0,10,r),stringify:stringifyNumber},intHex={identify:intIdentify,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(e,t,r)=>intResolve(e,2,16,r),stringify:e=>intStringify(e,16,"0x")};class YAMLSet extends YAMLMap{constructor(e){super(e),this.tag=YAMLSet.tag}add(e){let t;t=isPair(e)?e:e&&"object"==typeof e&&"key"in e&&"value"in e&&null===e.value?new Pair(e.key,null):new Pair(e,null);findPair(this.items,t.key)||this.items.push(t)}get(e,t){const r=findPair(this.items,e);return!t&&isPair(r)?isScalar$1(r.key)?r.key.value:r.key:r}set(e,t){if("boolean"!=typeof t)throw new Error("Expected boolean value for set(key, value) in a YAML set, not "+typeof t);const r=findPair(this.items,e);r&&!t?this.items.splice(this.items.indexOf(r),1):!r&&t&&this.items.push(new Pair(e))}toJSON(e,t){return super.toJSON(e,t,Set)}toString(e,t,r){if(!e)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},e,{allNullValues:!0}),t,r);throw new Error("Set items must all have null values")}static from(e,t,r){const{replacer:n}=r,i=new this(e);if(t&&Symbol.iterator in Object(t))for(let o of t)"function"==typeof n&&(o=n.call(t,o,o)),i.items.push(createPair(o,null,r));return i}}YAMLSet.tag="tag:yaml.org,2002:set";const set$1={collection:"map",identify:e=>e instanceof Set,nodeClass:YAMLSet,default:!1,tag:"tag:yaml.org,2002:set",createNode:(e,t,r)=>YAMLSet.from(e,t,r),resolve(e,t){if(isMap(e)){if(e.hasAllNullValues(!0))return Object.assign(new YAMLSet,e);t("Set items must all have null values")}else t("Expected a mapping for this tag");return e}};function parseSexagesimal(e,t){const r=e[0],n="-"===r||"+"===r?e.substring(1):e,i=e=>t?BigInt(e):Number(e),o=n.replace(/_/g,"").split(":").reduce((e,t)=>e*i(60)+i(t),i(0));return"-"===r?i(-1)*o:o}function stringifySexagesimal(e){let{value:t}=e,r=e=>e;if("bigint"==typeof t)r=e=>BigInt(e);else if(isNaN(t)||!isFinite(t))return stringifyNumber(e);let n="";t<0&&(n="-",t*=r(-1));const i=r(60),o=[t%i];return t<60?o.unshift(0):(t=(t-o[0])/i,o.unshift(t%i),t>=60&&(t=(t-o[0])/i,o.unshift(t))),n+o.map(e=>String(e).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}const intTime={identify:e=>"bigint"==typeof e||Number.isInteger(e),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(e,t,{intAsBigInt:r})=>parseSexagesimal(e,r),stringify:stringifySexagesimal},floatTime={identify:e=>"number"==typeof e,default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:e=>parseSexagesimal(e,!1),stringify:stringifySexagesimal},timestamp={identify:e=>e instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(e){const t=e.match(timestamp.test);if(!t)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,r,n,i,o,s,a]=t.map(Number),l=t[7]?Number((t[7]+"00").substr(1,3)):0;let c=Date.UTC(r,n-1,i,o||0,s||0,a||0,l);const u=t[8];if(u&&"Z"!==u){let e=parseSexagesimal(u,!1);Math.abs(e)<30&&(e*=60),c-=6e4*e}return new Date(c)},stringify:({value:e})=>(null==e?void 0:e.toISOString().replace(/(T00:00:00)?\.000Z$/,""))??""},schema=[map$1,seq,string$1,nullTag,trueTag,falseTag,intBin,intOct,int,intHex,floatNaN,floatExp,float$1,binary,merge$1,omap,pairs,set$1,intTime,floatTime,timestamp],schemas=new Map([["core",schema$2],["failsafe",[map$1,seq,string$1]],["json",schema$1],["yaml11",schema],["yaml-1.1",schema]]),tagsByName={binary:binary,bool:boolTag,float:float$2,floatExp:floatExp$1,floatNaN:floatNaN$1,floatTime:floatTime,int:int$1,intHex:intHex$1,intOct:intOct$1,intTime:intTime,map:map$1,merge:merge$1,null:nullTag,omap:omap,pairs:pairs,seq:seq,set:set$1,timestamp:timestamp},coreKnownTags={"tag:yaml.org,2002:binary":binary,"tag:yaml.org,2002:merge":merge$1,"tag:yaml.org,2002:omap":omap,"tag:yaml.org,2002:pairs":pairs,"tag:yaml.org,2002:set":set$1,"tag:yaml.org,2002:timestamp":timestamp};function getTags(e,t,r){const n=schemas.get(t);if(n&&!e)return r&&!n.includes(merge$1)?n.concat(merge$1):n.slice();let i=n;if(!i){if(!Array.isArray(e)){const e=Array.from(schemas.keys()).filter(e=>"yaml11"!==e).map(e=>JSON.stringify(e)).join(", ");throw new Error(`Unknown schema "${t}"; use one of ${e} or define customTags array`)}i=[]}if(Array.isArray(e))for(const o of e)i=i.concat(o);else"function"==typeof e&&(i=e(i.slice()));return r&&(i=i.concat(merge$1)),i.reduce((e,t)=>{const r="string"==typeof t?tagsByName[t]:t;if(!r){const e=JSON.stringify(t),r=Object.keys(tagsByName).map(e=>JSON.stringify(e)).join(", ");throw new Error(`Unknown custom tag ${e}; use one of ${r}`)}return e.includes(r)||e.push(r),e},[])}const sortMapEntriesByKey=(e,t)=>e.key<t.key?-1:e.key>t.key?1:0;class Schema{constructor({compat:e,customTags:t,merge:r,resolveKnownTags:n,schema:i,sortMapEntries:o,toStringDefaults:s}){this.compat=Array.isArray(e)?getTags(e,"compat"):e?getTags(null,e):null,this.name="string"==typeof i&&i||"core",this.knownTags=n?coreKnownTags:{},this.tags=getTags(t,this.name,r),this.toStringOptions=s??null,Object.defineProperty(this,MAP,{value:map$1}),Object.defineProperty(this,SCALAR$1,{value:string$1}),Object.defineProperty(this,SEQ,{value:seq}),this.sortMapEntries="function"==typeof o?o:!0===o?sortMapEntriesByKey:null}clone(){const e=Object.create(Schema.prototype,Object.getOwnPropertyDescriptors(this));return e.tags=this.tags.slice(),e}}function stringifyDocument(e,t){var r;const n=[];let i=!0===t.directives;if(!1!==t.directives&&e.directives){const t=e.directives.toString(e);t?(n.push(t),i=!0):e.directives.docStart&&(i=!0)}i&&n.push("---");const o=createStringifyContext(e,t),{commentString:s}=o.options;if(e.commentBefore){1!==n.length&&n.unshift("");const t=s(e.commentBefore);n.unshift(indentComment(t,""))}let a=!1,l=null;if(e.contents){if(isNode(e.contents)){if(e.contents.spaceBefore&&i&&n.push(""),e.contents.commentBefore){const t=s(e.contents.commentBefore);n.push(indentComment(t,""))}o.forceBlockIndent=!!e.comment,l=e.contents.comment}const t=l?void 0:()=>a=!0;let r=stringify$2(e.contents,o,()=>l=null,t);l&&(r+=lineComment(r,"",s(l))),"|"!==r[0]&&">"!==r[0]||"---"!==n[n.length-1]?n.push(r):n[n.length-1]=`--- ${r}`}else n.push(stringify$2(e.contents,o));if(null==(r=e.directives)?void 0:r.docEnd)if(e.comment){const t=s(e.comment);t.includes("\n")?(n.push("..."),n.push(indentComment(t,""))):n.push(`... ${t}`)}else n.push("...");else{let t=e.comment;t&&a&&(t=t.replace(/^\n+/,"")),t&&(a&&!l||""===n[n.length-1]||n.push(""),n.push(indentComment(s(t),"")))}return n.join("\n")+"\n"}class Document{constructor(e,t,r){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,NODE_TYPE,{value:DOC});let n=null;"function"==typeof t||Array.isArray(t)?n=t:void 0===r&&t&&(r=t,t=void 0);const i=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,stringKeys:!1,uniqueKeys:!0,version:"1.2"},r);this.options=i;let{version:o}=i;(null==r?void 0:r._directives)?(this.directives=r._directives.atDocument(),this.directives.yaml.explicit&&(o=this.directives.yaml.version)):this.directives=new Directives({version:o}),this.setSchema(o,r),this.contents=void 0===e?null:this.createNode(e,n,r)}clone(){const e=Object.create(Document.prototype,{[NODE_TYPE]:{value:DOC}});return e.commentBefore=this.commentBefore,e.comment=this.comment,e.errors=this.errors.slice(),e.warnings=this.warnings.slice(),e.options=Object.assign({},this.options),this.directives&&(e.directives=this.directives.clone()),e.schema=this.schema.clone(),e.contents=isNode(this.contents)?this.contents.clone(e.schema):this.contents,this.range&&(e.range=this.range.slice()),e}add(e){assertCollection(this.contents)&&this.contents.add(e)}addIn(e,t){assertCollection(this.contents)&&this.contents.addIn(e,t)}createAlias(e,t){if(!e.anchor){const r=anchorNames(this);e.anchor=!t||r.has(t)?findNewAnchor(t||"a",r):t}return new Alias(e.anchor)}createNode(e,t,r){let n;if("function"==typeof t)e=t.call({"":e},"",e),n=t;else if(Array.isArray(t)){const e=e=>"number"==typeof e||e instanceof String||e instanceof Number,r=t.filter(e).map(String);r.length>0&&(t=t.concat(r)),n=t}else void 0===r&&t&&(r=t,t=void 0);const{aliasDuplicateObjects:i,anchorPrefix:o,flow:s,keepUndefined:a,onTagObj:l,tag:c}=r??{},{onAnchor:u,setAnchors:d,sourceObjects:h}=createNodeAnchors(this,o||"a"),f=createNode(e,c,{aliasDuplicateObjects:i??!0,keepUndefined:a??!1,onAnchor:u,onTagObj:l,replacer:n,schema:this.schema,sourceObjects:h});return s&&isCollection$1(f)&&(f.flow=!0),d(),f}createPair(e,t,r={}){const n=this.createNode(e,null,r),i=this.createNode(t,null,r);return new Pair(n,i)}delete(e){return!!assertCollection(this.contents)&&this.contents.delete(e)}deleteIn(e){return isEmptyPath(e)?null!=this.contents&&(this.contents=null,!0):!!assertCollection(this.contents)&&this.contents.deleteIn(e)}get(e,t){return isCollection$1(this.contents)?this.contents.get(e,t):void 0}getIn(e,t){return isEmptyPath(e)?!t&&isScalar$1(this.contents)?this.contents.value:this.contents:isCollection$1(this.contents)?this.contents.getIn(e,t):void 0}has(e){return!!isCollection$1(this.contents)&&this.contents.has(e)}hasIn(e){return isEmptyPath(e)?void 0!==this.contents:!!isCollection$1(this.contents)&&this.contents.hasIn(e)}set(e,t){null==this.contents?this.contents=collectionFromPath(this.schema,[e],t):assertCollection(this.contents)&&this.contents.set(e,t)}setIn(e,t){isEmptyPath(e)?this.contents=t:null==this.contents?this.contents=collectionFromPath(this.schema,Array.from(e),t):assertCollection(this.contents)&&this.contents.setIn(e,t)}setSchema(e,t={}){let r;switch("number"==typeof e&&(e=String(e)),e){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new Directives({version:"1.1"}),r={resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=e:this.directives=new Directives({version:e}),r={resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,r=null;break;default:{const t=JSON.stringify(e);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${t}`)}}if(t.schema instanceof Object)this.schema=t.schema;else{if(!r)throw new Error("With a null YAML version, the { schema: Schema } option is required");this.schema=new Schema(Object.assign(r,t))}}toJS({json:e,jsonArg:t,mapAsMap:r,maxAliasCount:n,onAnchor:i,reviver:o}={}){const s={anchors:new Map,doc:this,keep:!e,mapAsMap:!0===r,mapKeyWarned:!1,maxAliasCount:"number"==typeof n?n:100},a=toJS(this.contents,t??"",s);if("function"==typeof i)for(const{count:l,res:c}of s.anchors.values())i(c,l);return"function"==typeof o?applyReviver(o,{"":a},"",a):a}toJSON(e,t){return this.toJS({json:!0,jsonArg:e,mapAsMap:!1,onAnchor:t})}toString(e={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in e&&(!Number.isInteger(e.indent)||Number(e.indent)<=0)){const t=JSON.stringify(e.indent);throw new Error(`"indent" option must be a positive integer, not ${t}`)}return stringifyDocument(this,e)}}function assertCollection(e){if(isCollection$1(e))return!0;throw new Error("Expected a YAML collection as document contents")}class YAMLError extends Error{constructor(e,t,r,n){super(),this.name=e,this.code=r,this.message=n,this.pos=t}}class YAMLParseError extends YAMLError{constructor(e,t,r){super("YAMLParseError",e,t,r)}}class YAMLWarning extends YAMLError{constructor(e,t,r){super("YAMLWarning",e,t,r)}}const prettifyError=(e,t)=>r=>{if(-1===r.pos[0])return;r.linePos=r.pos.map(e=>t.linePos(e));const{line:n,col:i}=r.linePos[0];r.message+=` at line ${n}, column ${i}`;let o=i-1,s=e.substring(t.lineStarts[n-1],t.lineStarts[n]).replace(/[\n\r]+$/,"");if(o>=60&&s.length>80){const e=Math.min(o-39,s.length-79);s="…"+s.substring(e),o-=e-1}if(s.length>80&&(s=s.substring(0,79)+"…"),n>1&&/^ *$/.test(s.substring(0,o))){let r=e.substring(t.lineStarts[n-2],t.lineStarts[n-1]);r.length>80&&(r=r.substring(0,79)+"…\n"),s=r+s}if(/[^ ]/.test(s)){let e=1;const t=r.linePos[1];t&&t.line===n&&t.col>i&&(e=Math.max(1,Math.min(t.col-i,80-o)));const a=" ".repeat(o)+"^".repeat(e);r.message+=`:\n\n${s}\n${a}\n`}};function resolveProps(e,{flow:t,indicator:r,next:n,offset:i,onError:o,parentIndent:s,startOnNewline:a}){let l=!1,c=a,u=a,d="",h="",f=!1,p=!1,y=null,g=null,m=null,b=null,w=null,v=null,k=null;for(const S of e)switch(p&&("space"!==S.type&&"newline"!==S.type&&"comma"!==S.type&&o(S.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),p=!1),y&&(c&&"comment"!==S.type&&"newline"!==S.type&&o(y,"TAB_AS_INDENT","Tabs are not allowed as indentation"),y=null),S.type){case"space":t||"doc-start"===r&&"flow-collection"===(null==n?void 0:n.type)||!S.source.includes("\t")||(y=S),u=!0;break;case"comment":{u||o(S,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const e=S.source.substring(1)||" ";d?d+=h+e:d=e,h="",c=!1;break}case"newline":c?d?d+=S.source:v&&"seq-item-ind"===r||(l=!0):h+=S.source,c=!0,f=!0,(g||m)&&(b=S),u=!0;break;case"anchor":g&&o(S,"MULTIPLE_ANCHORS","A node can have at most one anchor"),S.source.endsWith(":")&&o(S.offset+S.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),g=S,k??(k=S.offset),c=!1,u=!1,p=!0;break;case"tag":m&&o(S,"MULTIPLE_TAGS","A node can have at most one tag"),m=S,k??(k=S.offset),c=!1,u=!1,p=!0;break;case r:(g||m)&&o(S,"BAD_PROP_ORDER",`Anchors and tags must be after the ${S.source} indicator`),v&&o(S,"UNEXPECTED_TOKEN",`Unexpected ${S.source} in ${t??"collection"}`),v=S,c="seq-item-ind"===r||"explicit-key-ind"===r,u=!1;break;case"comma":if(t){w&&o(S,"UNEXPECTED_TOKEN",`Unexpected , in ${t}`),w=S,c=!1,u=!1;break}default:o(S,"UNEXPECTED_TOKEN",`Unexpected ${S.type} token`),c=!1,u=!1}const _=e[e.length-1],E=_?_.offset+_.source.length:i;return p&&n&&"space"!==n.type&&"newline"!==n.type&&"comma"!==n.type&&("scalar"!==n.type||""!==n.source)&&o(n.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),y&&(c&&y.indent<=s||"block-map"===(null==n?void 0:n.type)||"block-seq"===(null==n?void 0:n.type))&&o(y,"TAB_AS_INDENT","Tabs are not allowed as indentation"),{comma:w,found:v,spaceBefore:l,comment:d,hasNewline:f,anchor:g,tag:m,newlineAfterProp:b,end:E,start:k??E}}function containsNewline(e){if(!e)return null;switch(e.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(e.source.includes("\n"))return!0;if(e.end)for(const t of e.end)if("newline"===t.type)return!0;return!1;case"flow-collection":for(const t of e.items){for(const e of t.start)if("newline"===e.type)return!0;if(t.sep)for(const e of t.sep)if("newline"===e.type)return!0;if(containsNewline(t.key)||containsNewline(t.value))return!0}return!1;default:return!0}}function flowIndentCheck(e,t,r){if("flow-collection"===(null==t?void 0:t.type)){const n=t.end[0];if(n.indent===e&&("]"===n.source||"}"===n.source)&&containsNewline(t)){r(n,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}}function mapIncludes(e,t,r){const{uniqueKeys:n}=e.options;if(!1===n)return!1;const i="function"==typeof n?n:(e,t)=>e===t||isScalar$1(e)&&isScalar$1(t)&&e.value===t.value;return t.some(e=>i(e.key,r))}const startColMsg="All mapping items must start at the same column";function resolveBlockMap({composeNode:e,composeEmptyNode:t},r,n,i,o){var s;const a=new((null==o?void 0:o.nodeClass)??YAMLMap)(r.schema);r.atRoot&&(r.atRoot=!1);let l=n.offset,c=null;for(const u of n.items){const{start:o,key:d,sep:h,value:f}=u,p=resolveProps(o,{indicator:"explicit-key-ind",next:d??(null==h?void 0:h[0]),offset:l,onError:i,parentIndent:n.indent,startOnNewline:!0}),y=!p.found;if(y){if(d&&("block-seq"===d.type?i(l,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in d&&d.indent!==n.indent&&i(l,"BAD_INDENT",startColMsg)),!p.anchor&&!p.tag&&!h){c=p.end,p.comment&&(a.comment?a.comment+="\n"+p.comment:a.comment=p.comment);continue}(p.newlineAfterProp||containsNewline(d))&&i(d??o[o.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else(null==(s=p.found)?void 0:s.indent)!==n.indent&&i(l,"BAD_INDENT",startColMsg);r.atKey=!0;const g=p.end,m=d?e(r,d,p,i):t(r,g,o,null,p,i);r.schema.compat&&flowIndentCheck(n.indent,d,i),r.atKey=!1,mapIncludes(r,a.items,m)&&i(g,"DUPLICATE_KEY","Map keys must be unique");const b=resolveProps(h??[],{indicator:"map-value-ind",next:f,offset:m.range[2],onError:i,parentIndent:n.indent,startOnNewline:!d||"block-scalar"===d.type});if(l=b.end,b.found){y&&("block-map"!==(null==f?void 0:f.type)||b.hasNewline||i(l,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),r.options.strict&&p.start<b.found.offset-1024&&i(m.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));const o=f?e(r,f,b,i):t(r,l,h,null,b,i);r.schema.compat&&flowIndentCheck(n.indent,f,i),l=o.range[2];const s=new Pair(m,o);r.options.keepSourceTokens&&(s.srcToken=u),a.items.push(s)}else{y&&i(m.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),b.comment&&(m.comment?m.comment+="\n"+b.comment:m.comment=b.comment);const e=new Pair(m);r.options.keepSourceTokens&&(e.srcToken=u),a.items.push(e)}}return c&&c<l&&i(c,"IMPOSSIBLE","Map comment with trailing content"),a.range=[n.offset,l,c??l],a}function resolveBlockSeq({composeNode:e,composeEmptyNode:t},r,n,i,o){const s=new((null==o?void 0:o.nodeClass)??YAMLSeq)(r.schema);r.atRoot&&(r.atRoot=!1),r.atKey&&(r.atKey=!1);let a=n.offset,l=null;for(const{start:c,value:u}of n.items){const o=resolveProps(c,{indicator:"seq-item-ind",next:u,offset:a,onError:i,parentIndent:n.indent,startOnNewline:!0});if(!o.found){if(!(o.anchor||o.tag||u)){l=o.end,o.comment&&(s.comment=o.comment);continue}u&&"block-seq"===u.type?i(o.end,"BAD_INDENT","All sequence items must start at the same column"):i(a,"MISSING_CHAR","Sequence item without - indicator")}const d=u?e(r,u,o,i):t(r,o.end,c,null,o,i);r.schema.compat&&flowIndentCheck(n.indent,u,i),a=d.range[2],s.items.push(d)}return s.range=[n.offset,a,l??a],s}function resolveEnd(e,t,r,n){let i="";if(e){let o=!1,s="";for(const a of e){const{source:e,type:l}=a;switch(l){case"space":o=!0;break;case"comment":{r&&!o&&n(a,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const t=e.substring(1)||" ";i?i+=s+t:i=t,s="";break}case"newline":i&&(s+=e),o=!0;break;default:n(a,"UNEXPECTED_TOKEN",`Unexpected ${l} at node end`)}t+=e.length}}return{comment:i,offset:t}}const blockMsg="Block collections are not allowed within flow collections",isBlock=e=>e&&("block-map"===e.type||"block-seq"===e.type);function resolveFlowCollection({composeNode:e,composeEmptyNode:t},r,n,i,o){const s="{"===n.start.source,a=s?"flow map":"flow sequence",l=new((null==o?void 0:o.nodeClass)??(s?YAMLMap:YAMLSeq))(r.schema);l.flow=!0;const c=r.atRoot;c&&(r.atRoot=!1),r.atKey&&(r.atKey=!1);let u=n.offset+n.start.source.length;for(let y=0;y<n.items.length;++y){const o=n.items[y],{start:c,key:d,sep:h,value:f}=o,p=resolveProps(c,{flow:a,indicator:"explicit-key-ind",next:d??(null==h?void 0:h[0]),offset:u,onError:i,parentIndent:n.indent,startOnNewline:!1});if(!p.found){if(!(p.anchor||p.tag||h||f)){0===y&&p.comma?i(p.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${a}`):y<n.items.length-1&&i(p.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${a}`),p.comment&&(l.comment?l.comment+="\n"+p.comment:l.comment=p.comment),u=p.end;continue}!s&&r.options.strict&&containsNewline(d)&&i(d,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(0===y)p.comma&&i(p.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${a}`);else if(p.comma||i(p.start,"MISSING_CHAR",`Missing , between ${a} items`),p.comment){let e="";e:for(const t of c)switch(t.type){case"comma":case"space":break;case"comment":e=t.source.substring(1);break e;default:break e}if(e){let t=l.items[l.items.length-1];isPair(t)&&(t=t.value??t.key),t.comment?t.comment+="\n"+e:t.comment=e,p.comment=p.comment.substring(e.length+1)}}if(s||h||p.found){r.atKey=!0;const y=p.end,g=d?e(r,d,p,i):t(r,y,c,null,p,i);isBlock(d)&&i(g.range,"BLOCK_IN_FLOW",blockMsg),r.atKey=!1;const m=resolveProps(h??[],{flow:a,indicator:"map-value-ind",next:f,offset:g.range[2],onError:i,parentIndent:n.indent,startOnNewline:!1});if(m.found){if(!s&&!p.found&&r.options.strict){if(h)for(const e of h){if(e===m.found)break;if("newline"===e.type){i(e,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}p.start<m.found.offset-1024&&i(m.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else f&&("source"in f&&f.source&&":"===f.source[0]?i(f,"MISSING_CHAR",`Missing space after : in ${a}`):i(m.start,"MISSING_CHAR",`Missing , or : between ${a} items`));const b=f?e(r,f,m,i):m.found?t(r,m.end,h,null,m,i):null;b?isBlock(f)&&i(b.range,"BLOCK_IN_FLOW",blockMsg):m.comment&&(g.comment?g.comment+="\n"+m.comment:g.comment=m.comment);const w=new Pair(g,b);if(r.options.keepSourceTokens&&(w.srcToken=o),s){const e=l;mapIncludes(r,e.items,g)&&i(y,"DUPLICATE_KEY","Map keys must be unique"),e.items.push(w)}else{const e=new YAMLMap(r.schema);e.flow=!0,e.items.push(w);const t=(b??g).range;e.range=[g.range[0],t[1],t[2]],l.items.push(e)}u=b?b.range[2]:m.end}else{const n=f?e(r,f,p,i):t(r,p.end,h,null,p,i);l.items.push(n),u=n.range[2],isBlock(f)&&i(n.range,"BLOCK_IN_FLOW",blockMsg)}}const d=s?"}":"]",[h,...f]=n.end;let p=u;if(h&&h.source===d)p=h.offset+h.source.length;else{const e=a[0].toUpperCase()+a.substring(1);i(u,c?"MISSING_CHAR":"BAD_INDENT",c?`${e} must end with a ${d}`:`${e} in block collection must be sufficiently indented and end with a ${d}`),h&&1!==h.source.length&&f.unshift(h)}if(f.length>0){const e=resolveEnd(f,p,r.options.strict,i);e.comment&&(l.comment?l.comment+="\n"+e.comment:l.comment=e.comment),l.range=[n.offset,p,e.offset]}else l.range=[n.offset,p,p];return l}function resolveCollection(e,t,r,n,i,o){const s="block-map"===r.type?resolveBlockMap(e,t,r,n,o):"block-seq"===r.type?resolveBlockSeq(e,t,r,n,o):resolveFlowCollection(e,t,r,n,o),a=s.constructor;return"!"===i||i===a.tagName?(s.tag=a.tagName,s):(i&&(s.tag=i),s)}function composeCollection(e,t,r,n,i){var o;const s=n.tag,a=s?t.directives.tagName(s.source,e=>i(s,"TAG_RESOLVE_FAILED",e)):null;if("block-seq"===r.type){const{anchor:e,newlineAfterProp:t}=n,r=e&&s?e.offset>s.offset?e:s:e??s;if(r&&(!t||t.offset<r.offset)){i(r,"MISSING_CHAR","Missing newline after block sequence props")}}const l="block-map"===r.type?"map":"block-seq"===r.type?"seq":"{"===r.start.source?"map":"seq";if(!s||!a||"!"===a||a===YAMLMap.tagName&&"map"===l||a===YAMLSeq.tagName&&"seq"===l)return resolveCollection(e,t,r,i,a);let c=t.schema.tags.find(e=>e.tag===a&&e.collection===l);if(!c){const n=t.schema.knownTags[a];if(!n||n.collection!==l)return n?i(s,"BAD_COLLECTION_TYPE",`${n.tag} used for ${l} collection, but expects ${n.collection??"scalar"}`,!0):i(s,"TAG_RESOLVE_FAILED",`Unresolved tag: ${a}`,!0),resolveCollection(e,t,r,i,a);t.schema.tags.push(Object.assign({},n,{default:!1})),c=n}const u=resolveCollection(e,t,r,i,a,c),d=(null==(o=c.resolve)?void 0:o.call(c,u,e=>i(s,"TAG_RESOLVE_FAILED",e),t.options))??u,h=isNode(d)?d:new Scalar(d);return h.range=u.range,h.tag=a,(null==c?void 0:c.format)&&(h.format=c.format),h}function resolveBlockScalar(e,t,r){const n=t.offset,i=parseBlockScalarHeader(t,e.options.strict,r);if(!i)return{value:"",type:null,comment:"",range:[n,n,n]};const o=">"===i.mode?Scalar.BLOCK_FOLDED:Scalar.BLOCK_LITERAL,s=t.source?splitLines(t.source):[];let a=s.length;for(let y=s.length-1;y>=0;--y){const e=s[y][1];if(""!==e&&"\r"!==e)break;a=y}if(0===a){const e="+"===i.chomp&&s.length>0?"\n".repeat(Math.max(1,s.length-1)):"";let r=n+i.length;return t.source&&(r+=t.source.length),{value:e,type:o,comment:i.comment,range:[n,r,r]}}let l=t.indent+i.indent,c=t.offset+i.length,u=0;for(let y=0;y<a;++y){const[t,n]=s[y];if(""!==n&&"\r"!==n){if(t.length<l){const e="Block scalars with more-indented leading empty lines must use an explicit indentation indicator";r(c+t.length,"MISSING_CHAR",e)}if(0===i.indent&&(l=t.length),u=y,0===l&&!e.atRoot){r(c,"BAD_INDENT","Block scalar values in collections must be indented")}break}0===i.indent&&t.length>l&&(l=t.length),c+=t.length+n.length+1}for(let y=s.length-1;y>=a;--y)s[y][0].length>l&&(a=y+1);let d="",h="",f=!1;for(let y=0;y<u;++y)d+=s[y][0].slice(l)+"\n";for(let y=u;y<a;++y){let[e,t]=s[y];c+=e.length+t.length+1;const n="\r"===t[t.length-1];if(n&&(t=t.slice(0,-1)),t&&e.length<l){const o=`Block scalar lines must not be less indented than their ${i.indent?"explicit indentation indicator":"first line"}`;r(c-t.length-(n?2:1),"BAD_INDENT",o),e=""}o===Scalar.BLOCK_LITERAL?(d+=h+e.slice(l)+t,h="\n"):e.length>l||"\t"===t[0]?(" "===h?h="\n":f||"\n"!==h||(h="\n\n"),d+=h+e.slice(l)+t,h="\n",f=!0):""===t?"\n"===h?d+="\n":h="\n":(d+=h+t,h=" ",f=!1)}switch(i.chomp){case"-":break;case"+":for(let e=a;e<s.length;++e)d+="\n"+s[e][0].slice(l);"\n"!==d[d.length-1]&&(d+="\n");break;default:d+="\n"}const p=n+i.length+t.source.length;return{value:d,type:o,comment:i.comment,range:[n,p,p]}}function parseBlockScalarHeader({offset:e,props:t},r,n){if("block-scalar-header"!==t[0].type)return n(t[0],"IMPOSSIBLE","Block scalar header not found"),null;const{source:i}=t[0],o=i[0];let s=0,a="",l=-1;for(let h=1;h<i.length;++h){const t=i[h];if(a||"-"!==t&&"+"!==t){const r=Number(t);!s&&r?s=r:-1===l&&(l=e+h)}else a=t}-1!==l&&n(l,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${i}`);let c=!1,u="",d=i.length;for(let h=1;h<t.length;++h){const e=t[h];switch(e.type){case"space":c=!0;case"newline":d+=e.source.length;break;case"comment":if(r&&!c){n(e,"MISSING_CHAR","Comments must be separated from other tokens by white space characters")}d+=e.source.length,u=e.source.substring(1);break;case"error":n(e,"UNEXPECTED_TOKEN",e.message),d+=e.source.length;break;default:{n(e,"UNEXPECTED_TOKEN",`Unexpected token in block scalar header: ${e.type}`);const t=e.source;t&&"string"==typeof t&&(d+=t.length)}}}return{mode:o,indent:s,chomp:a,comment:u,length:d}}function splitLines(e){const t=e.split(/\n( *)/),r=t[0],n=r.match(/^( *)/),i=[(null==n?void 0:n[1])?[n[1],r.slice(n[1].length)]:["",r]];for(let o=1;o<t.length;o+=2)i.push([t[o],t[o+1]]);return i}function resolveFlowScalar(e,t,r){const{offset:n,type:i,source:o,end:s}=e;let a,l;const c=(e,t,i)=>r(n+e,t,i);switch(i){case"scalar":a=Scalar.PLAIN,l=plainValue(o,c);break;case"single-quoted-scalar":a=Scalar.QUOTE_SINGLE,l=singleQuotedValue(o,c);break;case"double-quoted-scalar":a=Scalar.QUOTE_DOUBLE,l=doubleQuotedValue(o,c);break;default:return r(e,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${i}`),{value:"",type:null,comment:"",range:[n,n+o.length,n+o.length]}}const u=n+o.length,d=resolveEnd(s,u,t,r);return{value:l,type:a,comment:d.comment,range:[n,u,d.offset]}}function plainValue(e,t){let r="";switch(e[0]){case"\t":r="a tab character";break;case",":r="flow indicator character ,";break;case"%":r="directive indicator character %";break;case"|":case">":r=`block scalar indicator ${e[0]}`;break;case"@":case"`":r=`reserved character ${e[0]}`}return r&&t(0,"BAD_SCALAR_START",`Plain value cannot start with ${r}`),foldLines(e)}function singleQuotedValue(e,t){return"'"===e[e.length-1]&&1!==e.length||t(e.length,"MISSING_CHAR","Missing closing 'quote"),foldLines(e.slice(1,-1)).replace(/''/g,"'")}function foldLines(e){let t,r;try{t=new RegExp("(.*?)(?<![ \t])[ \t]*\r?\n","sy"),r=new RegExp("[ \t]*(.*?)(?:(?<![ \t])[ \t]*)?\r?\n","sy")}catch{t=/(.*?)[ \t]*\r?\n/sy,r=/[ \t]*(.*?)[ \t]*\r?\n/sy}let n=t.exec(e);if(!n)return e;let i=n[1],o=" ",s=t.lastIndex;for(r.lastIndex=s;n=r.exec(e);)""===n[1]?"\n"===o?i+=o:o="\n":(i+=o+n[1],o=" "),s=r.lastIndex;const a=/[ \t]*(.*)/sy;return a.lastIndex=s,n=a.exec(e),i+o+((null==n?void 0:n[1])??"")}function doubleQuotedValue(e,t){let r="";for(let n=1;n<e.length-1;++n){const i=e[n];if("\r"!==i||"\n"!==e[n+1])if("\n"===i){const{fold:t,offset:i}=foldNewline(e,n);r+=t,n=i}else if("\\"===i){let i=e[++n];const o=escapeCodes[i];if(o)r+=o;else if("\n"===i)for(i=e[n+1];" "===i||"\t"===i;)i=e[1+ ++n];else if("\r"===i&&"\n"===e[n+1])for(i=e[1+ ++n];" "===i||"\t"===i;)i=e[1+ ++n];else if("x"===i||"u"===i||"U"===i){const o={x:2,u:4,U:8}[i];r+=parseCharCode(e,n+1,o,t),n+=o}else{const i=e.substr(n-1,2);t(n-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${i}`),r+=i}}else if(" "===i||"\t"===i){const t=n;let o=e[n+1];for(;" "===o||"\t"===o;)o=e[1+ ++n];"\n"===o||"\r"===o&&"\n"===e[n+2]||(r+=n>t?e.slice(t,n+1):i)}else r+=i}return'"'===e[e.length-1]&&1!==e.length||t(e.length,"MISSING_CHAR",'Missing closing "quote'),r}function foldNewline(e,t){let r="",n=e[t+1];for(;!(" "!==n&&"\t"!==n&&"\n"!==n&&"\r"!==n||"\r"===n&&"\n"!==e[t+2]);)"\n"===n&&(r+="\n"),n=e[(t+=1)+1];return r||(r=" "),{fold:r,offset:t}}const escapeCodes={0:"\0",a:"",b:"\b",e:"",f:"\f",n:"\n",r:"\r",t:"\t",v:"\v",N:"",_:" ",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","\t":"\t"};function parseCharCode(e,t,r,n){const i=e.substr(t,r),o=i.length===r&&/^[0-9a-fA-F]+$/.test(i)?parseInt(i,16):NaN;if(isNaN(o)){const i=e.substr(t-2,r+2);return n(t-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${i}`),i}return String.fromCodePoint(o)}function composeScalar(e,t,r,n){const{value:i,type:o,comment:s,range:a}="block-scalar"===t.type?resolveBlockScalar(e,t,n):resolveFlowScalar(t,e.options.strict,n),l=r?e.directives.tagName(r.source,e=>n(r,"TAG_RESOLVE_FAILED",e)):null;let c,u;c=e.options.stringKeys&&e.atKey?e.schema[SCALAR$1]:l?findScalarTagByName(e.schema,i,l,r,n):"scalar"===t.type?findScalarTagByTest(e,i,t,n):e.schema[SCALAR$1];try{const o=c.resolve(i,e=>n(r??t,"TAG_RESOLVE_FAILED",e),e.options);u=isScalar$1(o)?o:new Scalar(o)}catch(d){const e=d instanceof Error?d.message:String(d);n(r??t,"TAG_RESOLVE_FAILED",e),u=new Scalar(i)}return u.range=a,u.source=i,o&&(u.type=o),l&&(u.tag=l),c.format&&(u.format=c.format),s&&(u.comment=s),u}function findScalarTagByName(e,t,r,n,i){var o;if("!"===r)return e[SCALAR$1];const s=[];for(const l of e.tags)if(!l.collection&&l.tag===r){if(!l.default||!l.test)return l;s.push(l)}for(const l of s)if(null==(o=l.test)?void 0:o.test(t))return l;const a=e.knownTags[r];return a&&!a.collection?(e.tags.push(Object.assign({},a,{default:!1,test:void 0})),a):(i(n,"TAG_RESOLVE_FAILED",`Unresolved tag: ${r}`,"tag:yaml.org,2002:str"!==r),e[SCALAR$1])}function findScalarTagByTest({atKey:e,directives:t,schema:r},n,i,o){const s=r.tags.find(t=>{var r;return(!0===t.default||e&&"key"===t.default)&&(null==(r=t.test)?void 0:r.test(n))})||r[SCALAR$1];if(r.compat){const e=r.compat.find(e=>{var t;return e.default&&(null==(t=e.test)?void 0:t.test(n))})??r[SCALAR$1];if(s.tag!==e.tag){o(i,"TAG_RESOLVE_FAILED",`Value may be parsed as either ${t.tagString(s.tag)} or ${t.tagString(e.tag)}`,!0)}}return s}function emptyScalarPosition(e,t,r){if(t){r??(r=t.length);for(let n=r-1;n>=0;--n){let r=t[n];switch(r.type){case"space":case"comment":case"newline":e-=r.source.length;continue}for(r=t[++n];"space"===(null==r?void 0:r.type);)e+=r.source.length,r=t[++n];break}}return e}const CN={composeNode:composeNode,composeEmptyNode:composeEmptyNode};function composeNode(e,t,r,n){const i=e.atKey,{spaceBefore:o,comment:s,anchor:a,tag:l}=r;let c,u=!0;switch(t.type){case"alias":c=composeAlias(e,t,n),(a||l)&&n(t,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":c=composeScalar(e,t,l,n),a&&(c.anchor=a.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":c=composeCollection(CN,e,t,r,n),a&&(c.anchor=a.source.substring(1));break;default:n(t,"UNEXPECTED_TOKEN","error"===t.type?t.message:`Unsupported token (type: ${t.type})`),c=composeEmptyNode(e,t.offset,void 0,null,r,n),u=!1}if(a&&""===c.anchor&&n(a,"BAD_ALIAS","Anchor cannot be an empty string"),i&&e.options.stringKeys&&(!isScalar$1(c)||"string"!=typeof c.value||c.tag&&"tag:yaml.org,2002:str"!==c.tag)){n(l??t,"NON_STRING_KEY","With stringKeys, all keys must be strings")}return o&&(c.spaceBefore=!0),s&&("scalar"===t.type&&""===t.source?c.comment=s:c.commentBefore=s),e.options.keepSourceTokens&&u&&(c.srcToken=t),c}function composeEmptyNode(e,t,r,n,{spaceBefore:i,comment:o,anchor:s,tag:a,end:l},c){const u=composeScalar(e,{type:"scalar",offset:emptyScalarPosition(t,r,n),indent:-1,source:""},a,c);return s&&(u.anchor=s.source.substring(1),""===u.anchor&&c(s,"BAD_ALIAS","Anchor cannot be an empty string")),i&&(u.spaceBefore=!0),o&&(u.comment=o,u.range[2]=l),u}function composeAlias({options:e},{offset:t,source:r,end:n},i){const o=new Alias(r.substring(1));""===o.source&&i(t,"BAD_ALIAS","Alias cannot be an empty string"),o.source.endsWith(":")&&i(t+r.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);const s=t+r.length,a=resolveEnd(n,s,e.strict,i);return o.range=[t,s,a.offset],a.comment&&(o.comment=a.comment),o}function composeDoc(e,t,{offset:r,start:n,value:i,end:o},s){const a=Object.assign({_directives:t},e),l=new Document(void 0,a),c={atKey:!1,atRoot:!0,directives:l.directives,options:l.options,schema:l.schema},u=resolveProps(n,{indicator:"doc-start",next:i??(null==o?void 0:o[0]),offset:r,onError:s,parentIndent:0,startOnNewline:!0});u.found&&(l.directives.docStart=!0,!i||"block-map"!==i.type&&"block-seq"!==i.type||u.hasNewline||s(u.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),l.contents=i?composeNode(c,i,u,s):composeEmptyNode(c,u.end,n,null,u,s);const d=l.contents.range[2],h=resolveEnd(o,d,!1,s);return h.comment&&(l.comment=h.comment),l.range=[r,d,h.offset],l}function getErrorPos(e){if("number"==typeof e)return[e,e+1];if(Array.isArray(e))return 2===e.length?e:[e[0],e[1]];const{offset:t,source:r}=e;return[t,t+("string"==typeof r?r.length:1)]}function parsePrelude(e){var t;let r="",n=!1,i=!1;for(let o=0;o<e.length;++o){const s=e[o];switch(s[0]){case"#":r+=(""===r?"":i?"\n\n":"\n")+(s.substring(1)||" "),n=!0,i=!1;break;case"%":"#"!==(null==(t=e[o+1])?void 0:t[0])&&(o+=1),n=!1;break;default:n||(i=!0),n=!1}}return{comment:r,afterEmptyLine:i}}class Composer{constructor(e={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(e,t,r,n)=>{const i=getErrorPos(e);n?this.warnings.push(new YAMLWarning(i,t,r)):this.errors.push(new YAMLParseError(i,t,r))},this.directives=new Directives({version:e.version||"1.2"}),this.options=e}decorate(e,t){const{comment:r,afterEmptyLine:n}=parsePrelude(this.prelude);if(r){const i=e.contents;if(t)e.comment=e.comment?`${e.comment}\n${r}`:r;else if(n||e.directives.docStart||!i)e.commentBefore=r;else if(isCollection$1(i)&&!i.flow&&i.items.length>0){let e=i.items[0];isPair(e)&&(e=e.key);const t=e.commentBefore;e.commentBefore=t?`${r}\n${t}`:r}else{const e=i.commentBefore;i.commentBefore=e?`${r}\n${e}`:r}}t?(Array.prototype.push.apply(e.errors,this.errors),Array.prototype.push.apply(e.warnings,this.warnings)):(e.errors=this.errors,e.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:parsePrelude(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(e,t=!1,r=-1){for(const n of e)yield*this.next(n);yield*this.end(t,r)}*next(e){switch(e.type){case"directive":this.directives.add(e.source,(t,r,n)=>{const i=getErrorPos(e);i[0]+=t,this.onError(i,"BAD_DIRECTIVE",r,n)}),this.prelude.push(e.source),this.atDirectives=!0;break;case"document":{const t=composeDoc(this.options,this.directives,e,this.onError);this.atDirectives&&!t.directives.docStart&&this.onError(e,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(t,!1),this.doc&&(yield this.doc),this.doc=t,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(e.source);break;case"error":{const t=e.source?`${e.message}: ${JSON.stringify(e.source)}`:e.message,r=new YAMLParseError(getErrorPos(e),"UNEXPECTED_TOKEN",t);this.atDirectives||!this.doc?this.errors.push(r):this.doc.errors.push(r);break}case"doc-end":{if(!this.doc){const t="Unexpected doc-end without preceding document";this.errors.push(new YAMLParseError(getErrorPos(e),"UNEXPECTED_TOKEN",t));break}this.doc.directives.docEnd=!0;const t=resolveEnd(e.end,e.offset+e.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),t.comment){const e=this.doc.comment;this.doc.comment=e?`${e}\n${t.comment}`:t.comment}this.doc.range[2]=t.offset;break}default:this.errors.push(new YAMLParseError(getErrorPos(e),"UNEXPECTED_TOKEN",`Unsupported token ${e.type}`))}}*end(e=!1,t=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(e){const e=Object.assign({_directives:this.directives},this.options),r=new Document(void 0,e);this.atDirectives&&this.onError(t,"MISSING_CHAR","Missing directives-end indicator line"),r.range=[0,t,t],this.decorate(r,!1),yield r}}}function resolveAsScalar(e,t=!0,r){if(e){const n=(e,t,n)=>{const i="number"==typeof e?e:Array.isArray(e)?e[0]:e.offset;if(!r)throw new YAMLParseError([i,i+1],t,n);r(i,t,n)};switch(e.type){case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return resolveFlowScalar(e,t,n);case"block-scalar":return resolveBlockScalar({options:{strict:t}},e,n)}}return null}function createScalarToken(e,t){const{implicitKey:r=!1,indent:n,inFlow:i=!1,offset:o=-1,type:s="PLAIN"}=t,a=stringifyString({type:s,value:e},{implicitKey:r,indent:n>0?" ".repeat(n):"",inFlow:i,options:{blockQuote:!0,lineWidth:-1}}),l=t.end??[{type:"newline",offset:-1,indent:n,source:"\n"}];switch(a[0]){case"|":case">":{const e=a.indexOf("\n"),t=a.substring(0,e),r=a.substring(e+1)+"\n",i=[{type:"block-scalar-header",offset:o,indent:n,source:t}];return addEndtoBlockProps(i,l)||i.push({type:"newline",offset:-1,indent:n,source:"\n"}),{type:"block-scalar",offset:o,indent:n,props:i,source:r}}case'"':return{type:"double-quoted-scalar",offset:o,indent:n,source:a,end:l};case"'":return{type:"single-quoted-scalar",offset:o,indent:n,source:a,end:l};default:return{type:"scalar",offset:o,indent:n,source:a,end:l}}}function setScalarValue(e,t,r={}){let{afterKey:n=!1,implicitKey:i=!1,inFlow:o=!1,type:s}=r,a="indent"in e?e.indent:null;if(n&&"number"==typeof a&&(a+=2),!s)switch(e.type){case"single-quoted-scalar":s="QUOTE_SINGLE";break;case"double-quoted-scalar":s="QUOTE_DOUBLE";break;case"block-scalar":{const t=e.props[0];if("block-scalar-header"!==t.type)throw new Error("Invalid block scalar header");s=">"===t.source[0]?"BLOCK_FOLDED":"BLOCK_LITERAL";break}default:s="PLAIN"}const l=stringifyString({type:s,value:t},{implicitKey:i||null===a,indent:null!==a&&a>0?" ".repeat(a):"",inFlow:o,options:{blockQuote:!0,lineWidth:-1}});switch(l[0]){case"|":case">":setBlockScalarValue(e,l);break;case'"':setFlowScalarValue(e,l,"double-quoted-scalar");break;case"'":setFlowScalarValue(e,l,"single-quoted-scalar");break;default:setFlowScalarValue(e,l,"scalar")}}function setBlockScalarValue(e,t){const r=t.indexOf("\n"),n=t.substring(0,r),i=t.substring(r+1)+"\n";if("block-scalar"===e.type){const t=e.props[0];if("block-scalar-header"!==t.type)throw new Error("Invalid block scalar header");t.source=n,e.source=i}else{const{offset:t}=e,r="indent"in e?e.indent:-1,o=[{type:"block-scalar-header",offset:t,indent:r,source:n}];addEndtoBlockProps(o,"end"in e?e.end:void 0)||o.push({type:"newline",offset:-1,indent:r,source:"\n"});for(const n of Object.keys(e))"type"!==n&&"offset"!==n&&delete e[n];Object.assign(e,{type:"block-scalar",indent:r,props:o,source:i})}}function addEndtoBlockProps(e,t){if(t)for(const r of t)switch(r.type){case"space":case"comment":e.push(r);break;case"newline":return e.push(r),!0}return!1}function setFlowScalarValue(e,t,r){switch(e.type){case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":e.type=r,e.source=t;break;case"block-scalar":{const n=e.props.slice(1);let i=t.length;"block-scalar-header"===e.props[0].type&&(i-=e.props[0].source.length);for(const e of n)e.offset+=i;delete e.props,Object.assign(e,{type:r,source:t,end:n});break}case"block-map":case"block-seq":{const n={type:"newline",offset:e.offset+t.length,indent:e.indent,source:"\n"};delete e.items,Object.assign(e,{type:r,source:t,end:[n]});break}default:{const n="indent"in e?e.indent:-1,i="end"in e&&Array.isArray(e.end)?e.end.filter(e=>"space"===e.type||"comment"===e.type||"newline"===e.type):[];for(const t of Object.keys(e))"type"!==t&&"offset"!==t&&delete e[t];Object.assign(e,{type:r,indent:n,source:t,end:i})}}}const stringify$1=e=>"type"in e?stringifyToken(e):stringifyItem(e);function stringifyToken(e){switch(e.type){case"block-scalar":{let t="";for(const r of e.props)t+=stringifyToken(r);return t+e.source}case"block-map":case"block-seq":{let t="";for(const r of e.items)t+=stringifyItem(r);return t}case"flow-collection":{let t=e.start.source;for(const r of e.items)t+=stringifyItem(r);for(const r of e.end)t+=r.source;return t}case"document":{let t=stringifyItem(e);if(e.end)for(const r of e.end)t+=r.source;return t}default:{let t=e.source;if("end"in e&&e.end)for(const r of e.end)t+=r.source;return t}}}function stringifyItem({start:e,key:t,sep:r,value:n}){let i="";for(const o of e)i+=o.source;if(t&&(i+=stringifyToken(t)),r)for(const o of r)i+=o.source;return n&&(i+=stringifyToken(n)),i}const BREAK$1=Symbol("break visit"),SKIP=Symbol("skip children"),REMOVE=Symbol("remove item");function visit(e,t){"type"in e&&"document"===e.type&&(e={start:e.start,value:e.value}),_visit(Object.freeze([]),e,t)}function _visit(e,t,r){let n=r(t,e);if("symbol"==typeof n)return n;for(const i of["key","value"]){const o=t[i];if(o&&"items"in o){for(let t=0;t<o.items.length;++t){const n=_visit(Object.freeze(e.concat([[i,t]])),o.items[t],r);if("number"==typeof n)t=n-1;else{if(n===BREAK$1)return BREAK$1;n===REMOVE&&(o.items.splice(t,1),t-=1)}}"function"==typeof n&&"key"===i&&(n=n(t,e))}}return"function"==typeof n?n(t,e):n}visit.BREAK=BREAK$1,visit.SKIP=SKIP,visit.REMOVE=REMOVE,visit.itemAtPath=(e,t)=>{let r=e;for(const[n,i]of t){const e=null==r?void 0:r[n];if(!e||!("items"in e))return;r=e.items[i]}return r},visit.parentCollection=(e,t)=>{const r=visit.itemAtPath(e,t.slice(0,-1)),n=t[t.length-1][0],i=null==r?void 0:r[n];if(i&&"items"in i)return i;throw new Error("Parent collection not found")};const BOM="\ufeff",DOCUMENT="",FLOW_END="",SCALAR="",isCollection=e=>!!e&&"items"in e,isScalar=e=>!!e&&("scalar"===e.type||"single-quoted-scalar"===e.type||"double-quoted-scalar"===e.type||"block-scalar"===e.type);function prettyToken(e){switch(e){case BOM:return"<BOM>";case DOCUMENT:return"<DOC>";case FLOW_END:return"<FLOW_END>";case SCALAR:return"<SCALAR>";default:return JSON.stringify(e)}}function tokenType(e){switch(e){case BOM:return"byte-order-mark";case DOCUMENT:return"doc-mode";case FLOW_END:return"flow-error-end";case SCALAR:return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case"\n":case"\r\n":return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(e[0]){case" ":case"\t":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}const cst=Object.freeze(Object.defineProperty({__proto__:null,BOM:BOM,DOCUMENT:DOCUMENT,FLOW_END:FLOW_END,SCALAR:SCALAR,createScalarToken:createScalarToken,isCollection:isCollection,isScalar:isScalar,prettyToken:prettyToken,resolveAsScalar:resolveAsScalar,setScalarValue:setScalarValue,stringify:stringify$1,tokenType:tokenType,visit:visit},Symbol.toStringTag,{value:"Module"}));function isEmpty(e){switch(e){case void 0:case" ":case"\n":case"\r":case"\t":return!0;default:return!1}}const hexDigits=new Set("0123456789ABCDEFabcdef"),tagChars=new Set("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()"),flowIndicatorChars=new Set(",[]{}"),invalidAnchorChars=new Set(" ,[]{}\n\r\t"),isNotAnchorChar=e=>!e||invalidAnchorChars.has(e);class Lexer{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(e,t=!1){if(e){if("string"!=typeof e)throw TypeError("source is not a string");this.buffer=this.buffer?this.buffer+e:e,this.lineEndPos=null}this.atEnd=!t;let r=this.next??"stream";for(;r&&(t||this.hasChars(1));)r=yield*this.parseNext(r)}atLineEnd(){let e=this.pos,t=this.buffer[e];for(;" "===t||"\t"===t;)t=this.buffer[++e];return!t||"#"===t||"\n"===t||"\r"===t&&"\n"===this.buffer[e+1]}charAt(e){return this.buffer[this.pos+e]}continueScalar(e){let t=this.buffer[e];if(this.indentNext>0){let r=0;for(;" "===t;)t=this.buffer[++r+e];if("\r"===t){const t=this.buffer[r+e+1];if("\n"===t||!t&&!this.atEnd)return e+r+1}return"\n"===t||r>=this.indentNext||!t&&!this.atEnd?e+r:-1}if("-"===t||"."===t){const t=this.buffer.substr(e,3);if(("---"===t||"..."===t)&&isEmpty(this.buffer[e+3]))return-1}return e}getLine(){let e=this.lineEndPos;return("number"!=typeof e||-1!==e&&e<this.pos)&&(e=this.buffer.indexOf("\n",this.pos),this.lineEndPos=e),-1===e?this.atEnd?this.buffer.substring(this.pos):null:("\r"===this.buffer[e-1]&&(e-=1),this.buffer.substring(this.pos,e))}hasChars(e){return this.pos+e<=this.buffer.length}setNext(e){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=e,null}peek(e){return this.buffer.substr(this.pos,e)}*parseNext(e){switch(e){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let e=this.getLine();if(null===e)return this.setNext("stream");if(e[0]===BOM&&(yield*this.pushCount(1),e=e.substring(1)),"%"===e[0]){let t=e.length,r=e.indexOf("#");for(;-1!==r;){const n=e[r-1];if(" "===n||"\t"===n){t=r-1;break}r=e.indexOf("#",r+1)}for(;;){const r=e[t-1];if(" "!==r&&"\t"!==r)break;t-=1}const n=(yield*this.pushCount(t))+(yield*this.pushSpaces(!0));return yield*this.pushCount(e.length-n),this.pushNewline(),"stream"}if(this.atLineEnd()){const t=yield*this.pushSpaces(!0);return yield*this.pushCount(e.length-t),yield*this.pushNewline(),"stream"}return yield DOCUMENT,yield*this.parseLineStart()}*parseLineStart(){const e=this.charAt(0);if(!e&&!this.atEnd)return this.setNext("line-start");if("-"===e||"."===e){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");const e=this.peek(3);if(("---"===e||"..."===e)&&isEmpty(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,"---"===e?"doc":"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!isEmpty(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){const[e,t]=this.peek(2);if(!t&&!this.atEnd)return this.setNext("block-start");if(("-"===e||"?"===e||":"===e)&&isEmpty(t)){const e=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=e,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);const e=this.getLine();if(null===e)return this.setNext("doc");let t=yield*this.pushIndicators();switch(e[t]){case"#":yield*this.pushCount(e.length-t);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(isNotAnchorChar),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return t+=(yield*this.parseBlockScalarHeader()),t+=(yield*this.pushSpaces(!0)),yield*this.pushCount(e.length-t),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let e,t,r=-1;do{e=yield*this.pushNewline(),e>0?(t=yield*this.pushSpaces(!1),this.indentValue=r=t):t=0,t+=(yield*this.pushSpaces(!0))}while(e+t>0);const n=this.getLine();if(null===n)return this.setNext("flow");if(-1!==r&&r<this.indentNext&&"#"!==n[0]||0===r&&(n.startsWith("---")||n.startsWith("..."))&&isEmpty(n[3])){if(!(r===this.indentNext-1&&1===this.flowLevel&&("]"===n[0]||"}"===n[0])))return this.flowLevel=0,yield FLOW_END,yield*this.parseLineStart()}let i=0;for(;","===n[i];)i+=(yield*this.pushCount(1)),i+=(yield*this.pushSpaces(!0)),this.flowKey=!1;switch(i+=(yield*this.pushIndicators()),n[i]){case void 0:return"flow";case"#":return yield*this.pushCount(n.length-i),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(isNotAnchorChar),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{const e=this.charAt(1);if(this.flowKey||isEmpty(e)||","===e)return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){const e=this.charAt(0);let t=this.buffer.indexOf(e,this.pos+1);if("'"===e)for(;-1!==t&&"'"===this.buffer[t+1];)t=this.buffer.indexOf("'",t+2);else for(;-1!==t;){let e=0;for(;"\\"===this.buffer[t-1-e];)e+=1;if(e%2==0)break;t=this.buffer.indexOf('"',t+1)}const r=this.buffer.substring(0,t);let n=r.indexOf("\n",this.pos);if(-1!==n){for(;-1!==n;){const e=this.continueScalar(n+1);if(-1===e)break;n=r.indexOf("\n",e)}-1!==n&&(t=n-("\r"===r[n-1]?2:1))}if(-1===t){if(!this.atEnd)return this.setNext("quoted-scalar");t=this.buffer.length}return yield*this.pushToIndex(t+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let e=this.pos;for(;;){const t=this.buffer[++e];if("+"===t)this.blockScalarKeep=!0;else if(t>"0"&&t<="9")this.blockScalarIndent=Number(t)-1;else if("-"!==t)break}return yield*this.pushUntil(e=>isEmpty(e)||"#"===e)}*parseBlockScalar(){let e,t=this.pos-1,r=0;e:for(let i=this.pos;e=this.buffer[i];++i)switch(e){case" ":r+=1;break;case"\n":t=i,r=0;break;case"\r":{const e=this.buffer[i+1];if(!e&&!this.atEnd)return this.setNext("block-scalar");if("\n"===e)break}default:break e}if(!e&&!this.atEnd)return this.setNext("block-scalar");if(r>=this.indentNext){-1===this.blockScalarIndent?this.indentNext=r:this.indentNext=this.blockScalarIndent+(0===this.indentNext?1:this.indentNext);do{const e=this.continueScalar(t+1);if(-1===e)break;t=this.buffer.indexOf("\n",e)}while(-1!==t);if(-1===t){if(!this.atEnd)return this.setNext("block-scalar");t=this.buffer.length}}let n=t+1;for(e=this.buffer[n];" "===e;)e=this.buffer[++n];if("\t"===e){for(;"\t"===e||" "===e||"\r"===e||"\n"===e;)e=this.buffer[++n];t=n-1}else if(!this.blockScalarKeep)for(;;){let e=t-1,n=this.buffer[e];"\r"===n&&(n=this.buffer[--e]);const i=e;for(;" "===n;)n=this.buffer[--e];if(!("\n"===n&&e>=this.pos&&e+1+r>i))break;t=e}return yield SCALAR,yield*this.pushToIndex(t+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){const e=this.flowLevel>0;let t,r=this.pos-1,n=this.pos-1;for(;t=this.buffer[++n];)if(":"===t){const t=this.buffer[n+1];if(isEmpty(t)||e&&flowIndicatorChars.has(t))break;r=n}else if(isEmpty(t)){let i=this.buffer[n+1];if("\r"===t&&("\n"===i?(n+=1,t="\n",i=this.buffer[n+1]):r=n),"#"===i||e&&flowIndicatorChars.has(i))break;if("\n"===t){const e=this.continueScalar(n+1);if(-1===e)break;n=Math.max(n,e-2)}}else{if(e&&flowIndicatorChars.has(t))break;r=n}return t||this.atEnd?(yield SCALAR,yield*this.pushToIndex(r+1,!0),e?"flow":"doc"):this.setNext("plain-scalar")}*pushCount(e){return e>0?(yield this.buffer.substr(this.pos,e),this.pos+=e,e):0}*pushToIndex(e,t){const r=this.buffer.slice(this.pos,e);return r?(yield r,this.pos+=r.length,r.length):(t&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(isNotAnchorChar))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{const e=this.flowLevel>0,t=this.charAt(1);if(isEmpty(t)||e&&flowIndicatorChars.has(t))return e?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if("<"===this.charAt(1)){let e=this.pos+2,t=this.buffer[e];for(;!isEmpty(t)&&">"!==t;)t=this.buffer[++e];return yield*this.pushToIndex(">"===t?e+1:e,!1)}{let e=this.pos+1,t=this.buffer[e];for(;t;)if(tagChars.has(t))t=this.buffer[++e];else{if("%"!==t||!hexDigits.has(this.buffer[e+1])||!hexDigits.has(this.buffer[e+2]))break;t=this.buffer[e+=3]}return yield*this.pushToIndex(e,!1)}}*pushNewline(){const e=this.buffer[this.pos];return"\n"===e?yield*this.pushCount(1):"\r"===e&&"\n"===this.charAt(1)?yield*this.pushCount(2):0}*pushSpaces(e){let t,r=this.pos-1;do{t=this.buffer[++r]}while(" "===t||e&&"\t"===t);const n=r-this.pos;return n>0&&(yield this.buffer.substr(this.pos,n),this.pos=r),n}*pushUntil(e){let t=this.pos,r=this.buffer[t];for(;!e(r);)r=this.buffer[++t];return yield*this.pushToIndex(t,!1)}}class LineCounter{constructor(){this.lineStarts=[],this.addNewLine=e=>this.lineStarts.push(e),this.linePos=e=>{let t=0,r=this.lineStarts.length;for(;t<r;){const n=t+r>>1;this.lineStarts[n]<e?t=n+1:r=n}if(this.lineStarts[t]===e)return{line:t+1,col:1};if(0===t)return{line:0,col:e};return{line:t,col:e-this.lineStarts[t-1]+1}}}}function includesToken(e,t){for(let r=0;r<e.length;++r)if(e[r].type===t)return!0;return!1}function findNonEmptyIndex(e){for(let t=0;t<e.length;++t)switch(e[t].type){case"space":case"comment":case"newline":break;default:return t}return-1}function isFlowToken(e){switch(null==e?void 0:e.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function getPrevProps(e){switch(e.type){case"document":return e.start;case"block-map":{const t=e.items[e.items.length-1];return t.sep??t.start}case"block-seq":return e.items[e.items.length-1].start;default:return[]}}function getFirstKeyStartProps(e){var t;if(0===e.length)return[];let r=e.length;e:for(;--r>=0;)switch(e[r].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;"space"===(null==(t=e[++r])?void 0:t.type););return e.splice(r,e.length)}function fixFlowSeqItems(e){if("flow-seq-start"===e.start.type)for(const t of e.items)!t.sep||t.value||includesToken(t.start,"explicit-key-ind")||includesToken(t.sep,"map-value-ind")||(t.key&&(t.value=t.key),delete t.key,isFlowToken(t.value)?t.value.end?Array.prototype.push.apply(t.value.end,t.sep):t.value.end=t.sep:Array.prototype.push.apply(t.start,t.sep),delete t.sep)}class Parser{constructor(e){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new Lexer,this.onNewLine=e}*parse(e,t=!1){this.onNewLine&&0===this.offset&&this.onNewLine(0);for(const r of this.lexer.lex(e,t))yield*this.next(r);t||(yield*this.end())}*next(e){if(this.source=e,this.atScalar)return this.atScalar=!1,yield*this.step(),void(this.offset+=e.length);const t=tokenType(e);if(t)if("scalar"===t)this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=t,yield*this.step(),t){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+e.length);break;case"space":this.atNewLine&&" "===e[0]&&(this.indent+=e.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=e.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=e.length}else{const t=`Not a YAML token: ${e}`;yield*this.pop({type:"error",offset:this.offset,message:t,source:e}),this.offset+=e.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){const e=this.peek(1);if("doc-end"!==this.type||e&&"doc-end"===e.type){if(!e)return yield*this.stream();switch(e.type){case"document":return yield*this.document(e);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(e);case"block-scalar":return yield*this.blockScalar(e);case"block-map":return yield*this.blockMap(e);case"block-seq":return yield*this.blockSequence(e);case"flow-collection":return yield*this.flowCollection(e);case"doc-end":return yield*this.documentEnd(e)}yield*this.pop()}else{for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source})}}peek(e){return this.stack[this.stack.length-e]}*pop(e){const t=e??this.stack.pop();if(t)if(0===this.stack.length)yield t;else{const e=this.peek(1);switch("block-scalar"===t.type?t.indent="indent"in e?e.indent:0:"flow-collection"===t.type&&"document"===e.type&&(t.indent=0),"flow-collection"===t.type&&fixFlowSeqItems(t),e.type){case"document":e.value=t;break;case"block-scalar":e.props.push(t);break;case"block-map":{const r=e.items[e.items.length-1];if(r.value)return e.items.push({start:[],key:t,sep:[]}),void(this.onKeyLine=!0);if(!r.sep)return Object.assign(r,{key:t,sep:[]}),void(this.onKeyLine=!r.explicitKey);r.value=t;break}case"block-seq":{const r=e.items[e.items.length-1];r.value?e.items.push({start:[],value:t}):r.value=t;break}case"flow-collection":{const r=e.items[e.items.length-1];return void(!r||r.value?e.items.push({start:[],key:t,sep:[]}):r.sep?r.value=t:Object.assign(r,{key:t,sep:[]}))}default:yield*this.pop(),yield*this.pop(t)}if(!("document"!==e.type&&"block-map"!==e.type&&"block-seq"!==e.type||"block-map"!==t.type&&"block-seq"!==t.type)){const r=t.items[t.items.length-1];r&&!r.sep&&!r.value&&r.start.length>0&&-1===findNonEmptyIndex(r.start)&&(0===t.indent||r.start.every(e=>"comment"!==e.type||e.indent<t.indent))&&("document"===e.type?e.end=r.start:e.items.push({start:r.start}),t.items.splice(-1,1))}}else{const e="Tried to pop an empty stack";yield{type:"error",offset:this.offset,source:"",message:e}}}*stream(){switch(this.type){case"directive-line":return void(yield{type:"directive",offset:this.offset,source:this.source});case"byte-order-mark":case"space":case"comment":case"newline":return void(yield this.sourceToken);case"doc-mode":case"doc-start":{const e={type:"document",offset:this.offset,start:[]};return"doc-start"===this.type&&e.start.push(this.sourceToken),void this.stack.push(e)}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(e){if(e.value)return yield*this.lineEnd(e);switch(this.type){case"doc-start":return void(-1!==findNonEmptyIndex(e.start)?(yield*this.pop(),yield*this.step()):e.start.push(this.sourceToken));case"anchor":case"tag":case"space":case"comment":case"newline":return void e.start.push(this.sourceToken)}const t=this.startBlockValue(e);t?this.stack.push(t):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(e){if("map-value-ind"===this.type){const t=getFirstKeyStartProps(getPrevProps(this.peek(2)));let r;e.end?(r=e.end,r.push(this.sourceToken),delete e.end):r=[this.sourceToken];const n={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:t,key:e,sep:r}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=n}else yield*this.lineEnd(e)}*blockScalar(e){switch(this.type){case"space":case"comment":case"newline":return void e.props.push(this.sourceToken);case"scalar":if(e.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let e=this.source.indexOf("\n")+1;for(;0!==e;)this.onNewLine(this.offset+e),e=this.source.indexOf("\n",e)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(e){var t;const r=e.items[e.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,r.value){const t="end"in r.value?r.value.end:void 0,n=Array.isArray(t)?t[t.length-1]:void 0;"comment"===(null==n?void 0:n.type)?null==t||t.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else r.sep?r.sep.push(this.sourceToken):r.start.push(this.sourceToken);return;case"space":case"comment":if(r.value)e.items.push({start:[this.sourceToken]});else if(r.sep)r.sep.push(this.sourceToken);else{if(this.atIndentedComment(r.start,e.indent)){const n=e.items[e.items.length-2],i=null==(t=null==n?void 0:n.value)?void 0:t.end;if(Array.isArray(i))return Array.prototype.push.apply(i,r.start),i.push(this.sourceToken),void e.items.pop()}r.start.push(this.sourceToken)}return}if(this.indent>=e.indent){const t=!this.onKeyLine&&this.indent===e.indent,n=t&&(r.sep||r.explicitKey)&&"seq-item-ind"!==this.type;let i=[];if(n&&r.sep&&!r.value){const t=[];for(let n=0;n<r.sep.length;++n){const i=r.sep[n];switch(i.type){case"newline":t.push(n);break;case"space":break;case"comment":i.indent>e.indent&&(t.length=0);break;default:t.length=0}}t.length>=2&&(i=r.sep.splice(t[1]))}switch(this.type){case"anchor":case"tag":return void(n||r.value?(i.push(this.sourceToken),e.items.push({start:i}),this.onKeyLine=!0):r.sep?r.sep.push(this.sourceToken):r.start.push(this.sourceToken));case"explicit-key-ind":return r.sep||r.explicitKey?n||r.value?(i.push(this.sourceToken),e.items.push({start:i,explicitKey:!0})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken],explicitKey:!0}]}):(r.start.push(this.sourceToken),r.explicitKey=!0),void(this.onKeyLine=!0);case"map-value-ind":if(r.explicitKey)if(r.sep)if(r.value)e.items.push({start:[],key:null,sep:[this.sourceToken]});else if(includesToken(r.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:i,key:null,sep:[this.sourceToken]}]});else if(isFlowToken(r.key)&&!includesToken(r.sep,"newline")){const e=getFirstKeyStartProps(r.start),t=r.key,n=r.sep;n.push(this.sourceToken),delete r.key,delete r.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:e,key:t,sep:n}]})}else i.length>0?r.sep=r.sep.concat(i,this.sourceToken):r.sep.push(this.sourceToken);else if(includesToken(r.start,"newline"))Object.assign(r,{key:null,sep:[this.sourceToken]});else{const e=getFirstKeyStartProps(r.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:e,key:null,sep:[this.sourceToken]}]})}else r.sep?r.value||n?e.items.push({start:i,key:null,sep:[this.sourceToken]}):includesToken(r.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):r.sep.push(this.sourceToken):Object.assign(r,{key:null,sep:[this.sourceToken]});return void(this.onKeyLine=!0);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const t=this.flowScalar(this.type);return void(n||r.value?(e.items.push({start:i,key:t,sep:[]}),this.onKeyLine=!0):r.sep?this.stack.push(t):(Object.assign(r,{key:t,sep:[]}),this.onKeyLine=!0))}default:{const n=this.startBlockValue(e);if(n){if("block-seq"===n.type){if(!r.explicitKey&&r.sep&&!includesToken(r.sep,"newline"))return void(yield*this.pop({type:"error",offset:this.offset,message:"Unexpected block-seq-ind on same line with key",source:this.source}))}else t&&e.items.push({start:i});return void this.stack.push(n)}}}}yield*this.pop(),yield*this.step()}*blockSequence(e){var t;const r=e.items[e.items.length-1];switch(this.type){case"newline":if(r.value){const t="end"in r.value?r.value.end:void 0,n=Array.isArray(t)?t[t.length-1]:void 0;"comment"===(null==n?void 0:n.type)?null==t||t.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else r.start.push(this.sourceToken);return;case"space":case"comment":if(r.value)e.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(r.start,e.indent)){const n=e.items[e.items.length-2],i=null==(t=null==n?void 0:n.value)?void 0:t.end;if(Array.isArray(i))return Array.prototype.push.apply(i,r.start),i.push(this.sourceToken),void e.items.pop()}r.start.push(this.sourceToken)}return;case"anchor":case"tag":if(r.value||this.indent<=e.indent)break;return void r.start.push(this.sourceToken);case"seq-item-ind":if(this.indent!==e.indent)break;return void(r.value||includesToken(r.start,"seq-item-ind")?e.items.push({start:[this.sourceToken]}):r.start.push(this.sourceToken))}if(this.indent>e.indent){const t=this.startBlockValue(e);if(t)return void this.stack.push(t)}yield*this.pop(),yield*this.step()}*flowCollection(e){const t=e.items[e.items.length-1];if("flow-error-end"===this.type){let e;do{yield*this.pop(),e=this.peek(1)}while(e&&"flow-collection"===e.type)}else if(0===e.end.length){switch(this.type){case"comma":case"explicit-key-ind":return void(!t||t.sep?e.items.push({start:[this.sourceToken]}):t.start.push(this.sourceToken));case"map-value-ind":return void(!t||t.value?e.items.push({start:[],key:null,sep:[this.sourceToken]}):t.sep?t.sep.push(this.sourceToken):Object.assign(t,{key:null,sep:[this.sourceToken]}));case"space":case"comment":case"newline":case"anchor":case"tag":return void(!t||t.value?e.items.push({start:[this.sourceToken]}):t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken));case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const r=this.flowScalar(this.type);return void(!t||t.value?e.items.push({start:[],key:r,sep:[]}):t.sep?this.stack.push(r):Object.assign(t,{key:r,sep:[]}))}case"flow-map-end":case"flow-seq-end":return void e.end.push(this.sourceToken)}const r=this.startBlockValue(e);r?this.stack.push(r):(yield*this.pop(),yield*this.step())}else{const t=this.peek(2);if("block-map"===t.type&&("map-value-ind"===this.type&&t.indent===e.indent||"newline"===this.type&&!t.items[t.items.length-1].sep))yield*this.pop(),yield*this.step();else if("map-value-ind"===this.type&&"flow-collection"!==t.type){const r=getFirstKeyStartProps(getPrevProps(t));fixFlowSeqItems(e);const n=e.end.splice(1,e.end.length);n.push(this.sourceToken);const i={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:r,key:e,sep:n}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=i}else yield*this.lineEnd(e)}}flowScalar(e){if(this.onNewLine){let e=this.source.indexOf("\n")+1;for(;0!==e;)this.onNewLine(this.offset+e),e=this.source.indexOf("\n",e)+1}return{type:e,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(e){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;const t=getFirstKeyStartProps(getPrevProps(e));return t.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:t,explicitKey:!0}]}}case"map-value-ind":{this.onKeyLine=!0;const t=getFirstKeyStartProps(getPrevProps(e));return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:t,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(e,t){return"comment"===this.type&&(!(this.indent<=t)&&e.every(e=>"newline"===e.type||"space"===e.type))}*documentEnd(e){"doc-mode"!==this.type&&(e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],"newline"===this.type&&(yield*this.pop()))}*lineEnd(e){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;default:e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],"newline"===this.type&&(yield*this.pop())}}}function parseOptions(e){const t=!1!==e.prettyErrors;return{lineCounter:e.lineCounter||t&&new LineCounter||null,prettyErrors:t}}function parseAllDocuments(e,t={}){const{lineCounter:r,prettyErrors:n}=parseOptions(t),i=new Parser(null==r?void 0:r.addNewLine),o=new Composer(t),s=Array.from(o.compose(i.parse(e)));if(n&&r)for(const a of s)a.errors.forEach(prettifyError(e,r)),a.warnings.forEach(prettifyError(e,r));return s.length>0?s:Object.assign([],{empty:!0},o.streamInfo())}function parseDocument(e,t={}){const{lineCounter:r,prettyErrors:n}=parseOptions(t),i=new Parser(null==r?void 0:r.addNewLine),o=new Composer(t);let s=null;for(const a of o.compose(i.parse(e),!0,e.length))if(s){if("silent"!==s.options.logLevel){s.errors.push(new YAMLParseError(a.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}}else s=a;return n&&r&&(s.errors.forEach(prettifyError(e,r)),s.warnings.forEach(prettifyError(e,r))),s}function parse$2(e,t,r){let n;"function"==typeof t?n=t:void 0===r&&t&&"object"==typeof t&&(r=t);const i=parseDocument(e,r);if(!i)return null;if(i.warnings.forEach(e=>warn(i.options.logLevel,e)),i.errors.length>0){if("silent"!==i.options.logLevel)throw i.errors[0];i.errors=[]}return i.toJS(Object.assign({reviver:n},r))}function stringify(e,t,r){let n=null;if("function"==typeof t||Array.isArray(t)?n=t:void 0===r&&t&&(r=t),"string"==typeof r&&(r=r.length),"number"==typeof r){const e=Math.round(r);r=e<1?void 0:e>8?{indent:8}:{indent:e}}if(void 0===e){const{keepUndefined:e}=r??t??{};if(!e)return}return isDocument(e)&&!n?e.toString(r):new Document(e,n,r).toString(r)}const YAML=Object.freeze(Object.defineProperty({__proto__:null,Alias:Alias,CST:cst,Composer:Composer,Document:Document,Lexer:Lexer,LineCounter:LineCounter,Pair:Pair,Parser:Parser,Scalar:Scalar,Schema:Schema,YAMLError:YAMLError,YAMLMap:YAMLMap,YAMLParseError:YAMLParseError,YAMLSeq:YAMLSeq,YAMLWarning:YAMLWarning,isAlias:isAlias,isCollection:isCollection$1,isDocument:isDocument,isMap:isMap,isNode:isNode,isPair:isPair,isScalar:isScalar$1,isSeq:isSeq,parse:parse$2,parseAllDocuments:parseAllDocuments,parseDocument:parseDocument,stringify:stringify,visit:visit$1,visitAsync:visitAsync},Symbol.toStringTag,{value:"Module"}));function bin2text(e,t,r=0){const n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);let i="  ";0==r&&(r=n.length),r=Math.min(r,n.length);for(let o=0;o<r;o+=16){o+16<=r||n.length==r||(o=n.length-n.length%16,r=n.length,i=">>");const e=[o.toString(16).padStart(4,"0"),i];for(let t=0;t<16;t++)o+t<r?e.push(n[o+t].toString(16).padStart(2,"0")):e.push("  "),e.push(" ");for(let t=0;t<16;t++)if(o+t<r){const r=n[o+t];e.push(r>=32&&r<127?String.fromCharCode(r):".")}t(e.join(""))}}function bin2string(e,t=0){const r=[];return bin2text(e,e=>{r.push(e)},t),r.join("\n")}var Level={WARN:"warn",DEBUG:"debug",INFO:"info",ERROR:"error"},LogValue=class{constructor(e){this.fn=e}value(){try{return this.fn()}catch(e){return`LogValue:${e.message}`}}toJSON(){return this.value()}};function logValue(e,t){return logValueInternal(e,{...t,state:t.state||new Set([Math.random()])})}function logValueInternal(e,t){var r,n;switch(t={...t,state:t.state||new Set([Math.random()])},typeof e){case"function":return new LogValue(e);case"string":try{const r=JSON.parse(e);if("object"==typeof r&&null!==r)return logValueInternal(r,t)}catch(i){try{const t=new URL(e);return new LogValue(()=>t.toString())}catch(o){}}if(e.match(/[\n\r]/)){const t=e.split(/[\n\r]+/).map(e=>e.trim());return new LogValue(()=>t)}return new LogValue(()=>e.toString());case"number":case"boolean":return new LogValue(()=>e);case"object":{if(null===e)return new LogValue(()=>"null");if(ArrayBuffer.isView(e))try{const r=(new TextDecoder).decode(e);return logValueInternal(JSON.parse(r),t)}catch(i){return logValueInternal(bin2string(e,512),t)}if(Array.isArray(e))return new LogValue(()=>e.map(e=>logValue(e,{...t,state:void 0}).value()));if(e instanceof Headers)return new LogValue(()=>Object.fromEntries(e.entries()));if(e instanceof ReadableStream)return new LogValue(()=>">Stream<");if(e instanceof Promise)return new LogValue(()=>">Promise<");if(null==(r=t.state)?void 0:r.has(e))return new LogValue(()=>"...");if(null==(n=t.state)||n.add(e),"function"==typeof e.toJSON)return new LogValue(()=>e.toJSON());const o={},s=e;for(const e in s){if(t.ignoreAttr.IsSome()&&t.ignoreAttr.unwrap().test(e))continue;const r=s[e];r instanceof LogValue?o[e]=r:"function"!=typeof r&&(o[e]=logValueInternal(r,t))}return new LogValue(()=>o)}default:if(!e)return new LogValue(()=>"--Falsy--");throw new Error("Invalid type:"+typeof e)}}function IsLogger(e){return"object"==typeof e&&["Module","EnableLevel","DisableLevel","SetDebug","Str","Error","Warn","Debug","Log","WithLevel","Err","Info","Timestamp","Any","Dur","Uint64"].map(t=>"function"==typeof e[t]).reduce((e,t)=>e&&t,!0)}var Option=class e{static Some(e){return new Some(e)}static None(){return new None}static Is(t){return t instanceof e}static From(e){return e?new Some(e):new None}IsNone(){return this.is_none()}IsSome(){return this.is_some()}Unwrap(){return this.unwrap()}},Some=class extends Option{constructor(e){super(),this._t=e}is_none(){return!1}is_some(){return!0}unwrap(){return this._t}},None=class extends Option{is_none(){return!0}is_some(){return!1}unwrap(){throw new Error("None.unwrap")}},LevelHandlerImpl=class{constructor(){this._globalLevels=new Set([Level.INFO,Level.ERROR,Level.WARN]),this._modules=new Map,this.ignoreAttr=Option.Some(/^_/),this.isStackExposed=!1}enableLevel(e,...t){0!=t.length?this.forModules(e,t=>{this._modules.set(t,new Set([...this._globalLevels,e]))},...t):this._globalLevels.add(e)}disableLevel(e,...t){0!=t.length?this.forModules(e,e=>{this._modules.delete(e)},...t):this._globalLevels.delete(e)}setExposeStack(e){this.isStackExposed=!!e}setIgnoreAttr(e){this.ignoreAttr=Option.From(e)}forModules(e,t,...r){for(const n of r.flat()){if("string"!=typeof n)continue;const e=n.split(",").map(e=>e.trim()).filter(e=>e.length);for(const r of e)t(r)}}setDebug(...e){this.forModules(Level.DEBUG,e=>{this._modules.set(e,new Set([...this._globalLevels,Level.DEBUG]))},...e)}isEnabled(e,t){const r=e;if("string"==typeof t){const e=this._modules.get(t);if(e&&e.has(r))return!0}const n=this._modules.get("*");return!(!n||"string"!=typeof r||!n.has(r))||("string"!=typeof r||this._globalLevels.has(r))}},levelSingleton=new LevelHandlerImpl;function LevelHandlerSingleton(){return levelSingleton}var PartType={Slash:1,Root:3,Up:4,Noop:8},Path=class{constructor(e=[]){this.parts=e}toString(){return this.parts.map(e=>{if("string"==typeof e)return e;switch(e){case PartType.Slash:case PartType.Root:return"/";case PartType.Up:return"..";default:return e}}).join("")}add(e){if(this.parts.includes(PartType.Root)&&e===PartType.Root)throw new Error("Cannot add absolute part to absolute path");const t=this.parts[this.parts.length-1];if(!(t&PartType.Slash&&e===PartType.Slash)){switch(e){case".":return void this.parts.push(PartType.Noop);case"..":e=PartType.Up}t!==PartType.Noop||e!==PartType.Slash?this.parts.push(e):t===PartType.Noop&&this.parts.pop()}}};function splitPath(e){const t=new Path;if(""===e)return t;for(let r=0;e.length;r++)if(e.match(/^\/+/))0===r?t.add(PartType.Root):t.add(PartType.Slash),e=e.replace(/^\/+/,"");else{const r=e.replace(/\/.*$/,"");t.add(r),e=e.replace(/^[^/]+/,"")}return t}function pathJoin(...e){let t="";const r=[];for(let n=0;n<e.length;n++){const i=e[n];""!==i&&(t.endsWith("/")||i.startsWith("/")||""!==t&&r.push("/"),r.push(i),t=i)}return r.join("")}function relativePath(e,t){let r;r=splitPath(t).parts[0]===PartType.Root?t:pathJoin(e,t);const n=splitPath(r),i=[];let o=!1;for(const s of n.parts)switch(s){case PartType.Root:i.push(PartType.Root);break;case PartType.Up:if(i.length&&!o){const e=i.length-1;"string"==typeof i[e]&&i[e-1]==PartType.Root||i.pop(),i.pop(),0===i.length&&(o=o||!0,i.push(PartType.Up))}else i.push(PartType.Up);break;case PartType.Slash:i[i.length-1]&PartType.Slash||i.push(PartType.Slash);break;default:i.push(s)}return new Path(i).toString()}function match(e,t){const r={score:0,protocol:!1,hostname:!1,port:!1,pathname:!1,pathParts:[],params:{}},n=URI.from(e),i=URI.from(t);n.protocol===i.protocol&&(r.score+=1,r.protocol=!0);try{const e=n.hostname,t=n.port;e===i.hostname&&(r.score+=1,r.hostname=!0),t.length&&t===i.port&&(r.score+=1,r.port=!0)}catch(o){}if(n.pathname.length&&"/"!==n.pathname){const e=n.pathname.split("/").filter(e=>e.length),t=i.pathname.split("/").filter(e=>e.length);for(let n=0;n<e.length&&n<t.length;n++)t[n]===e[n]&&(r.score+=1,r.pathname=!0,r.pathParts.push(e[n]))}for(const[s,a]of n.getParams)i.getParam(s)===a&&(r.score+=1,r.params[s]=a);return r}function coerceKey(e,t){if("object"==typeof e){const t=Object.keys(e);if(1!==t.length)throw new Error(`Invalid key: ${JSON.stringify(e)}`);return{key:t[0],def:e[t[0]]}}return{key:e,def:t}}function falsy2undef(e){return null==e?void 0:e}function ensureURLWithDefaultProto(e,t){if(!e)return new MutableURL(`${t}//`);if("string"!=typeof e)return new MutableURL(e.toString());try{return new MutableURL(e)}catch(r){return new MutableURL(`${t}//${e}`)}}function isURL(e){return e instanceof URL||!!e&&"object"==typeof e.searchParams&&"function"==typeof e.searchParams.sort&&"string"==typeof e.hash}var MutableURL=class e extends URL{constructor(e){super("defect://does.not.exist");const t=e.split(":");this._hasHostpart=hasHostPartProtocols.has(t[0]);let r=["http",...t.slice(1)].join(":");if(!this._hasHostpart){const e=r.replace(/http:\/\/[/]*/,"").replace(/[#?].*$/,"");r=r.replace(/http:\/\//,`http://localhost/${e}`)}try{this._sysURL=new URL(r)}catch(n){const t=n;throw t.message=`${t.message} for URL: ${e}`,t}this._protocol=`${t[0]}:`,this._hasHostpart?this._pathname=this._sysURL.pathname:this._pathname=e.replace(new RegExp(`^${this._protocol}//`),"").replace(/[#?].*$/,""),this.hash=this._sysURL.hash}clone(){return new e(this.toString())}get host(){if(!this._hasHostpart)throw new Error(`you can use hostname only if protocol is ${this.toString()} ${JSON.stringify(Array.from(hasHostPartProtocols.keys()))}`);return this._sysURL.host}get port(){if(!this._hasHostpart)throw new Error(`you can use hostname only if protocol is ${JSON.stringify(Array.from(hasHostPartProtocols.keys()))}`);return this._sysURL.port}set port(e){if(!this._hasHostpart)throw new Error(`you can use port only if protocol is ${JSON.stringify(Array.from(hasHostPartProtocols.keys()))}`);this._sysURL.port=e}get hostname(){if(!this._hasHostpart)throw new Error(`you can use hostname only if protocol is ${JSON.stringify(Array.from(hasHostPartProtocols.keys()))}`);return this._sysURL.hostname}set hostname(e){if(!this._hasHostpart)throw new Error(`you can use hostname only if protocol is ${JSON.stringify(Array.from(hasHostPartProtocols.keys()))}`);this._sysURL.hostname=e}set pathname(e){this._pathname=e}get pathname(){return this._pathname}get protocol(){return this._protocol}set protocol(e){e.endsWith(":")||(e=`${e}:`),this._protocol=e}get searchParams(){return this._sysURL.searchParams}toString(){let e="";if(this._sysURL.searchParams.size)for(const[r,n]of Array.from(this._sysURL.searchParams.entries()).sort((e,t)=>e[0].localeCompare(t[0])))e+=`${e.length?"&":"?"}${r}=${encodeURIComponent(n)}`;let t="";return this._hasHostpart&&(t=this._sysURL.hostname,this._sysURL.port&&(t+=`:${this._sysURL.port}`),this._pathname.startsWith("/")||(t+="/")),`${this._protocol}//${t}${this._pathname}${e}`}};function from$2(e,t,r){switch(typeof falsy2undef(t)){case"undefined":return e(new MutableURL(`${r}///`));case"string":return e(ensureURLWithDefaultProto(t,r));case"object":if(BuildURI.is(t))return e(new MutableURL(t._url.toString()));if(URI.is(t))return e(new MutableURL(t._url.toString()));if(isURL(t))return e(new MutableURL(t.toString()));throw new Error(`unknown object type: ${t}`);default:throw new Error("Invalid argument: "+typeof t)}}function getParamResult(e,t,r=e=>`missing parameter: ${e}`){return void 0===t?Result.Err(r(e)):Result.Ok(t)}var BuildURI=class e{constructor(e){this._url=e}static is(t){return t instanceof e||!!t&&"function"==typeof t.delParam&&"function"==typeof t.setParam}static from(t,r="file:"){return from$2(t=>new e(t),t,r)}match(e){return match(this.URI(),URI.from(e))}port(e){return this._url.port=e,this}hostname(e){return this._url.hostname=e,this}protocol(e){return e.endsWith(":")||(e=`${e}:`),this._url.protocol=e,this}pathname(e){return this._url.pathname=e,this}resolve(e){return e?"string"!=typeof e||e.match(/^[a-zA-Z0-9]+:/)?(this._url=new MutableURL(e.toString()),this):e.startsWith("/")?(this.pathname(e),this):this.appendRelative(e):this}appendRelative(e){const t=URI.from(e),r="./"+t.pathname,n=this._url.pathname;this.pathname(relativePath(n,r));for(const[i,o]of t.getParams)this.setParam(i,o);return this}cleanParams(){for(const e of Array.from(this._url.searchParams.keys()))this._url.searchParams.delete(e);return this}delParam(e){return this._url.searchParams.delete(e),this}defParam(e,t){return this._url.searchParams.has(e)||this._url.searchParams.set(e,t),this}setParam(e,t){return this._url.searchParams.set(e,t),this}hasParam(e){return this._url.searchParams.has(e)}get getParams(){return this._url.searchParams.entries()}getParam(e,t){const{key:r,def:n}=coerceKey(e,t);let i=this._url.searchParams.get(r);return!falsy2undef(i)&&n&&(i=n),falsy2undef(i)}getParamResult(e,t){return getParamResult(e,this.getParam(e),t)}getParamsResult(...e){return getParamsResult(e,this)}toString(){return this._url.searchParams.sort(),this._url.toString()}toJSON(){return this.toString()}asURL(){return this.URI().asURL()}asObj(...e){return this.URI().asObj(...e)}clone(){return e.from(this.toString())}URI(){return URI.from(this._url)}},hasHostPartProtocols=new Set(["http","https","ws","wss"]),URI=class e{static protocolHasHostpart(e){return e=e.replace(/:$/,""),hasHostPartProtocols.add(e),()=>{hasHostPartProtocols.delete(e)}}match(e){return match(this,e)}static merge(t,r,n="file:"){const i=BuildURI.from(t,n),o=e.from(r,n);i.protocol(o.protocol);const s=o.pathname;0!==s.length&&"/"!==s&&"./"!==s&&i.pathname(o.pathname);for(const[e,a]of o.getParams)i.setParam(e,a);return i.URI()}static is(t){return t instanceof e||!!t&&"function"==typeof t.asURL&&"function"==typeof t.getParam&&"function"==typeof t.hasParam}static from(t,r="file:"){return from$2(t=>new e(t),t,r)}static fromResult(t,r="file:"){return exception2Result(()=>from$2(t=>new e(t),t,r))}constructor(e){this._url=e.clone()}build(){return BuildURI.from(this._url)}get hostname(){return this._url.hostname}get port(){return this._url.port}get host(){return this._url.host}get protocol(){return this._url.protocol}get pathname(){return this._url.pathname}get getParams(){return this._url.searchParams.entries()}hasParam(e){return this._url.searchParams.has(e)}getParam(e,t){const{key:r,def:n}=coerceKey(e,t);let i=this._url.searchParams.get(r);return!falsy2undef(i)&&n&&(i=n),falsy2undef(i)}getParamResult(e,t){return getParamResult(e,this.getParam(e),t)}getParamsResult(...e){return getParamsResult(e,this)}clone(){return new e(this._url)}asURL(){return this._url.clone()}toString(){return this._url.toString()}toJSON(){return this.toString()}asObj(...e){const t={style:"path",protocol:this.protocol,pathname:this.pathname,searchParams:Object.fromEntries(this.getParams)};return hasHostPartProtocols.has(this.protocol.replace(/:$/,""))?stripper(e,{...t,style:"host",hostname:this.hostname,port:this.port}):stripper(e,t)}},LogWriterStream=class{constructor(e){this._toFlush=[],this._flushIsRunning=!1,this._flushDoneFns=[],this._out=e}write(e){this._toFlush.push(async()=>{try{const t=this._out.getWriter();await t.ready,await t.write(e),t.releaseLock()}catch(t){console.error("Chunk error:",t)}}),this._flush()}_flush(e=void 0,t){if(t&&this._flushDoneFns.push(t),0==this._toFlush.length)return this._flushIsRunning=!1,this._flushDoneFns.forEach(e=>e()),void(this._flushDoneFns=[]);if(e||1!=this._toFlush.length||this._flushIsRunning){if(!e)return}else this._flushIsRunning=!0;const r=this._toFlush.shift();null==r||r().catch(e=>{console.error("Flush error:",e)}).finally(()=>{this._flush(this._toFlush)})}};function getLen(e,t){return Array.isArray(e)||"string"==typeof e?logValue(()=>e.length,t):"object"==typeof e&&null!==e?"number"==typeof e.size?logValue(()=>e.size,t):"number"==typeof e.length?logValue(()=>e.length,t):logValue(()=>Object.keys(e).length,t):logValue(()=>-1,t)}function toLogValue(e){if(e&&"function"==typeof e.then)throw new Error("async logValue Not implemented");return e}var JSONFormatter=class{constructor(e,t){this._txtEnDe=e,this._space=t}format(e){let t;try{t=JSON.stringify(e,null,this._space)}catch(r){t=JSON.stringify({internal:{message:r.message,stack:r.stack}})}return this._txtEnDe.encode(t+"\n")}},YAMLFormatter=class{constructor(e,t){this._txtEnDe=e,this._space=t}format(e){return this._txtEnDe.encode("---\n"+YAML.stringify(e,null,this._space)+"\n")}};function toLogValueCtx(e){return{ignoreAttr:e.ignoreAttr}}var LoggerImpl=class e{constructor(e){if(this._attributes={},e||(e={}),e.sys?this._sys=e.sys:this._sys=WebSysAbstraction(),e.txtEnDe?this._txtEnDe=e.txtEnDe:this._txtEnDe=TxtEnDecoderSingleton(),e.formatter?this._formatter=e.formatter:this._formatter=new JSONFormatter(this._txtEnDe),e.logWriter)this._logWriter=e.logWriter;else if(e.out)this._logWriter=new LogWriterStream(e.out);else{const e=runtimeFn();let t;if(e.isBrowser)t=new ConsoleWriterStream;else{if(!(e.isNodeIsh||e.isReactNative||e.isDeno||e.isCFWorker))throw new Error("No output defined for runtime");t=this._sys.Stdout()}this._logWriter=new LogWriterStream(t)}e.withAttributes?this._withAttributes={...e.withAttributes}:this._withAttributes={},this._attributes={...this._withAttributes},e.levelHandler?this.levelHandler=e.levelHandler:this.levelHandler=LevelHandlerSingleton()}TxtEnDe(){return this._txtEnDe}Attributes(){return JSON.parse(JSON.stringify(this._attributes,null))}SetExposeStack(e){return this.levelHandler.setExposeStack(e),this}EnableLevel(e,...t){return this.levelHandler.enableLevel(e,...t),this}DisableLevel(e,...t){return this.levelHandler.disableLevel(e,...t),this}Module(e){return this._attributes.module=logValue(e,toLogValueCtx(this.levelHandler)),this._withAttributes.module=logValue(e,toLogValueCtx(this.levelHandler)),this}SetDebug(...e){return this.levelHandler.setDebug(...e),this}SetIgnoreAttribute(e){return this.levelHandler.setIgnoreAttr(e),this}SetFormatter(e){return this._formatter=e,this}Timestamp(){return this._attributes.ts=logValue(()=>this._sys.Time().Now().toISOString(),toLogValueCtx(this.levelHandler)),this}Warn(){return this._attributes.level=logValue(Level.WARN,toLogValueCtx(this.levelHandler)),this}Log(){return this}Debug(){return this._attributes.level=logValue(Level.DEBUG,toLogValueCtx(this.levelHandler)),this}Error(){return this._attributes.level=logValue(Level.ERROR,toLogValueCtx(this.levelHandler)),this}Info(){return this._attributes.level=logValue(Level.INFO,toLogValueCtx(this.levelHandler)),this}Err(e){var t;let r="error";return Result.Is(e)&&(e.isOk()?(r="noerror",e=e.Ok()):e=e.Err()),e instanceof Error?(e.cause?this.coerceKey(r,{message:e.message,cause:e.cause}):this._attributes[r]=logValue(e.message,toLogValueCtx(this.levelHandler)),this.levelHandler.isStackExposed&&(this._attributes.stack=logValue(null==(t=e.stack)?void 0:t.split(/[\r\n]+/).map(e=>e.trim()),toLogValueCtx(this.levelHandler)))):this.Any(r,e),this}WithLevel(e){return this._attributes.level=logValue(e,toLogValueCtx(this.levelHandler)),this}Ref(e,t){return"function"==typeof t?this._attributes[e]=logValue(t,toLogValueCtx(this.levelHandler)):"function"==typeof t.toString?this._attributes[e]=logValue(()=>t.toString(),toLogValueCtx(this.levelHandler)):this._attributes[e]=logValue("INVALID REF",toLogValueCtx(this.levelHandler)),this}Bool(e,t){return this.coerceKey(e,!!t),this}Http(...e){const t=e.find(e=>"string"==typeof e),r=(e=e.filter(e=>"string"!=typeof e)).filter(e=>Result.Is(e)&&e.isErr());if(r.length)return this.Err(r.map(e=>e.Err().message).join("\n")),this;const n=e.map(e=>Result.Is(e)?e.Ok():e).find(e=>"number"!=typeof e.status),i=e.map(e=>Result.Is(e)?e.Ok():e).find(e=>"number"==typeof e.status);let o;return i&&n?o={res:i,req:n}:i||n?i?o=i:n&&(o=n):o=void 0,o&&this.Any(t||"Http",o),this}Pair(e){for(const t of Object.keys(e)){const r=e[t];r instanceof LogValue?this._attributes[t]=r:Result.Is(r)?this.Result(t,r):this.Any(t,r)}return this}Result(e,t){return t.isOk()?this._attributes[e]=logValue(t.Ok(),toLogValueCtx(this.levelHandler)):this.Err(t.Err()),this}Len(e,t="len"){return this._attributes[t]=getLen(e,toLogValueCtx(this.levelHandler)),this}Hash(e,t="hash"){throw new Error("Not implemented")}Url(e,t="url"){return this.Ref(t,()=>URI.from(e).toString()),this}coerceKey(e,t){"string"==typeof e?this._attributes[e]=logValue(t,toLogValueCtx(this.levelHandler)):this.Pair(e)}Str(e,t){return this.coerceKey(e,t),this}Any(e,t){return this.coerceKey(e,t),this}Dur(e,t){return this._attributes[e]=logValue(`${t}ms`,toLogValueCtx(this.levelHandler)),this}Uint64(e,t){return this.coerceKey(e,t),this}Int(e,t){return this.Uint64(e,t)}async Flush(){return new Promise(e=>{this._logWriter._flush(void 0,e)})}With(){return new WithLoggerBuilder(new e({logWriter:this._logWriter,sys:this._sys,levelHandler:this.levelHandler,formatter:this._formatter,withAttributes:{module:this._attributes.module,...this._withAttributes}}))}_resetAttributes(e){const t=e();return Object.keys(this._attributes).forEach(e=>{delete this._attributes[e]}),Object.assign(this._attributes,this._withAttributes),t}Msg(...e){const t=this._resetAttributes(()=>{var t,r;const n=this.levelHandler.isEnabled(null==(t=toLogValue(this._attributes.level))?void 0:t.value(),null==(r=toLogValue(this._attributes.module))?void 0:r.value());this._attributes.msg=logValue(e.join(" "),toLogValueCtx(this.levelHandler));const i=this._attributes.msg.value();"string"!=typeof i||i.trim().length||delete this._attributes.msg;let o=()=>this._formatter.format({...this._attributes});if(n){const e=o();this._logWriter.write(e),o=()=>e}return o}),r=()=>new Error(this._txtEnDe.decode(t()));return{ResultError:()=>Result.Err(r()),AsError:r}}},WithLoggerBuilder=class{constructor(e){this._li=e,this.levelHandler=e.levelHandler}TxtEnDe(){return this._li.TxtEnDe()}Logger(){return Object.assign(this._li._withAttributes,this._li._attributes),this._li}Attributes(){return{...this._li._attributes}}SetExposeStack(e){return this._li.levelHandler.setExposeStack(e),this}SetIgnoreAttribute(e){return this._li.levelHandler.setIgnoreAttr(e),this}SetFormatter(e){return this._li.SetFormatter(e),this}EnableLevel(e,...t){return this._li.levelHandler.enableLevel(e,...t),this}DisableLevel(e,...t){return this._li.levelHandler.enableLevel(e,...t),this}Module(e){return this._li.Module(e),this}SetDebug(...e){return this._li.SetDebug(...e),this}Http(...e){return this._li.Http(...e),this}Pair(e){return this._li.Pair(e),this}Str(e,t){return this._li.Str(e,t),this}Len(e,t){return this._li.Len(e,t),this}Hash(e,t){return this._li.Hash(e,t),this}Ref(e,t){return this._li.Ref(e,t),this}Bool(e,t){return this._li.Bool(e,t),this}Result(e,t){return this._li.Result(e,t),this}Url(e,t){return this._li.Url(e,t),this}Int(e,t){return this._li.Int(e,t),this}Log(){return this._li.Log(),this}WithLevel(e){return this._li.WithLevel(e),this}Error(){return this._li.Error(),this}Warn(){return this._li.Error(),this}Debug(){return this._li.Debug(),this}Err(e){return this._li.Err(e),this}Info(){return this._li.Info(),this}Timestamp(){return this._li.Timestamp(),this}Any(e,t){return this._li.Any(e,t),this}Dur(e,t){return this._li.Dur(e,t),this}Uint64(e,t){return this._li.Uint64(e,t),this}},utils_exports={},_pathOpsImpl_instances,parts_fn;function streamMap(e,t){const r={reader:e.getReader(),streamMap:t,idx:0};return new ReadableStream({async pull(e){const{done:t,value:n}=await r.reader.read();if(t)return r.streamMap.Close&&r.streamMap.Close(),void e.close();const i=r.streamMap.Map(n,r.idx++);let o;o=i instanceof Promise||"function"==typeof i.then?await i:i,e.enqueue(o)}})}async function devnull(e){const t=e.getReader();let r=0;for(;;){const{done:e}=await t.read();if(e)break;r++}return r}function array2stream(e){let t=0;return new ReadableStream({pull(r){t>=e.length?r.close():(r.enqueue(e[t]),t++)}})}async function stream2array(e){const t=[],r=e.getReader();for(;;){const{done:e,value:n}=await r.read();if(e)break;t.push(n)}return t}async function rebufferArray(e,t){return stream2array(rebuffer(array2stream(e),t))}function reChunk(e,t){const r=e.reduce((e,t)=>e+t.length,0),n=e[e.length-1],i=r-n.length,o=n.subarray(t-i);e[e.length-1]=n.subarray(0,t-i);const s=new Uint8Array(t);let a=0;for(const l of e)s.set(l,a),a+=l.length;return{rest:o,chunk:s}}function pump(e,t,r){e.reader.read().then(({done:n,value:i})=>{if(n)return e.tmpLen>0&&t.enqueue(reChunk(e.tmp,e.tmpLen).chunk),t.close(),void r();if(e.tmpLen+i.length>e.chunkSize){e.tmp.push(i);const n=reChunk(e.tmp,e.chunkSize);return t.enqueue(n.chunk),e.tmp=[n.rest],e.tmpLen=n.rest.length,void r()}i.length&&(e.tmp.push(i),e.tmpLen+=i.length),pump(e,t,r)}).catch(e=>{t.error(e),r()})}function rebuffer(e,t){const r={reader:e.getReader(),tmp:[],tmpLen:0,chunkSize:t};return new ReadableStream({pull:async e=>new Promise(t=>{pump(r,e,t)})})}async function stream2string(e,t){if(!e)return Promise.resolve("");const r=e.getReader();let n="";const i=new TextDecoder;let o=0;for(;void 0===t||o<t;)try{const e=await r.read();if(e.done)break;t&&o+e.value.length>t&&(e.value=e.value.slice(0,t-o));const s=i.decode(e.value,{stream:!0});o+=e.value.length,n+=s}catch(s){return Promise.reject(s)}return Promise.resolve(n)}async function stream2uint8array(e){if(!e)return Promise.resolve(new Uint8Array);const t=e.getReader();let r=new Uint8Array;for(;;)try{const{done:e,value:n}=await t.read();if(e)break;r=new Uint8Array([...r,...n])}catch(n){return Promise.reject(n)}return Promise.resolve(r)}function string2stream(e,t=TxtEnDecoderSingleton()){return uint8array2stream(t.encode(e))}function uint8array2stream(e){return new ReadableStream({start(t){t.enqueue(e),t.close()}})}function toSortedObjectArray(e){return e?toSortedArray$1(e).map(([e,t])=>({[e]:t})):[]}function toSortedArray$1(e){return e?Object.entries(e).sort(([e],[t])=>e.localeCompare(t)):[]}function toSortedObject(e){return e?Object.fromEntries(toSortedArray$1(e)):e}function UInt8ArrayEqual$1(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function randomBytes(e){const t=new Uint8Array(e);return e>0&&crypto.getRandomValues(t),t}function digestSHA256(e){return Promise.resolve(crypto.subtle.digest("SHA-256",e))}function toCryptoRuntime(e={}){return{importKey:e.importKey||crypto.subtle.importKey.bind(crypto.subtle),exportKey:e.exportKey||crypto.subtle.exportKey.bind(crypto.subtle),encrypt:e.encrypt||crypto.subtle.encrypt.bind(crypto.subtle),decrypt:e.decrypt||crypto.subtle.decrypt.bind(crypto.subtle),randomBytes:e.randomBytes||randomBytes,digestSHA256:e.digestSHA256||digestSHA256}}__export$1(utils_exports,{ConsoleWriterStream:()=>ConsoleWriterStream,ConsoleWriterStreamDefaultWriter:()=>ConsoleWriterStreamDefaultWriter,FanoutWriteStream:()=>FanoutWriteStream,UInt8ArrayEqual:()=>UInt8ArrayEqual$1,array2stream:()=>array2stream,asyncCoerceIntoUint8:()=>asyncCoerceIntoUint8,coerceIntoUint8:()=>coerceIntoUint8,devnull:()=>devnull,getParamsResult:()=>getParamsResult,rebuffer:()=>rebuffer,rebufferArray:()=>rebufferArray,stream2array:()=>stream2array,stream2string:()=>stream2string,stream2uint8array:()=>stream2uint8array,streamMap:()=>streamMap,string2stream:()=>string2stream,stripper:()=>stripper,toSortedArray:()=>toSortedArray$1,toSortedObject:()=>toSortedObject,toSortedObjectArray:()=>toSortedObjectArray,uint8array2stream:()=>uint8array2stream}),Object.keys({__packageVersion__:"xxxx"})[0];var pathOpsImpl$1=class{constructor(){__privateAdd(this,_pathOpsImpl_instances)}join(...e){return e.map(e=>e.replace(/\/+$/,"")).join("/")}dirname(e){return __privateMethod(this,_pathOpsImpl_instances,parts_fn).call(this,e).dirname}basename(e){return __privateMethod(this,_pathOpsImpl_instances,parts_fn).call(this,e).basename}};_pathOpsImpl_instances=new WeakSet,parts_fn=function(e){const t=e.split("/"),r=t.pop();return t.length&&""===r?__privateMethod(this,_pathOpsImpl_instances,parts_fn).call(this,this.join(...t)):{dirname:this.join(...t),basename:null!=r?r:""}},new pathOpsImpl$1;const empty$1=new Uint8Array(0);function fromHex(e){const t=e.match(/../g);return null!=t?new Uint8Array(t.map(e=>parseInt(e,16))):empty$1}function equals$1(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}function coerce(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function fromString$2(e){return(new TextEncoder).encode(e)}function toString$2(e){return(new TextDecoder).decode(e)}function base(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=e.length,l=e.charAt(0),c=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===l;)n++,t++;for(var o=(e.length-t)*c+1>>>0,s=new Uint8Array(o);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var d=0,h=o-1;(0!==u||d<i)&&-1!==h;h--,d++)u+=a*s[h]>>>0,s[h]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=d,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(n+(o-f)),y=n;f!==o;)p[y++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var s=(o-i)*u+1>>>0,c=new Uint8Array(s);i!==o;){for(var d=t[i],h=0,f=s-1;(0!==d||h<n)&&-1!==f;f--,h++)d+=256*c[f]>>>0,c[f]=d%a>>>0,d=d/a>>>0;if(0!==d)throw new Error("Non-zero carry");n=h,i++}for(var p=s-n;p!==s&&0===c[p];)p++;for(var y=l.repeat(r);p<s;++p)y+=e.charAt(c[p]);return y},decodeUnsafe:d,decode:function(e){var r=d(e);if(r)return r;throw new Error(`Non-${t} character`)}}}var src=base,_brrp__multiformats_scope_baseX=src;class Encoder{constructor(e,t,r){__publicField(this,"name"),__publicField(this,"prefix"),__publicField(this,"baseEncode"),this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Decoder{constructor(e,t,r){__publicField(this,"name"),__publicField(this,"prefix"),__publicField(this,"baseDecode"),__publicField(this,"prefixCodePoint"),this.name=e,this.prefix=t;const n=t.codePointAt(0);if(void 0===n)throw new Error("Invalid prefix character");this.prefixCodePoint=n,this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return or(this,e)}}class ComposedDecoder{constructor(e){__publicField(this,"decoders"),this.decoders=e}or(e){return or(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(null!=r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function or(e,t){return new ComposedDecoder({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}class Codec{constructor(e,t,r,n){__publicField(this,"name"),__publicField(this,"prefix"),__publicField(this,"baseEncode"),__publicField(this,"baseDecode"),__publicField(this,"encoder"),__publicField(this,"decoder"),this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new Encoder(e,t,r),this.decoder=new Decoder(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}function from$1({name:e,prefix:t,encode:r,decode:n}){return new Codec(e,t,r,n)}function baseX({name:e,prefix:t,alphabet:r}){const{encode:n,decode:i}=_brrp__multiformats_scope_baseX(r,e);return from$1({prefix:t,name:e,encode:n,decode:e=>coerce(i(e))})}function decode$f(e,t,r,n){let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*r/8|0);let s=0,a=0,l=0;for(let c=0;c<i;++c){const i=t[e[c]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);a=a<<r|i,s+=r,s>=8&&(s-=8,o[l++]=255&a>>s)}if(s>=r||255&a<<8-s)throw new SyntaxError("Unexpected end of data");return o}function encode$d(e,t,r){const n="="===t[t.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let l=0;l<e.length;++l)for(a=a<<8|e[l],s+=8;s>r;)s-=r,o+=t[i&a>>s];if(0!==s&&(o+=t[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o}function createAlphabetIdx(e){const t={};for(let r=0;r<e.length;++r)t[e[r]]=r;return t}function rfc4648({name:e,prefix:t,bitsPerChar:r,alphabet:n}){const i=createAlphabetIdx(n);return from$1({prefix:t,name:e,encode:e=>encode$d(e,n,r),decode:t=>decode$f(t,i,r,e)})}const base32=rfc4648({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper=rfc4648({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad=rfc4648({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper=rfc4648({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex=rfc4648({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper=rfc4648({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad=rfc4648({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper=rfc4648({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z=rfc4648({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$1=Object.freeze(Object.defineProperty({__proto__:null,base32:base32,base32hex:base32hex,base32hexpad:base32hexpad,base32hexpadupper:base32hexpadupper,base32hexupper:base32hexupper,base32pad:base32pad,base32padupper:base32padupper,base32upper:base32upper,base32z:base32z},Symbol.toStringTag,{value:"Module"})),base36=baseX({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper=baseX({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$1=Object.freeze(Object.defineProperty({__proto__:null,base36:base36,base36upper:base36upper},Symbol.toStringTag,{value:"Module"})),base58btc=baseX({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr=baseX({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58=Object.freeze(Object.defineProperty({__proto__:null,base58btc:base58btc,base58flickr:base58flickr},Symbol.toStringTag,{value:"Module"}));var encode_1$1=encode$c,MSB$3=128,REST$3=127,MSBALL$1=~REST$3,INT$1=Math.pow(2,31);function encode$c(e,t,r){t=t||[];for(var n=r=r||0;e>=INT$1;)t[r++]=255&e|MSB$3,e/=128;for(;e&MSBALL$1;)t[r++]=255&e|MSB$3,e>>>=7;return t[r]=0|e,encode$c.bytes=r-n+1,t}var decode$e=read$3,MSB$1$1=128,REST$1$1=127;function read$3(e,t){var r,n=0,i=0,o=t=t||0,s=e.length;do{if(o>=s)throw read$3.bytes=0,new RangeError("Could not decode varint");r=e[o++],n+=i<28?(r&REST$1$1)<<i:(r&REST$1$1)*Math.pow(2,i),i+=7}while(r>=MSB$1$1);return read$3.bytes=o-t,n}var N1$2=Math.pow(2,7),N2$2=Math.pow(2,14),N3$2=Math.pow(2,21),N4$2=Math.pow(2,28),N5$2=Math.pow(2,35),N6$2=Math.pow(2,42),N7$2=Math.pow(2,49),N8$1=Math.pow(2,56),N9$1=Math.pow(2,63),length$2=function(e){return e<N1$2?1:e<N2$2?2:e<N3$2?3:e<N4$2?4:e<N5$2?5:e<N6$2?6:e<N7$2?7:e<N8$1?8:e<N9$1?9:10},varint$2={encode:encode_1$1,decode:decode$e,encodingLength:length$2},_brrp_varint=varint$2;function decode$d(e,t=0){return[_brrp_varint.decode(e,t),_brrp_varint.decode.bytes]}function encodeTo(e,t,r=0){return _brrp_varint.encode(e,t,r),t}function encodingLength$1(e){return _brrp_varint.encodingLength(e)}function create$c(e,t){const r=t.byteLength,n=encodingLength$1(e),i=n+encodingLength$1(r),o=new Uint8Array(i+r);return encodeTo(e,o,0),encodeTo(r,o,n),o.set(t,i),new Digest(e,r,t,o)}function decode$c(e){const t=coerce(e),[r,n]=decode$d(t),[i,o]=decode$d(t.subarray(n)),s=t.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new Digest(r,i,s,t)}function equals(e,t){if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&equals$1(e.bytes,r.bytes)}}class Digest{constructor(e,t,r,n){__publicField(this,"code"),__publicField(this,"size"),__publicField(this,"digest"),__publicField(this,"bytes"),this.code=e,this.size=t,this.digest=r,this.bytes=n}}function format$1(e,t){const{bytes:r,version:n}=e;return 0===n?toStringV0(r,baseCache(e),t??base58btc.encoder):toStringV1(r,baseCache(e),t??base32.encoder)}const cache=new WeakMap;function baseCache(e){const t=cache.get(e);if(null==t){const t=new Map;return cache.set(e,t),t}return t}class CID{constructor(e,t,r,n){__publicField(this,"code"),__publicField(this,"version"),__publicField(this,"multihash"),__publicField(this,"bytes"),__publicField(this,"/"),__publicField(this,_a,"CID"),this.code=t,this.version=e,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return CID.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=create$c(e,t);return CID.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return CID.equals(this,e)}static equals(e,t){const r=t;return null!=r&&e.code===r.code&&e.version===r.version&&equals(e.multihash,r.multihash)}toString(e){return format$1(this,e)}toJSON(){return{"/":format$1(this)}}link(){return this}[(_a=Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom"))](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof CID)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:r,multihash:n,bytes:i}=t;return new CID(e,r,n,i??encodeCID(e,r,n.bytes))}if(!0===t[cidSymbol]){const{version:e,multihash:r,code:n}=t,i=decode$c(r);return CID.create(e,n,i)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new CID(e,t,r,r.bytes);case 1:{const n=encodeCID(e,t,r.bytes);return new CID(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return CID.create(0,DAG_PB_CODE,e)}static createV1(e,t){return CID.create(1,e,t)}static decode(e){const[t,r]=CID.decodeFirst(e);if(0!==r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=CID.inspectBytes(e),r=t.size-t.multihashSize,n=coerce(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=n.subarray(t.multihashSize-t.digestSize),o=new Digest(t.multihashCode,t.digestSize,i,n);return[0===t.version?CID.createV0(o):CID.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=decode$d(e.subarray(t));return t+=n,r};let n=r(),i=DAG_PB_CODE;if(18===n?(n=0,t=0):i=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const o=t,s=r(),a=r(),l=t+a;return{version:n,codec:i,multihashCode:s,digestSize:a,multihashSize:l-o,size:l}}static parse(e,t){const[r,n]=parseCIDtoBytes(e,t),i=CID.decode(n);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return baseCache(i).set(r,e),i}}function parseCIDtoBytes(e,t){switch(e[0]){case"Q":{const r=t??base58btc;return[base58btc.prefix,r.decode(`${base58btc.prefix}${e}`)]}case base58btc.prefix:{const r=t??base58btc;return[base58btc.prefix,r.decode(e)]}case base32.prefix:{const r=t??base32;return[base32.prefix,r.decode(e)]}case base36.prefix:{const r=t??base36;return[base36.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}function toStringV0(e,t,r){const{prefix:n}=r;if(n!==base58btc.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=t.get(n);if(null==i){const i=r.encode(e).slice(1);return t.set(n,i),i}return i}function toStringV1(e,t,r){const{prefix:n}=r,i=t.get(n);if(null==i){const i=r.encode(e);return t.set(n,i),i}return i}const DAG_PB_CODE=112,SHA_256_CODE=18;function encodeCID(e,t,r){const n=encodingLength$1(e),i=n+encodingLength$1(t),o=new Uint8Array(i+r.byteLength);return encodeTo(e,o,0),encodeTo(t,o,n),o.set(r,i),o}const cidSymbol=Symbol.for("@ipld/js-cid/CID"),DEFAULT_MIN_DIGEST_LENGTH=20;function from({name:e,code:t,encode:r,minDigestLength:n,maxDigestLength:i}){return new Hasher(e,t,r,n,i)}class Hasher{constructor(e,t,r,n,i){__publicField(this,"name"),__publicField(this,"code"),__publicField(this,"encode"),__publicField(this,"minDigestLength"),__publicField(this,"maxDigestLength"),this.name=e,this.code=t,this.encode=r,this.minDigestLength=n??DEFAULT_MIN_DIGEST_LENGTH,this.maxDigestLength=i}digest(e,t){if(null!=(null==t?void 0:t.truncate)){if(t.truncate<this.minDigestLength)throw new Error(`Invalid truncate option, must be greater than or equal to ${this.minDigestLength}`);if(null!=this.maxDigestLength&&t.truncate>this.maxDigestLength)throw new Error(`Invalid truncate option, must be less than or equal to ${this.maxDigestLength}`)}if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?createDigest(r,this.code,null==t?void 0:t.truncate):r.then(e=>createDigest(e,this.code,null==t?void 0:t.truncate))}throw Error("Unknown type, must be binary type")}}function createDigest(e,t,r){if(null!=r&&r!==e.byteLength){if(r>e.byteLength)throw new Error(`Invalid truncate option, must be less than or equal to ${e.byteLength}`);e=e.subarray(0,r)}return create$c(t,e)}function readonly({enumerable:e=!0,configurable:t=!1}={}){return{enumerable:e,configurable:t,writable:!1}}function*linksWithin(e,t){if(null!=t&&"object"==typeof t)if(Array.isArray(t))for(const[r,n]of t.entries()){const t=[...e,r],i=CID.asCID(n);null!=i?yield[t.join("/"),i]:"object"==typeof n&&(yield*links$1(n,t))}else{const r=CID.asCID(t);null!=r?yield[e.join("/"),r]:yield*links$1(t,e)}}function*links$1(e,t){if(null==e||e instanceof Uint8Array)return;const r=CID.asCID(e);null!=r&&(yield[t.join("/"),r]);for(const[n,i]of Object.entries(e)){const e=[...t,n];yield*linksWithin(e,i)}}function*treeWithin(e,t){if(Array.isArray(t))for(const[r,n]of t.entries()){const t=[...e,r];yield t.join("/"),"object"==typeof n&&null==CID.asCID(n)&&(yield*tree(n,t))}else yield*tree(t,e)}function*tree(e,t){if(null!=e&&"object"==typeof e)for(const[r,n]of Object.entries(e)){const e=[...t,r];yield e.join("/"),null==n||n instanceof Uint8Array||"object"!=typeof n||null!=CID.asCID(n)||(yield*treeWithin(e,n))}}function get$3(e,t){let r=e;for(const[n,i]of t.entries()){if(r=r[i],null==r)throw new Error(`Object has no property at ${t.slice(0,n+1).map(e=>`[${JSON.stringify(e)}]`).join("")}`);const e=CID.asCID(r);if(null!=e)return{value:e,remaining:t.slice(n+1).join("/")}}return{value:r}}let Block$1=class{constructor({cid:e,bytes:t,value:r}){if(__publicField(this,"cid"),__publicField(this,"bytes"),__publicField(this,"value"),__publicField(this,"asBlock"),null==e||null==t||void 0===r)throw new Error("Missing required argument");this.cid=e,this.bytes=t,this.value=r,this.asBlock=this,Object.defineProperties(this,{cid:readonly(),bytes:readonly(),value:readonly(),asBlock:readonly()})}links(){return links$1(this.value,[])}tree(){return tree(this.value,[])}get(e="/"){return get$3(this.value,e.split("/").filter(Boolean))}};async function encode$b({value:e,codec:t,hasher:r}){if(void 0===e)throw new Error('Missing required argument "value"');if(null==t||null==r)throw new Error("Missing required argument: codec or hasher");const n=t.encode(e),i=await r.digest(n),o=CID.create(1,t.code,i);return new Block$1({value:e,bytes:n,cid:o})}async function decode$b({bytes:e,codec:t,hasher:r}){if(null==e)throw new Error('Missing required argument "bytes"');if(null==t||null==r)throw new Error("Missing required argument: codec or hasher");const n=t.decode(e),i=await r.digest(e),o=CID.create(1,t.code,i);return new Block$1({value:n,bytes:e,cid:o})}function isLink(e){if(null==e)return!1;const t=e;if(null!=t["/"]&&t["/"]===t.bytes)return!0;return e.asCID===e}function parse$1(e,t){return CID.parse(e,t)}function sha(e){return async t=>new Uint8Array(await crypto.subtle.digest(e,t))}const sha256=from({name:"sha2-256",code:18,encode:sha("SHA-256")}),typeofs=["string","number","bigint","symbol"],objectTypeNames=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function is(e){if(null===e)return"null";if(void 0===e)return"undefined";if(!0===e||!1===e)return"boolean";const t=typeof e;if(typeofs.includes(t))return t;if("function"===t)return"Function";if(Array.isArray(e))return"Array";if(isBuffer$1(e))return"Buffer";const r=getObjectType(e);return r||"Object"}function isBuffer$1(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function getObjectType(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(objectTypeNames.includes(t))return t}const useBuffer=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"==typeof globalThis.Buffer.isBuffer,textDecoder$2=new TextDecoder,textEncoder$2=new TextEncoder;function isBuffer(e){return useBuffer&&globalThis.Buffer.isBuffer(e)}function asU8A(e){return e instanceof Uint8Array?isBuffer(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const toString$1=useBuffer?(e,t,r)=>r-t>64?globalThis.Buffer.from(e.subarray(t,r)).toString("utf8"):utf8Slice(e,t,r):(e,t,r)=>r-t>64?textDecoder$2.decode(e.subarray(t,r)):utf8Slice(e,t,r),fromString$1=useBuffer?e=>e.length>64?globalThis.Buffer.from(e):utf8ToBytes(e):e=>e.length>64?textEncoder$2.encode(e):utf8ToBytes(e),fromArray=e=>Uint8Array.from(e),slice$1=useBuffer?(e,t,r)=>isBuffer(e)?new Uint8Array(e.subarray(t,r)):e.slice(t,r):(e,t,r)=>e.slice(t,r),concat$1=useBuffer?(e,t)=>(e=e.map(e=>e instanceof Uint8Array?e:globalThis.Buffer.from(e)),asU8A(globalThis.Buffer.concat(e,t))):(e,t)=>{const r=new Uint8Array(t);let n=0;for(let i of e)n+i.length>r.length&&(i=i.subarray(0,r.length-n)),r.set(i,n),n+=i.length;return r},alloc$1=useBuffer?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function compare$2(e,t){if(isBuffer(e)&&isBuffer(t))return e.compare(t);for(let r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return 0}function utf8ToBytes(e){const t=[];let r=0;for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);i<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=63&i|128):55296==(64512&i)&&n+1<e.length&&56320==(64512&e.charCodeAt(n+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++n)),t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=63&i|128):(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=63&i|128)}return t}function utf8Slice(e,t,r){const n=[];for(;t<r;){const i=e[t];let o=null,s=i>239?4:i>223?3:i>191?2:1;if(t+s<=r){let r,n,a,l;switch(s){case 1:i<128&&(o=i);break;case 2:r=e[t+1],128==(192&r)&&(l=(31&i)<<6|63&r,l>127&&(o=l));break;case 3:r=e[t+1],n=e[t+2],128==(192&r)&&128==(192&n)&&(l=(15&i)<<12|(63&r)<<6|63&n,l>2047&&(l<55296||l>57343)&&(o=l));break;case 4:r=e[t+1],n=e[t+2],a=e[t+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(l=(15&i)<<18|(63&r)<<12|(63&n)<<6|63&a,l>65535&&l<1114112&&(o=l))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),t+=s}return decodeCodePointsArray(n)}const MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(e){const t=e.length;if(t<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=MAX_ARGUMENTS_LENGTH));return r}class Type{constructor(e,t,r){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=r}toString(){return`Type[${this.major}].${this.name}`}equals(e){return this.major===e.major&&this.name===e.name}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}Type.uint=new Type(0,"uint",!0),Type.negint=new Type(1,"negint",!0),Type.bytes=new Type(2,"bytes",!0),Type.string=new Type(3,"string",!0),Type.array=new Type(4,"array",!1),Type.map=new Type(5,"map",!1),Type.tag=new Type(6,"tag",!1),Type.float=new Type(7,"float",!0),Type.false=new Type(7,"false",!0),Type.true=new Type(7,"true",!0),Type.null=new Type(7,"null",!0),Type.undefined=new Type(7,"undefined",!0),Type.break=new Type(7,"break",!0);class Token{constructor(e,t,r){this.type=e,this.value=t,this.encodedLength=r,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}function assertEnoughData(e,t,r,n){if(e.length-t<r)throw new Error(`${n} not enough data for type`)}const uintBoundaries=[24,256,65536,4294967296,BigInt("18446744073709551616")];function readUint8(e,t,r){assertEnoughData(e,t,1,r.decodeErrPrefix);const n=e[t];if(!0===r.strict&&n<uintBoundaries[0])throw new Error(`${r.decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return n}function readUint16(e,t,r){assertEnoughData(e,t,2,r.decodeErrPrefix);const n=e[t]<<8|e[t+1];if(!0===r.strict&&n<uintBoundaries[1])throw new Error(`${r.decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return n}function readUint32(e,t,r){assertEnoughData(e,t,4,r.decodeErrPrefix);const n=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(!0===r.strict&&n<uintBoundaries[2])throw new Error(`${r.decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return n}function readUint64(e,t,r){assertEnoughData(e,t,8,r.decodeErrPrefix);const n=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],i=16777216*e[t+4]+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],o=(BigInt(n)<<BigInt(32))+BigInt(i);if(!0===r.strict&&o<uintBoundaries[3])throw new Error(`${r.decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);if(o<=Number.MAX_SAFE_INTEGER)return Number(o);if(!0===r.allowBigInt)return o;throw new Error(`${r.decodeErrPrefix} integers outside of the safe integer range are not supported`)}function decodeUint8(e,t,r,n){return new Token(Type.uint,readUint8(e,t+1,n),2)}function decodeUint16(e,t,r,n){return new Token(Type.uint,readUint16(e,t+1,n),3)}function decodeUint32(e,t,r,n){return new Token(Type.uint,readUint32(e,t+1,n),5)}function decodeUint64(e,t,r,n){return new Token(Type.uint,readUint64(e,t+1,n),9)}function encodeUint(e,t,{encodeErrPrefix:r}){return encodeUintValue(e,0,t.value,r)}function encodeUintValue(e,t,r,n){if(r<uintBoundaries[0]){const n=Number(r);e.push([t|n])}else if(r<uintBoundaries[1]){const n=Number(r);e.push([24|t,n])}else if(r<uintBoundaries[2]){const n=Number(r);e.push([25|t,n>>>8,255&n])}else if(r<uintBoundaries[3]){const n=Number(r);e.push([26|t,n>>>24&255,n>>>16&255,n>>>8&255,255&n])}else{const i=BigInt(r);if(!(i<uintBoundaries[4]))throw new Error(`${n} encountered BigInt larger than allowable range`);{const r=[27|t,0,0,0,0,0,0,0];let n=Number(i&BigInt(4294967295)),o=Number(i>>BigInt(32)&BigInt(4294967295));r[8]=255&n,n>>=8,r[7]=255&n,n>>=8,r[6]=255&n,n>>=8,r[5]=255&n,r[4]=255&o,o>>=8,r[3]=255&o,o>>=8,r[2]=255&o,o>>=8,r[1]=255&o,e.push(r)}}}function decodeNegint8(e,t,r,n){return new Token(Type.negint,-1-readUint8(e,t+1,n),2)}function decodeNegint16(e,t,r,n){return new Token(Type.negint,-1-readUint16(e,t+1,n),3)}function decodeNegint32(e,t,r,n){return new Token(Type.negint,-1-readUint32(e,t+1,n),5)}encodeUint.encodedSize=function(e){return encodeUintValue.encodedSize(e.value)},encodeUintValue.encodedSize=function(e){return e<uintBoundaries[0]?1:e<uintBoundaries[1]?2:e<uintBoundaries[2]?3:e<uintBoundaries[3]?5:9},encodeUint.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};const neg1b=BigInt(-1),pos1b=BigInt(1);function decodeNegint64(e,t,r,n){const i=readUint64(e,t+1,n);if("bigint"!=typeof i){const e=-1-i;if(e>=Number.MIN_SAFE_INTEGER)return new Token(Type.negint,e,9)}if(!0!==n.allowBigInt)throw new Error(`${n.decodeErrPrefix} integers outside of the safe integer range are not supported`);return new Token(Type.negint,neg1b-BigInt(i),9)}function encodeNegint(e,t,{encodeErrPrefix:r}){const n=t.value,i="bigint"==typeof n?n*neg1b-pos1b:-1*n-1;encodeUintValue(e,t.type.majorEncoded,i,r)}function toToken$3(e,t,r,n,i){assertEnoughData(e,t,r+n,i);const o=slice$1(e,t+r,t+r+n);return new Token(Type.bytes,o,r+n)}function decodeBytesCompact(e,t,r,n){return toToken$3(e,t,1,r,n.decodeErrPrefix)}function decodeBytes8(e,t,r,n){return toToken$3(e,t,2,readUint8(e,t+1,n),n.decodeErrPrefix)}function decodeBytes16(e,t,r,n){return toToken$3(e,t,3,readUint16(e,t+1,n),n.decodeErrPrefix)}function decodeBytes32(e,t,r,n){return toToken$3(e,t,5,readUint32(e,t+1,n),n.decodeErrPrefix)}function decodeBytes64(e,t,r,n){const i=readUint64(e,t+1,n);if("bigint"==typeof i)throw new Error(`${n.decodeErrPrefix} 64-bit integer bytes lengths not supported`);return toToken$3(e,t,9,i,n.decodeErrPrefix)}function tokenBytes(e){return void 0===e.encodedBytes&&(e.encodedBytes=e.type.equals(Type.string)?fromString$1(e.value):e.value),e.encodedBytes}function encodeBytes(e,t,{encodeErrPrefix:r}){const n=tokenBytes(t);encodeUintValue(e,t.type.majorEncoded,n.length,r),e.push(n)}function compareBytes(e,t){return e.length<t.length?-1:e.length>t.length?1:compare$2(e,t)}function toToken$2(e,t,r,n,i){const o=r+n;assertEnoughData(e,t,o,i.decodeErrPrefix);const s=new Token(Type.string,toString$1(e,t+r,t+o),o);return!0===i.retainStringBytes&&(s.byteValue=slice$1(e,t+r,t+o)),s}function decodeStringCompact(e,t,r,n){return toToken$2(e,t,1,r,n)}function decodeString8(e,t,r,n){return toToken$2(e,t,2,readUint8(e,t+1,n),n)}function decodeString16(e,t,r,n){return toToken$2(e,t,3,readUint16(e,t+1,n),n)}function decodeString32(e,t,r,n){return toToken$2(e,t,5,readUint32(e,t+1,n),n)}function decodeString64(e,t,r,n){const i=readUint64(e,t+1,n);if("bigint"==typeof i)throw new Error(`${n.decodeErrPrefix} 64-bit integer string lengths not supported`);return toToken$2(e,t,9,i,n)}encodeNegint.encodedSize=function(e){const t=e.value,r="bigint"==typeof t?t*neg1b-pos1b:-1*t-1;return r<uintBoundaries[0]?1:r<uintBoundaries[1]?2:r<uintBoundaries[2]?3:r<uintBoundaries[3]?5:9},encodeNegint.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0},encodeBytes.encodedSize=function(e){const t=tokenBytes(e);return encodeUintValue.encodedSize(t.length)+t.length},encodeBytes.compareTokens=function(e,t){return compareBytes(tokenBytes(e),tokenBytes(t))};const encodeString=encodeBytes;function toToken$1(e,t,r,n){return new Token(Type.array,n,r)}function decodeArrayCompact(e,t,r,n){return toToken$1(e,t,1,r)}function decodeArray8(e,t,r,n){return toToken$1(e,t,2,readUint8(e,t+1,n))}function decodeArray16(e,t,r,n){return toToken$1(e,t,3,readUint16(e,t+1,n))}function decodeArray32(e,t,r,n){return toToken$1(e,t,5,readUint32(e,t+1,n))}function decodeArray64(e,t,r,n){const i=readUint64(e,t+1,n);if("bigint"==typeof i)throw new Error(`${n.decodeErrPrefix} 64-bit integer array lengths not supported`);return toToken$1(e,t,9,i)}function decodeArrayIndefinite(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${n.decodeErrPrefix} indefinite length items not allowed`);return toToken$1(e,t,1,1/0)}function encodeArray(e,t,{encodeErrPrefix:r}){encodeUintValue(e,Type.array.majorEncoded,t.value,r)}function toToken(e,t,r,n){return new Token(Type.map,n,r)}function decodeMapCompact(e,t,r,n){return toToken(e,t,1,r)}function decodeMap8(e,t,r,n){return toToken(e,t,2,readUint8(e,t+1,n))}function decodeMap16(e,t,r,n){return toToken(e,t,3,readUint16(e,t+1,n))}function decodeMap32(e,t,r,n){return toToken(e,t,5,readUint32(e,t+1,n))}function decodeMap64(e,t,r,n){const i=readUint64(e,t+1,n);if("bigint"==typeof i)throw new Error(`${n.decodeErrPrefix} 64-bit integer map lengths not supported`);return toToken(e,t,9,i)}function decodeMapIndefinite(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${n.decodeErrPrefix} indefinite length items not allowed`);return toToken(e,t,1,1/0)}function encodeMap(e,t,{encodeErrPrefix:r}){encodeUintValue(e,Type.map.majorEncoded,t.value,r)}function decodeTagCompact(e,t,r,n){return new Token(Type.tag,r,1)}function decodeTag8(e,t,r,n){return new Token(Type.tag,readUint8(e,t+1,n),2)}function decodeTag16(e,t,r,n){return new Token(Type.tag,readUint16(e,t+1,n),3)}function decodeTag32(e,t,r,n){return new Token(Type.tag,readUint32(e,t+1,n),5)}function decodeTag64(e,t,r,n){return new Token(Type.tag,readUint64(e,t+1,n),9)}function encodeTag(e,t,{encodeErrPrefix:r}){encodeUintValue(e,Type.tag.majorEncoded,t.value,r)}encodeArray.compareTokens=encodeUint.compareTokens,encodeArray.encodedSize=function(e){return encodeUintValue.encodedSize(e.value)},encodeMap.compareTokens=encodeUint.compareTokens,encodeMap.encodedSize=function(e){return encodeUintValue.encodedSize(e.value)},encodeTag.compareTokens=encodeUint.compareTokens,encodeTag.encodedSize=function(e){return encodeUintValue.encodedSize(e.value)};const MINOR_FALSE=20,MINOR_TRUE=21,MINOR_NULL=22,MINOR_UNDEFINED=23;function decodeUndefined(e,t,r,n){if(!1===n.allowUndefined)throw new Error(`${n.decodeErrPrefix} undefined values are not supported`);return!0===n.coerceUndefinedToNull?new Token(Type.null,null,1):new Token(Type.undefined,void 0,1)}function decodeBreak(e,t,r,n){if(!1===n.allowIndefinite)throw new Error(`${n.decodeErrPrefix} indefinite length items not allowed`);return new Token(Type.break,void 0,1)}function createToken(e,t,r){if(r){if(!1===r.allowNaN&&Number.isNaN(e))throw new Error(`${r.decodeErrPrefix} NaN values are not supported`);if(!1===r.allowInfinity&&(e===1/0||e===-1/0))throw new Error(`${r.decodeErrPrefix} Infinity values are not supported`)}return new Token(Type.float,e,t)}function decodeFloat16(e,t,r,n){return createToken(readFloat16(e,t+1,n.decodeErrPrefix),3,n)}function decodeFloat32(e,t,r,n){return createToken(readFloat32(e,t+1,n.decodeErrPrefix),5,n)}function decodeFloat64(e,t,r,n){return createToken(readFloat64(e,t+1,n.decodeErrPrefix),9,n)}function encodeFloat(e,t,r){const n=t.value;if(!1===n)e.push([Type.float.majorEncoded|MINOR_FALSE]);else if(!0===n)e.push([Type.float.majorEncoded|MINOR_TRUE]);else if(null===n)e.push([Type.float.majorEncoded|MINOR_NULL]);else if(void 0===n)e.push([Type.float.majorEncoded|MINOR_UNDEFINED]);else{let t,i=!1;r&&!0===r.float64||(encodeFloat16(n),t=readFloat16(ui8a,1,r.encodeErrPrefix),n===t||Number.isNaN(n)?(ui8a[0]=249,e.push(ui8a.slice(0,3)),i=!0):(encodeFloat32(n),t=readFloat32(ui8a,1,r.encodeErrPrefix),n===t&&(ui8a[0]=250,e.push(ui8a.slice(0,5)),i=!0))),i||(encodeFloat64(n),t=readFloat64(ui8a,1,r.encodeErrPrefix),ui8a[0]=251,e.push(ui8a.slice(0,9)))}}encodeFloat.encodedSize=function(e,t){const r=e.value;if(!1===r||!0===r||null==r)return 1;if(!t||!0!==t.float64){encodeFloat16(r);let e=readFloat16(ui8a,1,t.encodeErrPrefix);if(r===e||Number.isNaN(r))return 3;if(encodeFloat32(r),e=readFloat32(ui8a,1,t.encodeErrPrefix),r===e)return 5}return 9};const buffer=new ArrayBuffer(9),dataView=new DataView(buffer,1),ui8a=new Uint8Array(buffer,0);function encodeFloat16(e){if(e===1/0)dataView.setUint16(0,31744,!1);else if(e===-1/0)dataView.setUint16(0,64512,!1);else if(Number.isNaN(e))dataView.setUint16(0,32256,!1);else{dataView.setFloat32(0,e);const t=dataView.getUint32(0),r=(2139095040&t)>>23,n=8388607&t;if(255===r)dataView.setUint16(0,31744,!1);else if(0===r)dataView.setUint16(0,(2147483648&e)>>16|n>>13,!1);else{const e=r-127;e<-24?dataView.setUint16(0,0):e<-14?dataView.setUint16(0,(2147483648&t)>>16|1<<24+e,!1):dataView.setUint16(0,(2147483648&t)>>16|e+15<<10|n>>13,!1)}}}function readFloat16(e,t,r){if(e.length-t<2)throw new Error(`${r} not enough data for float16`);const n=(e[t]<<8)+e[t+1];if(31744===n)return 1/0;if(64512===n)return-1/0;if(32256===n)return NaN;const i=n>>10&31,o=1023&n;let s;return s=0===i?o*2**-24:31!==i?(o+1024)*2**(i-25):0===o?1/0:NaN,32768&n?-s:s}function encodeFloat32(e){dataView.setFloat32(0,e,!1)}function readFloat32(e,t,r){if(e.length-t<4)throw new Error(`${r} not enough data for float32`);const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,4).getFloat32(0,!1)}function encodeFloat64(e){dataView.setFloat64(0,e,!1)}function readFloat64(e,t,r){if(e.length-t<8)throw new Error(`${r} not enough data for float64`);const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,8).getFloat64(0,!1)}encodeFloat.compareTokens=encodeUint.compareTokens;const defaultChunkSize=256;class Bl{constructor(e=defaultChunkSize){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){const r=t.length-(this.maxCursor-this.cursor)-1;t.set(e,r)}else{if(t){const e=t.length-(this.maxCursor-this.cursor)-1;e<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,e),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=alloc$1(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,null===this._initReuseChunk&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(1===this.chunks.length){const r=this.chunks[0];e&&this.cursor>r.length/2?(t=this.cursor===r.length?r:r.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=slice$1(r,0,this.cursor)}else t=concat$1(this.chunks,this.cursor);return e&&this.reset(),t}}function invalidMinorWithPrefix(e){return(t,r,n)=>{throw new Error(`${e} encountered invalid minor (${n}) for major ${t[r]>>>5}`)}}function errorer(e,t){return()=>{throw new Error(`${t} ${e}`)}}function jump(e){const t=invalidMinorWithPrefix(e),r=Array(256).fill(t);r[24]=decodeUint8,r[25]=decodeUint16,r[26]=decodeUint32,r[27]=decodeUint64,r[56]=decodeNegint8,r[57]=decodeNegint16,r[58]=decodeNegint32,r[59]=decodeNegint64;for(let n=64;n<=87;n++)r[n]=decodeBytesCompact;r[88]=decodeBytes8,r[89]=decodeBytes16,r[90]=decodeBytes32,r[91]=decodeBytes64,r[95]=errorer("indefinite length bytes/strings are not supported",e);for(let n=96;n<=119;n++)r[n]=decodeStringCompact;r[120]=decodeString8,r[121]=decodeString16,r[122]=decodeString32,r[123]=decodeString64,r[127]=errorer("indefinite length bytes/strings are not supported",e);for(let n=128;n<=151;n++)r[n]=decodeArrayCompact;r[152]=decodeArray8,r[153]=decodeArray16,r[154]=decodeArray32,r[155]=decodeArray64,r[159]=decodeArrayIndefinite;for(let n=160;n<=183;n++)r[n]=decodeMapCompact;r[184]=decodeMap8,r[185]=decodeMap16,r[186]=decodeMap32,r[187]=decodeMap64,r[191]=decodeMapIndefinite;for(let n=192;n<=215;n++)r[n]=decodeTagCompact;r[216]=decodeTag8,r[217]=decodeTag16,r[218]=decodeTag32,r[219]=decodeTag64;for(let n=224;n<=243;n++)r[n]=errorer("simple values are not supported",e);return r[247]=decodeUndefined,r[248]=errorer("simple values are not supported",e),r[249]=decodeFloat16,r[250]=decodeFloat32,r[251]=decodeFloat64,r[255]=decodeBreak,r}const quick=[];for(let e=0;e<24;e++)quick[e]=new Token(Type.uint,e,1);for(let e=-1;e>=-24;e--)quick[31-e]=new Token(Type.negint,e,1);function quickEncodeToken(e){switch(e.type){case Type.false:return fromArray([244]);case Type.true:return fromArray([245]);case Type.null:return fromArray([246]);case Type.bytes:return e.value.length?void 0:fromArray([64]);case Type.string:return""===e.value?fromArray([96]):void 0;case Type.array:return 0===e.value?fromArray([128]):void 0;case Type.map:return 0===e.value?fromArray([160]):void 0;case Type.uint:return e.value<24?fromArray([Number(e.value)]):void 0;case Type.negint:if(e.value>=-24)return fromArray([31-Number(e.value)])}}quick[64]=new Token(Type.bytes,new Uint8Array(0),1),quick[96]=new Token(Type.string,"",1),quick[128]=new Token(Type.array,0,1),quick[160]=new Token(Type.map,0,1),quick[244]=new Token(Type.false,!1,1),quick[245]=new Token(Type.true,!0,1),quick[246]=new Token(Type.null,null,1);const defaultEncodeOptions$2={float64:!1,mapSorter:mapSorter$1,quickEncodeToken:quickEncodeToken,encodeErrPrefix:"CBOR encode error:"};function makeCborEncoders(){const e=[];return e[Type.uint.major]=encodeUint,e[Type.negint.major]=encodeNegint,e[Type.bytes.major]=encodeBytes,e[Type.string.major]=encodeString,e[Type.array.major]=encodeArray,e[Type.map.major]=encodeMap,e[Type.tag.major]=encodeTag,e[Type.float.major]=encodeFloat,e}const cborEncoders$1=makeCborEncoders(),buf=new Bl;class Ref{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do{if(t.obj===e)return!0}while(t=t.parent);return!1}static createCheck(e,t,{encodeErrPrefix:r}){if(e&&e.includes(t))throw new Error(`${r} object contains circular references`);return new Ref(t,e)}}const simpleTokens={null:new Token(Type.null,null),undefined:new Token(Type.undefined,void 0),true:new Token(Type.true,!0),false:new Token(Type.false,!1),emptyArray:new Token(Type.array,0),emptyMap:new Token(Type.map,0)},typeEncoders={number:(e,t,r,n)=>Number.isInteger(e)&&Number.isSafeInteger(e)?new Token(e>=0?Type.uint:Type.negint,e):new Token(Type.float,e),bigint:(e,t,r,n)=>e>=BigInt(0)?new Token(Type.uint,e):new Token(Type.negint,e),Uint8Array:(e,t,r,n)=>new Token(Type.bytes,e),string:(e,t,r,n)=>new Token(Type.string,e),boolean:(e,t,r,n)=>e?simpleTokens.true:simpleTokens.false,null:(e,t,r,n)=>simpleTokens.null,undefined:(e,t,r,n)=>simpleTokens.undefined,ArrayBuffer:(e,t,r,n)=>new Token(Type.bytes,new Uint8Array(e)),DataView:(e,t,r,n)=>new Token(Type.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),Array(e,t,r,n){if(!e.length)return!0===r.addBreakTokens?[simpleTokens.emptyArray,new Token(Type.break)]:simpleTokens.emptyArray;n=Ref.createCheck(n,e,r);const i=[];let o=0;for(const s of e)i[o++]=objectToTokens(s,r,n);return r.addBreakTokens?[new Token(Type.array,e.length),i,new Token(Type.break)]:[new Token(Type.array,e.length),i]},Object(e,t,r,n){const i="Object"!==t,o=i?e.keys():Object.keys(e),s=i?e.size:o.length;if(!s)return!0===r.addBreakTokens?[simpleTokens.emptyMap,new Token(Type.break)]:simpleTokens.emptyMap;n=Ref.createCheck(n,e,r);const a=[];let l=0;for(const c of o)a[l++]=[objectToTokens(c,r,n),objectToTokens(i?e.get(c):e[c],r,n)];return sortMapEntries(a,r),r.addBreakTokens?[new Token(Type.map,s),a,new Token(Type.break)]:[new Token(Type.map,s),a]}};typeEncoders.Map=typeEncoders.Object,typeEncoders.Buffer=typeEncoders.Uint8Array;for(const e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))typeEncoders[`${e}Array`]=typeEncoders.DataView;function objectToTokens(e,t,r){const n=is(e),i=t&&t.typeEncoders&&t.typeEncoders[n]||typeEncoders[n];if("function"==typeof i){const o=i(e,n,t,r);if(null!=o)return o}const o=typeEncoders[n];if(!o)throw new Error(`${t.encodeErrPrefix} unsupported type: ${n}`);return o(e,n,t,r)}function sortMapEntries(e,t){t.mapSorter&&e.sort(t.mapSorter)}function mapSorter$1(e,t){const r=Array.isArray(e[0])?e[0][0]:e[0],n=Array.isArray(t[0])?t[0][0]:t[0];if(r.type!==n.type)return r.type.compare(n.type);const i=r.type.major,o=cborEncoders$1[i].compareTokens(r,n);return 0===o&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),o}function tokensToEncoded(e,t,r,n){if(Array.isArray(t))for(const i of t)tokensToEncoded(e,i,r,n);else r[t.type.major](e,t,n)}function encodeCustom(e,t,r){const n=objectToTokens(e,r);if(!Array.isArray(n)&&r.quickEncodeToken){const e=r.quickEncodeToken(n);if(e)return e;const i=t[n.type.major];if(i.encodedSize){const e=i.encodedSize(n,r),t=new Bl(e);if(i(t,n,r),1!==t.chunks.length)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return asU8A(t.chunks[0])}}return buf.reset(),tokensToEncoded(buf,n,t,r),buf.toBytes(!0)}function encode$a(e,t){return t=Object.assign({},defaultEncodeOptions$2,t),encodeCustom(e,cborEncoders$1,t)}const defaultDecodeOptions={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0,decodeErrPrefix:"CBOR decode error:"};class Tokeniser{constructor(e,t){this._pos=0,this.data=e,this.options=t,this.jump=jump(t.decodeErrPrefix)}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const e=this.data[this._pos];let t=quick[e];if(void 0===t){const r=this.jump[e];if(!r)throw new Error(`${this.options.decodeErrPrefix} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);const n=31&e;t=r(this.data,this._pos,n,this.options)}return this._pos+=t.encodedLength,t}}const DONE=Symbol.for("DONE"),BREAK=Symbol.for("BREAK");function tokenToArray(e,t,r){const n=[];for(let i=0;i<e.value;i++){const o=tokensToObject(t,r);if(o===BREAK){if(e.value===1/0)break;throw new Error(`${r.decodeErrPrefix} got unexpected break to lengthed array`)}if(o===DONE)throw new Error(`${r.decodeErrPrefix} found array but not enough entries (got ${i}, expected ${e.value})`);n[i]=o}return n}function tokenToMap(e,t,r){const n=!0===r.useMaps,i=n?void 0:{},o=n?new Map:void 0;for(let s=0;s<e.value;s++){const a=tokensToObject(t,r);if(a===BREAK){if(e.value===1/0)break;throw new Error(`${r.decodeErrPrefix} got unexpected break to lengthed map`)}if(a===DONE)throw new Error(`${r.decodeErrPrefix} found map but not enough entries (got ${s} [no key], expected ${e.value})`);if(!0!==n&&"string"!=typeof a)throw new Error(`${r.decodeErrPrefix} non-string keys not supported (got ${typeof a})`);if(!0===r.rejectDuplicateMapKeys&&(n&&o.has(a)||!n&&a in i))throw new Error(`${r.decodeErrPrefix} found repeat map key "${a}"`);const l=tokensToObject(t,r);if(l===DONE)throw new Error(`${r.decodeErrPrefix} found map but not enough entries (got ${s} [no value], expected ${e.value})`);n?o.set(a,l):i[a]=l}return n?o:i}function tokensToObject(e,t){if(e.done())return DONE;const r=e.next();if(r.type.equals(Type.break))return BREAK;if(r.type.terminal)return r.value;if(r.type.equals(Type.array))return tokenToArray(r,e,t);if(r.type.equals(Type.map))return tokenToMap(r,e,t);if(r.type.equals(Type.tag)){if(t.tags&&"function"==typeof t.tags[r.value]){const n=tokensToObject(e,t);return t.tags[r.value](n)}throw new Error(`${t.decodeErrPrefix} tag not supported (${r.value})`)}throw new Error("unsupported")}function decodeFirst(e,t){if(t=Object.assign({},defaultDecodeOptions,t),!(e instanceof Uint8Array))throw new Error(`${t.decodeErrPrefix} data to decode must be a Uint8Array`);const r=t.tokenizer||new Tokeniser(e,t),n=tokensToObject(r,t);if(n===DONE)throw new Error(`${t.decodeErrPrefix} did not find any content to decode`);if(n===BREAK)throw new Error(`${t.decodeErrPrefix} got unexpected break`);return[n,e.subarray(r.pos())]}function decode$a(e,t){t=Object.assign({},defaultDecodeOptions,t);const[r,n]=decodeFirst(e,t);if(n.length>0)throw new Error(`${t.decodeErrPrefix} too many terminals, data makes no sense:${n.length}`);return r}const CID_CBOR_TAG=42;function toByteView$2(e){return e instanceof ArrayBuffer?new Uint8Array(e,0,e.byteLength):e}function cidEncoder$1(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;const t=CID.asCID(e);if(!t)return null;const r=new Uint8Array(t.bytes.byteLength+1);return r.set(t.bytes,1),[new Token(Type.tag,CID_CBOR_TAG),new Token(Type.bytes,r)]}function undefinedEncoder$1(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function numberEncoder$1(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const _encodeOptions={float64:!0,typeEncoders:{Object:cidEncoder$1,undefined:undefinedEncoder$1,number:numberEncoder$1}},encodeOptions$1={..._encodeOptions,typeEncoders:{..._encodeOptions.typeEncoders}};function cidDecoder(e){if(0!==e[0])throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return CID.decode(e.subarray(1))}const _decodeOptions={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};_decodeOptions.tags[CID_CBOR_TAG]=cidDecoder;const decodeOptions$1={..._decodeOptions,tags:_decodeOptions.tags.slice()},name$4="dag-cbor",code$6=113,encode$9=e=>encode$a(e,_encodeOptions),decode$9=e=>decode$a(toByteView$2(e),_decodeOptions),codec2=Object.freeze(Object.defineProperty({__proto__:null,code:code$6,decode:decode$9,decodeOptions:decodeOptions$1,encode:encode$9,encodeOptions:encodeOptions$1,name:name$4,toByteView:toByteView$2},Symbol.toStringTag,{value:"Module"})),advance=async(e,t,r)=>{const n=new EventFetcher(e),i=new Map(t.map(e=>[e.toString(),e]));if(i.has(r.toString()))return t;let o=!1;for(const s of t)await contains(n,r,s)&&(i.delete(s.toString()),i.set(r.toString(),r),o=!0);if(o)return[...i.values()];for(const s of t)if(await contains(n,s,r))return t;return t.concat(r)};class EventBlock extends Block$1{constructor({cid:e,value:t,bytes:r,prefix:n}){super({cid:e,value:t,bytes:r}),this.prefix=n}static create(e,t){return encodeEventBlock({data:e,parents:t??[]})}}class EventFetcher{constructor(e){this._blocks=e}async get(e){const t=await this._blocks.get(e);if(!t)throw new Error(`missing block: ${e}`);return decodeEventBlock(t.bytes)}}const encodeEventBlock=async e=>{const{cid:t,bytes:r}=await encode$b({value:e,codec:codec2,hasher:sha256});return new Block$1({cid:t,value:e,bytes:r})},decodeEventBlock=async e=>{const{cid:t,value:r}=await decode$b({bytes:e,codec:codec2,hasher:sha256});return new Block$1({cid:t,value:r,bytes:e})},contains=async(e,t,r)=>{if(t.toString()===r.toString())return!0;const[{value:n},{value:i}]=await Promise.all([e.get(t),e.get(r)]),o=[...n.parents],s=new Set;for(;o.length;){const t=o.shift();if(!t)break;if(t.toString()===r.toString())return!0;if(i.parents.some(e=>t.toString()===e.toString()))continue;if(s.has(t.toString()))continue;s.add(t.toString());const{value:n}=await e.get(t);o.push(...n.parents)}return!1},vis=async function*(e,t,r={}){const n=r.renderNodeLabel??(e=>shortLink(e.cid)),i=new EventFetcher(e);yield"digraph clock {",yield'  node [shape=point fontname="Courier"]; head;';const o=await Promise.all(t.map(e=>i.get(e))),s=[],a=new Set;for(const l of o){a.add(l.cid.toString()),yield`  node [shape=oval fontname="Courier"]; ${l.cid} [label="${n(l)}"];`,yield`  head -> ${l.cid};`;for(const e of l.value.parents)yield`  ${l.cid} -> ${e};`;s.push(...l.value.parents)}for(;s.length;){const e=s.shift();if(!e)break;if(a.has(e.toString()))continue;a.add(e.toString());const t=await i.get(e);yield`  node [shape=oval]; ${e} [label="${n(t)}" fontname="Courier"];`;for(const r of t.value.parents)yield`  ${e} -> ${r};`;s.push(...t.value.parents)}yield"}"},shortLink=e=>`${String(e).slice(0,4)}..${String(e).slice(-4)}`,KeyCharsASCII="ascii",MaxKeySize=4096;class ShardBlock extends Block$1{constructor({cid:e,value:t,bytes:r}){super({cid:e,value:t,bytes:r})}static create(e){return encodeBlock(create$b(e))}}const create$b=e=>({entries:[],...configure$2(e)}),configure$2=e=>({version:1,keyChars:(null==e?void 0:e.keyChars)??KeyCharsASCII,maxKeySize:(null==e?void 0:e.maxKeySize)??MaxKeySize,prefix:(null==e?void 0:e.prefix)??""}),withEntries=(e,t)=>({...create$b(t),entries:e}),decodeCache=new WeakMap,encodeBlock=async e=>{const{cid:t,bytes:r}=await encode$b({value:e,codec:codec2,hasher:sha256}),n=new ShardBlock({cid:t,value:e,bytes:r});return decodeCache.set(n.bytes,n),n},decodeBlock=async e=>{const t=decodeCache.get(e);if(t)return t;const{cid:r,value:n}=await decode$b({bytes:e,codec:codec2,hasher:sha256});if(!isShard(n))throw new Error(`invalid shard: ${r}`);return new ShardBlock({cid:r,value:n,bytes:e})},isShard=e=>null!=e&&"object"==typeof e&&Array.isArray(e.entries)&&1===e.version&&"number"==typeof e.maxKeySize&&"string"==typeof e.keyChars&&"string"==typeof e.prefix,isShardLink=e=>isLink(e)&&e.code===code$6;class ShardFetcher{constructor(e){this._blocks=e}async get(e){const t=await this._blocks.get(e);if(!t)throw new Error(`missing block: ${e}`);return decodeBlock(t.bytes)}}const putEntry=(e,t)=>{const r=[];for(const[n,i]of e.entries()){const[o,s]=i;if(t[0]===o){Array.isArray(t[1])?Array.isArray(s)&&null!=s[1]&&null==t[1][1]?r.push([o,[t[1][0],s[1]]]):r.push(t):Array.isArray(s)?r.push([o,[s[0],t[1]]]):r.push(t);for(let t=n+1;t<e.length;t++)r.push(e[t]);return r}if(0===n&&t[0]<o){r.push(t);for(let t=n;t<e.length;t++)r.push(e[t]);return r}if(n>0&&t[0]>e[n-1][0]&&t[0]<o){r.push(t);for(let t=n;t<e.length;t++)r.push(e[t]);return r}r.push(i)}return r.push(t),r},isPrintableASCII=e=>/^[\x20-\x7E]*$/.test(e),put$2=async(e,t,r,n)=>{const i=new ShardFetcher(e),o=await i.get(t);if(o.value.keyChars!==KeyCharsASCII)throw new Error(`unsupported key character set: ${o.value.keyChars}`);if(!isPrintableASCII(r))throw new Error("key contains non-ASCII characters");if((new TextEncoder).encode(r).length>o.value.maxKeySize)throw new Error(`UTF-8 encoded key exceeds max size of ${o.value.maxKeySize} bytes`);const s=await traverse$1(i,o,r),a=s[s.length-1],l=r.slice(a.value.prefix.length);let c=[l,n],u=[...a.value.entries];const d=[];for(const[p,y]of u.entries()){const[e,t]=y;if(e===l)break;const r=e.length<l.length?e:l,i=r===e?l:e;let o="";for(const n of r){const e=o+n;if(!i.startsWith(e))break;o=e}if(o.length){let r=[];o!==l&&(r=putEntry(r,[l.slice(o.length),n])),o!==e&&(r=putEntry(r,[e.slice(o.length),t]));let i=await encodeBlock(withEntries(r,{...a.value,prefix:a.value.prefix+o}));d.push(i);const s=[...o];for(let c=s.length-1;c>0;c--){const r={...a.value,prefix:a.value.prefix+s.slice(0,c).join("")};let u;if(c===s.length-1&&o===e){if(Array.isArray(t))throw new Error("found a shard link when expecting a value");u=[i.cid,t]}else u=c===s.length-1&&o===l?[i.cid,n]:[i.cid];const h=await encodeBlock(withEntries([[s[c],u]],r));d.push(h),i=h}if(u.splice(p,1),1===s.length&&o===e){if(Array.isArray(t))throw new Error("found a shard link when expecting a value");c=[s[0],[i.cid,t]]}else c=1===s.length&&o===l?[s[0],[i.cid,n]]:[s[0],[i.cid]];break}}const h=withEntries(putEntry(u,c),a.value);let f=await encodeBlock(h);if(f.cid.toString()===a.cid.toString())return{root:t,additions:[],removals:[]};d.push(f);for(let p=s.length-2;p>=0;p--){const e=s[p],t=f.value.prefix.slice(e.value.prefix.length),r=withEntries(e.value.entries.map(r=>{const[n,i]=r;if(n!==t)return r;if(!Array.isArray(i))throw new Error(`"${t}" is not a shard link in: ${e.cid}`);return null==i[1]?[n,[f.cid]]:[n,[f.cid,i[1]]]}),e.value);f=await encodeBlock(r),d.push(f)}return{root:d[d.length-1].cid,additions:d,removals:s}},get$2=async(e,t,r)=>{const n=new ShardFetcher(e),i=await n.get(t),o=await traverse$1(n,i,r),s=o[o.length-1],a=r.slice(s.value.prefix.length),l=s.value.entries.find(([e])=>e===a);if(l)return Array.isArray(l[1])?l[1][1]:l[1]},del=async(e,t,r)=>{const n=new ShardFetcher(e),i=await n.get(t),o=await traverse$1(n,i,r),s=o[o.length-1],a=r.slice(s.value.prefix.length),l=s.value.entries.findIndex(([e])=>e===a);if(-1===l)return{root:t,additions:[],removals:[]};const c=s.value.entries[l];if(Array.isArray(c[1])&&null==c[1][1])return{root:t,additions:[],removals:[]};const u=[],d=[...o];let h=withEntries([...s.value.entries],s.value);if(Array.isArray(c[1]))h.entries[l]=[c[0],[c[1][0]]];else for(h.entries.splice(l,1);!h.entries.length;){const e=o[o.length-1],t=o[o.length-2];if(!t)break;o.pop(),h=withEntries(t.value.entries.filter(t=>!Array.isArray(t[1])||t[1][0].toString()!==e.cid.toString()),t.value)}let f=await encodeBlock(h);u.push(f);for(let p=o.length-2;p>=0;p--){const e=o[p],t=f.value.prefix.slice(e.value.prefix.length),r=withEntries(e.value.entries.map(r=>{const[n,i]=r;if(n!==t)return r;if(!Array.isArray(i))throw new Error(`"${t}" is not a shard link in: ${e.cid}`);return null==i[1]?[n,[f.cid]]:[n,[f.cid,i[1]]]}),e.value);f=await encodeBlock(r),u.push(f)}return{root:u[u.length-1].cid,additions:u,removals:d}},isKeyPrefixOption=e=>{const t=e??{};return"prefix"in t&&Boolean(t.prefix)},isKeyRangeOption=e=>{const t=e??{};return"gt"in t&&Boolean(t.gt)||"gte"in t&&Boolean(t.gte)||"lt"in t&&Boolean(t.lt)||"lte"in t&&Boolean(t.lte)},isKeyLowerBoundRangeOption=e=>"gt"in e&&Boolean(e.gt)||"gte"in e&&Boolean(e.gte),isKeyLowerBoundRangeInclusiveOption=e=>"gte"in e&&Boolean(e.gte),isKeyLowerBoundRangeExclusiveOption=e=>"gt"in e&&Boolean(e.gt),isKeyUpperBoundRangeOption=e=>"lt"in e&&Boolean(e.lt)||"lte"in e&&Boolean(e.lte),isKeyUpperBoundRangeInclusiveOption=e=>"lte"in e&&Boolean(e.lte),isKeyUpperBoundRangeExclusiveOption=e=>"lt"in e&&Boolean(e.lt),entries$1=async function*(e,t,r){const n=isKeyPrefixOption(r),i=isKeyRangeOption(r),o=i&&isKeyLowerBoundRangeOption(r),s=o&&isKeyLowerBoundRangeInclusiveOption(r),a=o&&isKeyLowerBoundRangeExclusiveOption(r),l=i&&isKeyUpperBoundRangeOption(r),c=l&&isKeyUpperBoundRangeInclusiveOption(r),u=l&&isKeyUpperBoundRangeExclusiveOption(r),d=o&&l,h=new ShardFetcher(e),f=await h.get(t);yield*async function*e(t){for(const o of t.value.entries){const l=t.value.prefix+o[0];if(Array.isArray(o[1])){if(o[1][1]&&(n&&l.startsWith(r.prefix)||d&&(a&&l>r.gt||s&&l>=r.gte)&&(u&&l<r.lt||c&&l<=r.lte)||a&&l>r.gt||s&&l>=r.gte||u&&l<r.lt||c&&l<=r.lte||!n&&!i)&&(yield[l,o[1][1]]),n){if(r.prefix.length<=l.length&&!l.startsWith(r.prefix))continue;if(r.prefix.length>l.length&&!r.prefix.startsWith(l))continue}else if(a&&trunc(l,Math.min(l.length,r.gt.length))<trunc(r.gt,Math.min(l.length,r.gt.length))||s&&trunc(l,Math.min(l.length,r.gte.length))<trunc(r.gte,Math.min(l.length,r.gte.length))||u&&trunc(l,Math.min(l.length,r.lt.length))>trunc(r.lt,Math.min(l.length,r.lt.length))||c&&trunc(l,Math.min(l.length,r.lte.length))>trunc(r.lte,Math.min(l.length,r.lte.length)))continue;yield*e(await h.get(o[1][0]))}else(n&&l.startsWith(r.prefix)||i&&d&&(a&&l>r.gt||s&&l>=r.gte)&&(u&&l<r.lt||c&&l<=r.lte)||i&&!d&&(a&&l>r.gt||s&&l>=r.gte||u&&l<r.lt||c&&l<=r.lte)||!n&&!i)&&(yield[l,o[1]])}}(f)},trunc=(e,t)=>e.length<=t?e:e.slice(0,t),traverse$1=async(e,t,r)=>{for(const[n,i]of t.value.entries){if(r===n)return[t];if(r.startsWith(n)&&Array.isArray(i)){return[t,...await traverse$1(e,await e.get(i[0]),r.slice(n.length))]}}return[t]};class MemoryBlockstore{constructor(e){__privateAdd2(this,_blocks,new Map),e&&__privateSet2(this,_blocks,new Map(e.map(e=>[e.cid.toString(),e.bytes])))}async get(e){const t=__privateGet2(this,_blocks).get(e.toString());if(t)return{cid:e,bytes:t}}async put(e,t){__privateGet2(this,_blocks).set(e.toString(),t)}putSync(e,t){__privateGet2(this,_blocks).set(e.toString(),t)}async delete(e){__privateGet2(this,_blocks).delete(e.toString())}deleteSync(e){__privateGet2(this,_blocks).delete(e.toString())}*entries(){for(const[e,t]of __privateGet2(this,_blocks))yield{cid:parse$1(e),bytes:t}}}_blocks=new WeakMap;class MultiBlockFetcher{constructor(...e){__privateAdd2(this,_fetchers,void 0),__privateSet2(this,_fetchers,e)}async get(e){for(const t of __privateGet2(this,_fetchers)){const r=await t.get(e);if(r)return r}}}_fetchers=new WeakMap;const create$a=e=>({base:null==e?void 0:e.base,entries:[...(null==e?void 0:e.entries)??[]],...configure$2(e)});let Batcher$1=(_b=class{constructor({blocks:e,entries:t,prefix:r,version:n,keyChars:i,maxKeySize:o,base:s}){__privateAdd2(this,_committed,!1),this.blocks=e,this.prefix=r,this.entries=[...t],this.base=s,this.version=n,this.keyChars=i,this.maxKeySize=o}async put(e,t){if(__privateGet2(this,_committed))throw new BatchCommittedError;return put$1(this.blocks,this,e,t)}async commit(){if(__privateGet2(this,_committed))throw new BatchCommittedError;return __privateSet2(this,_committed,!0),commit$1(this)}static async create({blocks:e,link:t}){const r=new ShardFetcher(e),n=await r.get(t);return new _b({blocks:e,base:n,...n.value})}},_committed=new WeakMap,_b);const put$1=async(e,t,r,n)=>{if(t.keyChars!==KeyCharsASCII)throw new Error(`unsupported key character set: ${t.keyChars}`);if(!isPrintableASCII(r))throw new Error("key contains non-ASCII characters");if((new TextEncoder).encode(r).length>t.maxKeySize)throw new Error(`UTF-8 encoded key exceeds max size of ${t.maxKeySize} bytes`);const i=new ShardFetcher(e),o=await traverse(i,t,r);o.shard!==t&&(t=o.shard,r=o.key);let s=[o.key,n],a=[...o.shard.entries];for(const[l,c]of a.entries()){const[e,t]=c;if(e===o.key)break;const r=e.length<o.key.length?e:o.key,i=r===e?o.key:e;let u="";for(const n of r){const e=u+n;if(!i.startsWith(e))break;u=e}if(u.length){let r=[];u!==o.key&&(r=putEntry(r,[o.key.slice(u.length),n])),u!==e&&(r=putEntry(r,asShardEntry([e.slice(u.length),t])));let i=create$a({...configure$2(o.shard),prefix:o.shard.prefix+u,entries:r});const c=[...u];for(let s=c.length-1;s>0;s--){let r;if(s===c.length-1&&u===e){if(Array.isArray(t))throw new Error("found a shard link when expecting a value");r=[i,t]}else r=s===c.length-1&&u===o.key?[i,n]:[i];i=create$a({...configure$2(o.shard),prefix:o.shard.prefix+c.slice(0,s).join(""),entries:[[c[s],r]]})}if(a.splice(l,1),1===c.length&&u===e){if(Array.isArray(t))throw new Error("found a shard link when expecting a value");s=[c[0],[i,t]]}else s=1===c.length&&u===o.key?[c[0],[i,n]]:[c[0],[i]];break}}t.entries=putEntry(asShardEntries(a),asShardEntry(s))},traverse=async(e,t,r)=>{for(let n=0;n<t.entries.length;n++){const[i,o]=t.entries[n];if(r<=i)break;if(r.startsWith(i)&&Array.isArray(o)){if(isShardLink(o[0])){const s=await e.get(o[0]),a=create$a({base:s,...s.value});return t.entries[n]=[i,null==o[1]?[a]:[a,o[1]]],traverse(e,a,r.slice(i.length))}return traverse(e,o[0],r.slice(i.length))}}return{shard:t,key:r}},commit$1=async e=>{const t=[],r=[],n=[];for(const o of e.entries)if(Array.isArray(o[1])&&!isShardLink(o[1][0])){const e=await commit$1(o[1][0]);n.push([o[0],null==o[1][1]?[e.root]:[e.root,o[1][1]]]),t.push(...e.additions),r.push(...e.removals)}else n.push(asShardEntry(o));const i=await encodeBlock(withEntries(n,e));return t.push(i),e.base&&e.base.cid.toString()===i.cid.toString()?{root:i.cid,additions:[],removals:[]}:(e.base&&r.push(e.base),{root:i.cid,additions:t,removals:r})},asShardEntries=e=>e,asShardEntry=e=>e,create$9=(e,t)=>Batcher$1.create({blocks:e,link:t}),_BatchCommittedError=class e extends Error{constructor(t,r){super(t??"batch already committed",r),this.code=e.code}};__publicField(_BatchCommittedError,"code","ERR_BATCH_COMMITTED");let BatchCommittedError=_BatchCommittedError;const put=async(e,t,r,n)=>{const i=new MemoryBlockstore;if(e=new MultiBlockFetcher(i,e),!t.length){const o=await ShardBlock.create();i.putSync(o.cid,o.bytes);const s=await put$2(e,o.cid,r,n),a={type:"put",root:s.root,key:r,value:n},l=await EventBlock.create(a,t);return t=await advance(e,t,l.cid),{root:s.root,additions:[o,...s.additions],removals:s.removals,head:t,event:l}}const o=new EventFetcher(e),s=await findCommonAncestor(o,t);if(!s)throw new Error("failed to find common ancestor event");const a=await o.get(s);let{root:l}=a.value.data;const c=await findSortedEvents(o,t,s),u=new Map,d=new Map;for(const{value:y}of c){let t;if("put"===y.data.type)t=await put$2(e,l,y.data.key,y.data.value);else if("del"===y.data.type)t=await del(e,l,y.data.key);else{if("batch"!==y.data.type)throw new Error(`unknown operation: ${y.data.type}`);{const r=await create$9(e,l);for(const e of y.data.ops){if("put"!==e.type)throw new Error(`unsupported batch operation: ${e.type}`);await r.put(e.key,e.value)}t=await r.commit()}}l=t.root;for(const e of t.additions)i.putSync(e.cid,e.bytes),u.set(e.cid.toString(),e);for(const e of t.removals)d.set(e.cid.toString(),e)}const h=await put$2(e,l,r,n);if(h.root.toString()===l.toString())return{root:l,additions:[],removals:[],head:t};for(const y of h.additions)i.putSync(y.cid,y.bytes),u.set(y.cid.toString(),y);for(const y of h.removals)d.set(y.cid.toString(),y);const f={type:"put",root:h.root,key:r,value:n},p=await EventBlock.create(f,t);i.putSync(p.cid,p.bytes),t=await advance(e,t,p.cid);for(const y of d.keys())u.has(y)&&(u.delete(y),d.delete(y));return{root:h.root,additions:[...u.values()],removals:[...d.values()],head:t,event:p}},root=async(e,t)=>{if(!t.length)throw new Error("cannot determine root of headless clock");const r=new MemoryBlockstore;e=new MultiBlockFetcher(r,e);const n=new EventFetcher(e);if(1===t.length){const e=await n.get(t[0]),{root:r}=e.value.data;return{root:r,additions:[],removals:[]}}const i=await findCommonAncestor(n,t);if(!i)throw new Error("failed to find common ancestor event");const o=await n.get(i);let{root:s}=o.value.data;const a=await findSortedEvents(n,t,i),l=new Map,c=new Map;for(const{value:u}of a){let t;if("put"===u.data.type)t=await put$2(e,s,u.data.key,u.data.value);else if("del"===u.data.type)t=await del(e,s,u.data.key);else{if("batch"!==u.data.type)throw new Error(`unknown operation: ${u.data.type}`);{const r=await create$9(e,s);for(const e of u.data.ops){if("put"!==e.type)throw new Error(`unsupported batch operation: ${e.type}`);await r.put(e.key,e.value)}t=await r.commit()}}s=t.root;for(const e of t.additions)r.putSync(e.cid,e.bytes),l.set(e.cid.toString(),e);for(const e of t.removals)c.set(e.cid.toString(),e)}for(const u of c.keys())l.has(u)&&(l.delete(u),c.delete(u));return{root:s,additions:[...l.values()],removals:[...c.values()]}},get$1=async(e,t,r)=>{if(!t.length)return;const n=await root(e,t);return n.additions.length&&(e=new MultiBlockFetcher(new MemoryBlockstore(n.additions),e)),get$2(e,n.root,r)},entries=async function*(e,t,r){if(!t.length)return;const n=await root(e,t);n.additions.length&&(e=new MultiBlockFetcher(new MemoryBlockstore(n.additions),e)),yield*entries$1(e,n.root,r)},findCommonAncestor=async(e,t)=>{if(!t.length)return;const r=t.map(e=>[e]);for(;;){let t=!1;for(const n of r){const i=await findAncestorCandidate(e,n[n.length-1]);if(!i)continue;t=!0,n.push(i);const o=findCommonString(r);if(o)return o}if(!t)return}},findAncestorCandidate=async(e,t)=>{const{value:r}=await e.get(t);return r.parents.length?1===r.parents.length?r.parents[0]:findCommonAncestor(e,r.parents):t},findCommonString=e=>{e=e.map(e=>[...e]);for(const t of e)for(const r of t){let n=!0;for(const i of e)if(t!==i&&(n=i.some(e=>String(e)===String(r)),!n))break;if(n)return r}},findSortedEvents=async(e,t,r)=>{if(1===t.length&&t[0].toString()===r.toString())return[];const n=new Map,i=await Promise.all(t.map(t=>findEvents(e,t,r)));for(const s of i)for(const{event:e,depth:t}of s){const r=n.get(e.cid.toString());r?r.weight+=t:n.set(e.cid.toString(),{event:e,weight:t})}const o=new Map;for(const{event:s,weight:a}of n.values()){const e=o.get(a);e?e.push(s):o.set(a,[s])}return Array.from(o).sort((e,t)=>t[0]-e[0]).flatMap(([,e])=>e.sort((e,t)=>String(e.cid)<String(t.cid)?-1:1))},findEvents=async(e,t,r,n=0)=>{const i=await e.get(t),o=[{event:i,depth:n}],{parents:s}=i.value;if(1===s.length&&String(s[0])===String(r))return o;const a=await Promise.all(s.map(t=>findEvents(e,t,r,n+1)));return o.concat(...a)},_Batcher=class e{constructor({blocks:e,head:t,entries:r,prefix:n,version:i,keyChars:o,maxKeySize:s,base:a,additions:l,removals:c}){__privateAdd2(this,_committed2,!1),this.blocks=e,this.head=t,this.prefix=n,this.entries=[...r],this.base=a,this.version=i,this.keyChars=o,this.maxKeySize=s,this.additions=l,this.removals=c,this.ops=[]}async put(e,t){if(__privateGet2(this,_committed2))throw new BatchCommittedError;await put$1(this.blocks,this,e,t),this.ops.push({type:"put",key:e,value:t})}async commit(){if(__privateGet2(this,_committed2))throw new BatchCommittedError;__privateSet2(this,_committed2,!0);const e=await commit$1(this),t={type:"batch",ops:this.ops,root:e.root},r=await EventBlock.create(t,this.head),n=new MemoryBlockstore,i=new MultiBlockFetcher(n,this.blocks);n.putSync(r.cid,r.bytes);const o=await advance(i,this.head,r.cid),s=new Map,a=new Map;for(const l of this.additions)s.set(l.cid.toString(),l);for(const l of this.removals)a.set(l.cid.toString(),l);for(const l of e.additions)a.has(l.cid.toString())&&a.delete(l.cid.toString()),s.set(l.cid.toString(),l);for(const l of e.removals)s.has(l.cid.toString())?s.delete(l.cid.toString()):a.set(l.cid.toString(),l);return{head:o,event:r,root:e.root,additions:[...s.values()],removals:[...a.values()]}}static async create({blocks:t,head:r}){const n=new MemoryBlockstore;if(t=new MultiBlockFetcher(n,t),!r.length){const i=await ShardBlock.create();return n.putSync(i.cid,i.bytes),new e({blocks:t,head:r,entries:[],base:i,additions:[i],removals:[],...configure$2(i.value)})}const{root:i,additions:o,removals:s}=await root(t,r);for(const e of o)n.putSync(e.cid,e.bytes);const a=new ShardFetcher(t),l=await a.get(i);return new e({blocks:t,head:r,entries:l.value.entries,base:l,additions:o,removals:s,...configure$2(l.value)})}};_committed2=new WeakMap;let Batcher=_Batcher;const create$8=(e,t)=>Batcher.create({blocks:e,head:t}),textDecoder$1=new TextDecoder;function decodeVarint$1(e,t){let r=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(t>=e.length)throw new Error("protobuf: unexpected end of data");const i=e[t++];if(r+=n<28?(127&i)<<n:(127&i)*2**n,i<128)break}return[r,t]}function decodeBytes(e,t){let r;[r,t]=decodeVarint$1(e,t);const n=t+r;if(r<0||n<0)throw new Error("protobuf: invalid length");if(n>e.length)throw new Error("protobuf: unexpected end of data");return[e.subarray(t,n),n]}function decodeKey(e,t){let r;return[r,t]=decodeVarint$1(e,t),[7&r,r>>3,t]}function decodeLink(e){const t={},r=e.length;let n=0;for(;n<r;){let r,i;if([r,i,n]=decodeKey(e,n),1===i){if(t.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(2!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Hash`);if(void 0!==t.Name)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[t.Hash,n]=decodeBytes(e,n)}else if(2===i){if(void 0!==t.Name)throw new Error("protobuf: (PBLink) duplicate Name section");if(2!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Name`);if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let i;[i,n]=decodeBytes(e,n),t.Name=textDecoder$1.decode(i)}else{if(3!==i)throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${i}`);if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(0!==r)throw new Error(`protobuf: (PBLink) wrong wireType (${r}) for Tsize`);[t.Tsize,n]=decodeVarint$1(e,n)}}if(n>r)throw new Error("protobuf: (PBLink) unexpected end of data");return t}function decodeNode(e){const t=e.length;let r,n,i=0,o=!1;for(;i<t;){let t,s;if([t,s,i]=decodeKey(e,i),2!==t)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${t}`);if(1===s){if(n)throw new Error("protobuf: (PBNode) duplicate Data section");[n,i]=decodeBytes(e,i),r&&(o=!0)}else{if(2!==s)throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${s}`);{if(o)throw new Error("protobuf: (PBNode) duplicate Links section");let t;r||(r=[]),[t,i]=decodeBytes(e,i),r.push(decodeLink(t))}}}if(i>t)throw new Error("protobuf: (PBNode) unexpected end of data");const s={};return n&&(s.Data=n),s.Links=r||[],s}const textEncoder$1=new TextEncoder,maxInt32=2**32,maxUInt32=2**31;function encodeLink$1(e,t){let r=t.length;if("number"==typeof e.Tsize){if(e.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(e.Tsize))throw new Error("Tsize too large for encoding");r=encodeVarint(t,r,e.Tsize)-1,t[r]=24}if("string"==typeof e.Name){const n=textEncoder$1.encode(e.Name);r-=n.length,t.set(n,r),r=encodeVarint(t,r,n.length)-1,t[r]=18}return e.Hash&&(r-=e.Hash.length,t.set(e.Hash,r),r=encodeVarint(t,r,e.Hash.length)-1,t[r]=10),t.length-r}function encodeNode(e){const t=sizeNode(e),r=new Uint8Array(t);let n=t;if(e.Data&&(n-=e.Data.length,r.set(e.Data,n),n=encodeVarint(r,n,e.Data.length)-1,r[n]=10),e.Links)for(let i=e.Links.length-1;i>=0;i--){const t=encodeLink$1(e.Links[i],r.subarray(0,n));n-=t,n=encodeVarint(r,n,t)-1,r[n]=18}return r}function sizeLink(e){let t=0;if(e.Hash){const r=e.Hash.length;t+=1+r+sov(r)}if("string"==typeof e.Name){const r=textEncoder$1.encode(e.Name).length;t+=1+r+sov(r)}return"number"==typeof e.Tsize&&(t+=1+sov(e.Tsize)),t}function sizeNode(e){let t=0;if(e.Data){const r=e.Data.length;t+=1+r+sov(r)}if(e.Links)for(const r of e.Links){const e=sizeLink(r);t+=1+e+sov(e)}return t}function encodeVarint(e,t,r){const n=t-=sov(r);for(;r>=maxUInt32;)e[t++]=127&r|128,r/=128;for(;r>=128;)e[t++]=127&r|128,r>>>=7;return e[t]=r,n}function sov(e){return e%2==0&&e++,Math.floor((len64(e)+6)/7)}function len64(e){let t=0;return e>=maxInt32&&(e=Math.floor(e/maxInt32),t=32),e>=65536&&(e>>>=16,t+=16),e>=256&&(e>>>=8,t+=8),t+len8tab[e]}const len8tab=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],pbNodeProperties=["Data","Links"],pbLinkProperties=["Hash","Name","Tsize"],textEncoder=new TextEncoder;function linkComparator(e,t){if(e===t)return 0;const r=e.Name?textEncoder.encode(e.Name):[],n=t.Name?textEncoder.encode(t.Name):[];let i=r.length,o=n.length;for(let s=0,a=Math.min(i,o);s<a;++s)if(r[s]!==n[s]){i=r[s],o=n[s];break}return i<o?-1:o<i?1:0}function hasOnlyProperties(e,t){return!Object.keys(e).some(e=>!t.includes(e))}function asLink(e){if("object"==typeof e.asCID){const t=CID.asCID(e);if(!t)throw new TypeError("Invalid DAG-PB form");return{Hash:t}}if("object"!=typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const t={};if(e.Hash){let n=CID.asCID(e.Hash);try{n||("string"==typeof e.Hash?n=CID.parse(e.Hash):e.Hash instanceof Uint8Array&&(n=CID.decode(e.Hash)))}catch(r){throw new TypeError(`Invalid DAG-PB form: ${r.message}`)}n&&(t.Hash=n)}if(!t.Hash)throw new TypeError("Invalid DAG-PB form");return"string"==typeof e.Name&&(t.Name=e.Name),"number"==typeof e.Tsize&&(t.Tsize=e.Tsize),t}function prepare(e){if((e instanceof Uint8Array||"string"==typeof e)&&(e={Data:e}),"object"!=typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const t={};if(void 0!==e.Data)if("string"==typeof e.Data)t.Data=textEncoder.encode(e.Data);else{if(!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form");t.Data=e.Data}if(void 0!==e.Links){if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form");t.Links=e.Links.map(asLink),t.Links.sort(linkComparator)}else t.Links=[];return t}function validate(e){if(!e||"object"!=typeof e||Array.isArray(e)||e instanceof Uint8Array||e["/"]&&e["/"]===e.bytes)throw new TypeError("Invalid DAG-PB form");if(!hasOnlyProperties(e,pbNodeProperties))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(void 0!==e.Data&&!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let t=0;t<e.Links.length;t++){const r=e.Links[t];if(!r||"object"!=typeof r||Array.isArray(r)||r instanceof Uint8Array||r["/"]&&r["/"]===r.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!hasOnlyProperties(r,pbLinkProperties))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(void 0===r.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(null==r.Hash||!r.Hash["/"]||r.Hash["/"]!==r.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(void 0!==r.Name&&"string"!=typeof r.Name)throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(void 0!==r.Tsize){if("number"!=typeof r.Tsize||r.Tsize%1!=0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(r.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(t>0&&-1===linkComparator(r,e.Links[t-1]))throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function toByteView$1(e){return e instanceof ArrayBuffer?new Uint8Array(e,0,e.byteLength):e}const code$5=112;function encode$8(e){validate(e);const t={};return e.Links&&(t.Links=e.Links.map(e=>{const t={};return e.Hash&&(t.Hash=e.Hash.bytes),void 0!==e.Name&&(t.Name=e.Name),void 0!==e.Tsize&&(t.Tsize=e.Tsize),t})),e.Data&&(t.Data=e.Data),encodeNode(t)}function decode$8(e){const t=decodeNode(toByteView$1(e)),r={};return t.Data&&(r.Data=t.Data),t.Links&&(r.Links=t.Links.map(e=>{const t={};try{t.Hash=CID.decode(e.Hash)}catch{}if(!t.Hash)throw new Error("Invalid Hash field found in link, expected CID");return void 0!==e.Name&&(t.Name=e.Name),void 0!==e.Tsize&&(t.Tsize=e.Tsize),t})),r}var indexMinimal={},minimal$1={},aspromise=asPromise;function asPromise(e,t){for(var r=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(i,s){r[n]=function(e){if(o)if(o=!1,e)s(e);else{for(var t=new Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];i.apply(null,t)}};try{e.apply(t||null,r)}catch(a){o&&(o=!1,s(a))}})}var base64$3={};!function(e){var t=base64$3;t.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};for(var r=new Array(64),n=new Array(123),i=0;i<64;)n[r[i]=i<26?i+65:i<52?i+71:i<62?i-4:i-59|43]=i++;t.encode=function(e,t,n){for(var i,o=null,s=[],a=0,l=0;t<n;){var c=e[t++];switch(l){case 0:s[a++]=r[c>>2],i=(3&c)<<4,l=1;break;case 1:s[a++]=r[i|c>>4],i=(15&c)<<2,l=2;break;case 2:s[a++]=r[i|c>>6],s[a++]=r[63&c],l=0}a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0)}return l&&(s[a++]=r[i],s[a++]=61,1===l&&(s[a++]=61)),o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var o="invalid encoding";t.decode=function(e,t,r){for(var i,s=r,a=0,l=0;l<e.length;){var c=e.charCodeAt(l++);if(61===c&&a>1)break;if(void 0===(c=n[c]))throw Error(o);switch(a){case 0:i=c,a=1;break;case 1:t[r++]=i<<2|(48&c)>>4,i=c,a=2;break;case 2:t[r++]=(15&i)<<4|(60&c)>>2,i=c,a=3;break;case 3:t[r++]=(3&i)<<6|c,a=0}}if(1===a)throw Error(o);return r-s},t.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}}();var eventemitter=EventEmitter$1;function EventEmitter$1(){this._listeners={}}EventEmitter$1.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},EventEmitter$1.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],n=0;n<r.length;)r[n].fn===t?r.splice(n,1):++n;return this},EventEmitter$1.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,r)}return this};var float=factory(factory);function factory(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=128===r[3];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3]}function o(e,n,i){t[0]=e,n[i]=r[3],n[i+1]=r[2],n[i+2]=r[1],n[i+3]=r[0]}function s(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],t[0]}function a(e,n){return r[3]=e[n],r[2]=e[n+1],r[1]=e[n+2],r[0]=e[n+3],t[0]}e.writeFloatLE=n?i:o,e.writeFloatBE=n?o:i,e.readFloatLE=n?s:a,e.readFloatBE=n?a:s}():function(){function t(e,t,r,n){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,r,n);else if(isNaN(t))e(2143289344,r,n);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,r,n);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,r,n);else{var o=Math.floor(Math.log(t)/Math.LN2);e((i<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,r,n)}}function r(e,t,r){var n=e(t,r),i=2*(n>>31)+1,o=n>>>23&255,s=8388607&n;return 255===o?s?NaN:i*(1/0):0===o?1401298464324817e-60*i*s:i*Math.pow(2,o-150)*(s+8388608)}e.writeFloatLE=t.bind(null,writeUintLE),e.writeFloatBE=t.bind(null,writeUintBE),e.readFloatLE=r.bind(null,readUintLE),e.readFloatBE=r.bind(null,readUintBE)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=128===r[7];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3],n[i+4]=r[4],n[i+5]=r[5],n[i+6]=r[6],n[i+7]=r[7]}function o(e,n,i){t[0]=e,n[i]=r[7],n[i+1]=r[6],n[i+2]=r[5],n[i+3]=r[4],n[i+4]=r[3],n[i+5]=r[2],n[i+6]=r[1],n[i+7]=r[0]}function s(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],r[4]=e[n+4],r[5]=e[n+5],r[6]=e[n+6],r[7]=e[n+7],t[0]}function a(e,n){return r[7]=e[n],r[6]=e[n+1],r[5]=e[n+2],r[4]=e[n+3],r[3]=e[n+4],r[2]=e[n+5],r[1]=e[n+6],r[0]=e[n+7],t[0]}e.writeDoubleLE=n?i:o,e.writeDoubleBE=n?o:i,e.readDoubleLE=n?s:a,e.readDoubleBE=n?a:s}():function(){function t(e,t,r,n,i,o){var s=n<0?1:0;if(s&&(n=-n),0===n)e(0,i,o+t),e(1/n>0?0:2147483648,i,o+r);else if(isNaN(n))e(0,i,o+t),e(2146959360,i,o+r);else if(n>17976931348623157e292)e(0,i,o+t),e((s<<31|2146435072)>>>0,i,o+r);else{var a;if(n<22250738585072014e-324)e((a=n/5e-324)>>>0,i,o+t),e((s<<31|a/4294967296)>>>0,i,o+r);else{var l=Math.floor(Math.log(n)/Math.LN2);1024===l&&(l=1023),e(4503599627370496*(a=n*Math.pow(2,-l))>>>0,i,o+t),e((s<<31|l+1023<<20|1048576*a&1048575)>>>0,i,o+r)}}}function r(e,t,r,n,i){var o=e(n,i+t),s=e(n,i+r),a=2*(s>>31)+1,l=s>>>20&2047,c=4294967296*(1048575&s)+o;return 2047===l?c?NaN:a*(1/0):0===l?5e-324*a*c:a*Math.pow(2,l-1075)*(c+4503599627370496)}e.writeDoubleLE=t.bind(null,writeUintLE,0,4),e.writeDoubleBE=t.bind(null,writeUintBE,4,0),e.readDoubleLE=r.bind(null,readUintLE,0,4),e.readDoubleBE=r.bind(null,readUintBE,4,0)}(),e}function writeUintLE(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function writeUintBE(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function readUintLE(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function readUintBE(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}var inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}var utf8$3={},utf82;utf82=utf8$3,utf82.length=function(e){for(var t=0,r=0,n=0;n<e.length;++n)(r=e.charCodeAt(n))<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},utf82.read=function(e,t,r){if(r-t<1)return"";for(var n,i=null,o=[],s=0;t<r;)(n=e[t++])<128?o[s++]=n:n>191&&n<224?o[s++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[s++]=55296+(n>>10),o[s++]=56320+(1023&n)):o[s++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0);return i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))},utf82.write=function(e,t,r){for(var n,i,o=r,s=0;s<e.length;++s)(n=e.charCodeAt(s))<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=63&n|128):55296==(64512&n)&&56320==(64512&(i=e.charCodeAt(s+1)))?(n=65536+((1023&n)<<10)+(1023&i),++s,t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=63&n|128):(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=63&n|128);return r-o};var pool_1=pool$1,longbits,hasRequiredLongbits,hasRequiredMinimal;function pool$1(e,t,r){var n=r||8192,i=n>>>1,o=null,s=n;return function(r){if(r<1||r>i)return e(r);s+r>n&&(o=e(n),s=0);var a=t.call(o,s,s+=r);return 7&s&&(s=1+(7|s)),a}}function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=t;var e=requireMinimal();function t(e,t){this.lo=e>>>0,this.hi=t>>>0}var r=t.zero=new t(0,0);r.toNumber=function(){return 0},r.zzEncode=r.zzDecode=function(){return this},r.length=function(){return 1};var n=t.zeroHash="\0\0\0\0\0\0\0\0";t.fromNumber=function(e){if(0===e)return r;var n=e<0;n&&(e=-e);var i=e>>>0,o=(e-i)/4294967296>>>0;return n&&(o=~o>>>0,i=~i>>>0,++i>4294967295&&(i=0,++o>4294967295&&(o=0))),new t(i,o)},t.from=function(n){if("number"==typeof n)return t.fromNumber(n);if(e.isString(n)){if(!e.Long)return t.fromNumber(parseInt(n,10));n=e.Long.fromString(n)}return n.low||n.high?new t(n.low>>>0,n.high>>>0):r},t.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},t.prototype.toLong=function(t){return e.Long?new e.Long(0|this.lo,0|this.hi,Boolean(t)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(t)}};var i=String.prototype.charCodeAt;return t.fromHash=function(e){return e===n?r:new t((i.call(e,0)|i.call(e,1)<<8|i.call(e,2)<<16|i.call(e,3)<<24)>>>0,(i.call(e,4)|i.call(e,5)<<8|i.call(e,6)<<16|i.call(e,7)<<24)>>>0)},t.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},t.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},t.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},t.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10},longbits}function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,function(){var e=minimal$1;function t(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)void 0!==e[n[i]]&&r||(e[n[i]]=t[n[i]]);return e}function r(e){function r(e,n){if(!(this instanceof r))return new r(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,r):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&t(this,n)}return r.prototype=Object.create(Error.prototype,{constructor:{value:r,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),r}e.asPromise=aspromise,e.base64=base64$3,e.EventEmitter=eventemitter,e.float=float,e.inquire=inquire_1,e.utf8=utf8$3,e.pool=pool_1,e.LongBits=requireLongbits(),e.isNode=Boolean(void 0!==commonjsGlobal&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),e.global=e.isNode&&commonjsGlobal||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||commonjsGlobal,e.emptyArray=Object.freeze?Object.freeze([]):[],e.emptyObject=Object.freeze?Object.freeze({}):{},e.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},e.isString=function(e){return"string"==typeof e||e instanceof String},e.isObject=function(e){return e&&"object"==typeof e},e.isset=e.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},e.Buffer=function(){try{var t=e.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch(r){return null}}(),e._Buffer_from=null,e._Buffer_allocUnsafe=null,e.newBuffer=function(t){return"number"==typeof t?e.Buffer?e._Buffer_allocUnsafe(t):new e.Array(t):e.Buffer?e._Buffer_from(t):"undefined"==typeof Uint8Array?t:new Uint8Array(t)},e.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,e.Long=e.global.dcodeIO&&e.global.dcodeIO.Long||e.global.Long||e.inquire("long"),e.key2Re=/^true|false|0|1$/,e.key32Re=/^-?(?:0|[1-9][0-9]*)$/,e.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,e.longToHash=function(t){return t?e.LongBits.from(t).toHash():e.LongBits.zeroHash},e.longFromHash=function(t,r){var n=e.LongBits.fromHash(t);return e.Long?e.Long.fromBits(n.lo,n.hi,r):n.toNumber(Boolean(r))},e.merge=t,e.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},e.newError=r,e.ProtocolError=r("ProtocolError"),e.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},e.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},e.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},e._configure=function(){var t=e.Buffer;t?(e._Buffer_from=t.from!==Uint8Array.from&&t.from||function(e,r){return new t(e,r)},e._Buffer_allocUnsafe=t.allocUnsafe||function(e){return new t(e)}):e._Buffer_from=e._Buffer_allocUnsafe=null}}()),minimal$1}var writer=Writer$1,util$4=requireMinimal(),BufferWriter$1,LongBits$2=util$4.LongBits,base64$2=util$4.base64,utf8$2=util$4.utf8;function Op$1(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function noop$1(){}function State$1(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function Writer$1(){this.len=0,this.head=new Op$1(noop$1,0,0),this.tail=this.head,this.states=null}var create$7=function(){return util$4.Buffer?function(){return(Writer$1.create=function(){return new BufferWriter$1})()}:function(){return new Writer$1}};function writeByte$1(e,t,r){t[r]=255&e}function writeVarint32$1(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e}function VarintOp$1(e,t){this.len=e,this.next=void 0,this.val=t}function writeVarint64$1(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function writeFixed32$1(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}Writer$1.create=create$7(),Writer$1.alloc=function(e){return new util$4.Array(e)},util$4.Array!==Array&&(Writer$1.alloc=util$4.pool(Writer$1.alloc,util$4.Array.prototype.subarray)),Writer$1.prototype._push=function(e,t,r){return this.tail=this.tail.next=new Op$1(e,t,r),this.len+=t,this},VarintOp$1.prototype=Object.create(Op$1.prototype),VarintOp$1.prototype.fn=writeVarint32$1,Writer$1.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new VarintOp$1((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},Writer$1.prototype.int32=function(e){return e<0?this._push(writeVarint64$1,10,LongBits$2.fromNumber(e)):this.uint32(e)},Writer$1.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},Writer$1.prototype.uint64=function(e){var t=LongBits$2.from(e);return this._push(writeVarint64$1,t.length(),t)},Writer$1.prototype.int64=Writer$1.prototype.uint64,Writer$1.prototype.sint64=function(e){var t=LongBits$2.from(e).zzEncode();return this._push(writeVarint64$1,t.length(),t)},Writer$1.prototype.bool=function(e){return this._push(writeByte$1,1,e?1:0)},Writer$1.prototype.fixed32=function(e){return this._push(writeFixed32$1,4,e>>>0)},Writer$1.prototype.sfixed32=Writer$1.prototype.fixed32,Writer$1.prototype.fixed64=function(e){var t=LongBits$2.from(e);return this._push(writeFixed32$1,4,t.lo)._push(writeFixed32$1,4,t.hi)},Writer$1.prototype.sfixed64=Writer$1.prototype.fixed64,Writer$1.prototype.float=function(e){return this._push(util$4.float.writeFloatLE,4,e)},Writer$1.prototype.double=function(e){return this._push(util$4.float.writeDoubleLE,8,e)};var writeBytes$2=util$4.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};Writer$1.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(writeByte$1,1,0);if(util$4.isString(e)){var r=Writer$1.alloc(t=base64$2.length(e));base64$2.decode(e,r,0),e=r}return this.uint32(t)._push(writeBytes$2,t,e)},Writer$1.prototype.string=function(e){var t=utf8$2.length(e);return t?this.uint32(t)._push(utf8$2.write,t,e):this._push(writeByte$1,1,0)},Writer$1.prototype.fork=function(){return this.states=new State$1(this),this.head=this.tail=new Op$1(noop$1,0,0),this.len=0,this},Writer$1.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op$1(noop$1,0,0),this.len=0),this},Writer$1.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},Writer$1.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},Writer$1._configure=function(e){BufferWriter$1=e,Writer$1.create=create$7(),BufferWriter$1._configure()};var writer_buffer=BufferWriter,Writer=writer;(BufferWriter.prototype=Object.create(Writer.prototype)).constructor=BufferWriter;var util$3=requireMinimal();function BufferWriter(){Writer.call(this)}function writeStringBuffer$1(e,t,r){e.length<40?util$3.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}BufferWriter._configure=function(){BufferWriter.alloc=util$3._Buffer_allocUnsafe,BufferWriter.writeBytesBuffer=util$3.Buffer&&util$3.Buffer.prototype instanceof Uint8Array&&"set"===util$3.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}},BufferWriter.prototype.bytes=function(e){util$3.isString(e)&&(e=util$3._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(BufferWriter.writeBytesBuffer,t,e),this},BufferWriter.prototype.string=function(e){var t=util$3.Buffer.byteLength(e);return this.uint32(t),t&&this._push(writeStringBuffer$1,t,e),this},BufferWriter._configure();var reader=Reader$1,util$2=requireMinimal(),BufferReader$1,LongBits$1=util$2.LongBits,utf8$1=util$2.utf8;function indexOutOfRange$1(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function Reader$1(e){this.buf=e,this.pos=0,this.len=e.length}var create_array="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Reader$1(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Reader$1(e);throw Error("illegal buffer")},create$6=function(){return util$2.Buffer?function(e){return(Reader$1.create=function(e){return util$2.Buffer.isBuffer(e)?new BufferReader$1(e):create_array(e)})(e)}:create_array},value;function readLongVarint(){var e=new LongBits$1(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw indexOutOfRange$1(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw indexOutOfRange$1(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function readFixed32_end(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange$1(this,8);return new LongBits$1(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader$1.create=create$6(),Reader$1.prototype._slice=util$2.Array.prototype.subarray||util$2.Array.prototype.slice,Reader$1.prototype.uint32=(value=4294967295,function(){if(value=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return value;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange$1(this,10);return value}),Reader$1.prototype.int32=function(){return 0|this.uint32()},Reader$1.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)},Reader$1.prototype.bool=function(){return 0!==this.uint32()},Reader$1.prototype.fixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange$1(this,4);return readFixed32_end(this.buf,this.pos+=4)},Reader$1.prototype.sfixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange$1(this,4);return 0|readFixed32_end(this.buf,this.pos+=4)},Reader$1.prototype.float=function(){if(this.pos+4>this.len)throw indexOutOfRange$1(this,4);var e=util$2.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},Reader$1.prototype.double=function(){if(this.pos+8>this.len)throw indexOutOfRange$1(this,4);var e=util$2.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},Reader$1.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw indexOutOfRange$1(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,r);if(t===r){var n=util$2.Buffer;return n?n.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,r)},Reader$1.prototype.string=function(){var e=this.bytes();return utf8$1.read(e,0,e.length)},Reader$1.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw indexOutOfRange$1(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw indexOutOfRange$1(this)}while(128&this.buf[this.pos++]);return this},Reader$1.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},Reader$1._configure=function(e){BufferReader$1=e,Reader$1.create=create$6(),BufferReader$1._configure();var t=util$2.Long?"toLong":"toNumber";util$2.merge(Reader$1.prototype,{int64:function(){return readLongVarint.call(this)[t](!1)},uint64:function(){return readLongVarint.call(this)[t](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[t](!1)},fixed64:function(){return readFixed64.call(this)[t](!0)},sfixed64:function(){return readFixed64.call(this)[t](!1)}})};var reader_buffer=BufferReader,Reader=reader;(BufferReader.prototype=Object.create(Reader.prototype)).constructor=BufferReader;var util$1=requireMinimal();function BufferReader(e){Reader.call(this,e)}BufferReader._configure=function(){util$1.Buffer&&(BufferReader.prototype._slice=util$1.Buffer.prototype.slice)},BufferReader.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},BufferReader._configure();var rpc={},service=Service,util=requireMinimal();function Service(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");util.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}(Service.prototype=Object.create(util.EventEmitter.prototype)).constructor=Service,Service.prototype.rpcCall=function e(t,r,n,i,o){if(!i)throw TypeError("request must be specified");var s=this;if(!o)return util.asPromise(e,s,t,r,n,i);if(s.rpcImpl)try{return s.rpcImpl(t,r[s.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(e,r){if(e)return s.emit("error",e,t),o(e);if(null!==r){if(!(r instanceof n))try{r=n[s.responseDelimited?"decodeDelimited":"decode"](r)}catch(i){return s.emit("error",i,t),o(i)}return s.emit("data",r,t),o(null,r)}s.end(!0)})}catch(a){return s.emit("error",a,t),void setTimeout(function(){o(a)},0)}else setTimeout(function(){o(Error("already ended"))},0)},Service.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},rpc.Service=service;var roots={};!function(e){var t=indexMinimal;function r(){t.util._configure(),t.Writer._configure(t.BufferWriter),t.Reader._configure(t.BufferReader)}t.build="minimal",t.Writer=writer,t.BufferWriter=writer_buffer,t.Reader=reader,t.BufferReader=reader_buffer,t.util=requireMinimal(),t.rpc=rpc,t.roots=roots,t.configure=r,r()}();var minimal=indexMinimal;const $protobuf=getDefaultExportFromCjs(minimal),$Reader=$protobuf.Reader,$Writer=$protobuf.Writer,$util=$protobuf.util,$root=$protobuf.roots.unixfs||($protobuf.roots.unixfs={}),Data$1=$root.Data=(()=>{function e(e){if(this.blocksizes=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.Type=0,e.prototype.Data=$util.newBuffer([]),e.prototype.filesize=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.blocksizes=$util.emptyArray,e.prototype.hashType=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.fanout=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.mode=0,e.prototype.mtime=null,e.encode=function(e,t){if(t||(t=$Writer.create()),t.uint32(8).int32(e.Type),null!=e.Data&&Object.hasOwnProperty.call(e,"Data")&&t.uint32(18).bytes(e.Data),null!=e.filesize&&Object.hasOwnProperty.call(e,"filesize")&&t.uint32(24).uint64(e.filesize),null!=e.blocksizes&&e.blocksizes.length)for(var r=0;r<e.blocksizes.length;++r)t.uint32(32).uint64(e.blocksizes[r]);return null!=e.hashType&&Object.hasOwnProperty.call(e,"hashType")&&t.uint32(40).uint64(e.hashType),null!=e.fanout&&Object.hasOwnProperty.call(e,"fanout")&&t.uint32(48).uint64(e.fanout),null!=e.mode&&Object.hasOwnProperty.call(e,"mode")&&t.uint32(56).uint32(e.mode),null!=e.mtime&&Object.hasOwnProperty.call(e,"mtime")&&$root.UnixTime.encode(e.mtime,t.uint32(66).fork()).ldelim(),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.Data;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.Type=e.int32();break;case 2:n.Data=e.bytes();break;case 3:n.filesize=e.uint64();break;case 4:if(n.blocksizes&&n.blocksizes.length||(n.blocksizes=[]),2==(7&i))for(var o=e.uint32()+e.pos;e.pos<o;)n.blocksizes.push(e.uint64());else n.blocksizes.push(e.uint64());break;case 5:n.hashType=e.uint64();break;case 6:n.fanout=e.uint64();break;case 7:n.mode=e.uint32();break;case 8:n.mtime=$root.UnixTime.decode(e,e.uint32());break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("Type"))throw $util.ProtocolError("missing required 'Type'",{instance:n});return n},e.fromObject=function(e){if(e instanceof $root.Data)return e;var t=new $root.Data;switch(e.Type){case"Raw":case 0:t.Type=0;break;case"Directory":case 1:t.Type=1;break;case"File":case 2:t.Type=2;break;case"Metadata":case 3:t.Type=3;break;case"Symlink":case 4:t.Type=4;break;case"HAMTShard":case 5:t.Type=5}if(null!=e.Data&&("string"==typeof e.Data?$util.base64.decode(e.Data,t.Data=$util.newBuffer($util.base64.length(e.Data)),0):e.Data.length&&(t.Data=e.Data)),null!=e.filesize&&($util.Long?(t.filesize=$util.Long.fromValue(e.filesize)).unsigned=!0:"string"==typeof e.filesize?t.filesize=parseInt(e.filesize,10):"number"==typeof e.filesize?t.filesize=e.filesize:"object"==typeof e.filesize&&(t.filesize=new $util.LongBits(e.filesize.low>>>0,e.filesize.high>>>0).toNumber(!0))),e.blocksizes){if(!Array.isArray(e.blocksizes))throw TypeError(".Data.blocksizes: array expected");t.blocksizes=[];for(var r=0;r<e.blocksizes.length;++r)$util.Long?(t.blocksizes[r]=$util.Long.fromValue(e.blocksizes[r])).unsigned=!0:"string"==typeof e.blocksizes[r]?t.blocksizes[r]=parseInt(e.blocksizes[r],10):"number"==typeof e.blocksizes[r]?t.blocksizes[r]=e.blocksizes[r]:"object"==typeof e.blocksizes[r]&&(t.blocksizes[r]=new $util.LongBits(e.blocksizes[r].low>>>0,e.blocksizes[r].high>>>0).toNumber(!0))}if(null!=e.hashType&&($util.Long?(t.hashType=$util.Long.fromValue(e.hashType)).unsigned=!0:"string"==typeof e.hashType?t.hashType=parseInt(e.hashType,10):"number"==typeof e.hashType?t.hashType=e.hashType:"object"==typeof e.hashType&&(t.hashType=new $util.LongBits(e.hashType.low>>>0,e.hashType.high>>>0).toNumber(!0))),null!=e.fanout&&($util.Long?(t.fanout=$util.Long.fromValue(e.fanout)).unsigned=!0:"string"==typeof e.fanout?t.fanout=parseInt(e.fanout,10):"number"==typeof e.fanout?t.fanout=e.fanout:"object"==typeof e.fanout&&(t.fanout=new $util.LongBits(e.fanout.low>>>0,e.fanout.high>>>0).toNumber(!0))),null!=e.mode&&(t.mode=e.mode>>>0),null!=e.mtime){if("object"!=typeof e.mtime)throw TypeError(".Data.mtime: object expected");t.mtime=$root.UnixTime.fromObject(e.mtime)}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.blocksizes=[]),t.defaults){if(r.Type=t.enums===String?"Raw":0,t.bytes===String?r.Data="":(r.Data=[],t.bytes!==Array&&(r.Data=$util.newBuffer(r.Data))),$util.Long){var n=new $util.Long(0,0,!0);r.filesize=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.filesize=t.longs===String?"0":0;if($util.Long){n=new $util.Long(0,0,!0);r.hashType=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.hashType=t.longs===String?"0":0;if($util.Long){n=new $util.Long(0,0,!0);r.fanout=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.fanout=t.longs===String?"0":0;r.mode=0,r.mtime=null}if(null!=e.Type&&e.hasOwnProperty("Type")&&(r.Type=t.enums===String?$root.Data.DataType[e.Type]:e.Type),null!=e.Data&&e.hasOwnProperty("Data")&&(r.Data=t.bytes===String?$util.base64.encode(e.Data,0,e.Data.length):t.bytes===Array?Array.prototype.slice.call(e.Data):e.Data),null!=e.filesize&&e.hasOwnProperty("filesize")&&("number"==typeof e.filesize?r.filesize=t.longs===String?String(e.filesize):e.filesize:r.filesize=t.longs===String?$util.Long.prototype.toString.call(e.filesize):t.longs===Number?new $util.LongBits(e.filesize.low>>>0,e.filesize.high>>>0).toNumber(!0):e.filesize),e.blocksizes&&e.blocksizes.length){r.blocksizes=[];for(var i=0;i<e.blocksizes.length;++i)"number"==typeof e.blocksizes[i]?r.blocksizes[i]=t.longs===String?String(e.blocksizes[i]):e.blocksizes[i]:r.blocksizes[i]=t.longs===String?$util.Long.prototype.toString.call(e.blocksizes[i]):t.longs===Number?new $util.LongBits(e.blocksizes[i].low>>>0,e.blocksizes[i].high>>>0).toNumber(!0):e.blocksizes[i]}return null!=e.hashType&&e.hasOwnProperty("hashType")&&("number"==typeof e.hashType?r.hashType=t.longs===String?String(e.hashType):e.hashType:r.hashType=t.longs===String?$util.Long.prototype.toString.call(e.hashType):t.longs===Number?new $util.LongBits(e.hashType.low>>>0,e.hashType.high>>>0).toNumber(!0):e.hashType),null!=e.fanout&&e.hasOwnProperty("fanout")&&("number"==typeof e.fanout?r.fanout=t.longs===String?String(e.fanout):e.fanout:r.fanout=t.longs===String?$util.Long.prototype.toString.call(e.fanout):t.longs===Number?new $util.LongBits(e.fanout.low>>>0,e.fanout.high>>>0).toNumber(!0):e.fanout),null!=e.mode&&e.hasOwnProperty("mode")&&(r.mode=e.mode),null!=e.mtime&&e.hasOwnProperty("mtime")&&(r.mtime=$root.UnixTime.toObject(e.mtime,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e.DataType=function(){const e={},t=Object.create(e);return t[e[0]="Raw"]=0,t[e[1]="Directory"]=1,t[e[2]="File"]=2,t[e[3]="Metadata"]=3,t[e[4]="Symlink"]=4,t[e[5]="HAMTShard"]=5,t}(),e})();$root.UnixTime=(()=>{function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.Seconds=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.FractionalNanoseconds=0,e.encode=function(e,t){return t||(t=$Writer.create()),t.uint32(8).int64(e.Seconds),null!=e.FractionalNanoseconds&&Object.hasOwnProperty.call(e,"FractionalNanoseconds")&&t.uint32(21).fixed32(e.FractionalNanoseconds),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.UnixTime;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.Seconds=e.int64();break;case 2:n.FractionalNanoseconds=e.fixed32();break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("Seconds"))throw $util.ProtocolError("missing required 'Seconds'",{instance:n});return n},e.fromObject=function(e){if(e instanceof $root.UnixTime)return e;var t=new $root.UnixTime;return null!=e.Seconds&&($util.Long?(t.Seconds=$util.Long.fromValue(e.Seconds)).unsigned=!1:"string"==typeof e.Seconds?t.Seconds=parseInt(e.Seconds,10):"number"==typeof e.Seconds?t.Seconds=e.Seconds:"object"==typeof e.Seconds&&(t.Seconds=new $util.LongBits(e.Seconds.low>>>0,e.Seconds.high>>>0).toNumber())),null!=e.FractionalNanoseconds&&(t.FractionalNanoseconds=e.FractionalNanoseconds>>>0),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if($util.Long){var n=new $util.Long(0,0,!1);r.Seconds=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.Seconds=t.longs===String?"0":0;r.FractionalNanoseconds=0}return null!=e.Seconds&&e.hasOwnProperty("Seconds")&&("number"==typeof e.Seconds?r.Seconds=t.longs===String?String(e.Seconds):e.Seconds:r.Seconds=t.longs===String?$util.Long.prototype.toString.call(e.Seconds):t.longs===Number?new $util.LongBits(e.Seconds.low>>>0,e.Seconds.high>>>0).toNumber():e.Seconds),null!=e.FractionalNanoseconds&&e.hasOwnProperty("FractionalNanoseconds")&&(r.FractionalNanoseconds=e.FractionalNanoseconds),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e})(),$root.Metadata=(()=>{function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.MimeType="",e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.MimeType&&Object.hasOwnProperty.call(e,"MimeType")&&t.uint32(10).string(e.MimeType),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.Metadata;e.pos<r;){var i=e.uint32();if(i>>>3==1)n.MimeType=e.string();else e.skipType(7&i)}return n},e.fromObject=function(e){if(e instanceof $root.Metadata)return e;var t=new $root.Metadata;return null!=e.MimeType&&(t.MimeType=String(e.MimeType)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.MimeType=""),null!=e.MimeType&&e.hasOwnProperty("MimeType")&&(r.MimeType=e.MimeType),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e})();const NodeType=Data$1.DataType,EMPTY$3=Object.freeze([]),EMPTY_BUFFER$1=new Uint8Array(0),BLANK$2=Object.freeze({}),DEFAULT_FILE_MODE$1=parseInt("0644",8),DEFAULT_DIRECTORY_MODE$1=parseInt("0755",8),code$4=code$5,name$3="UnixFS",encodePB=(e,t)=>(Object(globalThis).debug&&console.log({data:e,links:t}),encode$8(prepare({Data:Data$1.encode(e).finish(),Links:t}))),createRaw=e=>({type:NodeType.Raw,content:e}),createEmptyFile=e=>createSimpleFile(EMPTY_BUFFER$1,e),createSimpleFile=(e,t)=>({type:NodeType.File,layout:"simple",content:e,metadata:decodeMetadata(t)}),createFileChunk=e=>({type:NodeType.File,layout:"simple",content:e}),createAdvancedFile=(e,t)=>({type:NodeType.File,layout:"advanced",parts:e,metadata:decodeMetadata(t)}),createFileShard=e=>({type:NodeType.File,layout:"advanced",parts:e}),createComplexFile=(e,t,r)=>({type:NodeType.File,layout:"complex",content:e,parts:t,metadata:decodeMetadata(r)}),createFlatDirectory=(e,t)=>({type:NodeType.Directory,metadata:decodeMetadata(t),entries:e}),createShardedDirectory=(e,t,r,n,i=BLANK$2)=>({type:NodeType.HAMTShard,bitfield:t,fanout:readFanout(r),hashType:readInt(n),entries:e,metadata:decodeMetadata(i)}),createDirectoryShard=(e,t,r,n)=>({type:NodeType.HAMTShard,bitfield:t,fanout:readFanout(r),hashType:readInt(n),entries:e}),encodeRaw=e=>encodePB({Type:NodeType.Raw,Data:e.byteLength>0?e:void 0,filesize:e.byteLength,blocksizes:EMPTY$3},[]),encodeFile$1=(e,t=!1)=>{const r=t?BLANK$2:Object(e).metadata;switch(e.layout){case"simple":return encodeSimpleFile(e.content,r);case"advanced":return encodeAdvancedFile(e.parts,r);case"complex":return encodeComplexFile(e.content,e.parts,r);default:throw new TypeError(`File with unknown layout "${Object(e).layout}" was passed`)}},encodeFileChunk=e=>encodeSimpleFile(e,BLANK$2),encodeFileShard=e=>encodePB({Type:NodeType.File,blocksizes:e.map(contentByteLength),filesize:cumulativeContentByteLength(e)},e.map(encodeLink)),encodeAdvancedFile=(e,t=BLANK$2)=>encodePB({Type:NodeType.File,blocksizes:e.map(contentByteLength),filesize:cumulativeContentByteLength(e),...encodeMetadata(t)},e.map(encodeLink)),encodeLink=e=>({Name:"",Tsize:e.dagByteLength,Hash:e.cid}),encodeSimpleFile=(e,t=BLANK$2)=>encodePB({Type:NodeType.File,Data:e.byteLength>0?e:void 0,filesize:e.byteLength,blocksizes:[],...encodeMetadata(t)},[]),encodeComplexFile=(e,t,r=BLANK$2)=>encodePB({Type:NodeType.File,Data:e,filesize:e.byteLength+cumulativeContentByteLength(t),blocksizes:t.map(contentByteLength)},t.map(encodeLink)),encodeDirectory=e=>encodePB({Type:e.type,...encodeDirectoryMetadata(e.metadata||BLANK$2)},e.entries.map(encodeNamedLink)),encodeHAMTShard=({bitfield:e,fanout:t,hashType:r,entries:n,metadata:i=BLANK$2})=>encodePB({Type:NodeType.HAMTShard,Data:e.byteLength>0?e:void 0,fanout:readFanout(t),hashType:readInt(r),...encodeDirectoryMetadata(i)},n.map(encodeNamedLink)),readFanout=e=>{if(Math.log2(e)%1==0)return e;throw new TypeError(`Expected hamt size to be a power of two instead got ${e}`)},readInt=e=>{if(Number.isInteger(e))return e;throw new TypeError(`Expected an integer value instead got ${e}`)},createSymlink=(e,t=BLANK$2)=>({type:NodeType.Symlink,content:e,metadata:decodeMetadata(t)}),encodeSymlink=(e,t=!1)=>{const r=t?BLANK$2:Object(e).metadata;return encodePB({Type:NodeType.Symlink,Data:e.content,...encodeMetadata(r||BLANK$2)},[])},encode$7=(e,t=!0)=>{switch(e.type){case NodeType.Raw:return encodeRaw(e.content);case NodeType.File:return encodeFile$1(e);case NodeType.Directory:return encodeDirectory(e);case NodeType.HAMTShard:return encodeHAMTShard(e);case NodeType.Symlink:return encodeSymlink(e);default:throw new Error(`Unknown node type ${Object(e).type}`)}},decode$7=e=>{const t=decode$8(e),r=Data$1.decode(t.Data),{Type:n,Data:i,mtime:o,mode:s,blocksizes:a,...l}=Data$1.toObject(r,{defaults:!1,arrays:!0,longs:Number,objects:!1}),c={...s&&{mode:s},...decodeMtime(o)},u=t.Links;switch(r.Type){case NodeType.Raw:return createRaw(i);case NodeType.File:return 0===u.length?new SimpleFileView(i,c):0===i.byteLength?new AdvancedFileView(decodeFileLinks(l.blocksizes,u),c):new ComplexFileView(i,decodeFileLinks(l.blocksizes,u),c);case NodeType.Directory:return createFlatDirectory(decodeDirectoryLinks(u),c);case NodeType.HAMTShard:return createShardedDirectory(decodeDirectoryLinks(u),i||EMPTY_BUFFER$1,l.fanout,l.hashType,c);case NodeType.Symlink:return createSymlink(i,c);default:throw new TypeError(`Unsupported node type ${r.Type}`)}},decodeMtime=e=>null==e?void 0:{mtime:{secs:e.Seconds,nsecs:e.FractionalNanoseconds||0}},decodeFileLinks=(e,t)=>{const r=[],n=e.length;for(;0<n;)r.push({cid:t[0].Hash,dagByteLength:t[0].Tsize||0,contentByteLength:e[0]});return r},decodeDirectoryLinks=e=>e.map(e=>({cid:e.Hash,name:e.Name||"",dagByteLength:e.Tsize||0})),cumulativeContentByteLength=e=>e.reduce((e,t)=>e+t.contentByteLength,0),cumulativeDagByteLength=(e,t)=>t.reduce((e,t)=>e+t.dagByteLength,e.byteLength),contentByteLength=e=>e.contentByteLength,encodeNamedLink=({name:e,dagByteLength:t,cid:r})=>({Name:e,Tsize:t,Hash:r}),encodeDirectoryMetadata=e=>encodeMetadata(e,DEFAULT_DIRECTORY_MODE$1),encodeMetadata=({mode:e,mtime:t},r=DEFAULT_FILE_MODE$1)=>({mode:null!=e?encodeMode(e,r):void 0,mtime:null!=t?encodeMTime(t):void 0}),decodeMetadata=e=>null==e?BLANK$2:{...null==e.mode?void 0:{mode:decodeMode(e.mode)},...null==e.mtime?void 0:{mtime:e.mtime}},encodeMTime=e=>null==e?void 0:0!==e.nsecs?{Seconds:e.secs,FractionalNanoseconds:e.nsecs}:{Seconds:e.secs},encodeMode=(e,t)=>{const r=null==e?void 0:decodeMode(e);return r===t||null==r?void 0:r},decodeMode=e=>4095&e|4294963200&e,matchFile=({content:e=EMPTY_BUFFER$1,parts:t=EMPTY$3,metadata:r=BLANK$2,...n})=>0===t.length?new SimpleFileView(e,r):0===e.byteLength?new AdvancedFileView(t,r):new ComplexFileView(e,t,r);class SimpleFileView{constructor(e,t){this.content=e,this.metadata=t,this.layout="simple",this.type=NodeType.File}get filesize(){return this.content.byteLength}encode(){return encodeSimpleFile(this.content,this.metadata)}}class AdvancedFileView{constructor(e,t){this.parts=e,this.metadata=t}get layout(){return"advanced"}get type(){return NodeType.File}get fileSize(){return cumulativeContentByteLength(this.parts)}get blockSizes(){return this.parts.map(contentByteLength)}encode(){return encodeAdvancedFile(this.parts,this.metadata)}}class ComplexFileView{constructor(e,t,r){this.content=e,this.parts=t,this.metadata=r}get layout(){return"complex"}get type(){return NodeType.File}get fileSize(){return this.content.byteLength+cumulativeContentByteLength(this.parts)}get blockSizes(){return this.parts.map(contentByteLength)}encode(){return encodeComplexFile(this.content,this.parts,this.metadata)}}const filesize=e=>{switch(e.type){case NodeType.Raw:case NodeType.Symlink:return e.content.byteLength;case NodeType.File:switch(e.layout){case"simple":return e.content.byteLength;case"advanced":return cumulativeContentByteLength(e.parts);case"complex":return e.content.byteLength+cumulativeContentByteLength(e.parts)}default:return 0}},UnixFS$1=Object.freeze(Object.defineProperty({__proto__:null,DEFAULT_DIRECTORY_MODE:DEFAULT_DIRECTORY_MODE$1,DEFAULT_FILE_MODE:DEFAULT_FILE_MODE$1,NodeType:NodeType,code:code$4,createAdvancedFile:createAdvancedFile,createComplexFile:createComplexFile,createDirectoryShard:createDirectoryShard,createEmptyFile:createEmptyFile,createFileChunk:createFileChunk,createFileShard:createFileShard,createFlatDirectory:createFlatDirectory,createRaw:createRaw,createShardedDirectory:createShardedDirectory,createSimpleFile:createSimpleFile,createSymlink:createSymlink,cumulativeContentByteLength:cumulativeContentByteLength,cumulativeDagByteLength:cumulativeDagByteLength,decode:decode$7,decodeMetadata:decodeMetadata,encode:encode$7,encodeAdvancedFile:encodeAdvancedFile,encodeComplexFile:encodeComplexFile,encodeDirectory:encodeDirectory,encodeDirectoryMetadata:encodeDirectoryMetadata,encodeFile:encodeFile$1,encodeFileChunk:encodeFileChunk,encodeFileShard:encodeFileShard,encodeHAMTShard:encodeHAMTShard,encodeLink:encodeLink,encodeMetadata:encodeMetadata,encodeMode:encodeMode,encodeRaw:encodeRaw,encodeSimpleFile:encodeSimpleFile,encodeSymlink:encodeSymlink,filesize:filesize,matchFile:matchFile,name:name$3},Symbol.toStringTag,{value:"Module"})),effect=function*(e){const t=yield*e;yield*send(t)};function*current(){return yield CURRENT}const suspend=function*(){yield SUSPEND},wait=function*(e){const t=yield*current();if(isAsync(e)){let r,n=!1;if(e.then(e=>{n=!1,r=e,enqueue(t)},e=>{n=!0,r=e,enqueue(t)}),yield*suspend(),n)throw r;return r}return main(wake(t)),yield*suspend(),e};function*wake(e){enqueue(e)}const isAsync=e=>null!=e&&"function"==typeof e.then,send=function*(e){yield e},listen=function*(e){const t=[];for(const r of Object.entries(e)){const[e,n]=r;n!==NONE&&t.push(yield*fork$1(tag(n,e)))}yield*group(t)},effects=e=>e.length>0?batch(e.map(effect)):NONE;function*batch(e){const t=[];for(const r of e)t.push(yield*fork$1(r));yield*group(t)}const tag=(e,t)=>e===NONE?NONE:e instanceof Tagger?new Tagger([...e.tags,t],e.source):new Tagger([t],e);class Tagger{constructor(e,t){this.tags=e,this.source=t,this.controller}[Symbol.iterator](){return this.controller||(this.controller=this.source[Symbol.iterator]()),this}box(e){if(e.done)return e;switch(e.value){case SUSPEND:case CURRENT:return e;default:{const t=e;let{value:r}=t;for(const e of this.tags)r=withTag(e,r);return t.value=r,t}}}next(e){return this.box(this.controller.next(e))}throw(e){return this.box(this.controller.throw(e))}return(e){return this.box(this.controller.return(e))}get[Symbol.toStringTag](){return"TaggedEffect"}}const none=()=>NONE,withTag=(e,t)=>({type:e,[e]:t}),CURRENT=Symbol("current"),SUSPEND=Symbol("suspend");class Group{static of(e){return e.group||MAIN}static enqueue(e,t){e.group=t,t.stack.active.push(e)}constructor(e,t=[],r=new Set,n=new Stack(t,r)){this.driver=e,this.parent=Group.of(e),this.stack=n,this.id=++ID}}class Main{constructor(){this.status=IDLE,this.stack=new Stack,this.id=0}}class Stack{constructor(e=[],t=new Set){this.active=e,this.idle=t}static size({active:e,idle:t}){return e.length+t.size}}const main=e=>enqueue(e[Symbol.iterator]()),enqueue=e=>{let t=Group.of(e);for(t.stack.active.push(e),t.stack.idle.delete(e);t.parent;){const{idle:e,active:r}=t.parent.stack;if(!e.has(t.driver))break;e.delete(t.driver),r.push(t.driver),t=t.parent}if(MAIN.status===IDLE)for(MAIN.status=ACTIVE;;)try{for(const e of step(MAIN));MAIN.status=IDLE;break}catch(r){MAIN.stack.active.shift()}},resume=e=>enqueue(e),step=function*(e){const{active:t}=e.stack;let r=t[0];for(e.stack.idle.delete(r);r;){let n=INIT;e:for(;!n.done&&r===t[0];){const t=n.value;switch(t){case SUSPEND:e.stack.idle.add(r);break e;case CURRENT:n=r.next(r);break;default:n=r.next(yield t)}}t.shift(),r=t[0],e.stack.idle.delete(r)}},fork$1=(e,t)=>new Fork(e,t),exit=(e,t)=>conclude(e,{ok:!0,value:t}),abort=(e,t)=>conclude(e,{ok:!1,error:t});function*conclude(e,t){try{const r=e,n=t.ok?r.return(t.value):r.throw(t.error);if(!n.done)if(n.value===SUSPEND){const{idle:e}=Group.of(r).stack;e.add(r)}else enqueue(r)}catch(r){}}function*group(e){if(0===e.length)return;const t=yield*current(),r=new Group(t);let n=null;for(const o of e){const{result:e}=o;e?e.ok||n||(n=e):move(o,r)}try{if(n)throw n.error;for(;yield*step(r),Stack.size(r.stack)>0;)yield*suspend()}catch(i){for(const e of r.stack.active)yield*abort(e,i);for(const e of r.stack.idle)yield*abort(e,i),enqueue(e);throw i}}const move=(e,t)=>{const r=Group.of(e);if(r!==t){const{active:n,idle:i}=r.stack,o=t.stack;if(e.group=t,i.has(e))i.delete(e),o.idle.add(e);else{const t=n.indexOf(e);t>=0&&(n.splice(t,1),o.active.push(e))}}};function*join(e){e.status===IDLE&&(yield*e),e.result||(yield*group([e]));const t=e.result;if(t.ok)return t.value;throw t.error}class Future{constructor(e){this.handler=e,this.result}get promise(){const{result:e}=this,t=null==e?new Promise((e,t)=>{this.handler.onsuccess=e,this.handler.onfailure=t}):e.ok?Promise.resolve(e.value):Promise.reject(e.error);return Object.defineProperty(this,"promise",{value:t}),t}then(e,t){return this.activate().promise.then(e,t)}catch(e){return this.activate().promise.catch(e)}finally(e){return this.activate().promise.finally(e)}activate(){return this}}class Fork extends Future{constructor(e,t=BLANK$1,r={},n=INIT){super(r),this.id=++ID,this.name=t.name||"",this.task=e,this.state=n,this.status=IDLE,this.result,this.handler=r,this.controller}*resume(){resume(this)}join(){return join(this)}abort(e){return abort(this,e)}exit(e){return exit(this,e)}get[Symbol.toStringTag](){return"Fork"}*[Symbol.iterator](){return this.activate()}activate(){return this.controller=this.task[Symbol.iterator](),this.status=ACTIVE,enqueue(this),this}panic(e){this.result={ok:!1,error:e},this.status=FINISHED;const{handler:t}=this;throw t.onfailure&&t.onfailure(e),e}step(e){if(this.state=e,e.done){this.result={ok:!0,value:e.value},this.status=FINISHED;const{handler:t}=this;t.onsuccess&&t.onsuccess(e.value)}return e}next(e){try{return this.step(this.controller.next(e))}catch(t){return this.panic(t)}}return(e){try{return this.step(this.controller.return(e))}catch(t){return this.panic(t)}}throw(e){try{return this.step(this.controller.throw(e))}catch(t){return this.panic(t)}}}const loop=function*(e,t){const r=yield*current(),n=new Group(r);for(Group.enqueue(e[Symbol.iterator](),n);;){for(const e of step(n))Group.enqueue(t(e)[Symbol.iterator](),n);if(!(Stack.size(n.stack)>0))break;yield*suspend()}};let ID=0;const IDLE="idle",ACTIVE="active",FINISHED="finished",INIT={done:!1,value:CURRENT},BLANK$1={},NONE=function*(){}(),MAIN=new Main;function Indexed(){}Object.defineProperties(Indexed,{prototype:{value:new Proxy(Object.prototype,{get:(e,t,r)=>"symbol"==typeof t?Reflect.get(e,t,r):r.get(t)})}});const empty=()=>new BufferView,slice=(e,t=0,r=e.byteLength)=>{const n=[],i=t<0?e.byteLength-t:t,o=r<0?e.byteLength-r:r;if(0===i&&o>=e.byteLength)return e;if(i>o||i>e.byteLength||o<=0)return empty();let s=0,a=0;for(const l of e.segments){const e=a+l.byteLength;if(0===s){if(o<=e){const e=l.subarray(i-a,o-a);n.push(e),s=e.byteLength;break}if(i<e){const e=i===a?l:l.subarray(i-a);n.push(e),s=e.byteLength}}else{if(o<=e){const t=o===e?l:l.subarray(0,o-a);n.push(t),s+=t.byteLength;break}n.push(l),s+=l.byteLength}a=e}return new BufferView(n,e.byteOffset+i,s)},push=(e,t)=>t.byteLength>0?(e.segments.push(t),new BufferView(e.segments,e.byteOffset,e.byteLength+t.byteLength)):e,get=(e,t)=>{if(t<e.byteLength){let r=0;for(const n of e.segments){if(t<r+n.byteLength)return n[t-r];r+=n.byteLength}}},copyTo=(e,t,r)=>{let n=r;for(const i of e.segments)t.set(i,n),n+=i.byteLength;return t};function*iterate(e){for(const t of e.segments)yield*t}class BufferView extends Indexed{constructor(e=[],t=0,r=0){super(),this.segments=e,this.byteLength=r,this.length=r,this.byteOffset=t}[Symbol.iterator](){return iterate(this)}slice(e,t){return slice(this,e,t)}subarray(e,t){return slice(this,e,t)}push(e){return push(this,e)}get(e){return get(this,e)}copyTo(e,t){return copyTo(this,e,t)}}const panic=e=>{throw new Error(e)},unreachable=(e,t,...r)=>panic(String.raw(e,JSON.stringify(t),...r)),EMPTY_BUFFER=new Uint8Array(0),EMPTY$2=[],open$1=e=>({config:e,buffer:empty()}),write$4=(e,t)=>t.byteLength>0?split(e.config,e.buffer.push(t),!1):{...e,chunks:EMPTY$2},close$6=e=>split(e.config,e.buffer,!0),split=(e,t,r)=>{const n=e.chunker,i=[];let o=0;for(const s of n.cut(n.context,t,r))if(s>0){const e=t.subarray(o,o+s);i.push(e),o+=s}return{config:e,chunks:i,buffer:t.subarray(o)}},mutable=()=>({mutable:!0,needs:{},nodes:{},links:{},linked:EMPTY$1}),addNodes=(e,t)=>{let r=patch(t,{});for(const n of e){const{ready:e,has:t,wants:i}=collect$1(n.children,r.links);r=0===i.length?patch(r,{links:assign(void 0,t),linked:[{id:n.id,links:e}]}):patch(r,{needs:assign(n.id,i),nodes:{[n.id]:{children:n.children,count:i.length}}})}return r},addLink=(e,t,r)=>{const n=r.needs[e],i=r.nodes[n];if(null!=i){if(1===i.count){const{ready:o,has:s}=collect$1(i.children,{...r.links,[e]:t});return patch(r,{needs:{[e]:void 0},links:assign(void 0,s),nodes:{[n]:void 0},linked:[{id:n,links:o}]})}return patch(r,{needs:{[e]:void 0},links:{[e]:t},nodes:{[n]:{...i,count:i.count-1}}})}return patch(r,{links:{[e]:t}})},patch=(e,{needs:t,nodes:r,links:n,linked:i})=>{const o=e.mutable?e:{...e},s=e.mutable?BLANK:void 0;return t&&(o.needs=patchDict(e.needs,t,s)),r&&(o.nodes=patchDict(e.nodes,r,s)),n&&(o.links=patchDict(e.links,n,s)),o.linked=i?append(e.linked||EMPTY$1,i,EMPTY$1):e.linked||[],o},assign=(e,t)=>{const r={};for(const n of t)r[n]=e;return r},patchDict=(e,t,r=e)=>{const n=e===r?{...e}:e;for(const i of Object.entries(t)){const[e,t]=i;null==t?delete n[e]:n[e]=t}return n},append=(e,t,r=e)=>{if(e===r)return[...e,...t];for(const n of t)e.push(n);return e},collect$1=(e,t)=>{const r=[],n=[],i=[];for(const o of e){const e=t[o];e?(r.push(o),i.push(e)):n.push(o)}return{has:r,wants:n,ready:i}},EMPTY$1=Object.freeze([]),BLANK=Object.freeze({}),update=(e,t)=>{switch(e.type){case"write":return write$3(t,e.bytes);case"link":return link(t,e.link);case"block":case"end":return{state:t,effect:none()};case"close":return close$5(t);default:return unreachable`File Writer got unknown message ${e}`}},init=(e,t,r)=>({status:"open",metadata:t,config:r,writer:e,chunker:open$1({chunker:r.chunker}),layout:r.fileLayout.open(),nodeQueue:mutable()}),write$3=(e,t)=>{if("open"===e.status){const{chunks:r,...n}=write$4(e.chunker,t),{nodes:i,leaves:o,layout:s}=e.config.fileLayout.write(e.layout,r),{linked:a,...l}=addNodes(i,e.nodeQueue),c=[...encodeLeaves(o,e.config),...encodeBranches(a,e.config)];return{state:{...e,chunker:n,layout:s,nodeQueue:l},effect:listen({link:effects(c)})}}return panic("Unable to perform write on closed file")},link=(e,{id:t,link:r,block:n})=>{let{linked:i,...o}=addLink(t,r,e.nodeQueue);const s=encodeBranches(i,e.config),a="closed"===e.status&&t===e.rootID?{...e,status:"linked",link:r,nodeQueue:o}:{...e,nodeQueue:o},l="closed"===e.status&&t===e.rootID&&e.end?e.end.resume():none();return{state:a,effect:listen({link:effects(s),block:writeBlock(e.writer,n),end:l})}},close$5=e=>{if("open"===e.status){const{chunks:t}=close$6(e.chunker),{layout:r,...n}=e.config.fileLayout.write(e.layout,t),{root:i,...o}=e.config.fileLayout.close(r,e.metadata),[s,a]=isLeafNode(i)?[[...n.nodes,...o.nodes],[...n.leaves,...o.leaves,i]]:[[...n.nodes,...o.nodes,i],[...n.leaves,...o.leaves]],{linked:l,...c}=addNodes(s,e.nodeQueue),u=[...encodeLeaves(a,e.config),...encodeBranches(l,e.config)],d=fork$1(suspend());return{state:{...e,chunker:null,layout:null,rootID:i.id,status:"closed",end:d,nodeQueue:c},effect:listen({link:effects(u),end:join(d)})}}return{state:e,effect:none()}},encodeLeaves=(e,t)=>e.map(e=>encodeLeaf(t,e,t.fileChunkEncoder)),encodeLeaf=function*({hasher:e,linker:t},{id:r,content:n},i){const o=i.encode(n?asUint8Array$1(n):EMPTY_BUFFER),s=yield*wait(e.digest(o)),a=t.createLink(i.code,s);return{id:r,block:{cid:a,bytes:o},link:{cid:a,contentByteLength:n?n.byteLength:0,dagByteLength:o.byteLength}}},encodeBranches=(e,t)=>e.map(e=>encodeBranch(t,e)),encodeBranch=function*(e,{id:t,links:r},n){const i=e.fileEncoder.encode({type:NodeType.File,layout:"advanced",parts:r,metadata:n}),o=yield*wait(Promise.resolve(e.hasher.digest(i))),s=e.linker.createLink(e.fileEncoder.code,o);return{id:t,block:{bytes:i,cid:s},link:{cid:s,contentByteLength:cumulativeContentByteLength(r),dagByteLength:cumulativeDagByteLength(i,r)}}},writeBlock=function*(e,t){(e.desiredSize||0)<=0&&(yield*wait(e.ready)),e.write(t)},asUint8Array$1=e=>e instanceof Uint8Array?e:e.copyTo(new Uint8Array(e.byteLength),0),isLeafNode=e=>null==e.children,name$2="fixed",context={maxChunkSize:262144},type="Stateless",withMaxChunkSize=e=>({type:"Stateless",context:{maxChunkSize:e},name:name$2,cut:cut}),cut=({maxChunkSize:e},{byteLength:t},r)=>{const n=t/e|0,i=new Array(n).fill(e),o=r?t-n*e:0;return o>0&&i.push(o),i},FixedSize=Object.freeze(Object.defineProperty({__proto__:null,context:context,cut:cut,name:name$2,type:type,withMaxChunkSize:withMaxChunkSize},Symbol.toStringTag,{value:"Module"}));let Node$2=class{constructor(e,t,r){this.id=e,this.children=t,this.metadata=r}};const withWidth=e=>({open:()=>open({width:e}),write:write$2,close:close$4}),defaults$3={width:174},open=({width:e}=defaults$3)=>({width:e,head:null,leafIndex:[],nodeIndex:[],lastID:0}),write$2=(e,t)=>{if(0===t.length)return{layout:e,nodes:EMPTY,leaves:EMPTY};{let{lastID:r}=e;const[n,i]=e.head?[null,(t.unshift(e.head),t)]:1===t.length&&0===e.leafIndex.length?[t[0],EMPTY]:[null,t];if(0===i.length)return{layout:{...e,head:n},nodes:EMPTY,leaves:EMPTY};{const t=[...e.leafIndex],o=[];for(const e of i){const n={id:++r,content:e};o.push(n),t.push(n.id)}return t.length>e.width?flush({...e,leafIndex:t,head:n,lastID:r},o):{layout:{...e,head:n,leafIndex:t,lastID:r},leaves:o,nodes:EMPTY}}}},flush=(e,t=EMPTY,r=[],n=!1)=>{let{lastID:i}=e;const o=e.nodeIndex.map(e=>[...e]),s=[...e.leafIndex],{width:a}=e;for(;s.length>a||s.length>0&&n;){grow(o,1);const e=new Node$2(++i,s.splice(0,a));o[0].push(e.id),r.push(e)}let l=0;for(;l<o.length;){const e=o[l];for(l++;e.length>a||e.length>0&&n&&l<o.length;){const t=new Node$2(++i,e.splice(0,a));grow(o,l+1),o[l].push(t.id),r.push(t)}}return{layout:{...e,lastID:i,leafIndex:s,nodeIndex:o},leaves:t,nodes:r}},close$4=(e,t)=>{const r=e;if(e.head)return{root:{id:1,content:e.head,metadata:t},leaves:EMPTY,nodes:EMPTY};if(0===e.leafIndex.length)return{root:{id:1,metadata:t},leaves:EMPTY,nodes:EMPTY};{const{nodes:e,layout:n}=flush(r,EMPTY,[],!0),{nodeIndex:i}=n,o=i[i.length-1];if(1===o.length){const t=e[e.length-1];return e.length=e.length-1,{root:t,nodes:e,leaves:EMPTY}}return{root:new Node$2(n.lastID+1,o,t),nodes:e,leaves:EMPTY}}},grow=(e,t)=>{for(;e.length<t;)e.push([]);return e},EMPTY=[],defaults$2=()=>({chunker:FixedSize,fileChunkEncoder:UnixFSLeaf,smallFileEncoder:UnixFSLeaf,fileEncoder:UnixFS$1,fileLayout:withWidth(174),hasher:sha256,linker:{createLink:CID.createV1}}),configure$1=e=>({...defaults$2(),...e}),UnixFSLeaf={code:code$4,name:name$3,encode:encodeFileChunk},create$5=({writer:e,metadata:t={},settings:r=defaults$2()})=>new FileWriterView(init(e,t,configure$1(r))),write$1=async(e,t)=>(await perform(e,send({type:"write",bytes:t})),e),close$3=async(e,{releaseLock:t=!1,closeWriter:r=!1}={})=>{await perform(e,send({type:"close"}));const{state:n}=e;if("linked"===n.status)return r?await e.state.writer.close():t&&e.state.writer.releaseLock(),n.link;panic(`Expected writer to be in 'linked' state after close, but it is in "${n.status}" instead`)},perform=(e,t)=>fork$1(loop(t,t=>{const{state:r,effect:n}=update(t,e.state);return e.state=r,n}));class FileWriterView{constructor(e){this.state=e}get writer(){return this.state.writer}get settings(){return this.state.config}write(e){return write$1(this,e)}close(e){return close$3(this,e)}}const defaults$1=defaults$2,create$4=({writer:e,settings:t=defaults$1(),metadata:r={}})=>new DirectoryWriter({writer:e,metadata:r,settings:t,entries:new Map,closed:!1}),set=(e,t,r,{overwrite:n=!1}={})=>{const i=asWritable(e.state);if(t.includes("/"))throw new Error(`Directory entry name "${t}" contains forbidden "/" character`);if(!n&&i.entries.has(t))throw new Error(`Directory already contains entry with name "${t}"`);return i.entries.set(t,r),e},remove=(e,t)=>(asWritable(e.state).entries.delete(t),e),asWritable=e=>{if(e.closed)throw new Error("Can not change written directory, but you can .fork() and make changes to it");return e},close$2=async(e,{closeWriter:t=!1,releaseLock:r=!1}={})=>{const{writer:n,settings:i,metadata:o}=asWritable(e.state);e.state.closed=!0;const s=[...links(e)],a=createFlatDirectory(s,o),l=encodeDirectory(a),c=await i.hasher.digest(l),u=i.linker.createLink(code$4,c);return(n.desiredSize||0)<=0&&await n.ready,n.write({cid:u,bytes:l}),t?await n.close():r&&n.releaseLock(),{cid:u,dagByteLength:cumulativeDagByteLength(l,s)}},links=function*({state:e}){for(const[t,{dagByteLength:r,cid:n}]of e.entries)yield{name:t,dagByteLength:r,cid:n}},fork=({state:e},{writer:t=e.writer,metadata:r=e.metadata,settings:n=e.settings}={})=>new DirectoryWriter({writer:t,metadata:r,settings:n,entries:new Map(e.entries.entries()),closed:!1});class DirectoryWriter{constructor(e){this.state=e}get writer(){return this.state.writer}get settings(){return this.state.settings}links(){return links(this)}set(e,t,r){return set(this,e,t,r)}remove(e){return remove(this,e)}fork(e){return fork(this,e)}close(e){return close$2(this,e)}entries(){return this.state.entries.entries()}has(e){return this.state.entries.has(e)}get size(){return this.state.entries.size}}var murmurHash3js={exports:{}},module,exports;module=murmurHash3js,exports=murmurHash3js.exports,function(e,t){var r={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function n(e){if(!Array.isArray(e)&&!ArrayBuffer.isView(e))return!1;for(var t=0;t<e.length;t++)if(!Number.isInteger(e[t])||e[t]<0||e[t]>255)return!1;return!0}function i(e,t){return(65535&e)*t+(((e>>>16)*t&65535)<<16)}function o(e,t){return e<<t|e>>>32-t}function s(e){return e=i(e^=e>>>16,2246822507),e=i(e^=e>>>13,3266489909),e^=e>>>16}function a(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]+t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]+t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]+t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]+t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function l(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]*t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]*t[3],r[1]+=r[2]>>>16,r[2]&=65535,r[2]+=e[3]*t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]*t[3],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[2]*t[2],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[3]*t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function c(e,t){return 32==(t%=64)?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:(t-=32,[e[1]<<t|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t])}function u(e,t){return 0==(t%=64)?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]}function d(e,t){return[e[0]^t[0],e[1]^t[1]]}function h(e){return e=d(e,[0,e[0]>>>1]),e=d(e=l(e,[4283543511,3981806797]),[0,e[0]>>>1]),e=d(e=l(e,[3301882366,444984403]),[0,e[0]>>>1])}r.x86.hash32=function(e,a){if(r.inputValidation&&!n(e))return t;a=a||0;for(var l=e.length%4,c=e.length-l,u=a,d=0,h=3432918353,f=461845907,p=0;p<c;p+=4)d=i(d=e[p]|e[p+1]<<8|e[p+2]<<16|e[p+3]<<24,h),d=i(d=o(d,15),f),u=i(u=o(u^=d,13),5)+3864292196;switch(d=0,l){case 3:d^=e[p+2]<<16;case 2:d^=e[p+1]<<8;case 1:d=i(d^=e[p],h),u^=d=i(d=o(d,15),f)}return(u=s(u^=e.length))>>>0},r.x86.hash128=function(e,a){if(r.inputValidation&&!n(e))return t;a=a||0;for(var l=e.length%16,c=e.length-l,u=a,d=a,h=a,f=a,p=0,y=0,g=0,m=0,b=597399067,w=2869860233,v=951274213,k=2716044179,_=0;_<c;_+=16)p=e[_]|e[_+1]<<8|e[_+2]<<16|e[_+3]<<24,y=e[_+4]|e[_+5]<<8|e[_+6]<<16|e[_+7]<<24,g=e[_+8]|e[_+9]<<8|e[_+10]<<16|e[_+11]<<24,m=e[_+12]|e[_+13]<<8|e[_+14]<<16|e[_+15]<<24,p=o(p=i(p,b),15),u=o(u^=p=i(p,w),19),u=i(u+=d,5)+1444728091,y=o(y=i(y,w),16),d=o(d^=y=i(y,v),17),d=i(d+=h,5)+197830471,g=o(g=i(g,v),17),h=o(h^=g=i(g,k),15),h=i(h+=f,5)+2530024501,m=o(m=i(m,k),18),f=o(f^=m=i(m,b),13),f=i(f+=u,5)+850148119;switch(p=0,y=0,g=0,m=0,l){case 15:m^=e[_+14]<<16;case 14:m^=e[_+13]<<8;case 13:m=i(m^=e[_+12],k),f^=m=i(m=o(m,18),b);case 12:g^=e[_+11]<<24;case 11:g^=e[_+10]<<16;case 10:g^=e[_+9]<<8;case 9:g=i(g^=e[_+8],v),h^=g=i(g=o(g,17),k);case 8:y^=e[_+7]<<24;case 7:y^=e[_+6]<<16;case 6:y^=e[_+5]<<8;case 5:y=i(y^=e[_+4],w),d^=y=i(y=o(y,16),v);case 4:p^=e[_+3]<<24;case 3:p^=e[_+2]<<16;case 2:p^=e[_+1]<<8;case 1:p=i(p^=e[_],b),u^=p=i(p=o(p,15),w)}return u^=e.length,u+=d^=e.length,u+=h^=e.length,d+=u+=f^=e.length,h+=u,f+=u,u=s(u),u+=d=s(d),u+=h=s(h),d+=u+=f=s(f),h+=u,f+=u,("00000000"+(u>>>0).toString(16)).slice(-8)+("00000000"+(d>>>0).toString(16)).slice(-8)+("00000000"+(h>>>0).toString(16)).slice(-8)+("00000000"+(f>>>0).toString(16)).slice(-8)},r.x64.hash128=function(e,i){if(r.inputValidation&&!n(e))return t;i=i||0;for(var o=e.length%16,s=e.length-o,f=[0,i],p=[0,i],y=[0,0],g=[0,0],m=[2277735313,289559509],b=[1291169091,658871167],w=0;w<s;w+=16)y=[e[w+4]|e[w+5]<<8|e[w+6]<<16|e[w+7]<<24,e[w]|e[w+1]<<8|e[w+2]<<16|e[w+3]<<24],g=[e[w+12]|e[w+13]<<8|e[w+14]<<16|e[w+15]<<24,e[w+8]|e[w+9]<<8|e[w+10]<<16|e[w+11]<<24],y=c(y=l(y,m),31),f=a(f=c(f=d(f,y=l(y,b)),27),p),f=a(l(f,[0,5]),[0,1390208809]),g=c(g=l(g,b),33),p=a(p=c(p=d(p,g=l(g,m)),31),f),p=a(l(p,[0,5]),[0,944331445]);switch(y=[0,0],g=[0,0],o){case 15:g=d(g,u([0,e[w+14]],48));case 14:g=d(g,u([0,e[w+13]],40));case 13:g=d(g,u([0,e[w+12]],32));case 12:g=d(g,u([0,e[w+11]],24));case 11:g=d(g,u([0,e[w+10]],16));case 10:g=d(g,u([0,e[w+9]],8));case 9:g=l(g=d(g,[0,e[w+8]]),b),p=d(p,g=l(g=c(g,33),m));case 8:y=d(y,u([0,e[w+7]],56));case 7:y=d(y,u([0,e[w+6]],48));case 6:y=d(y,u([0,e[w+5]],40));case 5:y=d(y,u([0,e[w+4]],32));case 4:y=d(y,u([0,e[w+3]],24));case 3:y=d(y,u([0,e[w+2]],16));case 2:y=d(y,u([0,e[w+1]],8));case 1:y=l(y=d(y,[0,e[w]]),m),f=d(f,y=l(y=c(y,31),b))}return f=a(f=d(f,[0,e.length]),p=d(p,[0,e.length])),p=a(p,f),f=a(f=h(f),p=h(p)),p=a(p,f),("00000000"+(f[0]>>>0).toString(16)).slice(-8)+("00000000"+(f[1]>>>0).toString(16)).slice(-8)+("00000000"+(p[0]>>>0).toString(16)).slice(-8)+("00000000"+(p[1]>>>0).toString(16)).slice(-8)},module.exports&&(exports=module.exports=r),exports.murmurHash3=r}();var murmurHash3jsExports=murmurHash3js.exports,murmurhash3jsRevisited=murmurHash3jsExports;const mur=getDefaultExportFromCjs(murmurhash3jsRevisited);new TextEncoder,mur.x64.hash126;const murmur3128=from({name:"murmur3-128",code:34,encode:e=>fromHex(mur.x64.hash128(e))}),murmur364=from({name:"murmur3-x64-64",code:34,encode:e=>fromHex(mur.x64.hash128(e)).subarray(0,8)});new TextEncoder;const toInt=(e,t,r)=>{let n=t/8|0,i=t%8,o=r,s=0;for(;o>0&&n<e.byteLength;){const t=8-i,r=t<o?t:o;s=(s<<r)+((255>>i&e[n])>>8-i-r),o-=r,n++,i=0}return s},utf8=new TextEncoder,hash64=e=>murmur364.encode(e),configure=({bitWidth:e=8,hash:t=hash64})=>{const r=t(new Uint8Array).byteLength,n={bitWidth:e,hash:t,hashSize:r};return{at:(e,t)=>read$2(e,t,n),from:e=>utf8.encode(e),size:1/0}},read$2=(e,t=0,{bitWidth:r=8,hash:n,hashSize:i})=>{const o=8*i;let s=0,a=r,l=r*t;for(;a>0;){const t=l/o|0,r=n(0===t?e:appendByte(e,t)),i=o<=l?l%o:l,c=o-i,u=c<a?c:a;s=(s<<u)+toInt(r,i,u),a-=u,l+=u}return s},appendByte=(e,t)=>{const r=new Uint8Array(e.byteLength+1).fill(t,e.byteLength);return r.set(e),r},bitWidth=8;configure({bitWidth:bitWidth});const createWriter$2=({writable:e,settings:t=defaults$2()})=>new FileSystemWriter({writer:e.getWriter(),settings:t}),close$1=async(e,{releaseLock:t=!0,closeWriter:r=!0}={})=>(r?await e.writer.close():t&&e.writer.releaseLock(),e);class FileSystemWriter{constructor({writer:e,settings:t}){this.writer=e,this.settings=configure$1(t)}createFileWriter({settings:e=this.settings,metadata:t}={}){return create$5({writer:this.writer,settings:e,metadata:t})}createDirectoryWriter({settings:e=this.settings,metadata:t}={}){return create$4({writer:this.writer,settings:e,metadata:t})}close(e){return close$1(this,e)}}const BLOCK_SIZE_LIMIT=1048576,defaultCapacity=100*BLOCK_SIZE_LIMIT,withCapacity=(e=defaultCapacity)=>({highWaterMark:e,size:e=>e.bytes.length}),name$1="raw",code$3=85;function encode$6(e){return coerce(e)}function decode$6(e){return coerce(e)}const raw=Object.freeze(Object.defineProperty({__proto__:null,code:code$3,decode:decode$6,encode:encode$6,name:name$1},Symbol.toStringTag,{value:"Module"}));function isAsyncIterable$4(e){return null!=e[Symbol.asyncIterator]}function last(e){if(isAsyncIterable$4(e))return(async()=>{let t;for await(const r of e)t=r;return t})();let t;for(const r of e)t=r;return t}const _BadPathError=class e extends Error{constructor(t="Bad path"){super(t),__publicField(this,"name",e.name),__publicField(this,"code",e.code)}};__publicField(_BadPathError,"name","BadPathError"),__publicField(_BadPathError,"code","ERR_BAD_PATH");let BadPathError=_BadPathError,NotFoundError$1=(_c=class extends Error{constructor(e="Not found"){super(e),__publicField(this,"name",_c.name),__publicField(this,"code",_c.code)}},__publicField(_c,"name","NotFoundError"),__publicField(_c,"code","ERR_NOT_FOUND"),_c);const _NoResolverError=class e extends Error{constructor(t="No resolver"){super(t),__publicField(this,"name",e.name),__publicField(this,"code",e.code)}};__publicField(_NoResolverError,"name","NoResolverError"),__publicField(_NoResolverError,"code","ERR_NO_RESOLVER");let NoResolverError=_NoResolverError;const _NotUnixFSError=class e extends Error{constructor(t="Not UnixFS"){super(t),__publicField(this,"name",e.name),__publicField(this,"code",e.code)}};__publicField(_NotUnixFSError,"name","NotUnixFSError"),__publicField(_NotUnixFSError,"code","ERR_NOT_UNIXFS");let NotUnixFSError=_NotUnixFSError;const _OverReadError=class e extends Error{constructor(t="Over read"){super(t),__publicField(this,"name",e.name),__publicField(this,"code",e.code)}};__publicField(_OverReadError,"name","OverReadError"),__publicField(_OverReadError,"code","ERR_OVER_READ");let OverReadError=_OverReadError;const _UnderReadError=class e extends Error{constructor(t="Under read"){super(t),__publicField(this,"name",e.name),__publicField(this,"code",e.code)}};__publicField(_UnderReadError,"name","UnderReadError"),__publicField(_UnderReadError,"code","ERR_UNDER_READ");let UnderReadError=_UnderReadError;const _NoPropError=class e extends Error{constructor(t="No Property found"){super(t),__publicField(this,"name",e.name),__publicField(this,"code",e.code)}};__publicField(_NoPropError,"name","NoPropError"),__publicField(_NoPropError,"code","ERR_NO_PROP");let NoPropError=_NoPropError;const _InvalidParametersError=class e extends Error{constructor(t="Invalid parameters"){super(t),__publicField(this,"name",e.name),__publicField(this,"code",e.code)}};__publicField(_InvalidParametersError,"name","InvalidParametersError"),__publicField(_InvalidParametersError,"code","ERR_INVALID_PARAMS");let InvalidParametersError=_InvalidParametersError;function wrapCompareTokens(e){const t=(t,r,n)=>e(t,r,n);return t.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0},t}function makeJSONEncoders(){const e=[],t=[];function r(e){const r=t[t.length-1];r&&(r.type.equals(Type.array)&&(r.elements++,1!==r.elements&&e.push([44])),r.type.equals(Type.map)&&(r.elements++,1!==r.elements&&(r.elements%2==1?e.push([44]):e.push([58]))))}return e[Type.uint.major]=wrapCompareTokens((e,t)=>{r(e);const n=String(t.value),i=[];for(let r=0;r<n.length;r++)i[r]=n.charCodeAt(r);e.push(i)}),e[Type.negint.major]=wrapCompareTokens((t,r,n)=>{e[Type.uint.major](t,r,n)}),e[Type.bytes.major]=wrapCompareTokens((e,t,{encodeErrPrefix:r})=>{throw new Error(`${r} unsupported type: Uint8Array`)}),e[Type.string.major]=wrapCompareTokens((e,t)=>{r(e);const n=fromString$1(JSON.stringify(t.value));e.push(n.length>32?asU8A(n):n)}),e[Type.array.major]=wrapCompareTokens((e,n)=>{r(e),t.push({type:Type.array,elements:0}),e.push([91])}),e[Type.map.major]=wrapCompareTokens((e,n)=>{r(e),t.push({type:Type.map,elements:0}),e.push([123])}),e[Type.tag.major]=wrapCompareTokens((e,t)=>{}),e[Type.float.major]=wrapCompareTokens((e,n,{encodeErrPrefix:i})=>{if(n.type.equals(Type.break)){const r=t.pop();if(r){if(r.type.equals(Type.array))e.push([93]);else{if(!r.type.equals(Type.map))throw new Error("Unexpected recursive type; this should not happen!");e.push([125])}return}throw new Error("Unexpected break; this should not happen!")}if(void 0===n.value)throw new Error(`${i} unsupported type: undefined`);if(r(e),n.type.equals(Type.true))return void e.push([116,114,117,101]);if(n.type.equals(Type.false))return void e.push([102,97,108,115,101]);if(n.type.equals(Type.null))return void e.push([110,117,108,108]);const o=String(n.value),s=[];let a=!1;for(let t=0;t<o.length;t++)s[t]=o.charCodeAt(t),a||46!==s[t]&&101!==s[t]&&69!==s[t]||(a=!0);a||(s.push(46),s.push(48)),e.push(s)}),e}const encodeErrPrefix="JSON encode error:";function mapSorter(e,t){if(Array.isArray(e[0])||Array.isArray(t[0]))throw new Error(`${encodeErrPrefix} complex map keys are not supported`);const r=e[0],n=t[0];if(!r.type.equals(Type.string)||!n.type.equals(Type.string))throw new Error(`${encodeErrPrefix} non-string map keys are not supported`);if(r<n)return-1;if(r>n)return 1;throw new Error(`${encodeErrPrefix} unexpected duplicate map keys, this is not supported`)}const defaultEncodeOptions$1={addBreakTokens:!0,encodeErrPrefix:encodeErrPrefix,mapSorter:mapSorter};function encode$5(e,t){return t=Object.assign({},defaultEncodeOptions$1,t),encodeCustom(e,makeJSONEncoders(),t)}class Tokenizer{constructor(e,t){this._pos=0,this.data=e,this.options=t,this.modeStack=["value"],this.lastToken=""}pos(){return this._pos}done(){return this._pos>=this.data.length}ch(){return this.data[this._pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();for(;32===e||9===e||13===e||10===e;)e=this.data[++this._pos]}expect(e){if(this.data.length-this._pos<e.length)throw new Error(`${this.options.decodeErrPrefix} unexpected end of input at position ${this._pos}`);for(let t=0;t<e.length;t++)if(this.data[this._pos++]!==e[t])throw new Error(`${this.options.decodeErrPrefix} unexpected token at position ${this._pos}, expected to find '${String.fromCharCode(...e)}'`)}parseNumber(){const e=this._pos;let t=!1,r=!1;const n=e=>{for(;!this.done();){const t=this.ch();if(!e.includes(t))break;this._pos++}};if(45===this.ch()&&(t=!0,this._pos++),48===this.ch()){if(this._pos++,46!==this.ch())return new Token(Type.uint,0,this._pos-e);this._pos++,r=!0}if(n([48,49,50,51,52,53,54,55,56,57]),t&&this._pos===e+1)throw new Error(`${this.options.decodeErrPrefix} unexpected token at position ${this._pos}`);if(!this.done()&&46===this.ch()){if(r)throw new Error(`${this.options.decodeErrPrefix} unexpected token at position ${this._pos}`);r=!0,this._pos++,n([48,49,50,51,52,53,54,55,56,57])}this.done()||101!==this.ch()&&69!==this.ch()||(r=!0,this._pos++,this.done()||43!==this.ch()&&45!==this.ch()||this._pos++,n([48,49,50,51,52,53,54,55,56,57]));const i=String.fromCharCode.apply(null,this.data.subarray(e,this._pos)),o=parseFloat(i);return r?new Token(Type.float,o,this._pos-e):!0!==this.options.allowBigInt||Number.isSafeInteger(o)?new Token(o>=0?Type.uint:Type.negint,o,this._pos-e):new Token(o>=0?Type.uint:Type.negint,BigInt(i),this._pos-e)}parseString(){if(34!==this.ch())throw new Error(`${this.options.decodeErrPrefix} unexpected character at position ${this._pos}; this shouldn't happen`);this._pos++;for(let i=this._pos,o=0;i<this.data.length&&o<65536;i++,o++){const e=this.data[i];if(92===e||e<32||e>=128)break;if(34===e){const e=String.fromCharCode.apply(null,this.data.subarray(this._pos,i));return this._pos=i+1,new Token(Type.string,e,o)}}const e=this._pos,t=[],r=()=>{if(this._pos+4>=this.data.length)throw new Error(`${this.options.decodeErrPrefix} unexpected end of unicode escape sequence at position ${this._pos}`);let e=0;for(let t=0;t<4;t++){let t=this.ch();if(t>=48&&t<=57)t-=48;else if(t>=97&&t<=102)t=t-97+10;else{if(!(t>=65&&t<=70))throw new Error(`${this.options.decodeErrPrefix} unexpected unicode escape character at position ${this._pos}`);t=t-65+10}e=16*e+t,this._pos++}return e},n=()=>{const e=this.ch();let r,n,i,o,s=null,a=e>239?4:e>223?3:e>191?2:1;if(this._pos+a>this.data.length)throw new Error(`${this.options.decodeErrPrefix} unexpected unicode sequence at position ${this._pos}`);switch(a){case 1:e<128&&(s=e);break;case 2:r=this.data[this._pos+1],128==(192&r)&&(o=(31&e)<<6|63&r,o>127&&(s=o));break;case 3:r=this.data[this._pos+1],n=this.data[this._pos+2],128==(192&r)&&128==(192&n)&&(o=(15&e)<<12|(63&r)<<6|63&n,o>2047&&(o<55296||o>57343)&&(s=o));break;case 4:r=this.data[this._pos+1],n=this.data[this._pos+2],i=this.data[this._pos+3],128==(192&r)&&128==(192&n)&&128==(192&i)&&(o=(15&e)<<18|(63&r)<<12|(63&n)<<6|63&i,o>65535&&o<1114112&&(s=o))}null===s?(s=65533,a=1):s>65535&&(s-=65536,t.push(s>>>10&1023|55296),s=56320|1023&s),t.push(s),this._pos+=a};for(;!this.done();){const i=this.ch();let o;switch(i){case 92:if(this._pos++,this.done())throw new Error(`${this.options.decodeErrPrefix} unexpected string termination at position ${this._pos}`);switch(o=this.ch(),this._pos++,o){case 34:case 39:case 92:case 47:t.push(o);break;case 98:t.push(8);break;case 116:t.push(9);break;case 110:t.push(10);break;case 102:t.push(12);break;case 114:t.push(13);break;case 117:t.push(r());break;default:throw new Error(`${this.options.decodeErrPrefix} unexpected string escape character at position ${this._pos}`)}break;case 34:return this._pos++,new Token(Type.string,decodeCodePointsArray(t),this._pos-e);default:if(i<32)throw new Error(`${this.options.decodeErrPrefix} invalid control character at position ${this._pos}`);i<128?(t.push(i),this._pos++):n()}}throw new Error(`${this.options.decodeErrPrefix} unexpected end of string at position ${this._pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this._pos++,new Token(Type.map,1/0,1);case 91:return this.modeStack.push("array-start"),this._pos++,new Token(Type.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new Token(Type.null,null,4);case 102:return this.expect([102,97,108,115,101]),new Token(Type.false,!1,5);case 116:return this.expect([116,114,117,101]),new Token(Type.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${this.options.decodeErrPrefix} unexpected character at position ${this._pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":if(this.modeStack.pop(),93===this.ch())return this._pos++,this.skipWhitespace(),new Token(Type.break,void 0,1);if(44!==this.ch())throw new Error(`${this.options.decodeErrPrefix} unexpected character at position ${this._pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue();case"array-start":return this.modeStack.pop(),93===this.ch()?(this._pos++,this.skipWhitespace(),new Token(Type.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(125===this.ch())return this.modeStack.pop(),this._pos++,this.skipWhitespace(),new Token(Type.break,void 0,1);if(44!==this.ch())throw new Error(`${this.options.decodeErrPrefix} unexpected character at position ${this._pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this._pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),125===this.ch())return this._pos++,this.skipWhitespace(),new Token(Type.break,void 0,1);const e=this.parseString();if(this.skipWhitespace(),58!==this.ch())throw new Error(`${this.options.decodeErrPrefix} unexpected character at position ${this._pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${this.options.decodeErrPrefix} unexpected parse state at position ${this._pos}; this shouldn't happen`)}}}function decode$5(e,t){return(t={decodeErrPrefix:"JSON decode error:",...t}).tokenizer=t.tokenizer||new Tokenizer(e,t),decode$a(e,t)}const base64=rfc4648({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad=rfc4648({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url=rfc4648({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad=rfc4648({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$1=Object.freeze(Object.defineProperty({__proto__:null,base64:base64,base64pad:base64pad,base64url:base64url,base64urlpad:base64urlpad},Symbol.toStringTag,{value:"Module"}));function toByteView(e){return e instanceof ArrayBuffer?new Uint8Array(e,0,e.byteLength):e}function cidEncoder(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;const t=CID.asCID(e);if(!t)return null;const r=t.toString();return[new Token(Type.map,1/0,1),new Token(Type.string,"/",1),new Token(Type.string,r,r.length),new Token(Type.break,void 0,1)]}function bytesEncoder(e){const t=base64.encode(e).slice(1);return[new Token(Type.map,1/0,1),new Token(Type.string,"/",1),new Token(Type.map,1/0,1),new Token(Type.string,"bytes",5),new Token(Type.string,t,t.length),new Token(Type.break,void 0,1),new Token(Type.break,void 0,1)]}function taBytesEncoder(e){return bytesEncoder(new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function abBytesEncoder(e){return bytesEncoder(new Uint8Array(e))}function undefinedEncoder(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function numberEncoder(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const encodeOptions={typeEncoders:{Object:cidEncoder,Buffer:bytesEncoder,Uint8Array:bytesEncoder,Int8Array:taBytesEncoder,Uint16Array:taBytesEncoder,Int16Array:taBytesEncoder,Uint32Array:taBytesEncoder,Int32Array:taBytesEncoder,Float32Array:taBytesEncoder,Float64Array:taBytesEncoder,Uint8ClampedArray:taBytesEncoder,BigInt64Array:taBytesEncoder,BigUint64Array:taBytesEncoder,DataView:taBytesEncoder,ArrayBuffer:abBytesEncoder,undefined:undefinedEncoder,number:numberEncoder}};class DagJsonTokenizer extends Tokenizer{constructor(e,t){super(e,t),this.tokenBuffer=[]}done(){return 0===this.tokenBuffer.length&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const e=this._next();if(0===e.type.compare(Type.map)){const e=this._next();if(0===e.type.compare(Type.string)&&"/"===e.value){const e=this._next();if(0===e.type.compare(Type.string)){if(this._next().type.compare(Type.break))throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(e),new Token(Type.tag,42,0)}if(0===e.type.compare(Type.map)){const e=this._next();if(0===e.type.compare(Type.string)&&"bytes"===e.value){const e=this._next();if(0===e.type.compare(Type.string)){for(let e=0;e<2;e++){if(this._next().type.compare(Type.break))throw new Error("Invalid encoded Bytes form")}const t=base64.decode(`m${e.value}`);return new Token(Type.bytes,t,e.value.length)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}return e}}const decodeOptions={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};decodeOptions.tags[42]=CID.parse;const code$2=297,encode$4=e=>encode$5(e,encodeOptions),decode$4=e=>{const t=toByteView(e);return decode$5(t,Object.assign(decodeOptions,{tokenizer:new DagJsonTokenizer(t,decodeOptions)}))},format=e=>utf8Decoder.decode(encode$4(e)),utf8Decoder=new TextDecoder,parse=e=>decode$4(utf8Encoder.encode(e)),utf8Encoder=new TextEncoder;new TextEncoder;const textDecoder=new TextDecoder,code$1=512;function decode$3(e){return JSON.parse(textDecoder.decode(e))}const code=0,name="identity",encode$3=coerce;function digest(e,t){if(null!=(null==t?void 0:t.truncate)&&t.truncate!==e.byteLength){if(t.truncate<0||t.truncate>e.byteLength)throw new Error(`Invalid truncate option, must be less than or equal to ${e.byteLength}`);e=e.subarray(0,t.truncate)}return create$c(code,encode$3(e))}const identity$1={code:code,name:name,encode:encode$3,digest:digest};function resolveObjectPath(e,t,r,n,i,o,s){let a=e,l=i;for(;o.length>0;){const c=o[0];if(!(c in a))throw new NoPropError(`No property named ${c} found in node ${r}`);{o.shift(),l=`${l}/${c}`;const u=CID.asCID(a[c]);if(null!=u)return{entry:{type:"object",name:n,path:i,cid:r,node:t,depth:s,size:BigInt(t.length),content:async function*(){yield e}},next:{cid:u,name:c,path:l,toResolve:o}};a=a[c]}}return{entry:{type:"object",name:n,path:i,cid:r,node:t,depth:s,size:BigInt(t.length),content:async function*(){yield e}}}}const resolve$5=async(e,t,r,n,i,o,s,a)=>{const l=await s.get(e,a);return resolveObjectPath(decode$9(l),l,e,t,r,n,o)},resolve$4=async(e,t,r,n,i,o,s,a)=>{const l=await s.get(e,a);return resolveObjectPath(decode$4(l),l,e,t,r,n,o)};class CustomProgressEvent extends Event{constructor(e,t){super(e),__publicField(this,"type"),__publicField(this,"detail"),this.type=e,this.detail=t}}function extractDataFromBlock(e,t,r,n){const i=BigInt(e.length),o=BigInt(t+i);return r>=o||n<t?new Uint8Array(0):(n>=t&&n<o&&(e=e.subarray(0,Number(n-t))),r>=t&&r<o&&(e=e.subarray(Number(r-t))),e)}const validateOffsetAndLength=(e,t=0,r=e)=>{const n=BigInt(e),i=BigInt(t??0);let o=BigInt(r);if(o!==n&&(o=i+o),o>n&&(o=n),i<0n)throw new InvalidParametersError("Offset must be greater than or equal to 0");if(i>n)throw new InvalidParametersError("Offset must be less than the file size");if(o<0n)throw new InvalidParametersError("Length must be greater than or equal to 0");if(o>n)throw new InvalidParametersError("Length must be less than the file size");return{start:i,end:o}},rawContent$1=e=>async function*(t={}){var r;const{start:n,end:i}=validateOffsetAndLength(e.length,t.offset,t.length),o=extractDataFromBlock(e,0n,n,i);null==(r=t.onProgress)||r.call(t,new CustomProgressEvent("unixfs:exporter:progress:identity",{bytesRead:BigInt(o.byteLength),totalBytes:i-n,fileSize:BigInt(e.byteLength)})),yield o},resolve$3=async(e,t,r,n,i,o,s,a)=>{if(n.length>0)throw new NotFoundError$1(`No link named ${r} found in raw node ${e}`);const l=decode$c(e.multihash.bytes);return{entry:{type:"identity",name:t,path:r,cid:e,content:rawContent$1(l.digest),depth:o,size:BigInt(l.digest.length),node:l.digest}}},resolve$2=async(e,t,r,n,i,o,s,a)=>{const l=await s.get(e,a);return resolveObjectPath(decode$3(l),l,e,t,r,n,o)},rawContent=e=>async function*(t={}){var r;const{start:n,end:i}=validateOffsetAndLength(e.length,t.offset,t.length),o=extractDataFromBlock(e,0n,n,i);null==(r=t.onProgress)||r.call(t,new CustomProgressEvent("unixfs:exporter:progress:raw",{bytesRead:BigInt(o.byteLength),totalBytes:i-n,fileSize:BigInt(e.byteLength)})),yield o},resolve$1=async(e,t,r,n,i,o,s,a)=>{if(n.length>0)throw new NotFoundError$1(`No link named ${r} found in raw node ${e}`);const l=await s.get(e,a);return{entry:{type:"raw",name:t,path:r,cid:e,content:rawContent(l),depth:o,size:BigInt(l.length),node:l}}},_InvalidTypeError=class e extends Error{constructor(t="Invalid type"){super(t),__publicField(this,"name",e.name),__publicField(this,"code",e.code)}};__publicField(_InvalidTypeError,"name","InvalidTypeError"),__publicField(_InvalidTypeError,"code","ERR_INVALID_TYPE");let InvalidTypeError=_InvalidTypeError;const _InvalidUnixFSMessageError=class e extends Error{constructor(t="Invalid message"){super(t),__publicField(this,"name",e.name),__publicField(this,"code",e.code)}};__publicField(_InvalidUnixFSMessageError,"name","InvalidUnixFSMessageError"),__publicField(_InvalidUnixFSMessageError,"code","ERR_INVALID_MESSAGE");let InvalidUnixFSMessageError=_InvalidUnixFSMessageError;function allocUnsafe(e=0){return new Uint8Array(e)}const N1$1=Math.pow(2,7),N2$1=Math.pow(2,14),N3$1=Math.pow(2,21),N4$1=Math.pow(2,28),N5$1=Math.pow(2,35),N6$1=Math.pow(2,42),N7$1=Math.pow(2,49),MSB$2=128,REST$2=127;function encodingLength(e){if(e<N1$1)return 1;if(e<N2$1)return 2;if(e<N3$1)return 3;if(e<N4$1)return 4;if(e<N5$1)return 5;if(e<N6$1)return 6;if(e<N7$1)return 7;if(null!=Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function encodeUint8Array(e,t,r=0){switch(encodingLength(e)){case 8:t[r++]=255&e|MSB$2,e/=128;case 7:t[r++]=255&e|MSB$2,e/=128;case 6:t[r++]=255&e|MSB$2,e/=128;case 5:t[r++]=255&e|MSB$2,e/=128;case 4:t[r++]=255&e|MSB$2,e>>>=7;case 3:t[r++]=255&e|MSB$2,e>>>=7;case 2:t[r++]=255&e|MSB$2,e>>>=7;case 1:t[r++]=255&e,e>>>=7;break;default:throw new Error("unreachable")}return t}function decodeUint8Array(e,t){let r=e[t],n=0;if(n+=r&REST$2,r<MSB$2)return n;if(r=e[t+1],n+=(r&REST$2)<<7,r<MSB$2)return n;if(r=e[t+2],n+=(r&REST$2)<<14,r<MSB$2)return n;if(r=e[t+3],n+=(r&REST$2)<<21,r<MSB$2)return n;if(r=e[t+4],n+=(r&REST$2)*N4$1,r<MSB$2)return n;if(r=e[t+5],n+=(r&REST$2)*N5$1,r<MSB$2)return n;if(r=e[t+6],n+=(r&REST$2)*N6$1,r<MSB$2)return n;if(r=e[t+7],n+=(r&REST$2)*N7$1,r<MSB$2)return n;throw new RangeError("Could not decode varint")}const f32=new Float32Array([-0]),f8b=new Uint8Array(f32.buffer);function writeFloatLE(e,t,r){f32[0]=e,t[r]=f8b[0],t[r+1]=f8b[1],t[r+2]=f8b[2],t[r+3]=f8b[3]}function readFloatLE(e,t){return f8b[0]=e[t],f8b[1]=e[t+1],f8b[2]=e[t+2],f8b[3]=e[t+3],f32[0]}const f64=new Float64Array([-0]),d8b=new Uint8Array(f64.buffer);function writeDoubleLE(e,t,r){f64[0]=e,t[r]=d8b[0],t[r+1]=d8b[1],t[r+2]=d8b[2],t[r+3]=d8b[3],t[r+4]=d8b[4],t[r+5]=d8b[5],t[r+6]=d8b[6],t[r+7]=d8b[7]}function readDoubleLE(e,t){return d8b[0]=e[t],d8b[1]=e[t+1],d8b[2]=e[t+2],d8b[3]=e[t+3],d8b[4]=e[t+4],d8b[5]=e[t+5],d8b[6]=e[t+6],d8b[7]=e[t+7],f64[0]}const MAX_SAFE_NUMBER_INTEGER=BigInt(Number.MAX_SAFE_INTEGER),MIN_SAFE_NUMBER_INTEGER=BigInt(Number.MIN_SAFE_INTEGER);class LongBits{constructor(e,t){__publicField(this,"lo"),__publicField(this,"hi"),this.lo=0|e,this.hi=0|t}toNumber(e=!1){if(!e&&this.hi>>>31>0){const e=1+~this.lo>>>0;let t=~this.hi>>>0;return 0===e&&(t=t+1>>>0),-(e+4294967296*t)}return this.lo+4294967296*this.hi}toBigInt(e=!1){if(e)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31!=0){const e=1+~this.lo>>>0;let t=~this.hi>>>0;return 0===e&&(t=t+1>>>0),-(BigInt(e)+(BigInt(t)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(e=!1){return this.toBigInt(e).toString()}zzEncode(){const e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this}zzDecode(){const e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this}length(){const e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}static fromBigInt(e){if(0n===e)return zero;if(e<MAX_SAFE_NUMBER_INTEGER&&e>MIN_SAFE_NUMBER_INTEGER)return this.fromNumber(Number(e));const t=e<0n;t&&(e=-e);let r=e>>32n,n=e-(r<<32n);return t&&(r=0n|~r,n=0n|~n,++n>TWO_32&&(n=0n,++r>TWO_32&&(r=0n))),new LongBits(Number(n),Number(r))}static fromNumber(e){if(0===e)return zero;const t=e<0;t&&(e=-e);let r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new LongBits(r,n)}static from(e){return"number"==typeof e?LongBits.fromNumber(e):"bigint"==typeof e?LongBits.fromBigInt(e):"string"==typeof e?LongBits.fromBigInt(BigInt(e)):null!=e.low||null!=e.high?new LongBits(e.low>>>0,e.high>>>0):zero}}const zero=new LongBits(0,0);zero.toBigInt=function(){return 0n},zero.zzEncode=zero.zzDecode=function(){return this},zero.length=function(){return 1};const TWO_32=4294967296n;function length$1(e){let t=0,r=0;for(let n=0;n<e.length;++n)r=e.charCodeAt(n),r<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t}function read$1(e,t,r){if(r-t<1)return"";let n;const i=[];let o,s=0;for(;t<r;)o=e[t++],o<128?i[s++]=o:o>191&&o<224?i[s++]=(31&o)<<6|63&e[t++]:o>239&&o<365?(o=((7&o)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,i[s++]=55296+(o>>10),i[s++]=56320+(1023&o)):i[s++]=(15&o)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((n??(n=[])).push(String.fromCharCode.apply(String,i)),s=0);return null!=n?(s>0&&n.push(String.fromCharCode.apply(String,i.slice(0,s))),n.join("")):String.fromCharCode.apply(String,i.slice(0,s))}function write(e,t,r){const n=r;let i,o;for(let s=0;s<e.length;++s)i=e.charCodeAt(s),i<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=63&i|128):55296==(64512&i)&&56320==(64512&(o=e.charCodeAt(s+1)))?(i=65536+((1023&i)<<10)+(1023&o),++s,t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=63&i|128):(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=63&i|128);return r-n}function indexOutOfRange(e,t){return RangeError(`index out of range: ${e.pos} + ${t??1} > ${e.len}`)}function readFixed32End(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}class Uint8ArrayReader{constructor(e){__publicField(this,"buf"),__publicField(this,"pos"),__publicField(this,"len"),__publicField(this,"_slice",Uint8Array.prototype.subarray),this.buf=e,this.pos=0,this.len=e.length}uint32(){let e=4294967295;if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return e}int32(){return 0|this.uint32()}sint32(){const e=this.uint32();return e>>>1^-(1&e)}bool(){return 0!==this.uint32()}fixed32(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32End(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return 0|readFixed32End(this.buf,this.pos+=4)}float(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);const e=readFloatLE(this.buf,this.pos);return this.pos+=4,e}double(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);const e=readDoubleLE(this.buf,this.pos);return this.pos+=8,e}bytes(){const e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw indexOutOfRange(this,e);return this.pos+=e,t===r?new Uint8Array(0):this.buf.subarray(t,r)}string(){const e=this.bytes();return read$1(e,0,e.length)}skip(e){if("number"==typeof e){if(this.pos+e>this.len)throw indexOutOfRange(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw indexOutOfRange(this)}while(128&this.buf[this.pos++]);return this}skipType(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${e} at offset ${this.pos}`)}return this}readLongVarint(){const e=new LongBits(0,0);let t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);const e=readFixed32End(this.buf,this.pos+=4),t=readFixed32End(this.buf,this.pos+=4);return new LongBits(e,t)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){const e=decodeUint8Array(this.buf,this.pos);return this.pos+=encodingLength(e),e}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}}function createReader(e){return new Uint8ArrayReader(e instanceof Uint8Array?e:e.subarray())}function decodeMessage(e,t,r){const n=createReader(e);return t.decode(n,void 0,r)}const base10=baseX({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$1=Object.freeze(Object.defineProperty({__proto__:null,base10:base10},Symbol.toStringTag,{value:"Module"})),base16=rfc4648({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper=rfc4648({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$1=Object.freeze(Object.defineProperty({__proto__:null,base16:base16,base16upper:base16upper},Symbol.toStringTag,{value:"Module"})),base2=rfc4648({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$1=Object.freeze(Object.defineProperty({__proto__:null,base2:base2},Symbol.toStringTag,{value:"Module"})),alphabet=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),alphabetBytesToChars=alphabet.reduce((e,t,r)=>(e[r]=t,e),[]),alphabetCharsToBytes=alphabet.reduce((e,t,r)=>{const n=t.codePointAt(0);if(null==n)throw new Error(`Invalid character: ${t}`);return e[n]=r,e},[]);function encode$2(e){return e.reduce((e,t)=>e+=alphabetBytesToChars[t],"")}function decode$2(e){const t=[];for(const r of e){const e=r.codePointAt(0);if(null==e)throw new Error(`Invalid character: ${r}`);const n=alphabetCharsToBytes[e];if(null==n)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}const base256emoji=from$1({prefix:"🚀",name:"base256emoji",encode:encode$2,decode:decode$2}),base256emoji$1=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:base256emoji},Symbol.toStringTag,{value:"Module"})),base8=rfc4648({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$1=Object.freeze(Object.defineProperty({__proto__:null,base8:base8},Symbol.toStringTag,{value:"Module"})),identity=from$1({prefix:"\0",name:"identity",encode:e=>toString$2(e),decode:e=>fromString$2(e)}),identityBase=Object.freeze(Object.defineProperty({__proto__:null,identity:identity},Symbol.toStringTag,{value:"Module"})),bases={...identityBase,...base2$1,...base8$1,...base10$1,...base16$1,...base32$1,...base36$1,...base58,...base64$1,...base256emoji$1};function createCodec$1(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const string=createCodec$1("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>(new TextEncoder).encode(e.substring(1))),ascii=createCodec$1("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{const t=allocUnsafe((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),BASES={utf8:string,"utf-8":string,hex:bases.base16,latin1:ascii,ascii:ascii,binary:ascii,...bases};function fromString(e,t="utf8"){const r=BASES[t];if(null==r)throw new Error(`Unsupported encoding "${t}"`);return r.decoder.decode(`${r.prefix}${e}`)}function pool(e){const t=e??8192,r=t>>>1;let n,i=t;return function(e){if(e<1||e>r)return allocUnsafe(e);i+e>t&&(n=allocUnsafe(t),i=0);const o=n.subarray(i,i+=e);return 7&i&&(i=1+(7|i)),o}}class Op{constructor(e,t,r){__publicField(this,"fn"),__publicField(this,"len"),__publicField(this,"next"),__publicField(this,"val"),this.fn=e,this.len=t,this.next=void 0,this.val=r}}function noop(){}class State{constructor(e){__publicField(this,"head"),__publicField(this,"tail"),__publicField(this,"len"),__publicField(this,"next"),this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}}const bufferPool=pool();function alloc(e){return null!=globalThis.Buffer?allocUnsafe(e):bufferPool(e)}class Uint8ArrayWriter{constructor(){__publicField(this,"len"),__publicField(this,"head"),__publicField(this,"tail"),__publicField(this,"states"),this.len=0,this.head=new Op(noop,0,0),this.tail=this.head,this.states=null}_push(e,t,r){return this.tail=this.tail.next=new Op(e,t,r),this.len+=t,this}uint32(e){return this.len+=(this.tail=this.tail.next=new VarintOp((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this}int32(e){return e<0?this._push(writeVarint64,10,LongBits.fromNumber(e)):this.uint32(e)}sint32(e){return this.uint32((e<<1^e>>31)>>>0)}uint64(e){const t=LongBits.fromBigInt(e);return this._push(writeVarint64,t.length(),t)}uint64Number(e){return this._push(encodeUint8Array,encodingLength(e),e)}uint64String(e){return this.uint64(BigInt(e))}int64(e){return this.uint64(e)}int64Number(e){return this.uint64Number(e)}int64String(e){return this.uint64String(e)}sint64(e){const t=LongBits.fromBigInt(e).zzEncode();return this._push(writeVarint64,t.length(),t)}sint64Number(e){const t=LongBits.fromNumber(e).zzEncode();return this._push(writeVarint64,t.length(),t)}sint64String(e){return this.sint64(BigInt(e))}bool(e){return this._push(writeByte,1,e?1:0)}fixed32(e){return this._push(writeFixed32,4,e>>>0)}sfixed32(e){return this.fixed32(e)}fixed64(e){const t=LongBits.fromBigInt(e);return this._push(writeFixed32,4,t.lo)._push(writeFixed32,4,t.hi)}fixed64Number(e){const t=LongBits.fromNumber(e);return this._push(writeFixed32,4,t.lo)._push(writeFixed32,4,t.hi)}fixed64String(e){return this.fixed64(BigInt(e))}sfixed64(e){return this.fixed64(e)}sfixed64Number(e){return this.fixed64Number(e)}sfixed64String(e){return this.fixed64String(e)}float(e){return this._push(writeFloatLE,4,e)}double(e){return this._push(writeDoubleLE,8,e)}bytes(e){const t=e.length>>>0;return 0===t?this._push(writeByte,1,0):this.uint32(t)._push(writeBytes$1,t,e)}string(e){const t=length$1(e);return 0!==t?this.uint32(t)._push(write,t,e):this._push(writeByte,1,0)}fork(){return this.states=new State(this),this.head=this.tail=new Op(noop,0,0),this.len=0,this}reset(){return null!=this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop,0,0),this.len=0),this}ldelim(){const e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),0!==r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this}finish(){let e=this.head.next;const t=alloc(this.len);let r=0;for(;null!=e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t}}function writeByte(e,t,r){t[r]=255&e}function writeVarint32(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e}class VarintOp extends Op{constructor(e,t){super(writeVarint32,e,t),__publicField(this,"next"),this.next=void 0}}function writeVarint64(e,t,r){for(;0!==e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function writeFixed32(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function writeBytes$1(e,t,r){t.set(e,r)}function writeBytesBuffer(e,t,r){t.set(e,r)}function writeStringBuffer(e,t,r){e.length<40?write(e,t,r):null!=t.utf8Write?t.utf8Write(e,r):t.set(fromString(e),r)}function createWriter$1(){return new Uint8ArrayWriter}function encodeMessage(e,t){const r=createWriter$1();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var CODEC_TYPES,CODEC_TYPES2,Data,UnixTime,Metadata;function createCodec(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function enumeration(e){function t(t){if(null==e[t.toString()])throw new Error("Invalid enum value");return e[t]}return createCodec("enum",CODEC_TYPES.VARINT,function(e,r){const n=t(e);r.int32(n)},function(e){return t(e.int32())})}function message(e,t){return createCodec("message",CODEC_TYPES.LENGTH_DELIMITED,e,t)}null!=globalThis.Buffer&&(Uint8ArrayWriter.prototype.bytes=function(e){const t=e.length>>>0;return this.uint32(t),t>0&&this._push(writeBytesBuffer,t,e),this},Uint8ArrayWriter.prototype.string=function(e){const t=globalThis.Buffer.byteLength(e);return this.uint32(t),t>0&&this._push(writeStringBuffer,t,e),this}),CODEC_TYPES2=CODEC_TYPES||(CODEC_TYPES={}),CODEC_TYPES2[CODEC_TYPES2.VARINT=0]="VARINT",CODEC_TYPES2[CODEC_TYPES2.BIT64=1]="BIT64",CODEC_TYPES2[CODEC_TYPES2.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",CODEC_TYPES2[CODEC_TYPES2.START_GROUP=3]="START_GROUP",CODEC_TYPES2[CODEC_TYPES2.END_GROUP=4]="END_GROUP",CODEC_TYPES2[CODEC_TYPES2.BIT32=5]="BIT32",function(e){var t;let r;var n;let i;(t=e.DataType||(e.DataType={})).Raw="Raw",t.Directory="Directory",t.File="File",t.Metadata="Metadata",t.Symlink="Symlink",t.HAMTShard="HAMTShard",(n=r||(r={}))[n.Raw=0]="Raw",n[n.Directory=1]="Directory",n[n.File=2]="File",n[n.Metadata=3]="Metadata",n[n.Symlink=4]="Symlink",n[n.HAMTShard=5]="HAMTShard",function(e){e.codec=()=>enumeration(r)}(e.DataType||(e.DataType={})),e.codec=()=>(null==i&&(i=message((t,r,n={})=>{if(!1!==n.lengthDelimited&&r.fork(),null!=t.Type&&(r.uint32(8),e.DataType.codec().encode(t.Type,r)),null!=t.Data&&(r.uint32(18),r.bytes(t.Data)),null!=t.filesize&&(r.uint32(24),r.uint64(t.filesize)),null!=t.blocksizes)for(const e of t.blocksizes)r.uint32(32),r.uint64(e);null!=t.hashType&&(r.uint32(40),r.uint64(t.hashType)),null!=t.fanout&&(r.uint32(48),r.uint64(t.fanout)),null!=t.mode&&(r.uint32(56),r.uint32(t.mode)),null!=t.mtime&&(r.uint32(66),UnixTime.codec().encode(t.mtime,r)),!1!==n.lengthDelimited&&r.ldelim()},(t,r)=>{const n={blocksizes:[]},i=null==r?t.len:t.pos+r;for(;t.pos<i;){const r=t.uint32();switch(r>>>3){case 1:n.Type=e.DataType.codec().decode(t);break;case 2:n.Data=t.bytes();break;case 3:n.filesize=t.uint64();break;case 4:n.blocksizes.push(t.uint64());break;case 5:n.hashType=t.uint64();break;case 6:n.fanout=t.uint64();break;case 7:n.mode=t.uint32();break;case 8:n.mtime=UnixTime.codec().decode(t,t.uint32());break;default:t.skipType(7&r)}}return n})),i),e.encode=t=>encodeMessage(t,e.codec()),e.decode=t=>decodeMessage(t,e.codec())}(Data||(Data={})),function(e){let t;e.codec=()=>(null==t&&(t=message((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),null!=e.Seconds&&(t.uint32(8),t.int64(e.Seconds)),null!=e.FractionalNanoseconds&&(t.uint32(21),t.fixed32(e.FractionalNanoseconds)),!1!==r.lengthDelimited&&t.ldelim()},(e,t)=>{const r={},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();switch(t>>>3){case 1:r.Seconds=e.int64();break;case 2:r.FractionalNanoseconds=e.fixed32();break;default:e.skipType(7&t)}}return r})),t),e.encode=t=>encodeMessage(t,e.codec()),e.decode=t=>decodeMessage(t,e.codec())}(UnixTime||(UnixTime={})),function(e){let t;e.codec=()=>(null==t&&(t=message((e,t,r={})=>{!1!==r.lengthDelimited&&t.fork(),null!=e.MimeType&&(t.uint32(10),t.string(e.MimeType)),!1!==r.lengthDelimited&&t.ldelim()},(e,t)=>{const r={},n=null==t?e.len:e.pos+t;for(;e.pos<n;){const t=e.uint32();if(t>>>3==1)r.MimeType=e.string();else e.skipType(7&t)}return r})),t),e.encode=t=>encodeMessage(t,e.codec()),e.decode=t=>decodeMessage(t,e.codec())}(Metadata||(Metadata={}));const types={Raw:"raw",Directory:"directory",File:"file",Metadata:"metadata",Symlink:"symlink",HAMTShard:"hamt-sharded-directory"},dirTypes=["directory","hamt-sharded-directory"],DEFAULT_FILE_MODE=parseInt("0644",8),DEFAULT_DIRECTORY_MODE=parseInt("0755",8),MAX_FANOUT=BigInt(1024);class UnixFS{constructor(e={type:"file"}){__publicField(this,"type"),__publicField(this,"data"),__publicField(this,"blockSizes"),__publicField(this,"hashType"),__publicField(this,"fanout"),__publicField(this,"mtime"),__publicField(this,"_mode"),__publicField(this,"_originalMode");const{type:t,data:r,blockSizes:n,hashType:i,fanout:o,mtime:s,mode:a}=e;if(null!=t&&!Object.values(types).includes(t))throw new InvalidTypeError("Type: "+t+" is not valid");this.type=t??"file",this.data=r,this.hashType=i,this.fanout=o,this.blockSizes=n??[],this._originalMode=0,this.mode=a,this.mtime=s}static unmarshal(e){const t=Data.decode(e);if(null!=t.fanout&&t.fanout>MAX_FANOUT)throw new InvalidUnixFSMessageError(`Fanout size was too large - ${t.fanout} > ${MAX_FANOUT}`);const r=new UnixFS({type:types[null!=t.Type?t.Type.toString():"File"],data:t.Data,blockSizes:t.blocksizes,mode:t.mode,mtime:null!=t.mtime?{secs:t.mtime.Seconds??0n,nsecs:t.mtime.FractionalNanoseconds}:void 0,fanout:t.fanout});return r._originalMode=t.mode??0,r}set mode(e){this._mode=null==e?this.isDirectory()?DEFAULT_DIRECTORY_MODE:DEFAULT_FILE_MODE:4095&e}get mode(){return this._mode}isDirectory(){return dirTypes.includes(this.type)}addBlockSize(e){this.blockSizes.push(e)}removeBlockSize(e){this.blockSizes.splice(e,1)}fileSize(){if(this.isDirectory())return 0n;let e=0n;return this.blockSizes.forEach(t=>{e+=t}),null!=this.data&&(e+=BigInt(this.data.length)),e}marshal(){let e;switch(this.type){case"raw":e=Data.DataType.Raw;break;case"directory":e=Data.DataType.Directory;break;case"file":e=Data.DataType.File;break;case"metadata":e=Data.DataType.Metadata;break;case"symlink":e=Data.DataType.Symlink;break;case"hamt-sharded-directory":e=Data.DataType.HAMTShard;break;default:throw new InvalidTypeError(`Type: ${e} is not valid`)}let t,r,n=this.data;return null!=this.data&&0!==this.data.length||(n=void 0),null!=this.mode&&(t=4294963200&this._originalMode|(this.mode??0),t!==DEFAULT_FILE_MODE||this.isDirectory()||(t=void 0),t===DEFAULT_DIRECTORY_MODE&&this.isDirectory()&&(t=void 0)),null!=this.mtime&&(r={Seconds:this.mtime.secs,FractionalNanoseconds:this.mtime.nsecs}),Data.encode({Type:e,Data:n,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:t,mtime:r})}}const BITS_PER_BYTE=7;var sparseArray=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(e,t){let r=this._internalPositionFor(e,!1);if(void 0===t)-1!==r&&(this._unsetInternalPos(r),this._unsetBit(e),this._changedLength=!0,this._changedData=!0);else{let n=!1;-1===r?(r=this._data.length,this._setBit(e),this._changedData=!0):n=!0,this._setInternalPos(r,e,t,n),this._changedLength=!0}}unset(e){this.set(e,void 0)}get(e){this._sortData();const t=this._internalPositionFor(e,!0);if(-1!==t)return this._data[t][1]}push(e){return this.set(this.length,e),this.length}get length(){if(this._sortData(),this._changedLength){const e=this._data[this._data.length-1];this._length=e?e[0]+1:0,this._changedLength=!1}return this._length}forEach(e){let t=0;for(;t<this.length;)e(this.get(t),t,this),t++}map(e){let t=0,r=new Array(this.length);for(;t<this.length;)r[t]=e(this.get(t),t,this),t++;return r}reduce(e,t){let r=0,n=t;for(;r<this.length;){n=e(n,this.get(r),r),r++}return n}find(e){let t,r,n=0;for(;n<this.length&&!t;)r=this.get(n),t=e(r),n++;return t?r:void 0}_internalPositionFor(e,t){const r=this._bytePosFor(e,t);if(r>=this._bitArrays.length)return-1;const n=this._bitArrays[r],i=e-r*BITS_PER_BYTE;if(!((n&1<<i)>0))return-1;return this._bitArrays.slice(0,r).reduce(popCountReduce,0)+popCount(n&~(4294967295<<i+1))-1}_bytePosFor(e,t){const r=Math.floor(e/BITS_PER_BYTE),n=r+1;for(;!t&&this._bitArrays.length<n;)this._bitArrays.push(0);return r}_setBit(e){const t=this._bytePosFor(e,!1);this._bitArrays[t]|=1<<e-t*BITS_PER_BYTE}_unsetBit(e){const t=this._bytePosFor(e,!1);this._bitArrays[t]&=~(1<<e-t*BITS_PER_BYTE)}_setInternalPos(e,t,r,n){const i=this._data,o=[t,r];if(n)this._sortData(),i[e]=o;else{if(i.length)if(i[i.length-1][0]>=t)i.push(o);else if(i[0][0]<=t)i.unshift(o);else{const e=Math.round(i.length/2);this._data=i.slice(0,e).concat(o).concat(i.slice(e))}else this._data.push(o);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(e){this._data.splice(e,1)}_sortData(){this._changedData&&this._data.sort(sortInternal),this._changedData=!1}bitField(){const e=[];let t,r=8,n=0,i=0;const o=this._bitArrays.slice();for(;o.length||n;){0===n&&(t=o.shift(),n=7);const s=Math.min(n,r);i|=(t&~(255<<s))<<8-r,t>>>=s,n-=s,r-=s,r&&(n||o.length)||(e.push(i),i=0,r=8)}for(var s=e.length-1;s>0;s--){if(0!==e[s])break;e.pop()}return e}compactArray(){return this._sortData(),this._data.map(valueOnly)}};function popCountReduce(e,t){return e+popCount(t)}function popCount(e){let t=e;return t-=t>>1&1431655765,t=(858993459&t)+(t>>2&858993459),16843009*(t+(t>>4)&252645135)>>24}function sortInternal(e,t){return e[0]-t[0]}function valueOnly(e){return e[1]}const SparseArray=getDefaultExportFromCjs(sparseArray);class Bucket{constructor(e,t,r=0){__publicField(this,"_options"),__publicField(this,"_popCount"),__publicField(this,"_parent"),__publicField(this,"_posAtParent"),__publicField(this,"_children"),__publicField(this,"key"),this._options=e,this._popCount=0,this._parent=t,this._posAtParent=r,this._children=new SparseArray,this.key=null}async put(e,t){const r=await this._findNewBucketAndPos(e);r.bucket._putAt(r,e,t)}async get(e){const t=await this._findChild(e);if(null!=t)return t.value}async del(e){const t=await this._findPlace(e),r=t.bucket._at(t.pos);null!=r&&r.key===e&&t.bucket._delAt(t.pos)}leafCount(){return this._children.compactArray().reduce((e,t)=>t instanceof Bucket?e+t.leafCount():e+1,0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){const e=this._children.compactArray();for(const t of e)t instanceof Bucket?yield*t.eachLeafSeries():yield t}serialize(e,t){return t(this._children.reduce((r,n,i)=>(null!=n&&(n instanceof Bucket?r.push(n.serialize(e,t)):r.push(e(n,i))),r),[]))}async asyncTransform(e,t){return asyncTransformBucket(this,e,t)}toJSON(){return this.serialize(mapNode,reduceNodes)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(e){const t=await this._findPlace(e),r=t.bucket._at(t.pos);if(!(r instanceof Bucket))return null!=r&&r.key===e?r:void 0}async _findPlace(e){const t=this._options.hash("string"==typeof e?fromString(e):e),r=await t.take(this._options.bits),n=this._children.get(r);return n instanceof Bucket?n._findPlace(t):{bucket:this,pos:r,hash:t,existingChild:n}}async _findNewBucketAndPos(e){const t=await this._findPlace(e);if(null!=t.existingChild&&t.existingChild.key!==e){const e=new Bucket(this._options,t.bucket,t.pos);t.bucket._putObjectAt(t.pos,e);const r=await e._findPlace(t.existingChild.hash);return r.bucket._putAt(r,t.existingChild.key,t.existingChild.value),e._findNewBucketAndPos(t.hash)}return t}_putAt(e,t,r){this._putObjectAt(e.pos,{key:t,value:r,hash:e.hash})}_putObjectAt(e,t){null==this._children.get(e)&&this._popCount++,this._children.set(e,t)}_delAt(e){if(-1===e)throw new Error("Invalid position");null!=this._children.get(e)&&this._popCount--,this._children.unset(e),this._level()}_level(){if(null!=this._parent&&this._popCount<=1)if(1===this._popCount){const e=this._children.find(exists);if(null!=e&&!(e instanceof Bucket)){const t=e.hash;t.untake(this._options.bits);const r={pos:this._posAtParent,hash:t,bucket:this._parent};this._parent._putAt(r,e.key,e.value)}}else this._parent._delAt(this._posAtParent)}_at(e){return this._children.get(e)}}function exists(e){return Boolean(e)}function mapNode(e,t){return e.key}function reduceNodes(e){return e}async function asyncTransformBucket(e,t,r){const n=[];for(const i of e._children.compactArray())if(i instanceof Bucket)await asyncTransformBucket(i,t,r);else{const r=await t(i);n.push({bitField:e._children.bitField(),children:r})}return r(n)}function asUint8Array(e){return e}function concat(e,t){null==t&&(t=e.reduce((e,t)=>e+t.length,0));const r=allocUnsafe(t);let n=0;for(const i of e)r.set(i,n),n+=i.length;return asUint8Array(r)}const START_MASKS=[255,254,252,248,240,224,192,128],STOP_MASKS=[1,3,7,15,31,63,127,255];class ConsumableBuffer{constructor(e){__publicField(this,"_value"),__publicField(this,"_currentBytePos"),__publicField(this,"_currentBitPos"),this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+8*this._currentBytePos}totalBits(){return 8*this._value.length}take(e){let t=e,r=0;for(;t>0&&this._haveBits();){const e=this._value[this._currentBytePos],n=this._currentBitPos+1,i=Math.min(n,t);r=(r<<i)+byteBitsToInt(e,n-i,i),t-=i,this._currentBitPos-=i,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return r}untake(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}}function byteBitsToInt(e,t,r){return(e&maskFor(t,r))>>>t}function maskFor(e,t){return START_MASKS[e]&STOP_MASKS[Math.min(t+e-1,7)]}function wrapHash(e){return function(t){return t instanceof InfiniteHash?t:new InfiniteHash(t,e)}}class InfiniteHash{constructor(e,t){if(__publicField(this,"_value"),__publicField(this,"_hashFn"),__publicField(this,"_depth"),__publicField(this,"_availableBits"),__publicField(this,"_currentBufferIndex"),__publicField(this,"_buffers"),!(e instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=e,this._hashFn=t,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let t=e;for(;this._availableBits<t;)await this._produceMoreBits();let r=0;for(;t>0;){const e=this._buffers[this._currentBufferIndex],n=Math.min(e.availableBits(),t);r=(r<<n)+e.take(n),t-=n,this._availableBits-=n,0===e.availableBits()&&this._currentBufferIndex++}return r}untake(e){let t=e;for(;t>0;){const e=this._buffers[this._currentBufferIndex],r=Math.min(e.totalBits()-e.availableBits(),t);e.untake(r),t-=r,this._availableBits+=r,this._currentBufferIndex>0&&e.totalBits()===e.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;const e=this._depth>0?concat([this._value,Uint8Array.from([this._depth])]):this._value,t=await this._hashFn(e),r=new ConsumableBuffer(t);this._buffers.push(r),this._availableBits+=r.availableBits()}}function createHAMT(e){if(null==e||null==e.hashFn)throw new Error("please define an options.hashFn");const t={bits:e.bits??8,hash:wrapHash(e.hashFn)};return new Bucket(t)}const hashFn=async function(e){return(await murmur3128.encode(e)).slice(0,8).reverse()},addLinksToHamtBucket=async(e,t,r)=>{const n=(t.tableSize()-1).toString(16).length;await Promise.all(e.map(async e=>{if(null==e.Name)throw new Error("Unexpected Link without a Name");if(e.Name.length===n){const n=parseInt(e.Name,16);return void t._putObjectAt(n,new Bucket({hash:r._options.hash,bits:r._options.bits},t,n))}await r.put(e.Name.substring(2),!0)}))},toPrefix=(e,t)=>e.toString(16).toUpperCase().padStart(t,"0").substring(0,t),toBucketPath=e=>{let t=e.bucket;const r=[];for(;null!=t._parent;)r.push(t),t=t._parent;return r.push(t),r.reverse()},findShardCid=async(e,t,r,n,i)=>{if(null==n){if(null==e.Data)throw new NotUnixFSError("no data in PBNode");let t;try{t=UnixFS.unmarshal(e.Data)}catch(u){throw new NotUnixFSError(u.message)}if("hamt-sharded-directory"!==t.type)throw new NotUnixFSError("not a HAMT");if(null==t.fanout)throw new NotUnixFSError("missing fanout");const r=createHAMT({hashFn:hashFn,bits:Math.log2(Number(t.fanout))});n={rootBucket:r,hamtDepth:1,lastBucket:r}}const o=(n.lastBucket.tableSize()-1).toString(16).length;await addLinksToHamtBucket(e.Links,n.lastBucket,n.rootBucket);const s=await n.rootBucket._findNewBucketAndPos(t);let a=toPrefix(s.pos,o);const l=toBucketPath(s);l.length>n.hamtDepth&&(n.lastBucket=l[n.hamtDepth],a=toPrefix(n.lastBucket._posAtParent,o));const c=e.Links.find(e=>{if(null==e.Name)return!1;const r=e.Name.substring(0,o),n=e.Name.substring(o);return r===a&&(""===n||n===t)});if(null==c)return;if(null!=c.Name&&c.Name.substring(o)===t)return c.Hash;n.hamtDepth++;return e=decode$8(await r.get(c.Hash,i)),findShardCid(e,t,r,n,i)};function peekable(e){const[t,r]=null!=e[Symbol.asyncIterator]?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],n=[];return{peek:()=>t.next(),push:e=>{n.push(e)},next:()=>n.length>0?{done:!1,value:n.shift()}:t.next(),[r](){return this}}}function isAsyncIterable$3(e){return null!=e[Symbol.asyncIterator]}function filter(e,t){let r=0;if(isAsyncIterable$3(e))return async function*(){for await(const n of e)await t(n,r++)&&(yield n)}();const n=peekable(e),{value:i,done:o}=n.next();if(!0===o)return function*(){}();const s=t(i,r++);if("function"==typeof s.then)return async function*(){await s&&(yield i);for(const e of n)await t(e,r++)&&(yield e)}();const a=t;return function*(){!0===s&&(yield i);for(const e of n)a(e,r++)&&(yield e)}()}function isAsyncIterable$2(e){return null!=e[Symbol.asyncIterator]}function map(e,t){let r=0;if(isAsyncIterable$2(e))return async function*(){for await(const n of e)yield t(n,r++)}();const n=peekable(e),{value:i,done:o}=n.next();if(!0===o)return function*(){}();const s=t(i,r++);if("function"==typeof s.then)return async function*(){yield await s;for(const e of n)yield t(e,r++)}();const a=t;return function*(){yield s;for(const e of n)yield a(e,r++)}()}function pDefer(){const e={};return e.promise=new Promise((t,r)=>{e.resolve=t,e.reject=r}),e}const CustomEvent=globalThis.CustomEvent??Event;async function*parallel(e,t={}){let r=t.concurrency??1/0;r<1&&(r=1/0);const n=t.ordered??!1,i=new EventTarget,o=[];let s,a=pDefer(),l=pDefer(),c=!1,u=!1;function d(){var e;return n?null==(e=o[0])?void 0:e.done:Boolean(o.find(e=>e.done))}function*h(){for(;o.length>0&&o[0].done;){const e=o[0];if(o.shift(),!e.ok)throw u=!0,a.resolve(),e.err;yield e.value,a.resolve()}}function*f(){for(;d();)for(let e=0;e<o.length;e++)if(o[e].done){const t=o[e];if(o.splice(e,1),e--,!t.ok)throw u=!0,a.resolve(),t.err;yield t.value,a.resolve()}}for(i.addEventListener("task-complete",()=>{l.resolve()}),Promise.resolve().then(async()=>{try{for await(const t of e){if(o.length===r&&(a=pDefer(),await a.promise),u)break;const e={done:!1};o.push(e),t().then(t=>{e.done=!0,e.ok=!0,e.value=t,i.dispatchEvent(new CustomEvent("task-complete"))},t=>{e.done=!0,e.err=t,i.dispatchEvent(new CustomEvent("task-complete"))})}c=!0,i.dispatchEvent(new CustomEvent("task-complete"))}catch(t){s=t,i.dispatchEvent(new CustomEvent("task-complete"))}});;){if(d()||(l=pDefer(),await l.promise),null!=s)throw s;if(n?yield*h():yield*f(),null!=s)throw s;if(c&&0===o.length)break}}class FixedFIFO{constructor(e){if(__publicField(this,"buffer"),__publicField(this,"mask"),__publicField(this,"top"),__publicField(this,"btm"),__publicField(this,"next"),!(e>0)||e-1&e)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class FIFO{constructor(e={}){__publicField(this,"size"),__publicField(this,"hwm"),__publicField(this,"head"),__publicField(this,"tail"),this.hwm=e.splitLimit??16,this.head=new FixedFIFO(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=(null==e?void 0:e.byteLength)?e.byteLength:1}push(e){if(null!=(null==e?void 0:e.value)&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new FixedFIFO(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(void 0===e&&null!=this.tail.next){const t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return null!=(null==e?void 0:e.value)&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}}let AbortError$3=class extends Error{constructor(e,t){super(e??"The operation was aborted"),__publicField(this,"type"),__publicField(this,"code"),this.type="aborted",this.code=t??"ABORT_ERR"}};function pushable(e={}){return _pushable(e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}},e)}function _pushable(e,t){let r,n,i,o=(t=t??{}).onEnd,s=new FIFO,a=pDefer();const l=e=>null!=n?n(e):(s.push(e),r),c=e=>{if(i)return r;if(!0!==(null==t?void 0:t.objectMode)&&null==(null==e?void 0:e.byteLength))throw new Error("objectMode was not true but tried to push non-Uint8Array value");return l({done:!1,value:e})},u=e=>i?r:(i=!0,null!=e?(e=>(s=new FIFO,null!=n?n({error:e}):(s.push({error:e}),r)))(e):l({done:!0}));if(r={[Symbol.asyncIterator](){return this},next:async()=>{try{return s.isEmpty()?i?{done:!0}:await new Promise((t,i)=>{n=o=>{n=null,s.push(o);try{t(e(s))}catch(a){i(a)}return r}}):e(s)}finally{s.isEmpty()&&queueMicrotask(()=>{a.resolve(),a=pDefer()})}},return:()=>(s=new FIFO,u(),{done:!0}),throw:e=>(u(e),{done:!0}),push:c,end:u,get readableLength(){return s.size},onEmpty:async e=>{const t=null==e?void 0:e.signal;if(null==t||t.throwIfAborted(),s.isEmpty())return;let r,n;null!=t&&(r=new Promise((e,r)=>{n=()=>{r(new AbortError$3)},t.addEventListener("abort",n)}));try{await Promise.race([a.promise,r])}finally{null!=n&&null!=t&&(null==t||t.removeEventListener("abort",n))}}},null==o)return r;const d=r;return r={[Symbol.asyncIterator](){return this},next:()=>d.next(),throw:e=>(d.throw(e),null!=o&&(o(e),o=void 0),{done:!0}),return:()=>(d.return(),null!=o&&(o(),o=void 0),{done:!0}),push:c,end:e=>(d.end(e),null!=o&&(o(e),o=void 0),r),get readableLength(){return d.readableLength},onEmpty:e=>d.onEmpty(e)},r}let AbortError$2=class extends Error{constructor(e,t,r){super(e??"The operation was aborted"),__publicField(this,"type"),__publicField(this,"code"),this.type="aborted",this.name=r??"AbortError",this.code=t??"ABORT_ERR"}};async function raceSignal(e,t,r){if(null==t)return e;if(t.aborted)return e.catch(()=>{}),Promise.reject(new AbortError$2(null==r?void 0:r.errorMessage,null==r?void 0:r.errorCode,null==r?void 0:r.errorName));let n;const i=new AbortError$2(null==r?void 0:r.errorMessage,null==r?void 0:r.errorCode,null==r?void 0:r.errorName);try{return await Promise.race([e,new Promise((e,r)=>{n=()=>{r(i)},t.addEventListener("abort",n)})])}finally{null!=n&&t.removeEventListener("abort",n)}}class QueuelessPushable{constructor(){__publicField(this,"readNext"),__publicField(this,"haveNext"),__publicField(this,"ended"),__publicField(this,"nextResult"),__publicField(this,"error"),this.ended=!1,this.readNext=pDefer(),this.haveNext=pDefer()}[Symbol.asyncIterator](){return this}async next(){if(null==this.nextResult&&await this.haveNext.promise,null==this.nextResult)throw new Error("HaveNext promise resolved but nextResult was undefined");const e=this.nextResult;return this.nextResult=void 0,this.readNext.resolve(),this.readNext=pDefer(),e}async throw(e){this.ended=!0,this.error=e,null!=e&&(this.haveNext.promise.catch(()=>{}),this.haveNext.reject(e));return{done:!0,value:void 0}}async return(){const e={done:!0,value:void 0};return this.ended=!0,this.nextResult=e,this.haveNext.resolve(),e}async push(e,t){await this._push(e,t)}async end(e,t){null!=e?await this.throw(e):await this._push(void 0,t)}async _push(e,t){if(null!=e&&this.ended)throw this.error??new Error("Cannot push value onto an ended pushable");for(;null!=this.nextResult;)await this.readNext.promise;null!=e?this.nextResult={done:!1,value:e}:(this.ended=!0,this.nextResult={done:!0,value:void 0}),this.haveNext.resolve(),this.haveNext=pDefer(),await raceSignal(this.readNext.promise,null==t?void 0:t.signal,t)}}function queuelessPushable(){return new QueuelessPushable}function isAsyncIterable$1(e){return null!=e[Symbol.asyncIterator]}async function addAllToPushable(e,t,r){try{await Promise.all(e.map(async e=>{for await(const n of e)await t.push(n,{signal:r}),r.throwIfAborted()})),await t.end(void 0,{signal:r})}catch(n){await t.end(n,{signal:r}).catch(()=>{})}}async function*mergeSources(e){const t=new AbortController,r=queuelessPushable();addAllToPushable(e,r,t.signal).catch(()=>{});try{yield*r}finally{t.abort()}}function*mergeSyncSources(e){for(const t of e)yield*t}function merge(...e){const t=[];for(const r of e)isAsyncIterable$1(r)||t.push(r);return t.length===e.length?mergeSyncSources(t):mergeSources(e)}function pipe(e,...t){if(null==e)throw new Error("Empty pipeline");if(isDuplex(e)){const t=e;e=()=>t.source}else if(isIterable(e)||isAsyncIterable(e)){const t=e;e=()=>t}const r=[e,...t];if(r.length>1&&isDuplex(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)isDuplex(r[n])&&(r[n]=duplexPipelineFn(r[n]));return rawPipe(...r)}const rawPipe=(...e)=>{let t;for(;e.length>0;)t=e.shift()(t);return t},isAsyncIterable=e=>null!=(null==e?void 0:e[Symbol.asyncIterator]),isIterable=e=>null!=(null==e?void 0:e[Symbol.iterator]),isDuplex=e=>null!=e&&(null!=e.sink&&null!=e.source),duplexPipelineFn=e=>t=>{const r=e.sink(t);if(null!=(null==r?void 0:r.then)){const t=pushable({objectMode:!0});let n;r.then(()=>{t.end()},e=>{t.end(e)});const i=e.source;if(isAsyncIterable(i))n=async function*(){yield*i,t.end()};else{if(!isIterable(i))throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");n=function*(){yield*i,t.end()}}return merge(t,n())}return e.source},directoryContent=(e,t,r,n,i,o,s)=>async function*(r={}){var a;const l=r.offset??0,c=r.length??t.Links.length,u=t.Links.slice(l,c);null==(a=r.onProgress)||a.call(r,new CustomProgressEvent("unixfs:exporter:walk:directory",{cid:e})),yield*pipe(u,e=>map(e,e=>async()=>{const t=e.Name??"",a=`${n}/${t}`;return(await i(e.Hash,t,a,[],o+1,s,r)).entry}),e=>parallel(e,{ordered:!0,concurrency:r.blockReadConcurrency}),e=>filter(e,e=>null!=e))};var eventemitter3={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new i(n,o||e,s),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function s(e,t){0===--e._eventsCount?e._events=new n:delete e._events[t]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,s=new Array(o);i<o;i++)s[i]=n[i].fn;return s},a.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,i,o,s){var a=r?r+e:e;if(!this._events[a])return!1;var l,c,u=this._events[a],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,i),!0;case 5:return u.fn.call(u.context,t,n,i,o),!0;case 6:return u.fn.call(u.context,t,n,i,o,s),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var h,f=u.length;for(c=0;c<f;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,n);break;case 4:u[c].fn.call(u[c].context,t,n,i);break;default:if(!l)for(h=1,l=new Array(d-1);h<d;h++)l[h-1]=arguments[h];u[c].fn.apply(u[c].context,l)}}return!0},a.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||i&&!a.once||n&&a.context!==n||s(this,o);else{for(var l=0,c=[],u=a.length;l<u;l++)(a[l].fn!==t||i&&!a[l].once||n&&a[l].context!==n)&&c.push(a[l]);c.length?this._events[o]=1===c.length?c[0]:c:s(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a}(eventemitter3);var eventemitter3Exports=eventemitter3.exports;const EventEmitter=getDefaultExportFromCjs(eventemitter3Exports);class TimeoutError extends Error{constructor(e){super(e),this.name="TimeoutError"}}let AbortError$1=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}};const getDOMException=e=>void 0===globalThis.DOMException?new AbortError$1(e):new DOMException(e),getAbortedReason=e=>{const t=void 0===e.reason?getDOMException("This operation was aborted."):e.reason;return t instanceof Error?t:getDOMException(t)};function pTimeout(e,t){const{milliseconds:r,fallback:n,message:i,customTimers:o={setTimeout:setTimeout,clearTimeout:clearTimeout}}=t;let s,a;const l=new Promise((l,c)=>{if("number"!=typeof r||1!==Math.sign(r))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${r}\``);if(t.signal){const{signal:e}=t;e.aborted&&c(getAbortedReason(e)),a=()=>{c(getAbortedReason(e))},e.addEventListener("abort",a,{once:!0})}if(r===Number.POSITIVE_INFINITY)return void e.then(l,c);const u=new TimeoutError;s=o.setTimeout.call(void 0,()=>{if(n)try{l(n())}catch(t){c(t)}else"function"==typeof e.cancel&&e.cancel(),!1===i?l():i instanceof Error?c(i):(u.message=i??`Promise timed out after ${r} milliseconds`,c(u))},r),(async()=>{try{l(await e)}catch(t){c(t)}})()}).finally(()=>{l.clear(),a&&t.signal&&t.signal.removeEventListener("abort",a)});return l.clear=()=>{o.clearTimeout.call(void 0,s),s=void 0},l}function lowerBound(e,t,r){let n=0,i=e.length;for(;i>0;){const o=Math.trunc(i/2);let s=n+o;r(e[s],t)<=0?(n=++s,i-=o+1):i=o}return n}class PriorityQueue{constructor(){__privateAdd2(this,_queue,[])}enqueue(e,t){const r={priority:(t={priority:0,...t}).priority,id:t.id,run:e};if(0===this.size||__privateGet2(this,_queue)[this.size-1].priority>=t.priority)return void __privateGet2(this,_queue).push(r);const n=lowerBound(__privateGet2(this,_queue),r,(e,t)=>t.priority-e.priority);__privateGet2(this,_queue).splice(n,0,r)}setPriority(e,t){const r=__privateGet2(this,_queue).findIndex(t=>t.id===e);if(-1===r)throw new ReferenceError(`No promise function with the id "${e}" exists in the queue.`);const[n]=__privateGet2(this,_queue).splice(r,1);this.enqueue(n.run,{priority:t,id:e})}dequeue(){const e=__privateGet2(this,_queue).shift();return null==e?void 0:e.run}filter(e){return __privateGet2(this,_queue).filter(t=>t.priority===e.priority).map(e=>e.run)}get size(){return __privateGet2(this,_queue).length}}_queue=new WeakMap;class PQueue extends EventEmitter{constructor(e){var t,r;if(super(),__privateAdd2(this,_doesIntervalAllowAnother),__privateAdd2(this,_doesConcurrentAllowAnother),__privateAdd2(this,_next),__privateAdd2(this,_onResumeInterval),__privateAdd2(this,_isIntervalPaused),__privateAdd2(this,_tryToStartAnother),__privateAdd2(this,_initializeIntervalIfNeeded),__privateAdd2(this,_onInterval),__privateAdd2(this,_processQueue),__privateAdd2(this,_throwOnAbort),__privateAdd2(this,_onEvent),__privateAdd2(this,_carryoverConcurrencyCount,void 0),__privateAdd2(this,_isIntervalIgnored,void 0),__privateAdd2(this,_intervalCount,0),__privateAdd2(this,_intervalCap,void 0),__privateAdd2(this,_interval,void 0),__privateAdd2(this,_intervalEnd,0),__privateAdd2(this,_intervalId,void 0),__privateAdd2(this,_timeoutId,void 0),__privateAdd2(this,_queue2,void 0),__privateAdd2(this,_queueClass,void 0),__privateAdd2(this,_pending,0),__privateAdd2(this,_concurrency,void 0),__privateAdd2(this,_isPaused,void 0),__privateAdd2(this,_throwOnTimeout,void 0),__privateAdd2(this,_idAssigner,1n),__publicField(this,"timeout"),!("number"==typeof(e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:PriorityQueue,...e}).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(null==(t=e.intervalCap)?void 0:t.toString())??""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(null==(r=e.interval)?void 0:r.toString())??""}\` (${typeof e.interval})`);__privateSet2(this,_carryoverConcurrencyCount,e.carryoverConcurrencyCount),__privateSet2(this,_isIntervalIgnored,e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval),__privateSet2(this,_intervalCap,e.intervalCap),__privateSet2(this,_interval,e.interval),__privateSet2(this,_queue2,new e.queueClass),__privateSet2(this,_queueClass,e.queueClass),this.concurrency=e.concurrency,this.timeout=e.timeout,__privateSet2(this,_throwOnTimeout,!0===e.throwOnTimeout),__privateSet2(this,_isPaused,!1===e.autoStart)}get concurrency(){return __privateGet2(this,_concurrency)}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);__privateSet2(this,_concurrency,e),__privateMethod2(this,_processQueue,processQueue_fn).call(this)}setPriority(e,t){__privateGet2(this,_queue2).setPriority(e,t)}async add(e,t={}){return t.id??(t.id=(__privateWrapper(this,_idAssigner)._++).toString()),t={timeout:this.timeout,throwOnTimeout:__privateGet2(this,_throwOnTimeout),...t},new Promise((r,n)=>{__privateGet2(this,_queue2).enqueue(async()=>{var i;__privateWrapper(this,_pending)._++;try{null==(i=t.signal)||i.throwIfAborted(),__privateWrapper(this,_intervalCount)._++;let n=e({signal:t.signal});t.timeout&&(n=pTimeout(Promise.resolve(n),{milliseconds:t.timeout})),t.signal&&(n=Promise.race([n,__privateMethod2(this,_throwOnAbort,throwOnAbort_fn).call(this,t.signal)]));const o=await n;r(o),this.emit("completed",o)}catch(o){if(o instanceof TimeoutError&&!t.throwOnTimeout)return void r();n(o),this.emit("error",o)}finally{__privateMethod2(this,_next,next_fn).call(this)}},t),this.emit("add"),__privateMethod2(this,_tryToStartAnother,tryToStartAnother_fn).call(this)})}async addAll(e,t){return Promise.all(e.map(async e=>this.add(e,t)))}start(){return __privateGet2(this,_isPaused)?(__privateSet2(this,_isPaused,!1),__privateMethod2(this,_processQueue,processQueue_fn).call(this),this):this}pause(){__privateSet2(this,_isPaused,!0)}clear(){__privateSet2(this,_queue2,new(__privateGet2(this,_queueClass)))}async onEmpty(){0!==__privateGet2(this,_queue2).size&&await __privateMethod2(this,_onEvent,onEvent_fn).call(this,"empty")}async onSizeLessThan(e){__privateGet2(this,_queue2).size<e||await __privateMethod2(this,_onEvent,onEvent_fn).call(this,"next",()=>__privateGet2(this,_queue2).size<e)}async onIdle(){0===__privateGet2(this,_pending)&&0===__privateGet2(this,_queue2).size||await __privateMethod2(this,_onEvent,onEvent_fn).call(this,"idle")}get size(){return __privateGet2(this,_queue2).size}sizeBy(e){return __privateGet2(this,_queue2).filter(e).length}get pending(){return __privateGet2(this,_pending)}get isPaused(){return __privateGet2(this,_isPaused)}}async function walkDAG(e,t,r,n,i,o,s){if(t instanceof Uint8Array){const e=extractDataFromBlock(t,n,i,o);return void r.push(e)}if(null==t.Data)throw new NotUnixFSError("no data in PBNode");let a;try{a=UnixFS.unmarshal(t.Data)}catch(c){throw new NotUnixFSError(c.message)}if(null!=a.data){const e=extractDataFromBlock(a.data,n,i,o);r.push(e),n+=BigInt(e.byteLength)}const l=[];if(t.Links.length!==a.blockSizes.length)throw new NotUnixFSError("Inconsistent block sizes and dag links");for(let u=0;u<t.Links.length;u++){const e=t.Links[u],r=n,s=r+a.blockSizes[u];if((i>=r&&i<s||o>=r&&o<=s||i<r&&o>s)&&l.push({link:e,blockStart:n}),(n=s)>o)break}await pipe(l,t=>map(t,t=>async()=>{const r=await e.get(t.link.Hash,s);return{...t,block:r}}),e=>parallel(e,{ordered:!0,concurrency:s.blockReadConcurrency}),async t=>{for await(const{link:n,block:a,blockStart:l}of t){let t;switch(n.Hash.code){case code$5:t=decode$8(a);break;case code$3:t=a;break;default:return void r.end(new NotUnixFSError(`Unsupported codec: ${n.Hash.code}`))}const c=new PQueue({concurrency:1});c.on("error",e=>{r.end(e)}),c.add(async()=>{var a;null==(a=s.onProgress)||a.call(s,new CustomProgressEvent("unixfs:exporter:walk:file",{cid:n.Hash})),await walkDAG(e,t,r,l,i,o,s)}),await c.onIdle()}}),n>=o&&r.end()}_carryoverConcurrencyCount=new WeakMap,_isIntervalIgnored=new WeakMap,_intervalCount=new WeakMap,_intervalCap=new WeakMap,_interval=new WeakMap,_intervalEnd=new WeakMap,_intervalId=new WeakMap,_timeoutId=new WeakMap,_queue2=new WeakMap,_queueClass=new WeakMap,_pending=new WeakMap,_concurrency=new WeakMap,_isPaused=new WeakMap,_throwOnTimeout=new WeakMap,_idAssigner=new WeakMap,_doesIntervalAllowAnother=new WeakSet,doesIntervalAllowAnother_get=function(){return __privateGet2(this,_isIntervalIgnored)||__privateGet2(this,_intervalCount)<__privateGet2(this,_intervalCap)},_doesConcurrentAllowAnother=new WeakSet,doesConcurrentAllowAnother_get=function(){return __privateGet2(this,_pending)<__privateGet2(this,_concurrency)},_next=new WeakSet,next_fn=function(){__privateWrapper(this,_pending)._--,__privateMethod2(this,_tryToStartAnother,tryToStartAnother_fn).call(this),this.emit("next")},_onResumeInterval=new WeakSet,onResumeInterval_fn=function(){__privateMethod2(this,_onInterval,onInterval_fn).call(this),__privateMethod2(this,_initializeIntervalIfNeeded,initializeIntervalIfNeeded_fn).call(this),__privateSet2(this,_timeoutId,void 0)},_isIntervalPaused=new WeakSet,isIntervalPaused_get=function(){const e=Date.now();if(void 0===__privateGet2(this,_intervalId)){const t=__privateGet2(this,_intervalEnd)-e;if(!(t<0))return void 0===__privateGet2(this,_timeoutId)&&__privateSet2(this,_timeoutId,setTimeout(()=>{__privateMethod2(this,_onResumeInterval,onResumeInterval_fn).call(this)},t)),!0;__privateSet2(this,_intervalCount,__privateGet2(this,_carryoverConcurrencyCount)?__privateGet2(this,_pending):0)}return!1},_tryToStartAnother=new WeakSet,tryToStartAnother_fn=function(){if(0===__privateGet2(this,_queue2).size)return __privateGet2(this,_intervalId)&&clearInterval(__privateGet2(this,_intervalId)),__privateSet2(this,_intervalId,void 0),this.emit("empty"),0===__privateGet2(this,_pending)&&this.emit("idle"),!1;if(!__privateGet2(this,_isPaused)){const e=!__privateGet2(this,_isIntervalPaused,isIntervalPaused_get);if(__privateGet2(this,_doesIntervalAllowAnother,doesIntervalAllowAnother_get)&&__privateGet2(this,_doesConcurrentAllowAnother,doesConcurrentAllowAnother_get)){const t=__privateGet2(this,_queue2).dequeue();return!!t&&(this.emit("active"),t(),e&&__privateMethod2(this,_initializeIntervalIfNeeded,initializeIntervalIfNeeded_fn).call(this),!0)}}return!1},_initializeIntervalIfNeeded=new WeakSet,initializeIntervalIfNeeded_fn=function(){__privateGet2(this,_isIntervalIgnored)||void 0!==__privateGet2(this,_intervalId)||(__privateSet2(this,_intervalId,setInterval(()=>{__privateMethod2(this,_onInterval,onInterval_fn).call(this)},__privateGet2(this,_interval))),__privateSet2(this,_intervalEnd,Date.now()+__privateGet2(this,_interval)))},_onInterval=new WeakSet,onInterval_fn=function(){0===__privateGet2(this,_intervalCount)&&0===__privateGet2(this,_pending)&&__privateGet2(this,_intervalId)&&(clearInterval(__privateGet2(this,_intervalId)),__privateSet2(this,_intervalId,void 0)),__privateSet2(this,_intervalCount,__privateGet2(this,_carryoverConcurrencyCount)?__privateGet2(this,_pending):0),__privateMethod2(this,_processQueue,processQueue_fn).call(this)},_processQueue=new WeakSet,processQueue_fn=function(){for(;__privateMethod2(this,_tryToStartAnother,tryToStartAnother_fn).call(this););},_throwOnAbort=new WeakSet,throwOnAbort_fn=async function(e){return new Promise((t,r)=>{e.addEventListener("abort",()=>{r(e.reason)},{once:!0})})},_onEvent=new WeakSet,onEvent_fn=async function(e,t){return new Promise(r=>{const n=()=>{t&&!t()||(this.off(e,n),r())};this.on(e,n)})};const fileContent=(e,t,r,n,i,o,s)=>async function*(n={}){var i,o;const a=r.fileSize();if(void 0===a)throw new Error("File was a directory");const{start:l,end:c}=validateOffsetAndLength(a,n.offset,n.length);if(0n===c)return;let u=0n;const d=c-l,h=pushable();null==(i=n.onProgress)||i.call(n,new CustomProgressEvent("unixfs:exporter:walk:file",{cid:e})),walkDAG(s,t,h,0n,l,c,n).catch(e=>{h.end(e)});for await(const e of h)if(null!=e){if(u+=BigInt(e.byteLength),u>d)throw h.end(),new OverReadError("Read too many bytes - the file size reported by the UnixFS data in the root node may be incorrect");u===d&&h.end(),null==(o=n.onProgress)||o.call(n,new CustomProgressEvent("unixfs:exporter:progress:unixfs:file",{bytesRead:u,totalBytes:d,fileSize:a})),yield e}if(u<d)throw new UnderReadError("Traversed entire DAG but did not read enough bytes")},hamtShardedDirectoryContent=(e,t,r,n,i,o,s)=>function(r={}){var a;return null==(a=r.onProgress)||a.call(r,new CustomProgressEvent("unixfs:exporter:walk:hamt-sharded-directory",{cid:e})),listDirectory(t,n,i,o,s,r)};async function*listDirectory(e,t,r,n,i,o){const s=e.Links;if(null==e.Data)throw new NotUnixFSError("no data in PBNode");let a;try{a=UnixFS.unmarshal(e.Data)}catch(u){throw new NotUnixFSError(u.message)}if(null==a.fanout)throw new NotUnixFSError("missing fanout");const l=(a.fanout-1n).toString(16).length,c=pipe(s,s=>map(s,s=>async()=>{var a;const c=null!=s.Name?s.Name.substring(l):null;if(null!=c&&""!==c){const e=await r(s.Hash,c,`${t}/${c}`,[],n+1,i,o);return{entries:null==e.entry?[]:[e.entry]}}{const l=await i.get(s.Hash,o);return e=decode$8(l),null==(a=o.onProgress)||a.call(o,new CustomProgressEvent("unixfs:exporter:walk:hamt-sharded-directory",{cid:s.Hash})),{entries:listDirectory(e,t,r,n,i,o)}}}),e=>parallel(e,{ordered:!0,concurrency:o.blockReadConcurrency}));for await(const{entries:d}of c)yield*d}const findLinkCid=(e,t)=>{const r=e.Links.find(e=>e.Name===t);return null==r?void 0:r.Hash},contentExporters={raw:fileContent,file:fileContent,directory:directoryContent,"hamt-sharded-directory":hamtShardedDirectoryContent,metadata:(e,t,r,n,i,o,s)=>()=>[],symlink:(e,t,r,n,i,o,s)=>()=>[]},unixFsResolver=async(e,t,r,n,i,o,s,a)=>{const l=decode$8(await s.get(e,a));let c,u;if(null==t&&(t=e.toString()),null==l.Data)throw new NotUnixFSError("no data in PBNode");try{c=UnixFS.unmarshal(l.Data)}catch(h){throw new NotUnixFSError(h.message)}if(null==r&&(r=t),n.length>0){let e;if(e="hamt-sharded-directory"===(null==c?void 0:c.type)?await findShardCid(l,n[0],s):findLinkCid(l,n[0]),null==e)throw new NotFoundError$1("file does not exist");const t=n.shift();u={cid:e,toResolve:n,name:t??"",path:`${r}/${t}`}}const d=contentExporters[c.type](e,l,c,r,i,o,s);if(null==d)throw new NotFoundError$1("could not find content exporter");return c.isDirectory()?{entry:{type:"directory",name:t,path:r,cid:e,content:d,unixfs:c,depth:o,node:l,size:c.fileSize()},next:u}:{entry:{type:"file",name:t,path:r,cid:e,content:d,unixfs:c,depth:o,node:l,size:c.fileSize()},next:u}},resolvers={[code$5]:unixFsResolver,[code$3]:resolve$1,[code$6]:resolve$5,[code$2]:resolve$4,[identity$1.code]:resolve$3,[code$1]:resolve$2},resolve=async(e,t,r,n,i,o,s)=>{const a=resolvers[e.code];if(null==a)throw new NoResolverError(`No resolver for code ${e.code}`);return a(e,t,r,n,resolve,i,o,s)},toPathComponents=(e="")=>(e.trim().match(/([^\\^/]|\\\/)+/g)??[]).filter(Boolean),cidAndRest=e=>{if(e instanceof Uint8Array)return{cid:CID.decode(e),toResolve:[]};const t=CID.asCID(e);if(null!=t)return{cid:t,toResolve:[]};if("string"==typeof e){0===e.indexOf("/ipfs/")&&(e=e.substring(6));const t=toPathComponents(e);return{cid:CID.parse(t[0]),toResolve:t.slice(1)}}throw new BadPathError(`Unknown path type ${e}`)};async function*walkPath(e,t,r={}){let{cid:n,toResolve:i}=cidAndRest(e),o=n.toString(),s=o;const a=i.length;for(;;){const l=await resolve(n,o,s,i,a,t,r);if(null==l.entry&&null==l.next)throw new NotFoundError$1(`Could not resolve ${e}`);if(null!=l.entry&&(yield l.entry),null==l.next)return;i=l.next.toResolve,n=l.next.cid,o=l.next.name,s=l.next.path}}async function exporter(e,t,r={}){const n=await last(walkPath(e,t,r));if(null==n)throw new NotFoundError$1(`Could not resolve ${e}`);return n}let Node$1=class{constructor(e){__publicField(this,"value"),__publicField(this,"next"),this.value=e}};class Queue{constructor(){__privateAdd2(this,_head,void 0),__privateAdd2(this,_tail,void 0),__privateAdd2(this,_size,void 0),this.clear()}enqueue(e){const t=new Node$1(e);__privateGet2(this,_head)?(__privateGet2(this,_tail).next=t,__privateSet2(this,_tail,t)):(__privateSet2(this,_head,t),__privateSet2(this,_tail,t)),__privateWrapper(this,_size)._++}dequeue(){const e=__privateGet2(this,_head);if(e)return __privateSet2(this,_head,__privateGet2(this,_head).next),__privateWrapper(this,_size)._--,e.value}peek(){if(__privateGet2(this,_head))return __privateGet2(this,_head).value}clear(){__privateSet2(this,_head,void 0),__privateSet2(this,_tail,void 0),__privateSet2(this,_size,0)}get size(){return __privateGet2(this,_size)}*[Symbol.iterator](){let e=__privateGet2(this,_head);for(;e;)yield e.value,e=e.next}*drain(){for(;__privateGet2(this,_head);)yield this.dequeue()}}function pLimit(e){validateConcurrency(e);const t=new Queue;let r=0;const n=()=>{r<e&&t.size>0&&(t.dequeue()(),r++)},i=async(e,t,i)=>{const o=(async()=>e(...i))();t(o);try{await o}catch{}r--,n()},o=(o,...s)=>new Promise(a=>{((o,s,a)=>{new Promise(e=>{t.enqueue(e)}).then(i.bind(void 0,o,s,a)),(async()=>{await Promise.resolve(),r<e&&n()})()})(o,a,s)});return Object.defineProperties(o,{activeCount:{get:()=>r},pendingCount:{get:()=>t.size},clearQueue:{value(){t.clear()}},concurrency:{get:()=>e,set(i){validateConcurrency(i),e=i,queueMicrotask(()=>{for(;r<e&&t.size>0;)n()})}}}),o}function validateConcurrency(e){if(!Number.isInteger(e)&&e!==Number.POSITIVE_INFINITY||!(e>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up")}_head=new WeakMap,_tail=new WeakMap,_size=new WeakMap;var encode_1=encode$1,MSB$1=128,REST$1=127,MSBALL=~REST$1,INT=Math.pow(2,31);function encode$1(e,t,r){if(Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw encode$1.bytes=0,new RangeError("Could not encode varint");t=t||[];for(var n=r=r||0;e>=INT;)t[r++]=255&e|MSB$1,e/=128;for(;e&MSBALL;)t[r++]=255&e|MSB$1,e>>>=7;return t[r]=0|e,encode$1.bytes=r-n+1,t}var decode$1=read,MSB=128,REST=127;function read(e,t){var r,n=0,i=0,o=t=t||0,s=e.length;do{if(o>=s||i>49)throw read.bytes=0,new RangeError("Could not decode varint");r=e[o++],n+=i<28?(r&REST)<<i:(r&REST)*Math.pow(2,i),i+=7}while(r>=MSB);return read.bytes=o-t,n}var N1=Math.pow(2,7),N2=Math.pow(2,14),N3=Math.pow(2,21),N4=Math.pow(2,28),N5=Math.pow(2,35),N6=Math.pow(2,42),N7=Math.pow(2,49),N8=Math.pow(2,56),N9=Math.pow(2,63),length=function(e){return e<N1?1:e<N2?2:e<N3?3:e<N4?4:e<N5?5:e<N6?6:e<N7?7:e<N8?8:e<N9?9:10},varint={encode:encode_1,decode:decode$1,encodingLength:length};const varint$1=getDefaultExportFromCjs(varint),CIDV0_BYTES={SHA2_256:18,LENGTH:32,DAG_PB:112},V2_HEADER_LENGTH=40;function decodeVarint(e,t){if(!e.length)throw new Error("Unexpected end of data");const r=varint$1.decode(e);return t.seek(varint$1.decode.bytes),r}function decodeV2Header(e){const t=new DataView(e.buffer,e.byteOffset,e.byteLength);let r=0;return{version:2,characteristics:[t.getBigUint64(r,!0),t.getBigUint64(r+=8,!0)],dataOffset:Number(t.getBigUint64(r+=8,!0)),dataSize:Number(t.getBigUint64(r+=8,!0)),indexOffset:Number(t.getBigUint64(r+=8,!0))}}function getMultihashLength(e){varint$1.decode(e);const t=varint$1.decode.bytes,r=varint$1.decode(e.subarray(varint$1.decode.bytes));return t+varint$1.decode.bytes+r}const Kinds={Null:e=>null===e?e:void 0,Int:e=>Number.isInteger(e)?e:void 0,Float:e=>"number"==typeof e&&Number.isFinite(e)?e:void 0,String:e=>"string"==typeof e?e:void 0,Bool:e=>"boolean"==typeof e?e:void 0,Bytes:e=>e instanceof Uint8Array?e:void 0,Link:e=>null!==e&&"object"==typeof e&&e.asCID===e?e:void 0,List:e=>Array.isArray(e)?e:void 0,Map:e=>null===e||"object"!=typeof e||e.asCID===e||Array.isArray(e)||e instanceof Uint8Array?void 0:e},Types={"CarV1HeaderOrV2Pragma > roots (anon) > valueType (anon)":Kinds.Link,"CarV1HeaderOrV2Pragma > roots (anon)":e=>{if(void 0!==Kinds.List(e)){for(let t=0;t<e.length;t++){let r=e[t];if(r=Types["CarV1HeaderOrV2Pragma > roots (anon) > valueType (anon)"](r),void 0===r)return;if(r!==e[t]){const r=e.slice(0,t);for(let n=t;n<e.length;n++){let t=e[n];if(t=Types["CarV1HeaderOrV2Pragma > roots (anon) > valueType (anon)"](t),void 0===t)return;r.push(t)}return r}}return e}},Int:Kinds.Int,CarV1HeaderOrV2Pragma:e=>{if(void 0===Kinds.Map(e))return;const t=Object.entries(e);let r=e,n=1;for(let i=0;i<t.length;i++){const[o,s]=t[i];switch(o){case"roots":{const n=Types["CarV1HeaderOrV2Pragma > roots (anon)"](e[o]);if(void 0===n)return;if(n!==s||r!==e){if(r===e){r={};for(let e=0;e<i;e++)r[t[e][0]]=t[e][1]}r.roots=n}}break;case"version":{n--;const a=Types.Int(e[o]);if(void 0===a)return;if(a!==s||r!==e){if(r===e){r={};for(let e=0;e<i;e++)r[t[e][0]]=t[e][1]}r.version=a}}break;default:return}}return n>0?void 0:r}},Reprs={"CarV1HeaderOrV2Pragma > roots (anon) > valueType (anon)":Kinds.Link,"CarV1HeaderOrV2Pragma > roots (anon)":e=>{if(void 0!==Kinds.List(e)){for(let t=0;t<e.length;t++){let r=e[t];if(r=Reprs["CarV1HeaderOrV2Pragma > roots (anon) > valueType (anon)"](r),void 0===r)return;if(r!==e[t]){const r=e.slice(0,t);for(let n=t;n<e.length;n++){let t=e[n];if(t=Reprs["CarV1HeaderOrV2Pragma > roots (anon) > valueType (anon)"](t),void 0===t)return;r.push(t)}return r}}return e}},Int:Kinds.Int,CarV1HeaderOrV2Pragma:e=>{if(void 0===Kinds.Map(e))return;const t=Object.entries(e);let r=e,n=1;for(let i=0;i<t.length;i++){const[o,s]=t[i];switch(o){case"roots":{const n=Reprs["CarV1HeaderOrV2Pragma > roots (anon)"](s);if(void 0===n)return;if(n!==s||r!==e){if(r===e){r={};for(let e=0;e<i;e++)r[t[e][0]]=t[e][1]}r.roots=n}}break;case"version":{n--;const o=Reprs.Int(s);if(void 0===o)return;if(o!==s||r!==e){if(r===e){r={};for(let e=0;e<i;e++)r[t[e][0]]=t[e][1]}r.version=o}}break;default:return}}return n>0?void 0:r}},CarV1HeaderOrV2Pragma={toTyped:Types.CarV1HeaderOrV2Pragma,toRepresentation:Reprs.CarV1HeaderOrV2Pragma};async function readHeader(e,t){const r=decodeVarint(await e.upTo(8),e);if(0===r)throw new Error("Invalid CAR header (zero length)");const n=await e.exactly(r,!0),i=decode$9(n);if(void 0===CarV1HeaderOrV2Pragma.toTyped(i))throw new Error("Invalid CAR header format");if(1!==i.version&&2!==i.version||void 0!==t&&i.version!==t)throw new Error(`Invalid CAR version: ${i.version}${void 0!==t?` (expected ${t})`:""}`);if(1===i.version){if(!Array.isArray(i.roots))throw new Error("Invalid CAR header format");return i}if(void 0!==i.roots)throw new Error("Invalid CAR header format");const o=decodeV2Header(await e.exactly(V2_HEADER_LENGTH,!0));e.seek(o.dataOffset-e.pos);const s=await readHeader(e,1);return Object.assign(s,o)}async function readCid(e){const t=await e.exactly(2,!1);if(t[0]===CIDV0_BYTES.SHA2_256&&t[1]===CIDV0_BYTES.LENGTH){const t=decode$c(await e.exactly(34,!0));return CID.create(0,CIDV0_BYTES.DAG_PB,t)}const r=decodeVarint(await e.upTo(8),e);if(1!==r)throw new Error(`Unexpected CID version (${r})`);const n=decodeVarint(await e.upTo(8),e),i=decode$c(await e.exactly(getMultihashLength(await e.upTo(8)),!0));return CID.create(r,n,i)}async function readBlockHead(e){const t=e.pos;let r=decodeVarint(await e.upTo(8),e);if(0===r)throw new Error("Invalid CAR section (zero length)");r+=e.pos-t;return{cid:await readCid(e),length:r,blockLength:r-Number(e.pos-t)}}async function readBlock(e){const{cid:t,blockLength:r}=await readBlockHead(e);return{bytes:await e.exactly(r,!0),cid:t}}async function readBlockIndex(e){const t=e.pos,{cid:r,length:n,blockLength:i}=await readBlockHead(e),o={cid:r,length:n,blockLength:i,offset:t,blockOffset:e.pos};return e.seek(o.blockLength),o}function createDecoder(e){const t=(async()=>{const t=await readHeader(e);if(2===t.version){const r=e.pos-t.dataOffset;e=limitReader(e,t.dataSize-r)}return t})();return{header:()=>t,async*blocks(){for(await t;(await e.upTo(8)).length>0;)yield await readBlock(e)},async*blocksIndex(){for(await t;(await e.upTo(8)).length>0;)yield await readBlockIndex(e)}}}function bytesReader(e){let t=0;return{upTo:async r=>e.subarray(t,t+Math.min(r,e.length-t)),async exactly(r,n=!1){if(r>e.length-t)throw new Error("Unexpected end of data");const i=e.subarray(t,t+r);return n&&(t+=r),i},seek(e){t+=e},get pos(){return t}}}function chunkReader(e){let t=0,r=0,n=0,i=new Uint8Array(0);const o=async t=>{r=i.length-n;const o=[i.subarray(n)];for(;r<t;){const t=await e();if(null==t)break;r<0?t.length>r&&o.push(t.subarray(-r)):o.push(t),r+=t.length}i=new Uint8Array(o.reduce((e,t)=>e+t.length,0));let s=0;for(const e of o)i.set(e,s),s+=e.length;n=0};return{upTo:async e=>(i.length-n<e&&await o(e),i.subarray(n,n+Math.min(i.length-n,e))),async exactly(e,r=!1){if(i.length-n<e&&await o(e),i.length-n<e)throw new Error("Unexpected end of data");const s=i.subarray(n,n+e);return r&&(t+=e,n+=e),s},seek(e){t+=e,n+=e},get pos(){return t}}}function asyncIterableReader(e){const t=e[Symbol.asyncIterator]();return chunkReader(async function(){const e=await t.next();return e.done?null:e.value})}function limitReader(e,t){let r=0;return{async upTo(n){let i=await e.upTo(n);return i.length+r>t&&(i=i.subarray(0,t-r)),i},async exactly(n,i=!1){const o=await e.exactly(n,i);if(o.length+r>t)throw new Error("Unexpected end of data");return i&&(r+=n),o},seek(t){r+=t,e.seek(t)},get pos(){return e.pos}}}class CarReader{constructor(e,t){this._header=e,this._blocks=t,this._keys=t.map(e=>e.cid.toString())}get version(){return this._header.version}async getRoots(){return this._header.roots}async has(e){return this._keys.indexOf(e.toString())>-1}async get(e){const t=this._keys.indexOf(e.toString());return t>-1?this._blocks[t]:void 0}async*blocks(){for(const e of this._blocks)yield e}async*cids(){for(const e of this._blocks)yield e.cid}static async fromBytes(e){if(!(e instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return decodeReaderComplete(bytesReader(e))}static async fromIterable(e){if(!e||"function"!=typeof e[Symbol.asyncIterator])throw new TypeError("fromIterable() requires an async iterable");return decodeReaderComplete(asyncIterableReader(e))}}async function decodeReaderComplete(e){const t=createDecoder(e),r=await t.header(),n=[];for await(const i of t.blocks())n.push(i);return new CarReader(r,n)}const cborEncoders=makeCborEncoders(),defaultEncodeOptions={float64:!1,quickEncodeToken:quickEncodeToken,encodeErrPrefix:"CBOR encode error: "};function tokensToLength(e,t=cborEncoders,r=defaultEncodeOptions){if(Array.isArray(e)){let n=0;for(const i of e)n+=tokensToLength(i,t,r);return n}{const n=t[e.type.major];if(void 0===n.encodedSize||"function"!=typeof n.encodedSize)throw new Error(`Encoder for ${e.type.name} does not have an encodedSize()`);return n.encodedSize(e,r)}}class CarBufferWriter{constructor(e,t){this.bytes=e,this.byteOffset=t,this.roots=[],this.headerSize=t}addRoot(e,t){return addRoot(this,e,t),this}write(e){return addBlock(this,e),this}close(e){return close(this,e)}}const addRoot=(e,t,r={})=>{const{resize:n=!1}=r,{bytes:i,headerSize:o,byteOffset:s,roots:a}=e;e.roots.push(t);const l=headerLength(e);if(l>o){if(!(l-o+s<i.byteLength))throw a.pop(),new RangeError(`Buffer has no capacity for a new root ${t}`);if(!n)throw a.pop(),new RangeError(`Header of size ${o} has no capacity for new root ${t}.\n  However there is a space in the buffer and you could call addRoot(root, { resize: root }) to resize header to make a space for this root.`);resizeHeader(e,l)}},blockLength=({cid:e,bytes:t})=>{const r=e.bytes.byteLength+t.byteLength;return varint$1.encodingLength(r)+r},addBlock=(e,{cid:t,bytes:r})=>{const n=t.bytes.byteLength+r.byteLength,i=varint$1.encode(n);if(e.byteOffset+i.length+n>e.bytes.byteLength)throw new RangeError("Buffer has no capacity for this block");writeBytes(e,i),writeBytes(e,t.bytes),writeBytes(e,r)},close=(e,t={})=>{const{resize:r=!1}=t,{roots:n,bytes:i,byteOffset:o,headerSize:s}=e,a=encode$9({version:1,roots:n}),l=varint$1.encode(a.length),c=l.length+a.byteLength;if(0===s-c)return writeHeader(e,l,a),i.subarray(0,o);if(r)return resizeHeader(e,c),writeHeader(e,l,a),i.subarray(0,e.byteOffset);throw new RangeError("Header size was overestimated.\nYou can use close({ resize: true }) to resize header")},resizeHeader=(e,t)=>{const{bytes:r,headerSize:n}=e;r.set(r.subarray(n,e.byteOffset),t),e.byteOffset+=t-n,e.headerSize=t},writeBytes=(e,t)=>{e.bytes.set(t,e.byteOffset),e.byteOffset+=t.length},writeHeader=({bytes:e},t,r)=>{e.set(t),e.set(r,t.length)},headerPreludeTokens=[new Token(Type.map,2),new Token(Type.string,"version"),new Token(Type.uint,1),new Token(Type.string,"roots")],CID_TAG=new Token(Type.tag,42),calculateHeaderLength=e=>{const t=[...headerPreludeTokens];t.push(new Token(Type.array,e.length));for(const n of e)t.push(CID_TAG),t.push(new Token(Type.bytes,{length:n+1}));const r=tokensToLength(t);return varint$1.encodingLength(r)+r},headerLength=({roots:e})=>calculateHeaderLength(e.map(e=>e.bytes.byteLength)),createWriter=(e,t={})=>{const{roots:r=[],byteOffset:n=0,byteLength:i=e.byteLength,headerSize:o=headerLength({roots:r})}=t,s=new Uint8Array(e,n,i),a=new CarBufferWriter(s,o);for(const l of r)a.addRoot(l);return a};var retry$2={};function RetryOperation(e,t){"boolean"==typeof t&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var retry_operation=RetryOperation;RetryOperation.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},RetryOperation.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},RetryOperation.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=(new Date).getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var r=this._timeouts.shift();if(void 0===r){if(!this._cachedTimeouts)return!1;this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1)}var n=this;return this._timer=setTimeout(function(){n._attempts++,n._operationTimeoutCb&&(n._timeout=setTimeout(function(){n._operationTimeoutCb(n._attempts)},n._operationTimeout),n._options.unref&&n._timeout.unref()),n._fn(n._attempts)},r),this._options.unref&&this._timer.unref(),!0},RetryOperation.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=(new Date).getTime(),this._fn(this._attempts)},RetryOperation.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},RetryOperation.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},RetryOperation.prototype.start=RetryOperation.prototype.try,RetryOperation.prototype.errors=function(){return this._errors},RetryOperation.prototype.attempts=function(){return this._attempts},RetryOperation.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,r=0,n=0;n<this._errors.length;n++){var i=this._errors[n],o=i.message,s=(e[o]||0)+1;e[o]=s,s>=r&&(t=i,r=s)}return t},function(e){var t=retry_operation;e.operation=function(r){var n=e.timeouts(r);return new t(n,{forever:r&&(r.forever||r.retries===1/0),unref:r&&r.unref,maxRetryTime:r&&r.maxRetryTime})},e.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var r in e)t[r]=e[r];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var n=[],i=0;i<t.retries;i++)n.push(this.createTimeout(i,t));return e&&e.forever&&!n.length&&n.push(this.createTimeout(i,t)),n.sort(function(e,t){return e-t}),n},e.createTimeout=function(e,t){var r=t.randomize?Math.random()+1:1,n=Math.round(r*Math.max(t.minTimeout,1)*Math.pow(t.factor,e));return n=Math.min(n,t.maxTimeout)},e.wrap=function(t,r,n){if(r instanceof Array&&(n=r,r=null),!n)for(var i in n=[],t)"function"==typeof t[i]&&n.push(i);for(var o=0;o<n.length;o++){var s=n[o],a=t[s];t[s]=function(n){var i=e.operation(r),o=Array.prototype.slice.call(arguments,1),s=o.pop();o.push(function(e){i.retry(e)||(e&&(arguments[0]=i.mainError()),s.apply(this,arguments))}),i.attempt(function(){n.apply(t,o)})}.bind(t,a),t[s].options=r}}}(retry$2);var retry=retry$2;const retry$1=getDefaultExportFromCjs(retry),objectToString=Object.prototype.toString,isError=e=>"[object Error]"===objectToString.call(e),errorMessages=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed","fetch failed","terminated"," A network error occurred.","Network connection lost"]);function isNetworkError(e){if(!(e&&isError(e)&&"TypeError"===e.name&&"string"==typeof e.message))return!1;const{message:t,stack:r}=e;return"Load failed"===t?void 0===r||"__sentry_captured__"in e:!!t.startsWith("error sending request for url")||errorMessages.has(t)}class AbortError extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,({message:e}=e)):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}const decorateErrorWithCounts=(e,t,r)=>{const n=r.retries-(t-1);return e.attemptNumber=t,e.retriesLeft=n,e};async function pRetry(e,t){return new Promise((r,n)=>{(t={...t}).onFailedAttempt??(t.onFailedAttempt=()=>{}),t.shouldRetry??(t.shouldRetry=()=>!0),t.retries??(t.retries=10);const i=retry$1.operation(t),o=()=>{var e;i.stop(),n(null==(e=t.signal)?void 0:e.reason)};t.signal&&!t.signal.aborted&&t.signal.addEventListener("abort",o,{once:!0});const s=()=>{var e;null==(e=t.signal)||e.removeEventListener("abort",o),i.stop()};i.attempt(async o=>{try{const t=await e(o);s(),r(t)}catch(a){try{if(!(a instanceof Error))throw new TypeError(`Non-error was thrown: "${a}". You should only throw errors.`);if(a instanceof AbortError)throw a.originalError;if(a instanceof TypeError&&!isNetworkError(a))throw a;if(decorateErrorWithCounts(a,o,t),await t.shouldRetry(a)||(i.stop(),n(a)),await t.onFailedAttempt(a),!i.retry(a))throw i.mainError()}catch(l){decorateErrorWithCounts(l,o,t),s(),n(l)}}})})}async function pMap(e,t,{concurrency:r=Number.POSITIVE_INFINITY,stopOnError:n=!0,signal:i}={}){return new Promise((o,s)=>{if(void 0===e[Symbol.iterator]&&void 0===e[Symbol.asyncIterator])throw new TypeError(`Expected \`input\` to be either an \`Iterable\` or \`AsyncIterable\`, got (${typeof e})`);if("function"!=typeof t)throw new TypeError("Mapper function is required");if(!(Number.isSafeInteger(r)&&r>=1||r===Number.POSITIVE_INFINITY))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${r}\` (${typeof r})`);const a=[],l=[],c=new Map;let u=!1,d=!1,h=!1,f=0,p=0;const y=void 0===e[Symbol.iterator]?e[Symbol.asyncIterator]():e[Symbol.iterator](),g=()=>{w(i.reason)},m=()=>{null==i||i.removeEventListener("abort",g)},b=e=>{o(e),m()},w=e=>{u=!0,d=!0,s(e),m()};i&&(i.aborted&&w(i.reason),i.addEventListener("abort",g,{once:!0}));const v=async()=>{if(d)return;const e=await y.next(),r=p;if(p++,e.done){if(h=!0,0===f&&!d){if(!n&&l.length>0)return void w(new AggregateError(l));if(d=!0,0===c.size)return void b(a);const e=[];for(const[t,r]of a.entries())c.get(t)!==pMapSkip&&e.push(r);b(e)}}else f++,(async()=>{try{const n=await e.value;if(d)return;const i=await t(n,r);i===pMapSkip&&c.set(r,i),a[r]=i,f--,await v()}catch(i){if(n)w(i);else{l.push(i),f--;try{await v()}catch(o){w(o)}}}})()};(async()=>{for(let t=0;t<r;t++){try{await v()}catch(e){w(e);break}if(h||u)break}})()})}const pMapSkip=Symbol("skip");var charwise$1={},number={};function flip(e){for(var t="",r=0;r<e.length;r++){var n=e[r];isNaN(Number(n))||" "===n?"-"!==n&&(t+=n):t+=String(9-Number(n))}return t}function padStart(e,t){return" ".repeat(t-e.length).substr(0,t)+e}number.encode=function(e){if(isNaN(e))return"DaN";if(0===e)return"FE  0M0";if(e===1/0)return"FF";if(e===-1/0)return"DD";var t=e.toExponential().split("e"),r=Number(t[1])+500,n=t[0]+(-1===t[0].indexOf(".")?".":"")+"0".repeat(20),i="E"+padStart(String(r),3)+"M"+String(n);return e>0?"F"+i:"D"+flip(i)},number.decode=function(e){if("DaN"===e)return NaN;if("FF"===e)return 1/0;if("DD"===e)return-1/0;var t="D"===e[0],r=(t?flip(e):e).slice(2).split("M");return Number((t?"-":"")+r[1]+"e"+String(Number(r[0])-500))};var object={},dictEscape={"?":"?@","!":"??",'"':"?%"};function escape(e){return/[!"]/.test(e)?e.replace(/[\?!"]/g,function(e){return dictEscape[e]}):e}var dictUnescape={"?@":"?","??":"!","?%":'"'};function unescape(e){return/\?[%\?@]/.test(e)?e.replace(/\?[%\?@]/g,function(e){return dictUnescape[e]}):e}object.factory=function(e){return{encode:t,decode:function(t){if("A"===t)return null;if("K!"===t)return[];for(var r,n=t.split('"'),i=[[]],o=0,s=n.length,a=0;a<s;a++){for(var l=n[a],c=l.length,u=0;"K"==l[u];)u++;for(var d=0;"!"==l[c-d-1];)d++;for(var h=l.slice(u,c-d),f=o+u,p=o;p<f;p++)i[p+1]=[],i[p].push(i[p+1]),r=i[o=f];0!==h.length&&r.push(e.decode(unescape(h)));for(p=f=o-d;p<o;p++)i[p+1]=[],r=i[o=f]}return i[0][0]}};function t(e){if(null===e)return"A";if(!Array.isArray(e))throw new Error("can only encode arrays");var t=e.length;if(0==t)return"K!";for(var n=r(e[0]),i=1;i<t;i++)n+='"'+r(e[i]);return"K"+n+"!"}function r(r){return"object"==typeof r?t(r):escape(e.encode(r))}},function(e){var t=number,r=object;e.flip=function(e){var t=e.toString(),r="";for(var n in t)r+="."==t[n]?".":9-+t[n];return r},e.number=t,e.string={encode:function(e){return/\x00|\x01/.test(e)?"J"+e.replace(/\x01/g,"").replace(/\x00/g,""):"J"+e},decode:function(e){if("J"===e[0])return e.substring(1)}},e.encode=function(t){return e[typeof t].encode(t)},e.decode=function(e){if(""===e)return e;if(!n[e[0]])throw new Error("no decoder for:"+JSON.stringify(e));return n[e[0]](e)},e.object=r.factory(e),e.boolean={encode:function(e){return e?"C":"B"},decode:function(e){return"C"===e}},e.undefined={encode:function(e){return"L"},decode:function(){}};var n={A:e.object.decode,B:e.boolean.decode,C:e.boolean.decode,D:e.number.decode,F:e.number.decode,J:e.string.decode,K:e.object.decode,L:e.undefined.decode};e.buffer=!1,e.type="charwise"}(charwise$1);const charwise=getDefaultExportFromCjs(charwise$1),readUInt32LE=e=>{const t=e.byteLength-4;return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]},MAX_UINT32=4294967295,bf=e=>{const t=Math.floor(MAX_UINT32/e);return async e=>{const r=await e.identity();if("number"!=typeof r)throw new Error("Identity must be a number");return r<=t}},simpleCompare=(e,t)=>e===t?0:e>t?1:-1;class CIDCounter{constructor(){this._cids=new Set}add(e){if(!e.address)throw new Error("Cannot add node without address");if(e.address.then){const t=e.address.then(e=>this._cids.add(e.toString()));this._cids.add(t),t.then(()=>this._cids.delete(t))}else this._cids.add(e.address.toString())}async all(){return await Promise.all([...this._cids]),this._cids}}class Entry{constructor({key:e,address:t},r={}){this.key=e,this.address=t,this.codec=r.codec,this.hasher=r.hasher}get isEntry(){return!0}}class EntryList{constructor({entries:e,closed:t}){if("boolean"!=typeof t)throw new Error('Missing required argument "closed"');this.entries=e,this.closed=t,this.startKey=e[0].key}find(e,t){const{entries:r}=this;for(let n=r.length-1;n>-1;n--){const i=r[n];if(t(e,i.key)>-1)return[n,i]}return null}findMany(e,t,r=!1,n=!1){const{entries:i}=this,o=new Map;e=r?[...e]:e.sort(t);for(let s=i.length-1;s>-1&&e.length;s--){const r=i[s],a=[];for(;e.length;){let i=e[e.length-1];i=i.key?i.key:i;const o=t(i,r.key);if(n)if(0===o)a.push(e.pop());else{if(!(o>0))break;e.pop()}else{if(!(o>-1))break;a.push(e.pop())}}a.length&&o.set(s,[r,a])}return o}findRange(e,t,r){const{entries:n}=this;let i,o=0;for(let s=n.length-1;s>-1;s--){if(r(t,n[s].key)>0){i=s;break}}for(let s=0;s<n.length;s++){const t=r(e,n[s].key);if(0===t){o=s;break}if(t<0)break;o=s}return{first:o,last:i,entries:n.slice(o,i+1)}}}const stringKey=e=>"string"==typeof e?e:JSON.stringify(e);function sortBulk(e,t){return e.sort(({key:e},{key:r})=>t.compare(e,r))}async function filterLeftmostInserts(e,t,r){const n=[];for(const i of t){const{key:t,del:o}=i;if(!(r(t,e)<0))break;o||n.push(i)}return n}async function generateNewLeaves(e,t,{chunker:r,compare:n}){return await Node.from({entries:e.map(e=>new t.LeafEntryClass(e,t)).sort((e,t)=>n(e.key,t.key)),chunker:r,NodeClass:t.LeafClass,distance:0,opts:t})}async function generateBranchEntries(e,t,r,n){return await Promise.all(t.map(async t=>{const i=await t.encode();r.blocks.push({block:i,node:t}),e.cache.set(t);return new n.BranchEntryClass({key:t.key,address:await t.address},n)}))}async function processRoot(e,t,r,n){const i=t.root;t.blocks.push({block:await i.encode(),node:i}),e.cache.set(i);const o=n.opts,s=i.distance,a=i.entryList.startKey,l=await filterLeftmostInserts(a,r,e.compare);if(l.length){const r=await generateNewLeaves(l,o,e),a=await generateBranchEntries(e,r,t,o),c=[new o.BranchEntryClass({key:i.entryList.startKey,address:await i.address},o),...a].sort(({key:e},{key:t})=>o.compare(e,t));let u=await Node.from({...n,entries:c,chunker:e.chunker,NodeClass:o.BranchClass,distance:s+1}),d=[...u];for(;u.length>1;){const t=await Promise.all(u.map(async e=>new o.BranchEntryClass({key:e.key,address:await e.address},o)));u=await Node.from({...n,entries:t.sort(({key:e},{key:t})=>o.compare(e,t)),chunker:e.chunker,NodeClass:o.BranchClass,distance:s+1}),d=[...d,...u]}await Promise.all(d.map(async r=>{const n=await r.encode();e.cache.set(r),t.blocks.push({block:n,node:r})})),t.root=u[0],t.nodes=[...t.nodes,...d]}}class Node{constructor({entryList:e,chunker:t,distance:r,getNode:n,compare:i,cache:o}){this.entryList=e,this.chunker=t,this.distance=r,this.getNode=n,this.compare=i,this.cache=o}get closed(){return this.entryList.closed}get key(){return this.entryList.startKey}async getEntry(e,t=new CIDCounter){return{result:await this._getEntry(e,t),cids:t}}async _getEntry(e,t){t.add(this);let r=this;for(;!r.isLeaf;){const n=r.entryList.find(e,this.compare);if(null===n)throw new Error("Not found");const[,i]=n;r=await this.getNode(await i.address),t.add(r)}const n=r.entryList.find(e,this.compare);if(null===n||n[1].key.toString()!==e.toString())throw new Error("Not found");const[,i]=n;return i}async getAllEntries(e=new CIDCounter){return{result:await this._getAllEntries(e),cids:e}}_getAllEntries(e){if(e.add(this),this.isLeaf)return this.entryList.entries;{const{entries:t}=this.entryList,r=async t=>this.getNode(await t.address).then(t=>t._getAllEntries(e)).catch(async e=>{throw e});return Promise.all(t.map(r)).then(e=>e.flat())}}async*vis(e=new Set){const t=e=>e.toString().slice(0,4)+e.toString().slice(-4),r=async function*(e,n,i){const o=await e.address;if(!i.has(o)){i.add(o);const a=await(async e=>{if(e.isLeaf)return`Leaf [${e.entryList.entries.map(e=>`[${e.key},${JSON.stringify(e.value).replace(/"/g,"'")}]`).join(", ")}]`;return`Branch [${e.entryList.entries.map(e=>`[${e.key}]`).join(", ")}]`})(e);yield`  node [shape=ellipse fontname="Courier"]; ${t(o)} [label="${a}"];`,yield`  ${t(n)} -> ${t(o)};`;for(const n of e.entryList.entries)if(n.address){const a=await n.address;try{const t=await e.getNode(a);yield*await r(t,o,i)}catch(s){yield`  ${t(o)} -> ${t(a)};`,yield`  node [shape=ellipse fontname="Courier"]; ${t(a)} [label="Error: ${s.message}"];`}}}};yield"digraph tree {",yield'  node [shape=ellipse fontname="Courier"]; rootnode;';for await(const n of r(this,"rootnode",e))yield n;yield"}"}async getEntries(e,t=!1,r=new CIDCounter){return{result:await this._getEntries(e,t,r),cids:r}}async _getEntries(e,t,r){r.add(this),t||(e=e.sort(this.compare));const n=this.entryList.findMany(e,this.compare,!0,this.isLeaf);if(this.isLeaf)return[...n.values()].map(([e])=>e);let i=[];for(const[o,s]of[...n.values()].reverse()){const e=this.getNode(await o.address);i.push(e.then(e=>e._getEntries(s.reverse(),!0,r)))}return i=await Promise.all(i),i.flat()}async getRangeEntries(e,t,r=new CIDCounter){return{result:await this._getRangeEntries(e,t,r),cids:r}}_getRangeEntries(e,t,r){r.add(this);const{entries:n}=this.entryList.findRange(e,t,this.compare);if(this.isLeaf)return n.filter(r=>{const n=this.compare(e,r.key),i=this.compare(t,r.key);return n<=0&&i>=0});if(!n.length)return[];const i=async n=>this.getNode(await n.address).then(n=>n._getRangeEntries(e,t,r)),o=[i(n.shift())];if(!n.length)return o[0];const s=i(n.pop());for(;n.length;){const e=async e=>this.getNode(await e.address).then(async e=>e._getAllEntries(r));o.push(e(n.shift()))}return o.push(s),Promise.all(o).then(e=>e.flat())}async transaction(e,t={}){t={codec:this.codec,hasher:this.hasher,getNode:this.getNode,compare:this.compare,cache:this.cache,...t};const r={chunker:this.chunker,opts:t},n=this.entryList.findMany(e,t.compare,!0,this.isLeaf);return this.isLeaf?await this.transactionLeaf(e,t,r,n):await this.transactionBranch(e,t,r,n)}async transactionLeaf(e,t,r,n){const{LeafClass:i,LeafEntryClass:o}=t,{entries:s,previous:a}=this.processLeafEntries(e,n,o,t),l={...r,entries:s,NodeClass:i,distance:0},c=await Node.from(l);return{nodes:c,previous:a,blocks:await Promise.all(c.map(async e=>{const t=await e.encode();return this.cache.set(e),{block:t,node:e}})),distance:0}}processLeafEntries(e,t,r,n){const i=[];let o=[];const s={},a=new Map;for(const{key:u,del:d,value:h}of e){const e=stringKey(u);d?void 0===s[e]&&a.set(e,null):(s[e]={key:u,value:h},a.delete(e))}o=[...this.entryList.entries];for(const[u,[d]]of t){i.push(d);const e=stringKey(d.key);a.has(e)?a.set(e,u):(o[u]=new r(s[e],n),delete s[e])}let l=0;for(const[,u]of a)null!==u&&o.splice(u-l++,1);const c=Object.values(s).map(e=>new r(e,n));return o=o.concat(c).sort(({key:e},{key:t})=>n.compare(e,t)),{entries:o,previous:i}}async transactionBranch(e,t,r,n){const{BranchClass:i,BranchEntryClass:o}=t;let s=0;for(const[h,[f,p]]of n){const e=this.getNode(await f.address).then(e=>e.transaction(p.reverse(),{...t,sorted:!0})).then(e=>({entry:f,keys:p,distance:s,...e}));n.set(h,e)}let a=[...this.entryList.entries];const l={previous:[],blocks:[],nodes:[]};for(const[h,f]of n){const{nodes:e,previous:t,blocks:r,distance:n}=await f;s=n,a[h]=e,t.length&&(l.previous=l.previous.concat(t)),r.length&&(l.blocks=l.blocks.concat(r)),e.length&&(l.nodes=l.nodes.concat(e))}a=a.flat();const c=await this.handlePrepend(a,t,r,l,s);s++;a=await Promise.all(c.map(async e=>{if(e.isEntry)return e;const r=await e.encode();return l.blocks.push({block:r,node:e}),this.cache.set(e),new o(e,t)}));const u={...r,entries:a,NodeClass:i,distance:s},d=await Node.from(u);return await Promise.all(d.map(async e=>{const t=await e.encode();l.blocks.push({block:t,node:e}),this.cache.set(e)})),l.nodes=d,{...l,distance:s}}async handlePrepend(e,t,r,n,i){const{BranchClass:o,LeafClass:s}=t;let a=[],l=null;for(const c of e)if(l){const e=await this.mergeFirstLeftEntries(c,l,r,n,i);l=null;const u=e[0].address?o:s,d={...r,entries:e.sort(({key:e},{key:r})=>t.compare(e,r)),NodeClass:u,distance:i},h=await Node.from(d);h[h.length-1].closed||(l=h.pop()),h.length&&(a=a.concat(h))}else c.isEntry||c.closed?a.push(c):l=c;return l&&a.push(l),a}async getNodeFirstFromBlocks(e,t){for(const{block:r,node:n}of e)if(await r.cid===t)return n;return await this.getNode(t)}async mergeFirstLeftEntries(e,t,r,n,i){const o=r.opts,{LeafClass:s,BranchClass:a,BranchEntryClass:l}=o;if(e.isEntry){const t=await e.address;e=await this.getNodeFirstFromBlocks(n.blocks,t)}const c=e.entryList.entries;if(!c.length)throw new Error("unreachable no entries");const u=(e,t)=>e.concat(t),d=async(e,t,r)=>await Promise.all(e.map(async e=>(t.blocks.push({block:await e.encode(),node:e}),this.cache.set(e),new l({key:e.key,address:await e.address},r))));if(c[0].constructor.name===t.entryList.entries[0].constructor.name)return await u(t.entryList.entries,c);{const e=c.shift();if(!e)throw new Error("unreachable no left entry");if(!e.address)throw new Error("unreachable existing leaf, no leftEntry.address");const l=await this.mergeFirstLeftEntries(e,t,r,n,i-1),h=c.shift();if(!h)return l;if(!h.address)throw new Error("unreachable existing leaf, no esf.address");const f=await this.getNodeFirstFromBlocks(n.blocks,await h.address);if(f.entryList.entries[0].address){if(l[0].address)return l.concat(f.entryList.entries);{const e=await Node.from({...r,entries:l.sort(({key:e},{key:t})=>o.compare(e,t)),NodeClass:s,distance:i}),t=await d(e,n,o),u=await Node.from({...r,entries:[...f.entryList.entries,...t,...c].sort(({key:e},{key:t})=>o.compare(e,t)),NodeClass:a,distance:i});return await d(u,n,o)}}{const e=await u(l,f.entryList.entries),t=await Node.from({...r,entries:e.sort(({key:e},{key:t})=>o.compare(e,t)),NodeClass:s,distance:i}),a=await d(t,n,o);return await u(a,c)}}}async bulk(e,t={},r=!0){const{BranchClass:n}=t;(t={codec:this.codec,hasher:this.hasher,getNode:this.getNode,compare:this.compare,cache:this.cache,...t}).sorted||(e=sortBulk(e,t),t.sorted=!0);const i={chunker:this.chunker,opts:t},o=await this.transaction(e,t);for(;o.nodes.length>1;){const e=o.nodes[0].distance+1,r=await Promise.all(o.nodes.map(async e=>{const r=await e.encode();return o.blocks.push({block:r,node:e}),this.cache.set(e),new t.BranchEntryClass(e,t)})),s=await Node.from({...i,entries:r,NodeClass:n,distance:e});await Promise.all(s.map(async e=>{const t=await e.encode();this.cache.set(e),o.blocks.push({block:t,node:e})})),o.nodes=s}return o.root=o.nodes[0],r&&o.root&&await processRoot(this,o,e,i),o.blocks=o.blocks.map(({block:e})=>e),o}static async from({entries:e,chunker:t,NodeClass:r,distance:n,opts:i}){if(!e.every(t=>t.constructor.name===e[0].constructor.name))throw new Error("all entries must be of the same type");const o=[];let s=[];for(const a of e)s.push(a),await t(a,n)&&(o.push(new EntryList({entries:s,closed:!0})),s=[]);return s.length&&o.push(new EntryList({entries:s,closed:!1})),o.map(e=>new r({entryList:e,chunker:t,distance:n,...i}))}}class IPLDNode extends Node{constructor({codec:e,hasher:t,block:r,...n}){super(n),this.codec=e,this.hasher=t,r?(this.block=r,this.address=r.cid):(this.block=this.encode(),this.address=this.block.then(e=>e.cid))}async get(e){const{result:t,cids:r}=await this.getEntry(e);return{result:t.key,cids:r}}async encode(){if(this.block)return this.block;const e=await this.encodeNode(),t={codec:this.codec,hasher:this.hasher,value:e};return this.block=await encode$b(t),this.block}}class IPLDBranch extends IPLDNode{async encodeNode(){const{entries:e}=this.entryList,t=await Promise.all(e.map(async e=>{if(!e.address)throw new Error("entry.address required");return[e.key,await e.address]}));return{branch:[this.distance,t],closed:this.closed}}get isBranch(){return!0}}class IPLDLeaf extends IPLDNode{async encodeNode(){return{leaf:await Promise.all(this.entryList.entries.map(async e=>await e.encodeNode())),closed:this.closed}}get isLeaf(){return!0}}const create$3=async function*(e){let{LeafClass:t,LeafEntryClass:r,BranchClass:n,BranchEntryClass:i,list:o,chunker:s,compare:a,...l}=e;o=o.map(e=>new r(e,l)),l.compare=a;let c=await Node.from({entries:o,chunker:s,NodeClass:t,distance:0,opts:l});yield*c;let u=1;for(;c.length>1;){const e=async e=>new i({key:e.key,address:await e.address},l),t=await Promise.all(c.map(e));c=await Node.from({entries:t,chunker:s,NodeClass:n,distance:u,opts:l}),yield*c,u++}};class MapEntry extends Entry{async identity(){const e=await this.codec.encode(await this.encodeNode()),t=await this.hasher.encode(e);return readUInt32LE(t)}}class MapLeafEntry extends MapEntry{constructor(e,t){super(e,t),this.value=e.value}encodeNode(){return[this.key,this.value]}}class MapBranchEntry extends MapEntry{constructor(e,t){if(!e.address)throw new Error("Cannot create MapBranchEntry without address");super(e,t)}async encodeNode(){return[this.key,await this.address]}}const getValue=async(e,t)=>{const{result:r,cids:n}=await e.getEntry(t);return{result:r.value,cids:n}},getManyValues=async(e,t)=>{const{result:r,cids:n}=await e.getEntries(t);return{result:r.map(e=>e.value),cids:n}};class MapLeaf extends IPLDLeaf{get(e){return getValue(this,e)}getMany(e){return getManyValues(this,e)}bulk(e,t={},r=!0){return super.bulk(e,{...classes$1,...t},r)}}class MapBranch extends IPLDBranch{get(e){return getValue(this,e)}getMany(e){return getManyValues(this,e)}bulk(e,t={},r=!0){return super.bulk(e,{...classes$1,...t},r)}}const classes$1={LeafClass:MapLeaf,LeafEntryClass:MapLeafEntry,BranchClass:MapBranch,BranchEntryClass:MapBranchEntry},createGetNode=(e,t,r,n,i,o,s)=>{const a=s.LeafClass||MapLeaf,l=s.LeafEntryClass||MapLeafEntry,c=s.BranchClass||MapBranch,u=s.BranchEntryClass||MapBranchEntry,d=async r=>t.has(r)?t.get(r):e(r).then(e=>h(e)),h=makeDecoder({chunker:r,cache:t,getNode:d,codec:n,hasher:i,compare:o,LeafEntryClass:l,LeafClass:a,BranchEntryClass:u,BranchClass:c});return d},create$2=({get:e,cache:t,chunker:r,list:n,codec:i,hasher:o,sorted:s,compare:a,...l})=>{s||(n=n.sort(({key:e},{key:t})=>a(e,t)));const c={list:n,codec:i,hasher:o,chunker:r,getNode:createGetNode(e,t,r,i,o,a,l),sorted:s,compare:a,cache:t,LeafClass:l.LeafClass||MapLeaf,LeafEntryClass:l.LeafEntryClass||MapLeafEntry,BranchClass:l.BranchClass||MapBranch,BranchEntryClass:l.BranchEntryClass||MapBranchEntry};return create$3(c)},load$1=({cid:e,get:t,cache:r,chunker:n,codec:i,hasher:o,compare:s,...a})=>createGetNode(t,r,n,i,o,s,a)(e);function makeDecoder({chunker:e,cache:t,getNode:r,codec:n,hasher:i,compare:o,LeafEntryClass:s,LeafClass:a,BranchEntryClass:l,BranchClass:c}){const u={codec:n,hasher:i};return d=>{const{value:h}=d,f={chunker:e,cache:t,block:d,getNode:r,codec:n,hasher:i,compare:o};let p,y;if(h.leaf)p=h.leaf.map(([e,t])=>new s({key:e,value:t},u)),y=a;else{if(!h.branch)throw new Error("Unknown block data, does not match schema");{const[e,t]=h.branch;f.distance=e,p=t.map(([e,t])=>new l({key:e,address:t},u)),y=c}}const g=new y({entryList:new EntryList({entries:p,closed:h.closed}),...f});return t.set(g),g}}const compare$1=(e,t)=>{const[r,n]=e,[i,o]=t,s=simpleCompare(r,i);return 0!==s?s:refCompare$1(n,o)},refCompare$1=(e,t)=>{if(Number.isNaN(e))return-1;if(Number.isNaN(t))throw new Error("ref may not be Infinity or NaN");return Number.isFinite(e)?simpleCompare(e,t):1},getIndex=async(e,t)=>{const r=[t,NaN],n=[t,1/0],{result:i,cids:o}=await e.getRangeEntries(r,n);return{result:i.map(e=>{const[t,r]=e.key;return{id:r,key:t,row:e.value}}),cids:o}},getRange=async(e,t,r)=>{t=[t,NaN],r=[r,1/0];const{result:n,cids:i}=await e.getRangeEntries(t,r);return{result:n.map(e=>{const[t,r]=e.key;return{id:r,key:t,row:e.value}}),cids:i}};class DBIndexLeaf extends MapLeaf{get(e){return getIndex(this,e)}range(e,t){return getRange(this,e,t)}bulk(e,t={},r=!0){return super.bulk(e,{...classes,...t},r)}}class DBIndexBranch extends MapBranch{get(e){return getIndex(this,e)}range(e,t){return getRange(this,e,t)}bulk(e,t={},r=!0){return super.bulk(e,{...classes,...t},r)}}const LeafClass=DBIndexLeaf,BranchClass=DBIndexBranch,classes={LeafClass:LeafClass,BranchClass:BranchClass,LeafEntryClass:MapLeafEntry,BranchEntryClass:MapBranchEntry},defaults={...classes,compare:compare$1},create$1=e=>(e={...defaults,...e},create$2(e)),load=e=>(e={...defaults,...e},load$1(e)),nocache={has:()=>!1,get:()=>{throw new Error("Cannot ask for entries from nocache")},set:()=>{}};var __defProp=Object.defineProperty,__export=(e,t)=>{for(var r in t)__defProp(e,r,{get:t[r],enumerable:!0})};function writeQueue(e,t=1/0,r=!1){const n=[];let i=!1;async function o(){if(i||0===n.length)return;i=!0;const s=n.splice(0,t),a=s.map(e=>e.task);if(r){const t=a.map(async(t,r)=>{try{const n=await e([t]);s[r].resolve(n)}catch(n){s[r].reject(n)}});await Promise.all(t)}else try{const t=await e(a);s.forEach(e=>e.resolve(t))}catch(l){s.forEach(e=>e.reject(l))}i=!1,o()}return{push:e=>new Promise((t,r)=>{n.push({task:e,resolve:t,reject:r}),o()})}}var block_exports={};__export(block_exports,{Block:()=>Block,create:()=>create,createUnsafe:()=>createUnsafe,decode:()=>decode,encode:()=>encode});var Block=Block$1;async function decode({bytes:e,codec:t,hasher:r}){if(null==e)throw new Error('Missing required argument "bytes"');if(null==t||null==r)throw new Error("Missing required argument: codec or hasher");const n=await Promise.resolve(t.decode(e)),i=await r.digest(e),o=CID.create(1,t.code,i);return new Block$1({value:n,bytes:e,cid:o})}async function encode({value:e,codec:t,hasher:r}){if(void 0===e)throw new Error('Missing required argument "value"');if(null==t||null==r)throw new Error("Missing required argument: codec or hasher");const n=await Promise.resolve(t.encode(e)),i=await r.digest(n),o=CID.create(1,t.code,i);return new Block$1({value:e,bytes:n,cid:o})}async function create({bytes:e,cid:t,hasher:r,codec:n}){if(null==e)throw new Error('Missing required argument "bytes"');if(null==r)throw new Error('Missing required argument "hasher"');const i=await Promise.resolve(n.decode(e)),o=await r.digest(e);if(!equals$1(t.multihash.bytes,o.bytes))throw new Error("CID hash does not match bytes");return createUnsafe({bytes:e,cid:t,value:i,codec:n})}async function createUnsafe({bytes:e,cid:t,value:r,codec:n}){const i=await Promise.resolve(void 0!==r?r:null==n?void 0:n.decode(e));if(void 0===i)throw new Error('Missing required argument, must either provide "value" or "codec"');return new Block({cid:t,bytes:e,value:i})}var blockstore_exports={};function toCIDBlock(e){return e}__export(blockstore_exports,{BaseBlockstore:()=>BaseBlockstore,CarTransaction:()=>CarTransaction,CompactionFetcher:()=>CompactionFetcher,ConnectionBase:()=>ConnectionBase,EncryptedBlockstore:()=>EncryptedBlockstore,FragmentGateway:()=>FragmentGateway,Loader:()=>Loader,addCryptoKeyToGatewayMetaPayload:()=>addCryptoKeyToGatewayMetaPayload,ensureStart:()=>ensureStart,getGatewayFromURL:()=>getGatewayFromURL,parseCarFile:()=>parseCarFile,registerStoreProtocol:()=>registerStoreProtocol,setCryptoKeyFromGatewayMetaPayload:()=>setCryptoKeyFromGatewayMetaPayload,testStoreFactory:()=>testStoreFactory,toCIDBlock:()=>toCIDBlock,toStoreRuntime:()=>toStoreRuntime});var files_exports={};__export(files_exports,{decodeFile:()=>decodeFile,encodeFile:()=>encodeFile});var queuingStrategy=withCapacity(),settings=configure$1({fileChunkEncoder:raw,smallFileEncoder:raw,chunker:withMaxChunkSize(1048576),fileLayout:withWidth(1024)});async function collect(e){const t=[];return await e.pipeTo(new WritableStream({write(e){t.push(e)}})),t}async function encodeFile(e){const t=createFileEncoderStream(e),r=await collect(t);return{cid:r.at(-1).cid,blocks:r}}async function decodeFile(e,t,r){const n=await exporter(t.toString(),e,{length:r.size}),i=[];for await(const o of n.content())i.push(o);return new File(i,n.name,{type:r.type,lastModified:0})}function createFileEncoderStream(e){const{readable:t,writable:r}=new TransformStream({},queuingStrategy),n=createWriter$2({writable:r,settings:settings}),i=new UnixFSFileBuilder("",e);return(async()=>{await i.finalize(n),await n.close()})(),t}var UnixFSFileBuilder=(_d=class{constructor(e,t){__privateAdd2(this,_file,void 0),this.name=e,__privateSet2(this,_file,t)}async finalize(e){const t=create$5(e);return await __privateGet2(this,_file).stream().pipeTo(new WritableStream({async write(e){await t.write(e)}})),await t.close()}},_file=new WeakMap,_d);function isFalsy(e){return!1===e&&null===e&&void 0===e}function throwFalsy(e){if(isFalsy(e))throw new Error("value is Falsy");return e}function falsyToUndef(e){if(!isFalsy(e))return e}var _globalLogger=new ResolveOnce;function globalLogger(){return _globalLogger.once(()=>new LoggerImpl)}var registerFP_DEBUG=new ResolveOnce,SuperThisImpl=class e{constructor(e){this.logger=e.logger,this.env=e.env,this.crypto=e.crypto,this.pathOps=e.pathOps,this.txt=e.txt,this.ctx={...e.ctx}}nextId(e=6){const t=this.crypto.randomBytes(e);return{str:base58btc.encode(t),bin:t}}timeOrderedNextId(e){const t=(281474976710656+(e="number"==typeof e?e:(new Date).getTime())).toString(16).replace(/^1/,""),r=this.crypto.randomBytes(10);r[1]=240&r[1]|(8|r[1]&&11);const n=Array.from(r).map(e=>e.toString(16).padStart(2,"0")).join("");return{str:`${t.slice(0,8)}-${t.slice(8)}-7${n.slice(0,3)}-${n.slice(3,7)}-${n.slice(7,19)}`}}start(){return Promise.resolve()}clone(t){return new e({logger:t.logger||this.logger,env:envFactory(t.env)||this.env,crypto:t.crypto||this.crypto,pathOps:t.pathOps||this.pathOps,txt:t.txt||this.txt,ctx:{...this.ctx,...t.ctx}})}};function presetEnv(){return new Map([...Array.from(Object.entries(globalThis[Symbol.for("FP_PRESET_ENV")]||{}))])}var pathOpsImpl=class{join(...e){return e.map(e=>e.replace(/\/+$/,"")).join("/")}dirname(e){return e.split("/").slice(0,-1).join("/")}},pathOps=new pathOpsImpl,txtOps={encode:e=>(new TextEncoder).encode(e),decode:e=>(new TextDecoder).decode(e)},_onSuperThis=new Map;function ensureSuperThis(e){var t,r;const n=envFactory({symbol:(null==(t=null==e?void 0:e.env)?void 0:t.symbol)||"FP_ENV",presetEnv:(null==(r=null==e?void 0:e.env)?void 0:r.presetEnv)||presetEnv()}),i=new SuperThisImpl({logger:(null==e?void 0:e.logger)||globalLogger(),env:n,crypto:(null==e?void 0:e.crypto)||toCryptoRuntime(),ctx:(null==e?void 0:e.ctx)||{},pathOps:pathOps,txt:(null==e?void 0:e.txt)||txtOps});return _onSuperThis.forEach(e=>e(i)),i}function ensureSuperLog(e,t,r){return e.clone({logger:ensureLogger(e,t,r)})}function ensureLogger(e,t,r){let n;n=e&&IsLogger(e.logger)?e.logger:globalLogger();const i=n.With().Module(t),o=[];let s=!1;if(r){"debug"in r&&("string"==typeof r.debug&&r.debug.length>0?o.push(r.debug):o.push(t),delete r.debug),"exposeStack"in r&&(s=!0,delete r.exposeStack),"this"in r&&(i.Str("this",e.nextId(4).str),delete r.this);for(const[e,t]of Object.entries(r))switch(typeof t){case"string":i.Str(e,t);break;case"number":i.Uint64(e,t);break;default:t instanceof Date?i.Str(e,t.toISOString()):isURL(t)?i.Str(e,t.toString()):"function"==typeof t?i.Ref(e,t):i.Any(e,t)}}registerFP_DEBUG.once(async()=>{e.env.onSet((e,t)=>{switch(e){case"FP_FORMAT":switch(t){case"jsonice":n.SetFormatter(new JSONFormatter(n.TxtEnDe(),2));break;case"yaml":n.SetFormatter(new YAMLFormatter(n.TxtEnDe(),2));break;default:n.SetFormatter(new JSONFormatter(n.TxtEnDe()))}break;case"FP_DEBUG":n.SetDebug(t||[]);break;case"FP_STACK":n.SetExposeStack(!!t)}},"FP_FORMAT","FP_DEBUG","FP_STACK")}).finally(()=>{}),o.length>0&&n.SetDebug(o),s&&n.SetExposeStack(!0);return i.Logger()}function getStore(e,t,r){const n=e.getParam("store");switch(n){case"data":case"wal":case"meta":break;default:throw t.logger.Error().Url(e).Msg("store not found").AsError()}let i=n;return e.hasParam("index")&&(i=r(e.getParam("index")||"idx",i)),{store:n,name:i}}function getKey(e,t){const r=e.getParam("key");if(!r)throw t.Error().Str("url",e.toString()).Msg("key not found").AsError();return r}async function exceptionWrapper(e){return e().catch(e=>Result.Err(e))}var NotFoundError=class extends Error{constructor(){super(...arguments),this.code="ENOENT"}};function isNotFoundError(e){if(Result.Is(e)){if(e.isOk())return!1;e=e.Err()}return"ENOENT"===e.code}function dataDir(e,t,r){if(!r)if(runtimeFn().isBrowser)r=e.env.get("FP_STORAGE_URL")||"indexdb://fp";else{const t=e.env.get("HOME")||"./";r=e.env.get("FP_STORAGE_URL")||`file://${e.pathOps.join(t,".fireproof")}`}return URI.from(r.toString()).build().setParam("name",t||"").URI()}function UInt8ArrayEqual(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}async function parseCarFile(e,t){const r=await e.getRoots(),n=await e.get(r[0]);if(!n)throw t.Error().Msg("missing header block").AsError();const i=(await decode({bytes:n.bytes,hasher:sha256,codec:codec2})).value;if(i&&!i.fp)throw t.Error().Msg("missing fp").AsError();return i.fp}var CarTransaction=class extends MemoryBlockstore{constructor(e,t={add:!0,noLoader:!1}){super(),t.add&&e.transactions.add(this),this.parent=e}async get(e){return await this.superGet(e)||falsyToUndef(await this.parent.get(e))}async superGet(e){return super.get(e)}};function defaultedBlockstoreRuntime(e,t,r,n){const i=ensureLogger(e,r,n),o=t.store||{};return{applyMeta:(e,t)=>Promise.resolve(),compact:async e=>({}),autoCompact:100,public:!1,name:void 0,threshold:1e6,...t,logger:i,keyBag:t.keyBag||{},crypto:toCryptoRuntime(t.crypto),store:o,storeRuntime:toStoreRuntime(o,e)}}function blockstoreFactory(e,t){return t.name?new EncryptedBlockstore(e,t):new BaseBlockstore(t)}var BaseBlockstore=class{constructor(e={}){this.transactions=new Set,this.sthis=ensureSuperThis(e),this.ebOpts=defaultedBlockstoreRuntime(this.sthis,e,"BaseBlockstore"),this.logger=this.ebOpts.logger}ready(){return Promise.resolve()}async close(){}async destroy(){}async compact(){}async get(e){if(!e)throw this.logger.Error().Msg("required cid").AsError();for(const t of this.transactions){const r=await t.superGet(e);if(r)return r}}async put(e,t){throw this.logger.Error().Msg("use a transaction to put").AsError()}async transaction(e,t){const r=new CarTransaction(this,t),n=await e(r);return this.lastTxMeta=n,{t:r,meta:n}}openTransaction(e={add:!0,noLoader:!1}){return new CarTransaction(this,e)}async commitTransaction(e,t,r){var n;if(!this.loader)throw this.logger.Error().Msg("loader required to commit").AsError();const i=await(null==(n=this.loader)?void 0:n.commit(e,t,r));if(this.ebOpts.autoCompact&&this.loader.carLog.length>this.ebOpts.autoCompact&&setTimeout(()=>{this.compact()},10),i)return this.transactions.delete(e),{meta:t,cars:i,t:e};throw this.logger.Error().Msg("failed to commit car files").AsError()}async*entries(){const e=new Set;for(const t of this.transactions)for await(const r of t.entries())e.has(r.cid.toString())||(e.add(r.cid.toString()),yield r)}},EncryptedBlockstore=class extends BaseBlockstore{constructor(e,t){super(t),this.compacting=!1,this.logger=ensureLogger(this.sthis,"EncryptedBlockstore");const{name:r}=t;if(!r)throw this.logger.Error().Msg("name required").AsError();this.name=r,this.loader=new Loader(this.name,t,e)}ready(){return this.loader.ready()}close(){return this.loader.close()}destroy(){return this.loader.destroy()}async get(e){const t=await super.get(e);return t||(this.loader?falsyToUndef(await this.loader.getBlock(e)):void 0)}async transaction(e,t={noLoader:!1}){const{t:r,meta:n}=await super.transaction(e),i=await this.loader.commit(r,n,t);if(this.ebOpts.autoCompact&&this.loader.carLog.length>this.ebOpts.autoCompact&&setTimeout(()=>{this.compact()},10),i)return this.transactions.delete(r),{meta:n,cars:i,t:r};throw this.logger.Error().Msg("failed to commit car files").AsError()}async getFile(e,t){if(await this.ready(),!this.loader)throw this.logger.Error().Msg("loader required to get file, database must be named").AsError();const r=await this.loader.loadFileCar(e),n=await r.get(t);if(!n)throw this.logger.Error().Str("cid",t.toString()).Msg("Missing block").AsError();return n.bytes}async compact(){var e;if(await this.ready(),!this.loader)throw this.logger.Error().Msg("loader required to compact").AsError();if(this.loader.carLog.length<2)return;const t=this.ebOpts.compact||(e=>this.defaultCompact(e,this.logger));if(!t||this.compacting)return;const r=new CompactionFetcher(this);this.compacting=!0;const n=await t(r);await(null==(e=this.loader)?void 0:e.commit(r.loggedBlocks,n,{compact:!0,noLoader:!0})),this.compacting=!1}async defaultCompact(e,t){if(!this.loader)throw t.Error().Msg("no loader").AsError();if(!this.lastTxMeta)throw t.Error().Msg("no lastTxMeta").AsError();for await(const r of this.loader.entries(!1))e.loggedBlocks.putSync(r.cid,r.bytes);for(const r of this.transactions)for await(const t of r.entries())e.loggedBlocks.putSync(t.cid,t.bytes);return this.lastTxMeta}async*entries(){for await(const e of this.loader.entries())yield e}},CompactionFetcher=class{constructor(e){this.blockstore=e,this.loggedBlocks=new CarTransaction(e)}async get(e){const t=await this.blockstore.get(e);return t&&this.loggedBlocks.putSync(e,t.bytes),falsyToUndef(t)}},CommitQueue=class{constructor(){this.queue=[],this.processing=!1,this._waitIdleItems=new Set}waitIdle(){if(0===this.queue.length&&!this.processing)return Promise.resolve();const e=new Future$1;return this._waitIdleItems.add(e),e.asPromise()}async enqueue(e){return new Promise((t,r)=>{this.queue.push(async()=>{try{t(await e())}catch(n){r(n)}finally{this.processing=!1,this.processNext()}}),this.processing||this.processNext()})}processNext(){if(this.queue.length>0&&!this.processing){this.processing=!0;const e=this.queue.shift();e&&e().finally(()=>{})}if(0===this.queue.length&&!this.processing){const e=Array.from(this._waitIdleItems);this._waitIdleItems.clear(),e.map(e=>e.resolve())}}},key_bag_exports={};__export(key_bag_exports,{KeyBag:()=>KeyBag,defaultKeyBagUrl:()=>defaultKeyBagUrl,getKeyBag:()=>getKeyBag,registerKeyBagProviderFactory:()=>registerKeyBagProviderFactory});var KeyBag=class{constructor(e){this.rt=e,this._warnOnce=new ResolveOnce,this._seq=new ResolveSeq,this.logger=ensureLogger(e.sthis,"KeyBag"),this.logger.Debug().Msg("KeyBag created")}async subtleKey(e){const t="_deprecated_internal_api"===this.rt.url.getParam("extractKey");return t&&this._warnOnce.once(()=>this.logger.Warn().Msg("extractKey is enabled via _deprecated_internal_api --- handle keys safely!!!")),await this.rt.crypto.importKey("raw",base58btc.decode(e),"AES-GCM",t,["encrypt","decrypt"])}async ensureKeyFromUrl(e,t){const r=e.getParam("storekey");if("insecure"===r)return Result.Ok(e);if(!r){const r=`@${t()}@`,n=await this.getNamedKey(r);if(n.isErr())return n;const i=e.build().setParam("storekey",r);return Result.Ok(i.URI())}if(r.startsWith("@")&&r.endsWith("@")){const e=await this.getNamedKey(r);if(e.isErr())return e}return Result.Ok(e)}async toKeyWithFingerPrint(e){const t=base58btc.decode(e),r=await this.subtleKey(e),n=await this.rt.crypto.digestSHA256(t);return Result.Ok({key:r,fingerPrint:base58btc.encode(new Uint8Array(n))})}async setNamedKey(e,t){return this._seq.add(()=>this._setNamedKey(e,t))}async _setNamedKey(e,t){const r={name:e,key:t},n=await this.rt.getBag();return this.logger.Debug().Str("name",e).Msg("setNamedKey"),await n.set(e,r),await this.toKeyWithFingerPrint(r.key)}async getNamedExtractableKey(e,t=!1){const r=await this.getNamedKey(e,t);if(r.isErr())return r;const n=r.Ok();return Result.Ok({...n,extract:async()=>{const e=new Uint8Array(await this.rt.crypto.exportKey("raw",n.key));return{key:e,keyStr:base58btc.encode(e)}}})}async getNamedKey(e,t=!1){const r=this.rt.sthis.nextId(4).str;return this._seq.add(async()=>{const n=await this.rt.getBag(),i=await n.get(e);if(i){const t=await this.toKeyWithFingerPrint(i.key);return this.logger.Debug().Str("id",r).Str("name",e).Result("fpr",t).Msg("fingerPrint getNamedKey"),t}if(t)return this.logger.Debug().Str("id",r).Str("name",e).Msg("failIfNotFound getNamedKey"),Result.Err(new Error(`Key not found: ${e}`));const o=await this._setNamedKey(e,base58btc.encode(this.rt.crypto.randomBytes(this.rt.keyLength)));return this.logger.Debug().Str("id",r).Str("name",e).Result("fpr",o).Msg("createKey getNamedKey-post"),o})}},keyBagProviderFactories=new Map([{protocol:"file:",factory:async(e,t)=>{const{KeyBagProviderImpl:r}=await __vitePreload(()=>import("./index-984bab00.js"),[]);return new r(e,t)}},{protocol:"indexdb:",factory:async(e,t)=>{const{KeyBagProviderImpl:r}=await __vitePreload(()=>import("./index-984bab00.js"),[]);return new r(e,t)}}].map(e=>[e.protocol,e]));function registerKeyBagProviderFactory(e){const t=e.protocol.endsWith(":")?e.protocol:e.protocol+":";keyBagProviderFactories.set(t,{...e,protocol:t})}function defaultKeyBagUrl(e){let t,r=e.env.get("FP_KEYBAG_URL");if(runtimeFn().isBrowser)t=URI.from(r||"indexdb://fp-keybag");else if(r)t=URI.from(r);else{r=`${e.env.get("HOME")}/.fireproof/keybag`,t=URI.from(`file://${r}`)}return ensureLogger(e,"defaultKeyBagUrl").Debug().Url(t).Msg("from env"),t}function defaultKeyBagOpts(e,t){if(t.keyRuntime)return t.keyRuntime;const r=ensureLogger(e,"KeyBag");let n;t.url?(n=URI.from(t.url),r.Debug().Url(n).Msg("from opts")):n=defaultKeyBagUrl(e);const i=keyBagProviderFactories.get(n.protocol);if(!i)throw r.Error().Url(n).Msg("unsupported protocol").AsError();if(n.hasParam("masterkey"))throw r.Error().Url(n).Msg("masterkey is not supported").AsError();return{url:n,crypto:t.crypto||toCryptoRuntime({}),sthis:e,logger:r,keyLength:t.keyLength||16,getBag:async()=>i.factory(n,e),id:()=>n.toString()}}var _keyBags=new KeyedResolvOnce;async function getKeyBag(e,t={}){await e.start();const r=defaultKeyBagOpts(e,t);return _keyBags.get(r.id()).once(async()=>new KeyBag(r))}async function encodeCarFile(e,t,r){let n=0;const i=headerLength({roots:e});n+=i;for(const{cid:a,bytes:l}of t.entries())n+=blockLength({cid:a,bytes:l});const o=new Uint8Array(n),s=createWriter(o,{headerSize:i});for(const a of e)s.addRoot(a);for(const{cid:a,bytes:l}of t.entries())s.write({cid:a,bytes:l});return s.close(),await encode({value:s.bytes,hasher:sha256,codec:r})}async function createCarFile(e,t,r){return encodeCarFile([t],r,e)}async function commitFiles(e,t,r,n){const{files:i}=makeFileCarHeader(n),o=[],s=(await e.keyedCrypto()).codec(),a=await prepareCarFilesFiles(s,i,r);for(const l of a){const{cid:r,bytes:n}=l;await e.save({cid:r,bytes:n}),await t.enqueueFile(r),o.push(r)}return o}function makeFileCarHeader(e){const t=[];for(const[,r]of Object.entries(e.files||{}))r&&"object"==typeof r&&"cid"in r&&null!==r&&t.push(r.cid);return{...e,files:t}}async function prepareCarFilesFiles(e,t,r){return[await encodeCarFile(t,r,e)]}function makeCarHeader(e,t,r=!1){return{...r?{cars:[],compact:t}:{cars:t,compact:[]},meta:e}}async function encodeCarHeader(e){return await encode({value:{fp:e},hasher:sha256,codec:codec2})}async function commit(e,t,r,n={noLoader:!1,compact:!1}){const i=makeCarHeader(r,e.carLog,!!n.compact),o=await encodeCarHeader(i),s=await prepareCarFiles(e.encoder,e.threshold,o,t),a=[];for(const c of s){const{cid:t,bytes:r}=c;await e.carStore.save({cid:t,bytes:r}),a.push(t)}const l={cars:a};return await e.WALStore.enqueue(l,n),await e.metaStore.save(l),{cgrp:a,header:i}}async function prepareCarFiles(e,t,r,n){const i=[];t=t||1024e3;let o=new CarTransaction(n.parent,{add:!1,noLoader:!1});o.putSync(r.cid,r.bytes);let s=blockLength(toCIDBlock(r)),a=r;for(const{cid:l,bytes:c}of n.entries())s+=blockLength(toCIDBlock({cid:l,bytes:c})),s>=t?(i.push(await createCarFile(e,a.cid,o)),o=new CarTransaction(n.parent,{add:!1,noLoader:!1}),o.putSync(l,c),a={cid:l,bytes:c},s=blockLength(toCIDBlock({cid:l,bytes:c}))):o.putSync(l,c);return i.push(await createCarFile(e,a.cid,o)),i}var TaskManager=class{constructor(e,t){this.eventsWeHandled=new Set,this.queue=[],this.isProcessing=!1,this.logger=ensureLogger(e,"TaskManager"),this.callback=t}async handleEvent(e,t,r){for(const n of t)this.eventsWeHandled.add(n.toString());this.queue.push({cid:e.toString(),dbMeta:r,retries:0}),this.queue=this.queue.filter(({cid:e})=>!this.eventsWeHandled.has(e)),this.processQueue()}async processQueue(){if(this.isProcessing)return;this.isProcessing=!0;const e=this.queue.filter(({cid:e})=>!this.eventsWeHandled.has(e))[0];if(e)try{await this.callback(e.dbMeta),this.eventsWeHandled.add(e.cid),this.queue=this.queue.filter(({cid:e})=>!this.eventsWeHandled.has(e))}catch(t){throw e.retries++>3&&(this.logger.Error().Str("cid",e.cid).Msg("failed to process event block after 3 retries"),this.queue=this.queue.filter(({cid:t})=>t!==e.cid)),await new Promise(e=>setTimeout(e,50)),this.logger.Error().Err(t).Msg("failed to process event block").AsError()}finally{this.isProcessing=!1,this.queue.length>0&&this.processQueue()}else this.isProcessing=!1}};function carLogIncludesGroup(e,t){return e.some(e=>e.toString()===t.toString())}function uniqueCids(e,t=new Set){const r=new Map;for(const n of e)t.has(n.toString())||r.set(n.toString(),n);return[...r.values()]}var Loader=class{constructor(e,t,r){this.commitQueue=new CommitQueue,this.isCompacting=!1,this.carReaders=new Map,this.seenCompacted=new Set,this.processedCars=new Set,this.carLog=[],this.getBlockCache=new Map,this.seenMeta=new Set,this.writeLimit=pLimit(1),this.onceReady=new ResolveOnce,this.name=e,this.sthis=r,this.ebOpts=defaultedBlockstoreRuntime(r,{...t,name:e},"Loader"),this.logger=this.ebOpts.logger,this.taskManager=new TaskManager(r,async e=>{await this.handleDbMetasFromStore([e])})}async keyBag(){return getKeyBag(this.sthis,this.ebOpts.keyBag)}async carStore(){return this.ebOpts.storeRuntime.makeDataStore(this)}async fileStore(){return this.ebOpts.storeRuntime.makeDataStore(this)}async WALStore(){return this.ebOpts.storeRuntime.makeWALStore(this)}async metaStore(){return this.ebOpts.storeRuntime.makeMetaStore(this)}async ready(){return this.onceReady.once(async()=>{const e=await(await this.metaStore()).load();this.ebOpts.meta?await this.handleDbMetasFromStore([this.ebOpts.meta]):e&&await this.handleDbMetasFromStore(e)})}async close(){const e=await Promise.all([this.carStore(),this.metaStore(),this.fileStore(),this.WALStore()]);await Promise.all(e.map(e=>e.close()))}async destroy(){const e=await Promise.all([this.carStore(),this.metaStore(),this.fileStore(),this.WALStore()]);await Promise.all(e.map(e=>e.destroy()))}async handleDbMetasFromStore(e){this.logger.Debug().Any("metas",e).Msg("handleDbMetasFromStore");for(const t of e)await this.writeLimit(async()=>{await this.mergeDbMetaIntoClock(t)})}async mergeDbMetaIntoClock(e){var t,r;if(this.isCompacting)throw this.logger.Error().Msg("cannot merge while compacting").AsError();if(this.seenMeta.has(e.cars.toString()))return;if(this.seenMeta.add(e.cars.toString()),carLogIncludesGroup(this.carLog,e.cars))return;const n=await this.loadCarHeaderFromMeta(e);n.compact.map(e=>e.toString()).forEach(this.seenCompacted.add,this.seenCompacted),await this.getMoreReaders(n.cars.flat()),this.carLog=[...uniqueCids([e.cars,...this.carLog,...n.cars],this.seenCompacted)],await(null==(r=(t=this.ebOpts).applyMeta)?void 0:r.call(t,n.meta))}async loadCarHeaderFromMeta({cars:e}){const t=await this.loadCar(e[0]);return await parseCarFile(t,this.logger)}async commitFiles(e,t){await this.ready();const r=await this.fileStore(),n=await this.WALStore();return this.commitQueue.enqueue(()=>commitFiles(r,n,e,t))}async loadFileCar(e){return await this.storesLoadCar(e,await this.fileStore(),this.remoteFileStore)}async commit(e,t,r={noLoader:!1,compact:!1}){await this.ready();const n=await this.fileStore(),i={encoder:(await n.keyedCrypto()).codec(),carLog:this.carLog,carStore:n,WALStore:await this.WALStore(),metaStore:await this.metaStore(),threshold:this.ebOpts.threshold};return this.commitQueue.enqueue(async()=>{await this.cacheTransaction(e);const n=await commit(i,e,t,r);return await this.updateCarLog(n.cgrp,n.header,!!r.compact),n.cgrp})}async updateCarLog(e,t,r){if(r){const r=t.compact[t.compact.length-1];t.compact.map(e=>e.toString()).forEach(this.seenCompacted.add,this.seenCompacted),this.carLog=[...uniqueCids([...this.carLog,...t.cars,e],this.seenCompacted)],await this.removeCidsForCompact(r[0]).catch(e=>e)}else this.carLog.unshift(e)}async cacheTransaction(e){for await(const t of e.entries()){const e=t.cid.toString();this.getBlockCache.has(e)||this.getBlockCache.set(e,t)}}async cacheCarReader(e,t){if(!this.processedCars.has(e)){this.processedCars.add(e);for await(const e of t.blocks()){const t=e.cid.toString();this.getBlockCache.has(t)||this.getBlockCache.set(t,e)}}}async removeCidsForCompact(e){const t=await this.loadCarHeaderFromMeta({cars:[e]});for(const r of t.compact)for(const e of r)await(await this.carStore()).remove(e)}async*entries(e=!0){if(await this.ready(),e)for(const[,t]of this.getBlockCache)yield t;else{for(const[,e]of this.getBlockCache)yield e;for(const e of this.carLog)for(const t of e){const e=await this.loadCar(t);if(!e)throw this.logger.Error().Ref("cid",t).Msg("missing car reader").AsError();for await(const t of e.blocks()){const e=t.cid.toString();this.getBlockCache.has(e)||(yield t)}}}}async getBlock(e){await this.ready();const t=e.toString();if(this.getBlockCache.has(t))return this.getBlockCache.get(t);const r=async e=>{if(this.getBlockCache.has(t))return this.getBlockCache.get(t);const r=await this.loadCar(e);if(!r)throw this.logger.Error().Ref("cid",e).Msg("missing car reader").AsError();if(await this.cacheCarReader(e.toString(),r).catch(()=>{}),this.getBlockCache.has(t))return this.getBlockCache.get(t);throw this.logger.Error().Str("cid",t).Msg("block not in reader").AsError()},n=async e=>{const n=await this.loadCar(e);if(!n)throw this.logger.Error().Str("cid",e.toString()).Msg("missing car reader").AsError();const i=(await parseCarFile(n,this.logger)).compact;let o;for(let t=0;t<i.length;t+=5){const e=[];for(let n=t;n<Math.min(t+5,i.length);n++)for(const t of i[n])e.push(r(t));try{o=await Promise.any(e)}catch{}if(o)break}if(this.getBlockCache.has(t))return this.getBlockCache.get(t);throw this.logger.Error().Str("cid",t).Msg("block not in compact reader").AsError()};let i;for(let o=0;o<this.carLog.length;o+=5){const e=this.carLog.slice(o,o+5).flatMap(e=>e.map(r));try{i=await Promise.any(e)}catch{}if(i)break}if(!i)try{i=await n(this.carLog[this.carLog.length-1][0])}catch{}return i}async loadCar(e){if(!this.carStore)throw this.logger.Error().Msg("car store not initialized").AsError();return await this.storesLoadCar(e,await this.carStore(),this.remoteCarStore)}async makeDecoderAndCarReader(e,t,r){const n=e.toString();let i,o=t;try{this.logger.Debug().Str("cid",n).Msg("loading car"),i=await t.load(e),this.logger.Debug().Bool("loadedCar",i).Msg("loaded")}catch(u){if(r){const n=await r.load(e);n&&(this.logger.Debug().Ref("cid",n.cid).Msg("saving remote car locally"),await t.save(n),i=n,o=r)}else this.logger.Error().Str("cid",n).Err(u).Msg("loading car")}if(!i)throw this.logger.Error().Url(t.url()).Str("cid",n).Msg("missing car files").AsError();const s=await decode({bytes:i.bytes,hasher:sha256,codec:(await o.keyedCrypto()).codec()}),a=await CarReader.fromBytes(s.value),l=Promise.resolve(a),c=l.then(async e=>(await this.cacheCarReader(n,e).catch(e=>{this.logger.Error().Err(e).Str("cid",n).Msg("error caching car reader")}),e));return this.carReaders.set(n,c),l}async storesLoadCar(e,t,r){const n=e.toString();let i=this.carReaders.get(n);return i||(i=this.makeDecoderAndCarReader(e,t,r),this.carReaders.set(n,i)),i}async getMoreReaders(e){const t=pLimit(5),r=e.filter(e=>!this.carReaders.has(e.toString()));await Promise.all(r.map(e=>t(()=>this.loadCar(e))))}},keyed_crypto_exports={};__export(keyed_crypto_exports,{BlockIvKeyIdCodec:()=>BlockIvKeyIdCodec,keyedCryptoFactory:()=>keyedCryptoFactory});var generateIV={random:{calc:async(e,t,r)=>t.randomBytes(e.ivLength),verify:async(e,t,r,n)=>!0},hash:{calc:async(e,t,r)=>{const n=await sha256.digest(r),i=new Uint8Array(n.bytes),o=new Uint8Array(e.ivLength);for(let s=0;s<i.length;s++)o[s%e.ivLength]^=i[s];return o},verify:async function(e,t,r,n){return"disable"!==e.url.getParam("ivverify")&&UInt8ArrayEqual(r,await this.calc(e,t,n))}}};function getGenerateIVFn(e,t){const r=t.ivCalc||e.getParam("ivhash")||"hash";return generateIV[r]||generateIV.hash}var BlockIvKeyIdCodec=class{constructor(e,t,r){this.code=3147065,this.name="Fireproof@encrypted-block:aes-gcm",this.ko=e,this.iv=t,this.opts=r||{}}async encode(e){const t=this.iv||await getGenerateIVFn(this.ko.url,this.opts).calc(this.ko,this.ko.crypto,e),{iv:r}=this.ko.algo(t),n=await this.ko.fingerPrint(),i=base58btc.decode(n);return this.ko.logger.Debug().Str("fp",n).Msg("encode"),encode$a({iv:r,keyId:i,data:await this.ko._encrypt({iv:r,bytes:e})})}async decode(e){var t;let r;r=e instanceof Uint8Array?e:new Uint8Array(e);const{iv:n,keyId:i,data:o}=decode$a(r),s=await this.ko.fingerPrint();if(this.ko.logger.Debug().Str("fp",base58btc.encode(i)).Msg("decode"),base58btc.encode(i)!==s)throw this.ko.logger.Error().Str("fp",s).Str("keyId",base58btc.encode(i)).Msg("keyId mismatch").AsError();const a=await this.ko._decrypt({iv:n,bytes:o});if(!(null==(t=this.opts)?void 0:t.noIVVerify)&&!(await getGenerateIVFn(this.ko.url,this.opts).verify(this.ko,this.ko.crypto,n,a)))throw this.ko.logger.Error().Msg("iv missmatch").AsError();return a}},keyedCrypto=class{constructor(e,t,r,n){this.ivLength=12,this.isEncrypting=!0,this.logger=ensureLogger(n,"keyedCrypto"),this.crypto=r,this.key=t,this.url=e}fingerPrint(){return Promise.resolve(this.key.fingerPrint)}codec(e,t){return new BlockIvKeyIdCodec(this,e,t)}algo(e){return{name:"AES-GCM",iv:e||this.crypto.randomBytes(this.ivLength),tagLength:128}}async _decrypt(e){return this.logger.Debug().Len(e.bytes,"bytes").Len(e.iv,"iv").Str("fp",this.key.fingerPrint).Msg("decrypting"),new Uint8Array(await this.crypto.decrypt(this.algo(e.iv),this.key.key,e.bytes))}async _encrypt(e){this.logger.Debug().Len(e.bytes).Str("fp",this.key.fingerPrint).Msg("encrypting");const t=this.algo(e.iv);return new Uint8Array(await this.crypto.encrypt(t,this.key.key,e.bytes))}},nullCodec=class{constructor(){this.code=0,this.name="Fireproof@unencrypted-block"}encode(e){return e}decode(e){return e}},noCrypto=class{constructor(e,t,r){this.ivLength=0,this.code=0,this.name="Fireproof@unencrypted-block",this.isEncrypting=!1,this._fingerPrint="noCrypto:"+Math.random(),this.logger=ensureLogger(r,"noCrypto"),this.crypto=t,this.url=e}fingerPrint(){return Promise.resolve(this._fingerPrint)}codec(e){return new nullCodec}algo(e){return{name:"noCrypto",iv:new Uint8Array,tagLength:0}}_decrypt(){throw this.logger.Error().Msg("noCrypto.decrypt not implemented").AsError()}_encrypt(){throw this.logger.Error().Msg("noCrypto.decrypt not implemented").AsError()}};async function keyedCryptoFactory(e,t,r){const n=e.getParam("storekey");if(n&&"insecure"!==n){let o=await t.getNamedKey(n,!0);if(o.isErr())try{o=await t.toKeyWithFingerPrint(n)}catch(i){throw r.logger.Error().Err(i).Str("keybag",t.rt.id()).Str("name",n).Msg("getNamedKey failed").AsError()}return new keyedCrypto(e,o.Ok(),t.rt.crypto,r)}return new noCrypto(e,t.rt.crypto,r)}function getFragSize(e){const t=e.getParam("fragSize");let r=0;return t&&(r=parseInt(t)),(isNaN(r)||r<=0)&&(r=0),r}async function getFrags(e,t,r,n){if(!getFragSize(e)){const r=await t.get(e);if(r.isErr())return[r];const n=r.unwrap();return[Result.Ok({fid:new Uint8Array(0),ofs:0,len:n.length,data:n})]}const i=await t.get(e.build().setParam("ofs","0").URI());if(i.isErr())return[i];const o=decode$a(i.unwrap()),s=o.data.length,a=[Promise.resolve(Result.Ok(o))],l=base58btc.encode(o.fid),c=e.build().setParam("fid",l).setParam("len",o.len.toString()).setParam("headerSize",r.toString());for(let u=s;u<o.len;u+=s)a.push((async(e,r)=>{const i=await t.get(e);if(i.isErr())return i;const o=decode$a(i.unwrap());return base58btc.encode(o.fid)!==l?Result.Err(n.Error().Msg("Fragment fid mismatch").AsError()):o.ofs!==r?Result.Err(n.Error().Uint64("ofs",r).Msg("Fragment ofs mismatch").AsError()):Result.Ok(o)})(c.setParam("ofs",u.toString()).URI(),u));return Promise.all(a)}var FragmentGateway=class{constructor(e,t){this.fidLength=4,this.headerSize=32,this.sthis=ensureSuperLog(e,"FragmentGateway"),this.logger=this.sthis.logger,this.innerGW=t}slicer(e,t){const r=getFragSize(e);if(!r)return[this.innerGW.put(e,t)];const n=r-this.headerSize;if(n<=0)throw this.logger.Error().Uint64("fragSize",r).Uint64("headerSize",this.headerSize).Msg("Fragment size is too small").AsError();const i=[],o=this.sthis.nextId(this.fidLength),s=e.build().setParam("fid",o.str).setParam("len",t.length.toString()).setParam("headerSize",this.headerSize.toString());for(let a=0;a<t.length;a+=n){const e=encode$a({fid:o.bin,ofs:a,len:t.length,data:t.slice(a,a+n)});if(e.length>r)throw this.logger.Error().Uint64("block",e.length).Uint64("fragSize",r).Msg("Block size to big").AsError();i.push(this.innerGW.put(s.setParam("ofs",a.toString()).URI(),e))}return i}buildUrl(e,t){return this.innerGW.buildUrl(e,t)}async destroy(e){return this.innerGW.destroy(e)}async start(e){return this.headerSize=encode$a({fid:this.sthis.nextId(this.fidLength).bin,ofs:1048576,len:16777216,data:new Uint8Array(1024)}).length-1024,this.innerGW.start(e)}async close(e){return this.innerGW.close(e)}async put(e,t){return await Promise.all(this.slicer(e,t)),Result.Ok(void 0)}async get(e){const t=await getFrags(e,this.innerGW,this.headerSize,this.logger);let r;for(const n of t){if(n.isErr())return Result.Err(n.Err());const e=n.Ok();r=r||new Uint8Array(e.len),r.set(e.data,e.ofs)}return Result.Ok(r||new Uint8Array(0))}async subscribe(e,t){return this.innerGW.subscribe?this.innerGW.subscribe(e,t):Result.Err(this.logger.Error().Url(e).Msg("subscribe not supported").AsError())}async delete(e){const t=await getFrags(e,this.innerGW,this.headerSize,this.logger);for(const r of t){if(r.isErr())return Result.Err(r.Err());const t=r.Ok(),n=base58btc.encode(t.fid),i=e.build().setParam("fid",n).setParam("len",t.len.toString()).setParam("headerSize",this.headerSize.toString()).URI();await this.innerGW.delete(i)}return Result.Ok(void 0)}};async function decodeGatewayMetaBytesToDbMeta(e,t){const r=JSON.parse(e.txt.decode(t));if(!Array.isArray(r))return e.logger.Debug().Str("crdtEntries",JSON.stringify(r)).Msg("No data in CRDT entries"),[];if(!r.length)return e.logger.Debug().Any("byteHeads",t).Msg("No CRDT entries found"),[];const n=ensureLogger(e,"decodeGatewayMetaBytesToDbMeta");return Promise.all(r.map(async t=>{const r=await decodeEventBlock(base64pad.decode(t.data)),i=parse(e.txt.decode(r.value.data.dbMeta));return n.Debug().Any("crdtEntry",{crdtEntry:t,eventBlock:r,dbMeta:i,dbMetaStrings:i.cars.map(e=>e.toString())}).Msg("CRDT entry"),{eventCid:r.cid,parents:t.parents,dbMeta:i}}))}async function setCryptoKeyFromGatewayMetaPayload(e,t,r){try{t.logger.Debug().Str("uri",e.toString()).Msg("Setting crypto key from gateway meta payload");const n=await decodeGatewayMetaBytesToDbMeta(t,r);if(n.length){const r=n[0].dbMeta;if(r.key){const n=await getKeyBag(t),i=getStoreKeyName(e),o=await n.setNamedKey(i,r.key);if(o.isErr())throw t.logger.Debug().Str("keyName",i).Str("dbMeta.key",r.key).Msg("Failed to set named key"),o.Err()}return t.logger.Debug().Str("dbMeta.key",r.key).Str("uri",e.toString()).Msg("Set crypto key from gateway meta payload"),Result.Ok(r)}return t.logger.Debug().Any("data",r).Msg("No crypto in gateway meta payload"),Result.Ok(void 0)}catch(n){return t.logger.Debug().Err(n).Msg("Failed to set crypto key from gateway meta payload"),Result.Err(n)}}async function addCryptoKeyToGatewayMetaPayload(e,t,r){try{t.logger.Debug().Str("uri",e.toString()).Msg("Adding crypto key to gateway meta payload");const n=getStoreKeyName(e),i=await getKeyBag(t),o=await i.getNamedExtractableKey(n,!0);if(o.isErr())throw t.logger.Error().Str("keyName",n).Msg("Failed to get named extractable key"),o.Err();const s=await o.Ok().extract(),a=await decodeGatewayMetaBytesToDbMeta(t,r),{dbMeta:l,parents:c}=a[0],u=c.map(e=>CID.parse(e));l.key=s.keyStr;const d=await Promise.all([l].map(e=>createDbMetaEventBlock(t,e,u))),h=await encodeEventsWithParents(t,d,u);return t.logger.Debug().Str("uri",e.toString()).Msg("Added crypto key to gateway meta payload"),Result.Ok(h)}catch(n){return t.logger.Error().Err(n).Msg("Failed to add crypto key to gateway meta payload"),Result.Err(n)}}function getStoreKeyName(e){const t=[e.getParam("localName")||e.getParam("name")],r=e.getParam("index");return r&&t.push(r),t.push("data"),`@${t.join(":")}@`}async function createDbMetaEventBlock(e,t,r){return await EventBlock.create({dbMeta:e.txt.encode(format(t))},r)}async function encodeEventsWithParents(e,t,r){const n=t.map(e=>{const t=base64pad.encode(e.bytes);return{cid:e.cid.toString(),data:t,parents:r.map(e=>e.toString())}});return e.txt.encode(JSON.stringify(n))}function guardVersion(e){return e.hasParam("version")?Result.Ok(e):Result.Err(`missing version: ${e.toString()}`)}var BaseStoreImpl=class{constructor(e,t,r,n,i){this._onStarted=[],this._onClosed=[],this.name=e,this._url=t,this.keybag=r.keybag,this.sthis=n,this.logger=i.With().Ref("url",()=>this._url.toString()).Str("name",e).Logger(),this.gateway=new FragmentGateway(this.sthis,r.gateway),this.loader=r.loader}url(){return this._url}onStarted(e){this._onStarted.push(e)}onClosed(e){this._onClosed.push(e)}async ready(){}async keyedCrypto(){return keyedCryptoFactory(this._url,await this.keybag(),this.sthis)}async start(){this.logger.Debug().Str("storeType",this.storeType).Msg("starting-gateway-pre"),this._url=this._url.build().setParam("store",this.storeType).URI();const e=await this.gateway.start(this._url);if(e.isErr())return this.logger.Error().Result("gw-start",e).Msg("started-gateway"),e;this._url=e.Ok();const t=await this.keybag(),r=await t.ensureKeyFromUrl(this._url,()=>{const e=this._url.getParam("index"),t=[this.name];return e&&t.push(e),t.push(this.storeType),t.join(":")});if(r.isErr())return r;this._url=r.Ok();const n=guardVersion(this._url);if(n.isErr())return this.logger.Error().Result("version",n).Msg("guardVersion"),await this.close(),n;if(this.ready){const e=this.ready.bind(this),t=await exception2Result(e);if(t.isErr())return await this.close(),t}return this._onStarted.forEach(e=>e()),this.logger.Debug().Msg("started"),n}},MetaStoreImpl=class extends BaseStoreImpl{constructor(e,t,r,n){super(t,r,{...n},e,ensureLogger(e,"MetaStoreImpl")),this.storeType="meta",this.subscribers=new Map,this.parents=[],n.gateway.subscribe&&this.onStarted(async()=>{var e,t;this.logger.Debug().Str("url",this.url().toString()).Msg("Subscribing to the gateway"),null==(t=(e=n.gateway).subscribe)||t.call(e,this.url(),async e=>{this.logger.Debug().Msg("Received message from gateway");const t=await decodeGatewayMetaBytesToDbMeta(this.sthis,e);await Promise.all(t.map(e=>{var t,r;return null==(r=null==(t=this.loader)?void 0:t.taskManager)?void 0:r.handleEvent(e.eventCid,e.parents,e.dbMeta)})),this.updateParentsFromDbMetas(t)})})}updateParentsFromDbMetas(e){const t=e.map(e=>e.eventCid),r=e.flatMap(e=>e.parents),n=new Map([...this.parents,...t].map(e=>[e.toString(),e])),i=new Set(r.map(e=>e.toString()));this.parents=Array.from(n.values()).filter(e=>!i.has(e.toString()))}async handleByteHeads(e){return await decodeGatewayMetaBytesToDbMeta(this.sthis,e)}async load(){var e;const t="main",r=await this.gateway.buildUrl(this.url(),t);if(r.isErr())throw this.logger.Error().Result("buildUrl",r).Str("branch",t).Msg("got error from gateway.buildUrl").AsError();const n=await this.gateway.get(r.Ok());if(n.isErr()){if(isNotFoundError(n))return;throw this.logger.Error().Url(r.Ok()).Result("bytes:",n).Msg("gateway get").AsError()}const i=await this.handleByteHeads(n.Ok());return await(null==(e=this.loader)?void 0:e.handleDbMetasFromStore(i.map(e=>e.dbMeta))),this.updateParentsFromDbMetas(i),i.map(e=>e.dbMeta)}async save(e,t){t=t||"main",this.logger.Debug().Str("branch",t).Any("meta",e).Msg("saving meta");const r=await createDbMetaEventBlock(this.sthis,e,this.parents),n=await encodeEventsWithParents(this.sthis,[r],this.parents),i=await this.gateway.buildUrl(this.url(),t);if(i.isErr())throw this.logger.Error().Err(i.Err()).Str("branch",t).Msg("got error from gateway.buildUrl").AsError();this.parents=[r.cid];const o=await this.gateway.put(i.Ok(),n);if(o.isErr())throw this.logger.Error().Err(o.Err()).Msg("got error from gateway.put").AsError();return o}async close(){return await this.gateway.close(this.url()),this._onClosed.forEach(e=>e()),Result.Ok(void 0)}async destroy(){return this.gateway.destroy(this.url())}},DataStoreImpl=class extends BaseStoreImpl{constructor(e,t,r,n){super(t,r,{...n},e,ensureLogger(e,"DataStoreImpl")),this.storeType="data"}async load(e){this.logger.Debug().Any("cid",e).Msg("loading");const t=await this.gateway.buildUrl(this.url(),e.toString());if(t.isErr())throw this.logger.Error().Err(t.Err()).Str("cid",e.toString()).Msg("got error from gateway.buildUrl").AsError();const r=await this.gateway.get(t.Ok());if(r.isErr())throw r.Err();return{cid:e,bytes:r.Ok()}}async save(e,t){this.logger.Debug().Any("cid",e.cid.toString()).Msg("saving");const r=await this.gateway.buildUrl(this.url(),e.cid.toString());if(r.isErr())throw this.logger.Error().Err(r.Err()).Ref("cid",e.cid).Msg("got error from gateway.buildUrl").AsError();const n=await this.gateway.put(r.Ok(),e.bytes);if(n.isErr())throw this.logger.Error().Err(n.Err()).Msg("got error from gateway.put").AsError();return n.Ok()}async remove(e){const t=await this.gateway.buildUrl(this.url(),e.toString());return t.isErr()?t:this.gateway.delete(t.Ok())}async close(){return await this.gateway.close(this.url()),this._onClosed.forEach(e=>e()),Result.Ok(void 0)}destroy(){return this.gateway.destroy(this.url())}},WALStoreImpl=class extends BaseStoreImpl{constructor(e,t,r){super(e.name,t,{...r},e.sthis,ensureLogger(e.sthis,"WALStoreImpl")),this.storeType="wal",this._ready=new ResolveOnce,this.walState={operations:[],noLoaderOps:[],fileOperations:[]},this.processing=void 0,this.processQueue=new CommitQueue,this.loader=e}async ready(){return this._ready.once(async()=>{const e=await this.load().catch(e=>{this.logger.Error().Any("error",e).Msg("error loading wal")});e?(this.walState.operations=e.operations||[],this.walState.fileOperations=e.fileOperations||[]):(this.walState.operations=[],this.walState.fileOperations=[])})}async enqueue(e,t){await this.ready(),t.compact?(this.walState.operations=[],this.walState.noLoaderOps=[e]):t.noLoader?this.walState.noLoaderOps.push(e):this.walState.operations.push(e),await this.save(this.walState),t.noLoader||this.process()}async enqueueFile(e,t=!1){await this.ready(),this.walState.fileOperations.push({cid:e,public:t})}async process(){await this.ready(),this.loader.remoteCarStore&&await this.processQueue.enqueue(async()=>{try{await this._doProcess()}catch(e){this.logger.Error().Any("error",e).Msg("error processing wal")}(this.walState.operations.length||this.walState.fileOperations.length||this.walState.noLoaderOps.length)&&setTimeout(()=>{this.process()},0)})}async _doProcess(){if(!this.loader.remoteCarStore)return;const e=[...this.walState.operations],t=[...this.walState.noLoaderOps],r=[...this.walState.fileOperations];if(e.length+t.length+r.length===0)return;const n=(e,t)=>pRetry(e,{retries:5,onFailedAttempt:e=>{this.logger.Warn().Msg(`Attempt ${e.attemptNumber} failed for ${t}. There are ${e.retriesLeft} retries left.`)}});try{if(await pMap(t,async e=>{await n(async()=>{for(const t of e.cars){const r=await(await this.loader.carStore()).load(t);if(r)await throwFalsy(this.loader.remoteCarStore).save(r);else if(carLogIncludesGroup(this.loader.carLog,e.cars))throw this.logger.Error().Ref("cid",t).Msg("missing local car").AsError()}this.walState.noLoaderOps=this.walState.noLoaderOps.filter(t=>t!==e)},`noLoaderOp with dbMeta.cars=${e.cars.toString()}`)},{concurrency:3}),await pMap(e,async e=>{await n(async()=>{for(const t of e.cars){const r=await(await this.loader.carStore()).load(t);if(r)await throwFalsy(this.loader.remoteCarStore).save(r);else if(carLogIncludesGroup(this.loader.carLog,e.cars))throw this.logger.Error().Ref("cid",t).Msg("missing local car").AsError()}this.walState.operations=this.walState.operations.filter(t=>t!==e)},`operation with dbMeta.cars=${e.cars.toString()}`)},{concurrency:3}),await pMap(r,async({cid:e,public:t})=>{await n(async()=>{var r;const n=await(await this.loader.fileStore()).load(e);if(!n)throw this.logger.Error().Ref("cid",e).Msg("missing file block").AsError();await(null==(r=this.loader.remoteFileStore)?void 0:r.save(n,{public:t})),this.walState.fileOperations=this.walState.fileOperations.filter(t=>t.cid!==e)},`fileOperation with cid=${e.toString()}`)},{concurrency:3}),e.length){const t=e[e.length-1];await n(async()=>{var e;await(null==(e=this.loader.remoteMetaStore)?void 0:e.save(t))},`remoteMetaStore save with dbMeta.cars=${t.cars.toString()}`)}}catch(i){return void this.logger.Error().Any("error",i).Msg("Processing failed")}finally{await this.save(this.walState)}}async load(){this.logger.Debug().Msg("loading");const e=await this.gateway.buildUrl(this.url(),"main");if(e.isErr())throw this.logger.Error().Err(e.Err()).Url(this.url()).Msg("error building url").AsError();const t=await this.gateway.get(e.Ok());if(t.isErr()){if(isNotFoundError(t))return;throw this.logger.Error().Err(t.Err()).Msg("error get").AsError()}try{return t&&parse(this.sthis.txt.decode(t.Ok()))}catch(r){throw this.logger.Error().Err(r).Msg("error parse").AsError()}}async save(e){const t=await this.gateway.buildUrl(this.url(),"main");if(t.isErr())throw this.logger.Error().Err(t.Err()).Url(this.url()).Msg("error building url").AsError();let r;try{r=format(e)}catch(i){throw this.logger.Error().Err(i).Any("state",e).Msg("error format").AsError()}const n=await this.gateway.put(t.Ok(),this.sthis.txt.encode(r));if(n.isErr())throw this.logger.Error().Err(n.Err()).Str("filePath",t.Ok().toString()).Msg("error saving").AsError()}async close(){return await this.gateway.close(this.url()),this._onClosed.forEach(e=>e()),Result.Ok(void 0)}destroy(){return this.gateway.destroy(this.url())}};function ensureIsIndex(e,t){return t?e.build().setParam("index",t).URI():e.build().delParam("index").URI()}function ensureName(e,t){return t.hasParam("name")?t:t.build().setParam("name",e).URI()}var storeFactory=new Map;function buildURL(e,t){var r;const n=t.ebOpts.store,i=Array.from(storeFactory.values()).find(e=>e.overrideBaseURL);let o;i&&i.overrideBaseURL&&(o=URI.from(i.overrideBaseURL));return ensureIsIndex(URI.from(e||o||dataDir(t.sthis,t.name,null==(r=n.stores)?void 0:r.base)),n.isIndex)}var onceGateway=new KeyedResolvOnce;async function getGatewayFromURL(e,t){return onceGateway.get(e.toString()).once(async()=>{const r=storeFactory.get(e.protocol);if(r){const n={gateway:await r.gateway(t),test:await r.test(t)},i=await n.gateway.start(e);return i.isErr()?void t.logger.Error().Result("start",i).Msg("start failed"):n}t.logger.Warn().Url(e).Msg("unsupported protocol")})}function registerStoreProtocol(e){let t=e.protocol;if(t.endsWith(":")||(t+=":"),storeFactory.has(t)&&!e.overrideBaseURL&&storeFactory.get(t)!==e)throw new Error("we need a logger here");return e.overrideBaseURL&&Array.from(storeFactory.values()).forEach(e=>{e.overrideBaseURL=void 0}),storeFactory.set(t,e),()=>{storeFactory.delete(t)}}var onceDataStoreFactory=new KeyedResolvOnce;async function dataStoreFactory(e){var t;const r=ensureName(e.name,buildURL(null==(t=e.ebOpts.store.stores)?void 0:t.data,e)).build().setParam("store","data").URI(),n=ensureSuperLog(e.sthis,"dataStoreFactory",{url:r.toString()});return onceDataStoreFactory.get(r.toString()).once(async()=>{const t=await getGatewayFromURL(r,n);if(!t)throw n.logger.Error().Url(r).Msg("gateway not found").AsError();return new DataStoreImpl(n,e.name,r,{gateway:t.gateway,keybag:()=>getKeyBag(e.sthis,{...e.ebOpts.keyBag})})})}var onceMetaStoreFactory=new KeyedResolvOnce;async function metaStoreFactory(e){var t;const r=ensureName(e.name,buildURL(null==(t=e.ebOpts.store.stores)?void 0:t.meta,e)).build().setParam("store","meta").URI(),n=ensureSuperLog(e.sthis,"metaStoreFactory",{url:()=>r.toString()});return onceMetaStoreFactory.get(r.toString()).once(async()=>{n.logger.Debug().Str("protocol",r.protocol).Msg("pre-protocol switch");const t=await getGatewayFromURL(r,n);if(!t)throw n.logger.Error().Url(r).Msg("gateway not found").AsError();return new MetaStoreImpl(e.sthis,e.name,r,{gateway:t.gateway,keybag:()=>getKeyBag(e.sthis,{...e.ebOpts.keyBag})})})}var onceRemoteWalFactory=new KeyedResolvOnce;async function remoteWalFactory(e){var t;const r=ensureName(e.name,buildURL(null==(t=e.ebOpts.store.stores)?void 0:t.wal,e)).build().setParam("store","wal").URI(),n=ensureSuperLog(e.sthis,"remoteWalFactory",{url:r.toString()});return onceRemoteWalFactory.get(r.toString()).once(async()=>{const t=await getGatewayFromURL(r,n);if(!t)throw n.logger.Error().Url(r).Msg("gateway not found").AsError();n.logger.Debug().Str("prepared",r.toString()).Msg("produced");return new WALStoreImpl(e,r,{gateway:t.gateway,keybag:()=>getKeyBag(e.sthis,{...e.ebOpts.keyBag})})})}async function testStoreFactory(e,t){t=ensureSuperLog(t,"testStoreFactory");const r=await getGatewayFromURL(e,t);if(!r)throw t.logger.Error().Url(e).Msg("gateway not found").AsError();return r.test}async function ensureStart(e,t){const r=await e.start();if(r.isErr())throw t.Error().Result("start",r).Msg("start failed").AsError();return t.Debug().Url(r.Ok(),"prepared").Msg("produced"),e}function toStoreRuntime(e,t){const r=ensureLogger(t,"toStoreRuntime",{});return{makeMetaStore:async e=>(r.Debug().Str("fromOpts",""+!!e.ebOpts.store.makeMetaStore).Msg("makeMetaStore"),ensureStart(await(e.ebOpts.store.makeMetaStore||metaStoreFactory)(e),r)),makeDataStore:async e=>(r.Debug().Str("fromOpts",""+!!e.ebOpts.store.makeDataStore).Msg("makeDataStore"),ensureStart(await(e.ebOpts.store.makeDataStore||dataStoreFactory)(e),r)),makeWALStore:async e=>(r.Debug().Str("fromOpts",""+!!e.ebOpts.store.makeWALStore).Msg("makeRemoteWAL"),ensureStart(await(e.ebOpts.store.makeWALStore||remoteWalFactory)(e),r)),encodeFile:e.encodeFile||encodeFile,decodeFile:e.decodeFile||decodeFile}}async function RemoteDataStore(e,t,r,n){const i=new DataStoreImpl(e,t,r,n);return await i.start(),i}async function RemoteMetaStore(e,t,r,n){const i=new MetaStoreImpl(e,t,r,n);return await i.start(),i}(runtimeFn().isNodeIsh||runtimeFn().isDeno)&&registerStoreProtocol({protocol:"file:",gateway:async e=>{const{GatewayImpl:t}=await __vitePreload(()=>import("./index-984bab00.js"),[]);return new t(e)},test:async e=>{const{GatewayTestImpl:t}=await __vitePreload(()=>import("./index-984bab00.js"),[]);return new t(e)}}),runtimeFn().isBrowser&&registerStoreProtocol({protocol:"indexdb:",gateway:async e=>{const{GatewayImpl:t}=await __vitePreload(()=>import("./index-984bab00.js"),[]);return new t(e)},test:async e=>{const{GatewayTestImpl:t}=await __vitePreload(()=>import("./index-984bab00.js"),[]);return new t(e)}});var ConnectionBase=class{constructor(e,t){this.loaded=Promise.resolve(),this.logger=t,this.url=e}async refresh(){await throwFalsy(throwFalsy(this.loader).remoteMetaStore).load(),await(await throwFalsy(this.loader).WALStore()).process()}async connect_X({loader:e}){if(!e)throw this.logger.Error().Msg("loader is required").AsError();await this.connectMeta_X({loader:e}),await this.connectStorage_X({loader:e})}async connectMeta_X({loader:e}){if(!e)throw this.logger.Error().Msg("connectMeta_X: loader is required").AsError();this.loader=e,await this.onConnect();const t=this.url.build().defParam("store","meta").URI(),r=await getGatewayFromURL(t,this.loader.sthis);if(!r)throw this.logger.Error().Url(t).Msg("connectMeta_X: gateway is required").AsError();const n=t.getParam("name");if(!n)throw this.logger.Error().Url(t).Msg("connectMeta_X: name is required").AsError();const i=await RemoteMetaStore(e.sthis,n,t,{gateway:r.gateway,keybag:()=>getKeyBag(e.sthis,e.ebOpts.keyBag),loader:e});this.loader.remoteMetaStore=i,this.loaded=this.loader.ready().then(async()=>i.load().then(async()=>(await throwFalsy(this.loader).WALStore()).process()))}async connectStorage_X({loader:e}){if(!e)throw this.logger.Error().Msg("connectStorage_X: loader is required").AsError();this.loader=e;const t=this.url.build().defParam("store","data").URI(),r=await getGatewayFromURL(t,this.loader.sthis);if(!r)throw this.logger.Error().Url(t).Msg("connectStorage_X: gateway is required").AsError();const n=t.getParam("name");if(!n)throw this.logger.Error().Url(t).Msg("connectStorage_X: name is required").AsError;e.remoteCarStore=await RemoteDataStore(e.sthis,n,this.url,{gateway:r.gateway,keybag:()=>{var t;return getKeyBag(e.sthis,null==(t=this.loader)?void 0:t.ebOpts.keyBag)}}),e.remoteFileStore=e.remoteCarStore}};function toString(e,t){switch(typeof e){case"string":case"number":return e.toString();default:throw t.Error().Msg("Invalid key type").AsError()}}function sanitizeDocumentFields(e){if(Array.isArray(e))return e.map(e=>"object"==typeof e&&null!==e?sanitizeDocumentFields(e):e);if("object"==typeof e&&null!==e){if(e instanceof Date)return e.toISOString();const t=e,r={};for(const e in t)if(Object.hasOwnProperty.call(t,e)){const n=t[e];if(null===n||!Number.isNaN(n)&&void 0!==n)if("object"!=typeof n||e.startsWith("_"))r[e]=n;else if(n instanceof Date)r[e]=n.toISOString();else{const t=sanitizeDocumentFields(n);r[e]=t}}return r}return e}async function applyBulkUpdateToCrdt(e,t,r,n,i){let o=null;if(n.length>1){const s=await create$8(t,r);for(const r of n){const n=await writeDocContent(e,t,r,i);await s.put(toString(r.id,i),n)}o=await s.commit()}else if(1===n.length){const s=await writeDocContent(e,t,n[0],i);o=await put(t,r,toString(n[0].id,i),s)}if(!o)throw i.Error().Uint64("updates.len",n.length).Msg("Missing result").AsError();if(o.event)for(const{cid:s,bytes:a}of[...o.additions,o.event])t.putSync(s,a);return{head:o.head}}async function writeDocContent(e,t,r,n){let i;if(r.del)i={del:!0};else{if(!r.value)throw n.Error().Msg("Missing value").AsError();await processFiles(e,t,r.value,n),i={doc:r.value}}const o=await encode({value:i,hasher:sha256,codec:codec2});return t.putSync(o.cid,o.bytes),o.cid}async function processFiles(e,t,r,n){r._files&&await processFileset(n,e,t,r._files),r._publicFiles&&await processFileset(n,e,t,r._publicFiles)}async function processFileset(e,t,r,n){const i=r.parent;if(!i.loader)throw e.Error().Msg("Missing loader, database name is required").AsError();const o=new CarTransaction(i),s=[];for(const a in n)if(File===n[a].constructor){const e=n[a],{cid:r,blocks:i}=await t.encodeFile(e);s.push(a);for(const t of i)o.putSync(t.cid,t.bytes);n[a]={cid:r,type:e.type,size:e.size}}else{const{cid:e,type:t,size:r,car:i}=n[a];e&&t&&r&&i&&(n[a]={cid:e,type:t,size:r,car:i})}if(s.length){const e=await i.loader.commitFiles(o,{files:n});if(e)for(const t of s)n[t]={car:e,...n[t]}}}async function getValueFromCrdt(e,t,r,n){if(!t.length)throw n.Debug().Msg("Getting from an empty database").AsError();const i=await get$1(e,t,r);if(!i)throw n.Error().Str("key",r).Msg("Missing key").AsError();return await getValueFromLink(e,i,n)}function readFiles(e,{doc:t}){t&&(t._files&&readFileset(e,t._files),t._publicFiles&&readFileset(e,t._publicFiles,!0))}function readFileset(e,t,r=!1){for(const n in t){const i=t[n];i.cid&&(r&&(i.url=`https://${i.cid.toString()}.ipfs.w3s.link/`),i.car&&(i.file=async()=>await e.ebOpts.storeRuntime.decodeFile({get:async t=>await e.getFile(throwFalsy(i.car),t)},i.cid,i))),t[n]=i}}async function getValueFromLink(e,t,r){const n=await e.get(t);if(!n)throw r.Error().Str("link",t.toString()).Msg("Missing linked block").AsError();const{value:i}=await decode({bytes:n.bytes,hasher:sha256,codec:codec2}),o={...i,cid:t};return readFiles(e,o),o}var DirtyEventFetcher=class extends EventFetcher{constructor(e,t){super(t),this.logger=e}async get(e){try{return super.get(e)}catch(t){return this.logger.Error().Ref("link",e.toString()).Err(t).Msg("Missing event"),{value:void 0}}}};async function clockChangesSince(e,t,r,n,i){const o=n.dirty?new DirtyEventFetcher(i,e):new EventFetcher(e),s=new Set;return{result:(await gatherUpdates(e,o,t,r,[],s,new Set,n.limit||1/0,i)).reverse(),head:t}}async function gatherUpdates(e,t,r,n,i=[],o,s,a,l){if(a<=0)return i;const c=r.map(e=>e.toString());for(const u of n)if(c.includes(u.toString()))return i;for(const u of r){if(s.has(u.toString()))continue;s.add(u.toString());const{value:r}=await t.get(u);if(!r)continue;const{type:c}=r.data;let d=[];"batch"===c?d=r.data.ops:"put"===c&&(d=[r.data]);for(let t=d.length-1;t>=0;t--){const{key:r,value:n}=d[t];if(!o.has(r)){const t=await getValueFromLink(e,n,l);i.push({id:r,value:t.doc,del:t.del,clock:u}),a--,o.add(r)}}r.parents&&(i=await gatherUpdates(e,t,r.parents,n,i,o,s,a,l))}return i}async function*getAllEntries(e,t,r){for await(const[n,i]of entries(e,t)){const t=await getValueFromLink(e,i,r);yield{id:n,value:t.doc,del:t.del}}}async function*clockVis(e,t){for await(const r of vis(e,t))yield r}var isCompacting=!1;async function doCompact(e,t,r){if(isCompacting)return;isCompacting=!0;for(const i of t){if(!(await e.get(i)))throw r.Error().Ref("cid",i).Msg("Missing head block").AsError()}for await(const i of getAllEntries(e,t,r));for await(const i of vis(e,t));const n=await root(e,t);for(const{cid:i,bytes:o}of[...n.additions,...n.removals])e.loggedBlocks.putSync(i,o);await clockChangesSince(e,t,[],{},r),isCompacting=!1}async function getBlock(e,t){const r=await e.get(parse$1(t));if(!r)throw new Error(`Missing block ${t}`);const{cid:n,value:i}=await decode({bytes:r.bytes,codec:codec2,hasher:sha256});return new Block({cid:n,value:i,bytes:r.bytes})}var IndexTree=class{};function refCompare(e,t){if(Number.isNaN(e))return-1;if(Number.isNaN(t))throw new Error("ref may not be Infinity or NaN");return e===1/0?1:simpleCompare(e,t)}function compare(e,t){const[r,n]=e,[i,o]=t,s=simpleCompare(r,i);return 0!==s?s:refCompare(n,o)}var byKeyOpts={cache:nocache,chunker:bf(30),codec:codec2,hasher:sha256,compare:compare},byIdOpts={cache:nocache,chunker:bf(30),codec:codec2,hasher:sha256,compare:simpleCompare};function indexEntriesForChanges(e,t){const r=[];return e.forEach(({id:e,value:n,del:i})=>{if(i||!n)return;let o=!1;const s=t({...n,_id:e},(t,n)=>{o=!0,void 0!==t&&r.push({key:[charwise.encode(t),e],value:n||null})});!o&&s&&r.push({key:[charwise.encode(s),e],value:null})}),r}function makeProllyGetBlock(e){return async t=>{const r=await e.get(t);if(!r)throw new Error(`Missing block ${t.toString()}`);const{cid:n,bytes:i}=r;return create({cid:n,bytes:i,hasher:sha256,codec:codec2})}}async function bulkIndex(e,t,r,n){if(!r.length)return t;if(!t.root){if(!t.cid){let t,i;for await(const o of await create$1({get:makeProllyGetBlock(e),list:r,...n})){const r=await o.block;await e.put(r.cid,r.bytes),t=r,i=o}if(!i||!t)throw new Error("failed to create index");return{root:i,cid:t.cid}}t.root=await load({cid:t.cid,get:makeProllyGetBlock(e),...n})}const{root:i,blocks:o}=await t.root.bulk(r);if(i){for await(const t of o)await e.put(t.cid,t.bytes);return{root:i,cid:(await i.block).cid}}return{root:void 0,cid:void 0}}async function loadIndex(e,t,r){return await load({cid:t,get:makeProllyGetBlock(e),...r})}async function applyQuery(e,t,r){return r.descending&&(t.result=t.result.reverse()),r.limit&&(t.result=t.result.slice(0,r.limit)),r.includeDocs&&(t.result=await Promise.all(t.result.map(async t=>{const r=await e.get(t.id),n=r?{...r.doc,_id:t.id}:void 0;return{...t,doc:n}}))),{rows:t.result.map(({key:e,...t})=>({key:charwise.decode(e),...t}))}}function encodeRange(e){return[charwise.encode(e[0]),charwise.encode(e[1])]}function encodeKey(e){return charwise.encode(e)}function index$1(e,{_crdt:t},r,n,i){if(n&&i)throw t.logger.Error().Msg("cannot provide both mapFn and meta").AsError();if(n&&"Function"!==n.constructor.name)throw t.logger.Error().Msg("mapFn must be a function").AsError();if(t.indexers.has(r)){t.indexers.get(r).applyMapFn(r,n,i)}else{const o=new Index(e,t,r,n,i);t.indexers.set(r,o)}return t.indexers.get(r)}var Index=class{constructor(e,t,r,n,i){if(this.mapFnString="",this.byKey=new IndexTree,this.byId=new IndexTree,this.includeDocsDefault=!1,this.logger=ensureLogger(e,"Index"),this.blockstore=t.indexBlockstore,this.crdt=t,this.applyMapFn(r,n,i),this.name=r,!this.mapFnString&&!this.initError)throw this.logger.Error().Msg("missing mapFnString").AsError()}ready(){return Promise.all([this.blockstore.ready(),this.crdt.ready()]).then(()=>{})}close(){return Promise.all([this.blockstore.close(),this.crdt.close()]).then(()=>{})}destroy(){return Promise.all([this.blockstore.destroy(),this.crdt.destroy()]).then(()=>{})}applyMapFn(e,t,r){if(t&&r)throw this.logger.Error().Msg("cannot provide both mapFn and meta").AsError();if(this.name&&this.name!==e)throw this.logger.Error().Msg("cannot change name").AsError();this.name=e;try{if(r){if(this.indexHead&&this.indexHead.map(e=>e.toString()).join()!==r.head.map(e=>e.toString()).join())throw this.logger.Error().Msg("cannot apply different head meta").AsError();this.mapFnString?this.mapFnString!==r.map?this.logger.Warn().Msg(`cannot apply different mapFn meta: old mapFnString ${this.mapFnString} new mapFnString ${r.map}`):(this.byId.cid=r.byId,this.byKey.cid=r.byKey,this.indexHead=r.head):(this.mapFnString=r.map,this.byId.cid=r.byId,this.byKey.cid=r.byKey,this.indexHead=r.head)}else this.mapFn?t&&this.mapFn.toString()!==t.toString()&&this.logger.Error().Msg("cannot apply different mapFn app2"):(t||(t=t=>t[e]??void 0),this.mapFnString?this.mapFnString!==t.toString()&&this.logger.Error().Str("mapFnString",this.mapFnString).Str("mapFn",t.toString()).Msg("cannot apply different mapFn app"):this.mapFnString=t.toString(),this.mapFn=t);const n=/=>\s*(.*)/.test(this.mapFnString);this.includeDocsDefault=n}catch(n){this.initError=n}}async query(e={}){if(await this.ready(),await this._updateIndex(),await this._hydrateIndex(),!this.byKey.root)return await applyQuery(this.crdt,{result:[]},e);if(this.includeDocsDefault&&void 0===e.includeDocs&&(e.includeDocs=!0),e.range){const t=encodeRange(e.range);return await applyQuery(this.crdt,await throwFalsy(this.byKey.root).range(t[0],t[1]),e)}if(e.key){const t=encodeKey(e.key);return await applyQuery(this.crdt,await throwFalsy(this.byKey.root).get(t),e)}if(Array.isArray(e.keys)){return{rows:(await Promise.all(e.keys.map(async t=>{const r=encodeKey(t);return(await applyQuery(this.crdt,await throwFalsy(this.byKey.root).get(r),e)).rows}))).flat()}}if(e.prefix){Array.isArray(e.prefix)||(e.prefix=[e.prefix]);const t=encodeRange([[...e.prefix,NaN],[...e.prefix,1/0]]);return await applyQuery(this.crdt,await this.byKey.root.range(...t),e)}const t=await this.byKey.root.getAllEntries();return await applyQuery(this.crdt,{result:t.result.map(({key:[e,t],value:r})=>({key:e,id:t,value:r}))},e)}_resetIndex(){this.byId=new IndexTree,this.byKey=new IndexTree,this.indexHead=void 0}async _hydrateIndex(){this.byId.root&&this.byKey.root||this.byId.cid&&this.byKey.cid&&(this.byId.root=await loadIndex(this.blockstore,this.byId.cid,byIdOpts),this.byKey.root=await loadIndex(this.blockstore,this.byKey.cid,byKeyOpts))}async _updateIndex(){var e;if(await this.ready(),this.initError)throw this.initError;if(!this.mapFn)throw this.logger.Error().Msg("No map function defined").AsError();let t,r;this.indexHead&&0!==this.indexHead.length?({result:t,head:r}=await this.crdt.changes(this.indexHead)):({result:t,head:r}=await this.crdt.allDocs()),0===t.length&&(this.indexHead=r);let n=[],i=[];if(this.byId.root){const e=t.map(({id:e})=>e),{result:r}=await this.byId.root.getMany(e);n=r.map(e=>({key:e,del:!0})),i=r.map(e=>({key:e[1],del:!0}))}const o=indexEntriesForChanges(t,this.mapFn),s=o.map(({key:e})=>({key:e[1],value:e})),a={indexes:new Map};for(const[c,u]of this.crdt.indexers)u.indexHead&&(null==(e=a.indexes)||e.set(c,{byId:u.byId.cid,byKey:u.byKey.cid,head:u.indexHead,map:u.mapFnString,name:u.name}));if(0===t.length)return a;const{meta:l}=await this.blockstore.transaction(async e=>{var t;if(this.byId=await bulkIndex(e,this.byId,i.concat(s),byIdOpts),this.byKey=await bulkIndex(e,this.byKey,n.concat(o),byKeyOpts),this.indexHead=r,this.byId.cid&&this.byKey.cid){const e={byId:this.byId.cid,byKey:this.byKey.cid,head:r,map:this.mapFnString,name:this.name};null==(t=a.indexes)||t.set(this.name,e)}return a});return l}};function applyHeadQueue(e,t){const r=[];let n=!1;async function*i(){if(n||0===r.length)return;n=!0;const o=[];try{for(;r.length>0;){r.sort((e,t)=>t.updates?1:-1);const n=r.shift();if(n&&(await e(n.newHead,n.prevHead,void 0!==n.updates).catch(e=>{throw t.Error().Err(e).Msg("int_applyHead worker error").AsError()}),n.updates&&o.push(...n.updates),!r.some(e=>e.updates)||n.updates)){const e=r.every(e=>null!==e.updates);yield{updates:o,all:e},o.length=0}}}finally{n=!1;const e=i();let t=await e.next();for(;!t.done;)t=await e.next()}}return{push:e=>(r.push(e),i()),size:()=>r.length}}var CRDTClock=class{constructor(e){this.head=[],this.zoomers=new Set,this.watchers=new Set,this.emptyWatchers=new Set,this._ready=new ResolveOnce,this.blockstore=e,this.logger=ensureLogger(e.sthis,"CRDTClock"),this.applyHeadQueue=applyHeadQueue(this.int_applyHead.bind(this),this.logger)}async ready(){return this._ready.once(async()=>{await this.blockstore.ready()})}async close(){await this.blockstore.close()}setHead(e){this.head=e}async applyHead(e,t,r){for await(const{updates:n,all:i}of this.applyHeadQueue.push({newHead:e,prevHead:t,updates:r}))return this.processUpdates(n,i,t)}async processUpdates(e,t,r){let n=e;if(this.watchers.size&&!t){n=(await clockChangesSince(throwFalsy(this.blockstore),this.head,r,{},this.logger)).result}this.zoomers.forEach(e=>e()),this.notifyWatchers(n||[])}notifyWatchers(e){this.emptyWatchers.forEach(e=>e()),this.watchers.forEach(t=>t(e||[]))}onTick(e){this.watchers.add(e)}onTock(e){this.emptyWatchers.add(e)}onZoom(e){this.zoomers.add(e)}async int_applyHead(e,t,r){const n=!r,i=sortClockHead(this.head);if(compareClockHeads(i,e=sortClockHead(e)))return;if(compareClockHeads(i,sortClockHead(t)))return void this.setHead(e);if(!this.blockstore)throw this.logger.Error().Msg("missing blockstore").AsError();await validateBlocks(this.logger,e,this.blockstore),this.transaction||(this.transaction=this.blockstore.openTransaction({noLoader:n,add:!1}));const o=this.transaction,s=await advanceBlocks(this.logger,e,o,this.head),a=await root(o,s);for(const{cid:l,bytes:c}of[...a.additions])o.putSync(l,c);n||(await this.blockstore.commitTransaction(o,{head:s},{add:!1,noLoader:n}),this.transaction=void 0),this.setHead(s)}};function sortClockHead(e){return e.sort((e,t)=>e.toString().localeCompare(t.toString()))}async function validateBlocks(e,t,r){if(!r)throw e.Error().Msg("missing blockstore");t.map(async t=>{if(!(await r.get(t)))throw e.Error().Str("cid",t.toString()).Msg("int_applyHead missing block").AsError()})}function compareClockHeads(e,t){return e.toString()===t.toString()}async function advanceBlocks(e,t,r,n){for(const o of t)try{n=await advance(r,n,o)}catch(i){e.Debug().Err(i).Msg("failed to advance head");continue}return n}var CRDT=class{constructor(e,t,r={}){var n;this.indexers=new Map,this.onceReady=new ResolveOnce,this.sthis=e,this.name=t,this.logger=ensureLogger(e,"CRDT"),this.opts=r,this.blockstore=blockstoreFactory(e,{name:t,applyMeta:async e=>{const t=e;if(!t.head)throw this.logger.Error().Msg("missing head").AsError();await this.clock.applyHead(t.head,[])},compact:async e=>(await doCompact(e,this.clock.head,this.logger),{head:this.clock.head}),autoCompact:this.opts.autoCompact||100,store:{...this.opts.store,isIndex:void 0},public:this.opts.public,meta:this.opts.meta,threshold:this.opts.threshold}),this.indexBlockstore=blockstoreFactory(e,{name:t,applyMeta:async e=>{const t=e;if(!t.indexes)throw this.logger.Error().Msg("missing indexes").AsError();for(const[r,n]of Object.entries(t.indexes))index$1(this.sthis,{_crdt:this},r,void 0,n)},store:{...this.opts.store,isIndex:(null==(n=this.opts.store)?void 0:n.isIndex)||"idx"},public:this.opts.public}),this.clock=new CRDTClock(this.blockstore),this.clock.onZoom(()=>{for(const e of this.indexers.values())e._resetIndex()})}async bulk(e){await this.ready();const t=[...this.clock.head];e=e.map(e=>({...e,value:sanitizeDocumentFields(e.value)}));const r=await this.blockstore.transaction(async t=>{const{head:r}=await applyBulkUpdateToCrdt(this.blockstore.ebOpts.storeRuntime,t,this.clock.head,e,this.logger);return e=e.map(e=>(readFiles(this.blockstore,{doc:e.value}),e)),{head:r}});return await this.clock.applyHead(r.meta.head,t,e),r.meta}async ready(){return this.onceReady.once(async()=>{try{await Promise.all([this.blockstore.ready(),this.indexBlockstore.ready(),this.clock.ready()])}catch(e){throw this.logger.Error().Err(e).Msg("CRDT is not ready").AsError()}})}async close(){await Promise.all([this.blockstore.close(),this.indexBlockstore.close(),this.clock.close()])}async destroy(){await Promise.all([this.blockstore.destroy(),this.indexBlockstore.destroy()])}async allDocs(){await this.ready();const e=[];for await(const t of getAllEntries(this.blockstore,this.clock.head,this.logger))e.push(t);return{result:e,head:this.clock.head}}async vis(){await this.ready();const e=[];for await(const t of clockVis(this.blockstore,this.clock.head))e.push(t);return e.join("\n")}async getBlock(e){return await this.ready(),await getBlock(this.blockstore,e)}async get(e){await this.ready();const t=await getValueFromCrdt(this.blockstore,this.clock.head,e,this.logger);if(!t.del)return t}async changes(e=[],t={}){return await this.ready(),await clockChangesSince(this.blockstore,this.clock.head,e,t,this.logger)}async compact(){const e=this.blockstore;return await e.compact()}},Database=(_e=class{constructor(e,t){this.opts={},this._listening=!1,this._listeners=new Set,this._noupdate_listeners=new Set,this._ready=new ResolveOnce,this.name=e,this.opts=t||this.opts,this.sthis=ensureSuperThis(this.opts),this.logger=ensureLogger(this.sthis,"Database"),this._crdt=new CRDT(this.sthis,e,this.opts),this.blockstore=this._crdt.blockstore,this._writeQueue=writeQueue(async e=>await this._crdt.bulk(e)),this._crdt.clock.onTock(()=>{this._no_update_notify()})}async close(){await this.ready(),await this._crdt.close(),await this.blockstore.close()}async destroy(){await this.ready(),await this._crdt.destroy(),await this.blockstore.destroy()}async ready(){return this._ready.once(async()=>{await this.sthis.start(),await this._crdt.ready(),await this.blockstore.ready()})}async get(e){if(!e)throw this.logger.Error().Str("db",this.name).Msg("Doc id is required").AsError();await this.ready(),this.logger.Debug().Str("id",e).Msg("get");const t=await this._crdt.get(e).catch(t=>{throw new NotFoundError(`Not found: ${e} - ${t.message}`)});if(!t)throw new NotFoundError(`Not found: ${e}`);const{doc:r}=t;return{...r,_id:e}}async put(e){await this.ready(),this.logger.Debug().Str("id",e._id).Msg("put");const{_id:t,...r}=e,n=t||this.sthis.timeOrderedNextId().str,i=await this._writeQueue.push({id:n,value:{...r,_id:n}});return{id:n,clock:null==i?void 0:i.head,name:this.name}}async del(e){await this.ready(),this.logger.Debug().Str("id",e).Msg("del");const t=await this._writeQueue.push({id:e,del:!0});return{id:e,clock:null==t?void 0:t.head,name:this.name}}async changes(e=[],t={}){await this.ready(),this.logger.Debug().Any("since",e).Any("opts",t).Msg("changes");const{result:r,head:n}=await this._crdt.changes(e,t),i=r.map(({id:e,value:t,del:r,clock:n})=>({key:e,value:r?{_id:e,_deleted:!0}:{_id:e,...t},clock:n}));return{rows:i,clock:n,name:this.name}}async allDocs(e={}){await this.ready(),this.logger.Debug().Msg("allDocs");const{result:t,head:r}=await this._crdt.allDocs(),n=t.map(({id:e,value:t,del:r})=>({key:e,value:r?{_id:e,_deleted:!0}:{_id:e,...t}}));return{rows:n,clock:r,name:this.name}}async allDocuments(){return this.allDocs()}subscribe(e,t){return this.logger.Debug().Bool("updates",t).Msg("subscribe"),t?(this._listening||(this._listening=!0,this._crdt.clock.onTick(e=>{this._notify(e)})),this._listeners.add(e),()=>{this._listeners.delete(e)}):(this._noupdate_listeners.add(e),()=>{this._noupdate_listeners.delete(e)})}async query(e,t={}){await this.ready(),this.logger.Debug().Any("field",e).Any("opts",t).Msg("query");const r=this._crdt,n="string"==typeof e?index$1(this.sthis,{_crdt:r},e):index$1(this.sthis,{_crdt:r},makeName(e.toString()),e);return await n.query(t)}async compact(){await this.ready(),await this._crdt.compact()}async _notify(e){if(await this.ready(),this._listeners.size){const t=e.map(({id:e,value:t})=>({...t,_id:e}));for(const e of this._listeners)await(async()=>await e(t))().catch(e=>{this.logger.Error().Err(e).Msg("subscriber error")})}}async _no_update_notify(){if(await this.ready(),this._noupdate_listeners.size)for(const e of this._noupdate_listeners)await(async()=>await e([]))().catch(e=>{this.logger.Error().Err(e).Msg("subscriber error")})}},_e.databases=new Map,_e);function toSortedArray(e){return e?Object.entries(e).sort(([e],[t])=>e.localeCompare(t)).map(([e,t])=>({[e]:t})):[]}function fireproof(e,t){var r;const n=JSON.stringify(toSortedArray({name:e,stores:toSortedArray(null==(r=null==t?void 0:t.store)?void 0:r.stores)}));let i=Database.databases.get(n);return i||(i=new Database(e,t),Database.databases.set(n,i)),i}function makeName(e){let t=null;return 0===Array.from(e.matchAll(/\(([^,()]+,\s*[^,()]+|\[[^\]]+\],\s*[^,()]+)\)/g),e=>e[1].trim()).length&&(t=/=>\s*{?\s*([^{}]+)\s*}?/.exec(e),t&&t[1].includes("return")&&(t=null)),t?t[1]:e}var runtime_exports={};function getPath(e,t){const r=e.pathname,n=e.getParam("name");if(n){const i=e.getParam("version");if(!i)throw t.logger.Error().Url(e).Msg("version not found").AsError();return t.pathOps.join(r,i,n)}return t.pathOps.join(r)}function getFileName(e,t){const r=e.getParam("key");if(!r)throw t.logger.Error().Url(e).Msg("key not found").AsError();const n=getStore(e,t,(...e)=>e.join("-"));switch(n.store){case"data":return t.pathOps.join(n.name,r+".car");case"wal":case"meta":return t.pathOps.join(n.name,r+".json");default:throw t.logger.Error().Url(e).Msg("unsupported store type").AsError()}}__export(runtime_exports,{FILESTORE_VERSION:()=>FILESTORE_VERSION,INDEXDB_VERSION:()=>INDEXDB_VERSION,files:()=>files_exports,getFileName:()=>getFileName,getPath:()=>getPath,kb:()=>key_bag_exports,kc:()=>keyed_crypto_exports,mf:()=>wait_pr_multiformats_exports,runtimeFn:()=>runtimeFn});var wait_pr_multiformats_exports={};__export(wait_pr_multiformats_exports,{block:()=>block_exports,codec:()=>codec_interface_exports});var codec_interface_exports={},FILESTORE_VERSION="v0.19-file",INDEXDB_VERSION="v0.19-indexdb";function deepClone(e){return"undefined"!=typeof structuredClone?structuredClone(e):JSON.parse(JSON.stringify(e))}function useFireproof(e="useFireproof",t={}){const r="string"==typeof e?fireproof(e,t):e,n=reactExports.useRef(!1);return{database:r,useLiveQuery:function(e,t={},n=[]){const[i,o]=reactExports.useState(()=>{const e=n.map(e=>e.doc).filter(e=>!!e);return{rows:n,docs:e,length:e.length,map:t=>e.map(t),filter:t=>e.filter(t),forEach:t=>e.forEach(t),[Symbol.iterator]:()=>e[Symbol.iterator]()}}),s=reactExports.useMemo(()=>JSON.stringify(t),[t]),a=reactExports.useMemo(()=>e.toString(),[e]),l=reactExports.useCallback(async()=>{const n=await r.query(e,t),i=n.rows.map(e=>e.doc).filter(e=>!!e);o({...n,docs:i,length:i.length,map:e=>i.map(e),filter:e=>i.filter(e),forEach:e=>i.forEach(e),[Symbol.iterator]:()=>i[Symbol.iterator]()})},[a,s]);return reactExports.useEffect(()=>(l(),r.subscribe(l)),[l]),i},useDocument:function(e){let t;t="function"==typeof e?e():e??{};const i=reactExports.useMemo(()=>deepClone({...t}),[]),[o,s]=reactExports.useState(t),a=reactExports.useCallback(async()=>{const e=o._id?await r.get(o._id).catch(()=>t):t;s(e)},[o._id]),l=reactExports.useCallback(async e=>{n.current=!1;const t=e??o,i=await r.put(t);return n.current||o._id||e||s(e=>({...e,_id:i.id})),i},[o]),c=reactExports.useCallback(async e=>{const n=(null==e?void 0:e._id)??o._id;if(!n)throw r.logger.Error().Msg("Document must have an _id to be removed").AsError();if(!(await r.get(n).catch(()=>{})))throw r.logger.Error().Str("id",n).Msg("Document not found").AsError();const i=await r.del(n);return s(t),i},[o,t]),u=reactExports.useCallback(e=>{n.current=!0,s(t=>({...t,...e}))},[]),d=reactExports.useCallback(e=>{n.current=!0,s(e)},[]),h=reactExports.useCallback(()=>{n.current=!0,s({...i})},[i]),f=reactExports.useCallback((e,t={replace:!1,reset:!1})=>e?t.replace?d(e):u(e):t.reset?h():a(),[a,h,d,u]);reactExports.useEffect(()=>{if(o._id)return r.subscribe(e=>{n.current||e.find(e=>e._id===o._id)&&a()},!0)},[o._id,a]),reactExports.useEffect(()=>{a()},[a]);const p=reactExports.useCallback(async e=>{(null==e?void 0:e.preventDefault)&&e.preventDefault(),await l(),h()},[l,h]),y={doc:{...o},merge:u,replace:d,reset:h,refresh:a,save:l,remove:c,submit:p},g=[{...o},f,l,c,h,a];return Object.assign(y,g),Object.defineProperty(y,Symbol.iterator,{enumerable:!1,value:function*(){yield*g}}),y},useAllDocs:function(e={}){const[t,n]=reactExports.useState({docs:[]}),i=reactExports.useMemo(()=>JSON.stringify(e),[e]),o=reactExports.useCallback(async()=>{const t=await r.allDocs(e);n({...t,docs:t.rows.map(e=>e.value)})},[i]);return reactExports.useEffect(()=>(o(),r.subscribe(o)),[o]),t},useChanges:function(e=[],t={}){const[n,i]=reactExports.useState({docs:[]}),o=reactExports.useMemo(()=>JSON.stringify(t),[t]),s=reactExports.useCallback(async()=>{const n=await r.changes(e,t);i({...n,docs:n.rows.map(e=>e.value)})},[e,o]);return reactExports.useEffect(()=>(s(),r.subscribe(s)),[s]),n}}}function topLevelUseLiveQuery(...e){const{useLiveQuery:t,database:r}=useFireproof();return topLevelUseLiveQuery.database=r,t(...e)}Object.keys({"0.19.125":"xxxx"})[0];var useLiveQuery=topLevelUseLiveQuery;const db=fireproof("demo-app");function useTodos(){return useLiveQuery("type",{key:"todo"}).docs||[]}function useDatabaseStatus(){const[e,t]=reactExports.useState({connected:!1,documents:0,size:0,lastModified:0});return reactExports.useEffect(()=>{const e=async()=>{try{const e=await db.query("type",{key:"note"});t({connected:!0,documents:e.rows.length,size:0,lastModified:Date.now()})}catch(e){t(e=>({...e,connected:!1}))}};e();const r=setInterval(e,5e3);return()=>clearInterval(r)},[]),e}function useTodoOperations(){return{addTodo:async e=>await db.put({_id:crypto.randomUUID(),type:"todo",text:e,done:!1,created:Date.now()}),toggleTodo:async(e,t)=>{const r=await db.get(e);if(r)return await db.put({...r,done:t})},deleteTodo:async e=>await db.del(e)}}function TodoList(){const[e,t]=reactExports.useState(""),r=useTodos(),{addTodo:n,toggleTodo:i,deleteTodo:o}=useTodoOperations(),s=async()=>{e.trim()&&(await n(e.trim()),t(""))};return jsxRuntimeExports.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"🍒 Fireproof Todo List"}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2 mb-4",children:[jsxRuntimeExports.jsx("input",{type:"text",value:e,onChange:e=>t(e.target.value),onKeyPress:e=>{"Enter"===e.key&&s()},placeholder:"Add a new todo...",className:"flex-1 px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-purple-400"}),jsxRuntimeExports.jsx("button",{onClick:s,disabled:!e.trim(),className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg transition-colors",children:"Add"})]}),jsxRuntimeExports.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:0===r.length?jsxRuntimeExports.jsx("p",{className:"text-white/60 text-center py-4",children:"No todos yet. Add one above! ✨"}):r.sort((e,t)=>t.created-e.created).map(e=>jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/5 rounded-lg border border-white/10",children:[jsxRuntimeExports.jsx("input",{type:"checkbox",checked:e.done,onChange:t=>(async(e,t)=>{await i(e,t)})(e._id,t.target.checked),className:"w-4 h-4 text-purple-600 bg-white/10 border-white/20 rounded focus:ring-purple-400"}),jsxRuntimeExports.jsx("span",{className:"flex-1 "+(e.done?"line-through text-white/60":"text-white"),children:e.text}),jsxRuntimeExports.jsx("button",{onClick:()=>(async e=>{await o(e)})(e._id),className:"text-red-400 hover:text-red-300 transition-colors",title:"Delete todo",children:"🗑️"})]},e._id))}),jsxRuntimeExports.jsx("div",{className:"mt-4 pt-4 border-t border-white/10",children:jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-sm text-white/60",children:[jsxRuntimeExports.jsxs("span",{children:["Total: ",r.length]}),jsxRuntimeExports.jsxs("span",{children:["Done: ",r.filter(e=>e.done).length]}),jsxRuntimeExports.jsxs("span",{children:["Remaining: ",r.filter(e=>!e.done).length]})]})})]})}const App$1="";function App(){const[e,t]=reactExports.useState(null),[r,n]=reactExports.useState(!0),[i,o]=reactExports.useState(null),[s,a]=reactExports.useState(!1),l=useDatabaseStatus(),{addTodo:c}=useTodoOperations();return reactExports.useEffect(()=>{(async()=>{try{const e=await fetch("/api/health");if(e.ok){const r=await e.json();t(r)}else o("Failed to connect to backend")}catch(e){o("Backend not available")}finally{n(!1)}})()},[]),jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900",children:jsxRuntimeExports.jsxs("div",{className:"container mx-auto px-4 py-8",children:[jsxRuntimeExports.jsxs("header",{className:"text-center mb-12",children:[jsxRuntimeExports.jsx("h1",{className:"text-5xl font-bold text-white mb-4",children:"demo-app"}),jsxRuntimeExports.jsx("p",{className:"text-xl text-purple-200",children:"Built with Go + Gin • TinyApp Factory"})]}),jsxRuntimeExports.jsxs("div",{className:"max-w-4xl mx-auto",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl p-8 mb-8 border border-white/20",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-semibold text-white mb-6",children:"🚀 System Status"}),r&&jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center py-8",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"}),jsxRuntimeExports.jsx("span",{className:"ml-3 text-white",children:"Checking backend..."})]}),i&&jsxRuntimeExports.jsxs("div",{className:"bg-red-500/20 border border-red-500/50 rounded-lg p-4",children:[jsxRuntimeExports.jsxs("p",{className:"text-red-200",children:["⚠️ ",i]}),jsxRuntimeExports.jsx("p",{className:"text-red-300 text-sm mt-2",children:"Make sure the backend is running on port 3000"})]}),e&&jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 bg-green-400 rounded-full animate-pulse"}),jsxRuntimeExports.jsx("span",{className:"text-green-200 font-medium",children:"Backend Connected"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white/5 rounded-lg p-4",children:[jsxRuntimeExports.jsxs("p",{className:"text-white/80",children:[jsxRuntimeExports.jsx("strong",{children:"Status:"})," ",e.status]}),jsxRuntimeExports.jsxs("p",{className:"text-white/80",children:[jsxRuntimeExports.jsx("strong",{children:"Message:"})," ",e.message]}),jsxRuntimeExports.jsxs("p",{className:"text-white/80",children:[jsxRuntimeExports.jsx("strong",{children:"Stack:"})," ",e.stack]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl p-8 mb-8 border border-white/20",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-semibold text-white mb-6",children:"🍒 Fireproof Database"}),jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full "+(l.connected?"bg-green-400 animate-pulse":"bg-red-400")}),jsxRuntimeExports.jsx("span",{className:"font-medium "+(l.connected?"text-green-200":"text-red-200"),children:l.connected?"Database Connected":"Database Disconnected"})]}),jsxRuntimeExports.jsx("div",{className:"bg-white/5 rounded-lg p-4",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-white/60",children:"Documents:"}),jsxRuntimeExports.jsx("span",{className:"text-white ml-2",children:l.documents})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-white/60",children:"Size:"}),jsxRuntimeExports.jsxs("span",{className:"text-white ml-2",children:[l.size," bytes"]})]})]})}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>a(!s),className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[s?"Hide":"Show"," Todo Demo"]}),jsxRuntimeExports.jsx("button",{onClick:()=>c("Sample todo from demo!"),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"Add Sample Data"})]})]})]}),s&&jsxRuntimeExports.jsx("div",{className:"mb-8",children:jsxRuntimeExports.jsx(TodoList,{})}),jsxRuntimeExports.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl p-8 border border-white/20",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-semibold text-white mb-6",children:"🎯 Next Steps"}),jsxRuntimeExports.jsxs("div",{className:"space-y-4 text-white/80",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start space-x-3",children:[jsxRuntimeExports.jsx("span",{className:"text-purple-400 font-bold",children:"1."}),jsxRuntimeExports.jsxs("p",{children:["Customize this UI in ",jsxRuntimeExports.jsx("code",{className:"bg-white/10 px-2 py-1 rounded",children:"frontend/src/App.tsx"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-start space-x-3",children:[jsxRuntimeExports.jsx("span",{className:"text-purple-400 font-bold",children:"2."}),jsxRuntimeExports.jsxs("p",{children:["Add API endpoints in ",jsxRuntimeExports.jsx("code",{className:"bg-white/10 px-2 py-1 rounded",children:"main.go"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-start space-x-3",children:[jsxRuntimeExports.jsx("span",{className:"text-purple-400 font-bold",children:"3."}),jsxRuntimeExports.jsxs("p",{children:["Build for production with ",jsxRuntimeExports.jsx("code",{className:"bg-white/10 px-2 py-1 rounded",children:'go build -ldflags="-s -w"'})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-start space-x-3",children:[jsxRuntimeExports.jsx("span",{className:"text-purple-400 font-bold",children:"4."}),jsxRuntimeExports.jsx("p",{children:"Deploy your single binary anywhere!"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl p-8 mt-8 border border-white/20",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-semibold text-white mb-6",children:"✨ Features"}),jsxRuntimeExports.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-white/80",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3",children:[jsxRuntimeExports.jsx("span",{className:"text-green-400",children:"✅"}),jsxRuntimeExports.jsx("span",{children:"Single binary deployment"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3",children:[jsxRuntimeExports.jsx("span",{className:"text-green-400",children:"✅"}),jsxRuntimeExports.jsx("span",{children:"Embedded frontend assets"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3",children:[jsxRuntimeExports.jsx("span",{className:"text-green-400",children:"✅"}),jsxRuntimeExports.jsx("span",{children:"Hot reload development"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3",children:[jsxRuntimeExports.jsx("span",{className:"text-green-400",children:"✅"}),jsxRuntimeExports.jsx("span",{children:"Health check API"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3",children:[jsxRuntimeExports.jsx("span",{className:"text-green-400",children:"✅"}),jsxRuntimeExports.jsx("span",{children:"Modern React UI"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-3",children:[jsxRuntimeExports.jsx("span",{className:"text-green-400",children:"✅"}),jsxRuntimeExports.jsx("span",{children:"Tailwind CSS styling"})]})]})]})]}),jsxRuntimeExports.jsx("footer",{className:"text-center mt-12 text-white/60",children:jsxRuntimeExports.jsx("p",{children:"Built with ❤️ using TinyApp Factory"})})]})})}const index="";client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));export{KeyedResolvOnce as K,NotFoundError as N,Result as R,exception2Result as a,exceptionWrapper as b,ResolveOnce as c,getKey as d,ensureLogger as e,getStore as g,runtime_exports as r};
